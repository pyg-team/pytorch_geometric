Title: IBM TKLM Login accounts hang and loose their credentials after recycling TIP. - United States

Text:
Gui log in logging login hang hangs hanging freeze freezes freezing portal loggin TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 After recyling Tivoli Integrated Portal-TIPProfile_Port_16310, tipadmin and other user-created accounts can not log in and hang. "Role Management" in navigation menu also hangs for tipadmin account 

SYMPTOM
GUI hangs


CAUSE
TIP software level needs to be upgraded

DIAGNOSING THE PROBLEM
Detailed problem description: 

TKLM version 2 with fixpack 3 is installed on Windows 2008 64 bit system and working fine. 
Installed TKLM fixpack 4. Installation went fine but problem started to arise with logins when TKLM accounts loose their credentials after recycling the TIP service: 
Tivoli Integrated Portal-TIPProfile_Port_16310. 

We start out with everything working fine. "Test" id and tipadmin id are able to logon and also tklmadmin. For tipadmin, the navigation panel - Role Management is accessible and manageable. 

Only when we stop/start or restart:Tivoli Integrated Portal-TIPProfile_Port_16310 we start having problems as follows: 

After restarting the Tivoli Integrated Portal(TIP), we try to login using tipadmin and get the welcome page with an error below: 

Action items 
User tipadmin does not have a valid Tivoli Key Lifecycle Manager role. 
Some roles require both device group and action permissions. Verify 
that the user's role has appropriate permissions. 
You are unable to see the information provided on this page. 

So for some reasons, restarting TIP caused the loss of credentials for tipadmin and also the other users. We click on Role Management, it hangs. Logs like Systemout.log and others haven't been modified after this action. 

We attempted to stop Portal-TIPProfile_Port_16310 but failed with: 

============ 
Services: 
Windows could not stop the Tivoli Integrated Portal - 
TIPProfile_Port_16310 
service on Local Computer. 
Error 1053: The service did not respond to the start or 
control request in a timely fashion. 
============ 

The "Service status:" on that window says: Stopping. 
So it is hanging. 

Workaround: 
We then go to the processes list and we manually kill: 
java.exe*32. There are two of them. After that the "Service status:" 
on the previous window changed to: Stopped. So the hang got cleared up and we were 
able to start TIP successfully. But... 
When we logged in as tipadmin, an error appears: 

============ 
"Another user is currently logged in with the same user ID" 
and gives the option to logoff the other user or relogin with a 
different user. 
============

We hit OK then get this error: 

============ 
Action items 
User tipadmin does not have a valid Tivoli Key Lifecycle Manager role. 
Some roles require both device group and action permissions. Verify 
that the user's role has appropriate permissions. 
You are unable to see the information provided on this page. 
============ 

To clear that, we login as tklmadmin and wait till it loads completely 
the navigation panel. We click on some items here and there, example: 
- view management portlet management 
- Console pref profile 
- Manage global refresh 
- Role mgmt is normal now 

We then login as tipadmin and everything works fine from that point on 
until the next tip restart and the scenario repeats again. 


RESOLVING THE PROBLEM
The cause of the problem is an old version of TIP that has this issue. A newer version of TIP fixed this problem. Refer to TIP APAR PM41277 for more details. Currently the server is on TIP 1.1.1.17. The latest version of TIP is 2.2.0.9. 


To fix this problem in TKLM environment, replace the two following files: 
- isclite.jar 
- iscadminportlets.jar 

You will need to open a PMR to have a support person send you the two jar files. 
Follow the steps below to replace existing files: 

0. Stop TIP or kill it from task manager. 
1. cd <TIPHOME>/systemApps/isclite.ear 
2. Make a backup copy of original file isclite.jar 
3. Replace isclite.jar with attached file. 
4. cd <TIPHOME>/systemApps/isclite.ear/ISCAdminPortlets.war/WEB-INF/lib 
5. Make a back up copy of iscadminportlets.jar 
6. Replace iscadminportlets.jar with attached file. 
7. Start TIP 

After replacement, this symptom disappears and user can login successfully by using each account without any abnormality.

You can safely apply the test fix on other servers if you run into similar issues after the upgrade. Since test fix can be undone by restoring the files to original version so there is no risk in applying the fix. 

[/support/docview.wss?uid=swg21623655&aid=2]iscadminportlets.jar [/support/docview.wss?uid=swg21623655&aid=1][/support/docview.wss?uid=swg21623655&aid=4]isclite.jar [/support/docview.wss?uid=swg21623655&aid=3]