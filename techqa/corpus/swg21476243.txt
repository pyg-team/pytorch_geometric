Title: IBM How do I carry out an unattended (silent) installation of SPSS or SPSS Statistics for Windows? - United States

Text:
 TECHNOTE (FAQ)

QUESTION
 How do I carry out an unattended (silent) installation of SPSS or SPSS Statistics for Windows? 

ANSWER
An unattended SPSS installation requires adding the responses a user would normally input during the installation as properties to the MSI file or as parameters to a command line. The following are the available properties (parameters) for unattended installations on Windows. 

NOTE: If you are performing an unattended installation with Statistics 19, please see also resolution 91305.

COMPANYNAME: Registers your company's name in the Help->About menu for each installation. 

ISX_SERIALNUM: Registers the serial number provided by SPSS Inc. in the Help->About menu for each installation This number can help Technical Support identify a registered user should that user require assistance from SPSS Technical Support.

INSTALLDIR: The directory where SPSS for Windows should be installed on the end user's desktop computer. For example: 

C:\Program Files\SPSSInc\SPSS16
C:\Program Files\SPSSInc\PASWStatistics17

(Please Note: The directory must exist on the system for the installation to be successful)

AUTHCODE: The authorization code that came with your software which requests a license for SPSS for Windows. Specify this property only if you have purchased a site license. Multiple authorization codes must be separated by colons (for example, authcode1:authcode2:authcode3).

PROXY_USERID: The user ID for the proxy. This parameter is necessary when you specify the AUTHCODE parameter and your site is using a proxy that requires a user ID and password to connect to the Internet. This parameter works only if the Local Area Network (LAN) settings in the Internet Settings control panel reference a specific proxy server address and port.

PROXY_PASSWORD: The password for the proxy user. Refer to the discussion of PROXY_USERID for more information.

SPSSLICENSE: The license type. Specify this property only if you have purchased a network license (using a network license manager to monitor concurrent usage). The only valid value, which is case sensitive, is

Network

NOTE: starting with version 18, use LICENSETYPE instead of SPSSLICENSE.



LSHOST: The IP address or the host name of the network computer on which the network license manager is running. Specify this property only if you have purchased a network license (using a network license manager to monitor concurrent usage). A valid value is an IP address or network computer name.

COMMUTE_MAX_LIFE: The maximum number of days for which an end user can check out a commuter license. Specify this property only if you have purchased a network license (using a network license manager to monitor concurrent usage). If you do not specify this property, the default maximum life is 7 days. Valid values are between 1 and 30.

DISABLE_COMMUTE: Disables the commuter license functionality on the end user's computer. If this property is specified, no shortcuts for commuting the license will be installed on the computer. The only valid value is "1", which indicates that commuter licenses are disabled.

The first step is to decide how to deploy each installation. No matter which method you choose, the preparation is basically the same, i.e. you pass the user input as properties (parameters) to the installation.

Note: If you intend to deploy an unattended installation to a directory where a previous version resides, you must first uninstall the old version using one of the following command lines. Please note you will lose all customization from the previous version.

If the user has SPSS 13.0 installed:
msiexec /X{DB8CEC42-30B1-4F49-BD06-9393EB81CCF7} /qn ALLUSERS=1 REMOVE="ALL"

If the user has SPSS 14.0 installed:
msiexec /X{0AE19D89-17A9-404D-932A-FAAF43F3C77E} /qn ALLUSERS=1 REMOVE="ALL"

If the user has SPSS 15.0 installed:
msiexec /X{15B25E12-3E5F-4C13-A637-9EC72A55491E} /qn ALLUSERS=1 REMOVE="ALL"

Place the SPSS CD-ROM in the drive and share it for machines to access it over the network. For performance reasons, it may be a good idea to copy the contents of the CD to the hard drive and share that location. The examples below assume the SPSS directory from the CD image is the shared directory. 

Please follow the msiexec instructions here as the webpage instructions assume 17.0.0 is already installed.

You can distribute the command line to each machine via third party software, e.g. SMS or Active Directory Group Policy, or run the command line manually on each machine. If you wish to see a basic user interface while the installation is running, specify /qb instead of /qn. Generating an installation log file (/L*V "<path>") is optional, but is a good resource for diagnosing problems with unattended installations. Below are some examples of command line installations:

Site License:

For SPSS 16:

msiexec /i "\\ServerName\SPSS\SPSS 16.0 for Windows.msi" /qb /L*V "<path>\spss16install.log" COMPANYNAME="My Company" ISX_SERIALNUM="999999" INSTALLDIR="c:\spss16" AUTHCODE="authcode1:authcode2:authcode3" PROXY_USERID="userid" PROXY_PASSWORD="password"

For PASW Statistics 17:
msiexec /i "\\ServerName\PASW Statistics 17.0.2.msi" /qb /L*V "<path>\spss17install.log" COMPANYNAME="My Company" ISX_SERIALNUM="999999" INSTALLDIR="C:\Program Files\SPSSInc\PASWStatistics17" AUTHCODE="authcode1:authcode2:authcode3" PROXY_USERID="userid" PROXY_PASSWORD="password"

For PASW Statistics 18:
MsiExec.exe /i "PASW Statistics 18.msi" /qb /L*V "<path>\spss18install.log" COMPANYNAME="My Company" ISX_SERIALNUM="999999" INSTALLDIR="C:\Program Files\SPSSInc\PASWStatistics17" AUTHCODE="authcode1:authcode2:authcode3" PROXY_USERID="userid" PROXY_PASSWORD="password"

Note: The characters of the authorization code(s) must be specified in all lowercase. The PROXY_USERNAME and PROXY_PASSWORD parameters are not necessary unless you require a user name and password to access the internet. If you do use a proxy to access the internet, you must have your proxy server settings defined in Internet Explorer options. To verify, open Internet Explorer, go to Tools->Options, select the 'Connections' tab, and click the 'LAN Settings' button. Make sure the 'Use a proxy server for your LAN' box is checked and that your proxy server and port are specified. If your proxy server settings are not listed here, you may not be able to automate licensing. 

Network License:

msiexec /i "ServerName\PASW Statistics 17.0.2.msi" /qb/log "C:\Program Files\SPSSInc\Statistics17\log.log" COMPANYNAME="My Company" ISX_SERIALNUM="999999" INSTALLDIR="C:\Program Files\SPSSInc\PASWStatistics17" SPSSLICENSE="Network" LSHOST="123.123.123.123"

For PASW Statistics 18:

MsiExec.exe /i "PASW Statistics 18.msi" /qn /L*V "<path>\spss18install.log" INSTALLDIR="C:\Statistics" LICENSETYPE="Network" LSHOST="mylicserver"


Active Directory Group Policy Installation:

You can add the above properties to the "SPSS 16.0 for Windows.msi" or "SPSS Statistics 17.msi" file or create a transform file using an MSI editor, such as ORCA. 

Note: ORCA is part of the Windows Installer SDK available for download from Microsoft's web site:

http://www.microsoft.com/downloads [http://www.microsoft.com/downloads] 

Open the *.msi file into the MSI editor, locate the "Property" table, and add the desired properties to it. Save the changes (or create a transform file) and distribute the updated MSI (or transform) via Active Directory Group Policy.

SMS (Systems Management Server) Installation:

The SPSS 16.0 for Windows and SPSS Statistics 17 CD-ROM contain a package definition file that can be used for installations distributed via SMS. This file, called SPSS 16.0 for Windows.sms or SPSS Statistics 17.sms, is located in the SPSS or SPSS Statistics directory on the CD-ROM. You will need to modify this file, using any text editor, to reflect the appropriate command line for your installation. The following is the default command line:

CommandLine = msiexec /qn /I "SPSS Statistics 17.msi"

Uninstallation:

To carry out an unattended uninstall for SPSS/Statistics for Windows, please use the following command lines:

PASW Statistics 18:
MsiExec.exe /X{C25215FC-5900-48B0-B93C-8D3379027312} /qn /L*v ALLUSERS=1 REMOVE="ALL"

Statistics 17.0
MsiExec.exe /X{46B65150-F8AA-42F2-94FB-2729A8AE5F7E} /qn ALLUSERS=1 REMOVE="ALL"

SPSS 16.0
msiexec /X{621025AE-3510-478E-BC27-1A647150976F} /qn ALLUSERS=1 REMOVE="ALL"
16.0.1 Patch > MsiExec.exe /X{8FDDA9B3-1969-48B2-B307-6EB267B5E0C6} /qn ALLUSERS=1 REMOVE="ALL"
16.0.2 Patch > MsiExec.exe /X{FFA913A1-E2F5-41F9-A7FB-73C672F81781} /qn ALLUSERS=1 REMOVE="ALL"

SPSS 15.0
MsiExec.exe /X{15B25E12-3E5F-4C13-A637-9EC72A55491E} /qn ALLUSERS=1 REMOVE="ALL"

Amos 16.0 > MsiExec.exe /X{4DA782CB-C9A0-462F-9D18-17D301BC507C} /qn ALLUSERS=1 REMOVE="ALL"

SPSS for Macintosh and Linux allow for unattended installations. Please locate a file called "SilentInstallOptions" in the root of the SPSS installation CD. Open the file in any text editor and modify the value(s) for any of the listed properties. For each property that you change, uncomment the property by removing "###" from that line. When finished, save the file. For example, if you wanted to change the installation directory, substitute the new path for "<value>", then remove "###" from the line to uncomment it, and finally, save the file.

### -V INSTALLDIR="<value>"

To invoke the unattended installation, run the following command lines:

Macintosh:

./setup.command -silent -options "SilentInstallOptions"

Linux:

./setup.bin -silent -options "SilentInstallOptions"



HISTORICAL NUMBER
 73286