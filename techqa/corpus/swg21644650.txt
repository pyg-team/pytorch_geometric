Title: IBM Information Server job fails to connect to SQL Server using HostName=<SQL_Server_host>/instance_name in the data source. - United States

Text:
SQLSTAGE=S1000 DBMS.CODE=0 SQL Server ODBC instance name TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 DataStage job connecting to SQL Server fails with the following error:

DSD.BCIConnect Connecting to <database_name>, call to function SQLConnect failed. SQLSTAGE=S1000, DBMS.CODE=0

[DataStage] [SQL Client] [ODBC] [IBM (DataDirect OEM)] [ODBC SQL Server Wire Protocol driver] General error. select failed: 0 

SYMPTOM
HostName=<SQL_Server_host>/instance_name
PortNumber=1434 


ODBC Trace has the following error: 


EXIT SQLError with return code 0 (SQL_SUCCESS)
HENV 0x0000000059c580
HDBC 0x000000005a1aa0
HSTMT (nil)
UCHAR * 0x007fffffffd770 [ 5] "S1000"
SDWORD * 0x007fffffffd56c (0)
UCHAR * 0x007fffffffd570 [ 90] "[IBM(DataDirect OEM)][ODBC SQL Server Wire Protocol driver]General error. select failed: 0" 
SWORD 511
SWORD * 0x007fffffffd56a (90)


CAUSE
Cause: 

 * incorrect hostname specified 
 * incorrect instancename specified 
 * SQL Server browser is not listening (or there is a firewall issue blocking communication) 
 * Known bug within Data Direct when the instance name is less than 12 characters.

DIAGNOSING THE PROBLEM
To obtain driver version: 

 1. cd into $DSEngine directory 
 2. source the dsenv file: . ./dsenv 
 3. cd ../branded_odbc/bin 
 4. For 64bit ODBC driver manger, run ./ddtestlib <path to VMsqls##.so> For 32bit ODBC driver manger, run ./ivtestlib <path to VMsqls##.so>

RESOLVING THE PROBLEM
Resolution: 

 * Ensure the specified hostname or IP-address is correct 
 * When specifying an instancename, ensure the instance name is correct and the Microsoft SQL Server Browser service is running (which listens on UDP port 1434). e.g.
   HostName=hostname\instancename 
 * If the SQL Server browser service cannot be started, do not refer to the instance name but specify the correct portnumber on which the SQL Server instance is listening on. e.g.
   HostName=hostname
   PortNumber=1234 
 * Known bug within Data Direct when the instance name is less than 12 characters. The fix was made in the ODBC 7.1, 7.0, and 6.1 SQL Server Wire Protocol drivers in the following versions: 07.01.0080 (B0091, U0062) 07.10.0019 (B0020, U0014) 06.12.0181 ((B0174, U0081) Note: Please verify the latest branded ODBC driver. So far I have download and verified the latest branded ODBC driver version 6.1 for Linux: LINUX64-61-odbc61-130605.tar.gz $ ./bin/ddtestlib ./lib/VMsqls25.so Load of ./lib/VMsqls25.so successful, qehandle is 0xC8C5060 File version: 06.12.0181 (B0174, U0081) 

RELATED INFORMATION
 http://knowledgebase.progress.com/articles/Article/8705 [http://knowledgebase.progress.com/articles/Article/8705]