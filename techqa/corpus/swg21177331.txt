Title: IBM decomposing documents larger than 1MB - United States

Text:
 TECHNOTE (FAQ)

QUESTION
 The XML document input parameter to dxxShredXML and dxxInsertXML stored procedures limited the document to be of size <= 1MB. The previous suggested method of bypassing this limitation was to drop and recreate dxxShredXML and/or dxxInsertXML with a larger declared input parameter. 

ANSWER
To decompose documents larger than 1MB, it's no longer necessary to drop and recreate the stored procedures dxxShredXML, dxxInsertXML. 

On DB2 for Unix/Windows v7:
To decompose such a document, invoke the stored procedure dxxShredXML50MB, which can shred documents up to 50MB. When a XML collection has previously been enabled, dxxInsertXML50MB may be used to decompose documents up to 50MB. Note that although these two stored procedures can accept large documents, the user may need to adjust other system or DB2 resources in order for the stored procedures to successfully shred large documents. To invoke the new stored procedure dxxShredXML50MB via the sample program "shred," use the new flag "-large".
Example: "shred -large mydb xxx.xml"

To invoke the new stored procedure dxxInsertXML50MB via the sample program "insertx," 
use the new flag "-large". 
Example: "insertx -large mydb xxx.xml"

Decomposing single documents of size greater than 50MB on v7 is not recommended, as other DB2 limits will be encountered.


On DB2 for Unix/Windows v8:
To decompose such a document, invoke the stored procedure dxxShredXML100MB, which can shred documents up to 100MB. When a XML collection has previously been enabled, dxxInsertXML100MB may be used to decompose documents up to 100MB. Note that although these two stored procedures can accept large documents, the user may need to adjust other system or DB2 resources in order for the stored procedures to successfully shred large documents. To invoke the new stored procedure dxxShredXML100MB via the sample program "dxxshrd," use the new flag "-large".
Example: "dxxshrd -large mydb xxx.xml"

To invoke the new stored procedure dxxInsertXML100MB via the sample program "dxxisrt," 
use the new flag "-large". 
Example: "dxxisrt -large mydb xxx.xml"

On DB2 for zOS v8:
To decompose such a document, invoke the stored procedure dxxShredXML100MB, which can shred documents up to 100MB. When a XML collection has previously been enabled, dxxInsertXML100MB may be used to decompose documents up to 100MB. Note that although these two stored procedures can accept large documents, the user may need to adjust other system or DB2 resources in order for the stored procedures to successfully shred large documents.

On DB2 or as400/iSeries V5R1 or V5R2:
To decompose documents > 1MB on DB2 for as400/iSeries, continue to use the old method of dropping and recreating the dxxShredXML and/or dxxInsertXML stored procedures.

On DB2 or as400/iSeries V5R3:
The dxxShredXML100MB and dxxInsertXML100MB stored procedures are available with PTF 5722DE1 V5R3M0 SI17983. 

To decompose such a document, invoke the stored procedure dxxShredXML100MB, which can shred documents up to 100MB. When a XML collection has previously been enabled, dxxInsertXML100MB may be used to decompose documents up to 100MB. Note that although these two stored procedures can accept large documents, the user may need to adjust other system or DB2 resources in order for the stored procedures to successfully shred large documents.

Passing a document greater than 16M requires additional changes to your application program. 
The following are sample lines of code to show how to define a CLOB parameter of size >64M that can be used with these new stored procedures: 

SQL TYPE is CLOB(100M) *xmlobjp;

xmlobjp = (_Packed struct xmlobjp_t *) malloc( sizeof (*xmlobjp));
if (xmlobjp ==NULL) {
fprintf(stderr, "Malloc() error.\n");
goto exit;
}

EXEC SQL CALL DB2XML.DXXSHREDXML100MB (
:dadobj:non_null_ind,
:*xmlobjp:non_null_ind,
:errCode:errCode_ind,
:msgtext:msgtext_ind);

The following compiler options must be used when compiling and building your application program that passes a clob of size > 16M.
TERASPACE(*YES *TSIFC) 
STGMDL(*TERASPACE)