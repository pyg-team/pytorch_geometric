Title: IBM Promoting a single server to a cluster in WebSphere Process Server requires the "resourcesScope" parameter to be set to "cluster" - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 If you create a cluster using an existing single server as the first cluster member, the process fails on WebSphere Process Server and WebSphere Enterprise Service Bus. 

SYMPTOM
You might see one of the following error messages in the administrative console or the SystemOut.log file of the deployment manager: 

 * "resourcesScope parameter needs to be set to 'cluster' if creating a cluster from an existing server" 
 * "CWWBZ0075E: Cannot create cluster '<clusterName>'. The value of the '-resourcesScope' parameter for the 'createCluster' or 'createClusterMember' command is not 'cluster'." 

=========================== 

The following exception can be found in the log files if you use AdminConfig.convertToCluster or AdminTask.createCluster tasks without using the "resourcesScope" parameter with the value "cluster" for WebSphere Process Server and WebSphere Enterprise Service Bus: 

00000000 AbstractShell E WASX7120E: Diagnostic information from exception with text "com.ibm.websphere.management.exception.ConfigServiceException 
com.ibm.websphere.management.exception.ConfigServiceException 
java.lang.Exception: java.lang.Exception: resourcesScope parameter needs to be set to 'cluster' if creating a cluster from an existing server 
" follows: 

com.ibm.websphere.management.exception.ConfigServiceException: java.lang.Exception: resourcesScope parameter needs to be set to 'cluster' if creating a cluster from an existing server 
at com.ibm.websphere.management.configservice.tasks.ServerClusterTasks.createCluster(ServerClusterTasks.java:249) 
at com.ibm.websphere.management.configservice.tasks.ServerClusterTasks.convertToCluster(ServerClusterTasks.java:174) 
at com.ibm.ws.scripting.AdminConfigClient.convertToCluster(AdminConfigClient.java:4183) 
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) 
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48) 
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37) 
at java.lang.reflect.Method.invoke(Method.java:600) 
at org.python.core.PyReflectedFunction.__call__(PyReflectedFunction.java) 
at org.python.core.PyMethod.__call__(PyMethod.java) 
at org.python.core.PyObject.__call__(PyObject.java) 
..... 
.... 

Caused by: java.lang.Exception: resourcesScope parameter needs to be set to 'cluster' if creating a cluster from an existing server 
at com.ibm.ws.sca.internal.admin.SCACreateCluster.executeStep(SCACreateCluster.java:137) 
at com.ibm.websphere.management.cmdframework.provider.AbstractTaskCommand.executeReal(AbstractTaskCommand.java:844) 
at com.ibm.websphere.management.cmdframework.provider.AbstractTaskCommand.access$000(AbstractTaskCommand.java:72) 
at com.ibm.websphere.management.cmdframework.provider.AbstractTaskCommand$1.run(AbstractTaskCommand.java:796) 
at com.ibm.ws.security.auth.ContextManagerImpl.runAs(ContextManagerImpl.java:4574) 
at com.ibm.ws.security.auth.ContextManagerImpl.runAsSpecified(ContextManagerImpl.java:4642) 
at com.ibm.websphere.management.cmdframework.provider.AbstractTaskCommand.execute(AbstractTaskCommand.java:794) 
at com.ibm.ws.management.cmdframework.impl.RemoteCommandMgrImpl.execute(RemoteCommandMgrImpl.java:362) 
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) 
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48) 
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37) 
at java.lang.reflect.Method.invoke(Method.java:600) 
at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:36) 
at sun.reflect.GeneratedMethodAccessor39.invoke(Unknown Source) 
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37) 
at java.lang.reflect.Method.invoke(Method.java:600) 
at sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:243) 
at javax.management.modelmbean.RequiredModelMBean.invokeMethod(RequiredModelMBean.java:1086) 
at javax.management.modelmbean.RequiredModelMBean.invoke(RequiredModelMBean.java:967) 
at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:848) 
at com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:773) 
at com.ibm.ws.management.AdminServiceImpl$1.run(AdminServiceImpl.java:1320) 
at com.ibm.ws.security.util.AccessController.doPrivileged(AccessController.java:118) 
at com.ibm.ws.management.AdminServiceImpl.invoke(AdminServiceImpl.java:1213) 
at com.ibm.ws.management.connector.AdminServiceDelegator.invoke(AdminServiceDelegator.java:181) 
at sun.reflect.GeneratedMethodAccessor41.invoke(Unknown Source) 
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37) 
at java.lang.reflect.Method.invoke(Method. 
CAUSE
WebSphere Application Server added a new parameter named "resourcesScope" to the createCluster and createClusterMember commands. The parameter allows you to control how the resources are processed when the first cluster member is added to a cluster. The parameter is described in the New parameter named resourcesScope was added to the createCluster and createClusterMember commands [http://www.ibm.com/support/docview.wss?uid=swg21389473] document.

The new default behavior for 6.1 and 7.0 is '"both," which copies the resources of the cluster member to the cluster level. This behavior can cause problems with the resources that are created during a WebSphere Process Server configuration like data sources and JMS queues. Problems result because they now exist at both the cluster member and the cluster scope. Modifying properties of these resources on the cluster scope does not have an effect because, at runtime, the resources at the cluster member scope are used. 

It is required to use the "resourcesScope" parameter with the value "cluster" for WebSphere Process Server and WebSphere Enterprise Service Bus. This parameter is not currently exposed in the administrative console. To override the default value, you must create the cluster or the first cluster member using an administrative script.


RESOLVING THE PROBLEM
The resourceScope parameter is not currently exposed in the administrative console when you create a cluster. Using the Create the member by converting an existing application server option is not supported for WebSphere Process Server and WebSphere Enterprise Service Bus. 


[/support/docview.wss?uid=swg21432325&aid=2] [/support/docview.wss?uid=swg21432325&aid=2] 

You can create the cluster without using an existing single server as the first cluster member. To convert an existing server to be first cluster member of a new cluster, use the createCluster command in the administrative script and provide the resourcesScope parameter with the "cluster" value. For example:

$AdminTask createCluster {-clusterConfig
{-clusterName newcluster -preferLocal true} 
-convertServer {-serverNode NODE1Node01 -serverName testserver 
-resourcesScope cluster}} 

RELATED INFORMATION
 WebSphere Application Server Infocenter [http://publib.boulder.ibm.com/infocenter/wasinfo/fep/topic/com.ibm.websphere.nd.multiplatform.doc/info/ae/ae/trun_wlm_cluster_v61.html]
WebSphere Application Server Technote [http://www.ibm.com/support/docview.wss?uid=swg21389473]
ClusterConfigCommands command group for the AdminTask [http://www.ibm.com/support/knowledgecenter/SSAW57_7.0.0/com.ibm.websphere.nd.doc/info/ae/ae/rxml_atclusterconfig.html]


 


Cross reference information Segment Product Component Platform Version Edition Business Integration WebSphere Enterprise Service Bus AIX, HP-UX, Linux, Linux zSeries, Solaris, Windows, z/OS 7.0, 6.2, 6.1.2, 6.1