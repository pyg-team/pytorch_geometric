Title: IBM IC87826: THE PARALLEL MODE OF DB2_ALL MAY HANG IN A VERY LARGE DPF ENVIRONMENT - United States

Text:
z/os SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  When running db2_all in parallel mode (i.e. ';' option), db2_all
   sends the user's command to the target partitions, and spawns
   waiter processes in the partition where the command was run from
   (i.e. sender partition).  After the target partitions completes
   the user's command, they send a remote shell command back to the
   sender partition to inform that the command completed.
   
   Prior to the fix for this APAR, should this remote shell command
   fails for any reason, the sender partition exhibits a hang
   symptom, as it thinks that the user's command has not completed
   in the target partitions, when in fact it has.
   
   This is caused due to the lack of error handling of the failed
   remote shell command.  This APAR addresses the error handling.
   
   The cause of the remote shell command failure varies, but a
   common known cause is the excessive number of remote shell
   running at the same time.  For example, starting too many ssh at
   the same time may cause some of them to fail with the following
   error.
   
   ssh_exchange_identification: Connection closed by remote host
   
   Running too many rsh at the same time can fail with the
   following errors.
   
   socket: protocol failure in circuit setup.
   socket: All ports in use
   
   These types of capacity related failures may happen in a very
   large DPF environment.  e.g. several hundred partitions.
   
   
    
   
   

LOCAL FIX
 *  Running db2_all in serial mode (i.e. without ';') does not have
   this problem.
   
   
    
   
   

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED:                                              *
   * Very large DPF environment                                   *
   ****************************************************************
   * PROBLEM DESCRIPTION:                                         *
   * When running db2_all in parallel mode (i.e. ';' option),     *
   * db2_all sends the user's command to the target partitions,   *
   * and spawns waiter processes in the partition where the       *
   * command was run from (i.e. sender partition).  After the     *
   * target partitions completes the user's command, they send a  *
   * remote shell command back to the sender partition to inform  *
   * that the command completed.                                  *
   *                                                              *
   * Prior to the fix for this APAR, should this remote shell     *
   * command fails for any reason, the sender partition exhibits  *
   * a hang symptom, as it thinks that the user's command has not *
   * completed in the target partitions, when in fact it has.     *
   *                                                              *
   * This is caused due to the lack of error handling of the      *
   * failed remote shell command.  This APAR addresses the error  *
   * handling.                                                    *
   *                                                              *
   * The cause of the remote shell command failure varies, but a  *
   * common known cause is the excessive number of remote shell   *
   * running at the same time.  For example, starting too many    *
   * ssh at the same time may cause some of them to fail with the *
   * following error.                                             *
   *                                                              *
   * ssh_exchange_identification: Connection closed by remote     *
   * host                                                         *
   *                                                              *
   * Running too many rsh at the same time can fail with the      *
   * following errors.                                            *
   *                                                              *
   * socket: protocol failure in circuit setup.                   *
   * socket: All ports in use                                     *
   *                                                              *
   * These types of capacity related failures may happen in a     *
   * very large DPF environment.  e.g. several hundred            *
   * partitions.                                                  *
   ****************************************************************
   * RECOMMENDATION:                                              *
   * Upgrade to DB2 10.1 Fixpack 1                                *
   ****************************************************************
   
   
    
   
   

PROBLEM CONCLUSION
 *  First fixed in DB2 10.1 Fixpack 1.
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IC87826
   
   
 * REPORTED COMPONENT NAME
   DB2 FOR LUW
   
   
 * REPORTED COMPONENT ID
   DB2FORLUW
   
   
 * REPORTED RELEASE
   A10
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2012-11-04
   
   
 * CLOSED DATE
   2012-11-21
   
   
 * LAST MODIFIED DATE
   2012-11-21
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
    IC81335 [http://www-01.ibm.com/support/docview.wss?uid=swg1IC81335]
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   DB2 FOR LUW
   
   
 * FIXED COMPONENT ID
   DB2FORLUW
   
   

APPLICABLE COMPONENT LEVELS
 * R970 PSN
   UP