Title: IBM Testing a connection with the ODBCTEST Utility - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 What are the steps to test an ODBC Data Source connection with the ODBCTEST Utility? 

RESOLVING THE PROBLEM
This document shows how to connect to an ODBC data source and run a SELECT statement against the table(s) on that database. 

You should have the latest copies of the Odbcte32.exe and the Gtrtst32.dll in a folder together on the hard drive.

How to connect to an ODBC data source:

1. Start ODBC Test utility by either double-clicking on the ODBC Test icon or choosing Start \ Run and browsing for Odbcte32.exe.
2. From the Connect menu (Conn), choose Full Connect. ODBC Test displays the SQL Data Source dialog box.
3. Select the ODBC Data Source that Impromptu is using from the list of data sources, enter the same userid and password that is being used in Impromptu and choose the OK button. ODBC Test displays the connection window and a message stating a successful connection.

EXAMPLE: In Impromptu, there is a catalog that goes against an Excel data source called National Excel. National Excel is the data source selected from the list of available data sources.

Upon successful connection, the message in the window would be:

Full Connect(Default)

Env. Attr. SQL_ATTR_ODBC_VERSION set to SQL_OV_ODBC3

Successfully connected to DSN 'National Excel'.

How to retrieve data the ODBC data source

1. Using the connection window, copy/paste the SQL from Impromptu or the SELECT statement from the ODBC trace file that was generated when Impromptu attempted to run the query. Highlight the entire SELECT statement with the mouse cursor:

EXAMPLE: SELECT * from `C:\Program Files\Cognos\Samples\National\national`.`Database`

2. From the Statement menu (Stmt), choose SQLExecDirect, and click OK. ODBC Test calls the driver to select the data from the table and displays information about the function call in the output window. 

There will be a statement ending with "Return: SQL_SUCCESS=0" if there aren't errors. If there is an error it will indicate that the problem Impromptu is having very likely is outside of Impromptu. 

3. If the return is successful the results can be displayed by using the Results menu (Results), and selecting Get Data All. This retrieves all of the data in the result set created by the SELECT statement. The column count, the column names, the data, and the number of rows fetched are displayed in the output window.

If ODBCTest is not available with your driver you can download a similar
free utility called WinSQL from http://www.indus-soft.com/winsql.


Related Knowledge Base Article # 57998

 

HISTORICAL NUMBER
 104829