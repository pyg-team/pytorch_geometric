Title: IBM Upgrading to IBM Atlas Policy Suite V6.0.3 - United States

Text:
 PRODUCT README

ABSTRACT
 This document is intended to help you prepare your existing IBM Atlas Policy Suite environment for upgrade to the IBM Atlas Policy Suite V6.0.3. The information in this document includes: An explanation of the significant changes made to your Atlas Policy Suite database schema during upgrade, required steps that you must complete before you upgrade, and recommended post-upgrade steps that you might want to complete after the upgrade successfully completes. 

CONTENT
About this task 

For optimal performance during the upgrade, you must set specific Oracle initialization parameter settings to the Oracle default values.

To upgrade to IBM Atlas Policy Suite V6.0.3, you must:


 1. Verify prerequisites. 
 2. Prepare the Oracle database. 
 3. Upgrade IBM Atlas Policy Suite. 
 4. Test the system and reset initialization parameters as needed.



Before you begin 
The Oracle Database server prerequisite is changed in this release because of the Oracle bug 9245737. Beginning with IBM Atlas Policy Suite V6.0.3, you must use Oracle Database server 11.2.0.2 or later. Oracle 10g, Oracle 11gR1, and Oracle 12c are not supported. 

Preparing the Oracle database 

For all of the actions in this section, see your Oracle product documentation for specific guidance. The following information describes a recommended sequence of tasks to ensure a successful upgrade. 

Remember: Configure your application server data source to use only the Oracle JDBC driver that is provided with IBM Atlas Policy Suite. This ensures that your database connections always use the same Oracle JDBC driver version that is tested by IBM. 

Important: If you are upgrading from an earlier version of IBM Atlas Policy Suite, verify that you do not have any Oracle MATERIALIZED VIEW LOG table whose source table is the SCOPETARGET table. If you do have this log, you must drop the MATERIALIZED VIEW LOG table before you start the upgrade. Otherwise, the RENAME step will fail. To drop a MATERIALIZED VIEW LOG, execute the DROP MATERIALIZED VIEW LOG statement. See the Oracle product documentation for more information. 

1. Quiesce all activity against the Atlas Policy Suite database schemas. 

As with any upgrade, you should plan for sufficient downtime to ensure that no business activity occurs during the upgrade. For example, you should stop the application in your application server to prevent user requests and scheduled Atlas Timer tasks and you should stop any Oracle Scheduler jobs that might be started during the upgrade such as Oracle Text sync jobs. 

2. Back up your Atlas Policy Suite application and database. 

Back up of both of your Atlas Policy Suite application components, for example:  * Product installation directory 
 * Application server deployment folders and files 
 * Related database schemas, for example, the PSSAPL, PSSRPTUSER, and PSSWEBUSER schemas. 


3. Upgrade your Oracle Database server to 11.2.0.2 or later. 

Because of the Oracle bug 9245737, you must upgrade your Oracle Database server to 11.2.0.2 or later, excluding Oracle 12c. Follow the Oracle product documentation to complete this installation. 

Be sure to run the Oracle Database Upgrade Assistant (Oracle DBUA) after you install Oracle Database server 11.2.0.2 or later on the database that contains your Atlas schemas. The Oracle DBUA will upgrade all schemas within the specified database. Also, be sure to note whether a new Oracle Listener port was designated for the upgraded Atlas database. If so, you might need to update your application server data source settings to use the new port. 

4. Perform acceptance testing. 

IBM Atlas Policy Suite V6.0.2 already supports Oracle Database server 11.2.0.2 and 11.2.0.3. Therefore, after you upgrade your Oracle Database server, be sure to perform compete acceptance testing of your existing Atlas Policy Suite installation against your upgraded Oracle Server. 

If you encounter difficulties later, you can rule out your Oracle upgrade as a potential cause of the problem if you have tested the database. Continue the Atlas Policy Suite upgrade only if Atlas Policy Suite is performing within expectation on the new version of Oracle Database server. 

5. Verify database storage capacity. 

During Atlas Policy Suite upgrade, a duplicate copy of your existing SCOPETARGET table will be created with two new columns added. Your old SCOPETARGET table will be renamed to SCOPETARGET_V602 and placed into the database in read-only mode. Indexes, constraints, foreign keys, and text indexes will also be duplicated. 

Work with your database administrator to ensure that the Oracle database has sufficient storage available to create the new table. Some database administrators refer to actual storage that is used for a database segment rather than storage that is allocated. It is recommended that you base your storage needs on allocated space. 

You should allow additional buffer for the two new columns, which are both created as NUMBER(1,0) columns. So, for example, if your existing SCOPETARGET table contains 2.8 million rows and consumes 350 MB of space, then verify that you have at least 750 MB or more of space available for Oracle database data files. 

6. Verify Oracle initialization parameters. 

To optimize performance of the SCOPETARGET table migration, Atlas Upgrade will utilize Oracle parallel execution and the Oracle Scheduler for table loading and index creation. Combined with the use of DIRECT LOAD of the new table, this operation becomes very fast, typically around a minute depending upon your hardware and environment, using only Oracle default settings for certain initialization parameters. If you have lower settings for these parameters, or have them disabled, your upgrade performance may degrade. For reference, the specific Oracle initialization parameters which may be a factor are listed here, along with typical Oracle default settings. 

ORACLE INITIALIZATION PARAMETER DEFAULT SETTING 
------------------------------- --------------- 
parallel_threads_per_cpu 2 
parallel_degree_limit CPU 
job_queue_processes 1000 
processes 100 

In production environments, the Oracle processes parameter is likely to be set higher. The appropriate value for this parameter depends on your level of concurrency, Oracle database features that are enabled, background Scheduler jobs, and many other factors. See the Oracle product documentation for more information. 

Upgrading Atlas Policy Suite 

After you complete the acceptance testing of your existing Atlas product installation with Oracle Database server 11.2.0.2 or later, follow the same procedure as in previous Atlas releases to upgrade to IBM Atlas Policy Suite V6.0.3. 

1. Be sure all activity is quiesced against the Atlas Policy Suite schemas in your database and be sure you have sufficient database storage available to complete the upgrade. 

2. Upgrade to Atlas Policy Suite V6.0.3. 

3. Optimize upgrade performance by ensuring that the Oracle initialization parameters referenced previously are set to at least the Oracle default values. 

For the SCOPETARGET table, Atlas Policy Suite creates and loads the new table in one step. The load takes advantage of Oracle Direct Load, where NOLOGGING and PARALLEL settings are used to speed transformation time. Your old SCOPETARGET table will be renamed to SCOPETARGET_V602 and will be placed into database in read-only mode. 

After the table is created, it will be re-enabled for LOGGING. All foreign key, indexes, and the primary key will be similarly renamed. New index and text index creation will be spawned as Oracle Scheduler jobs that are started immediately. Each Scheduler job will create one index, which is also enabled for parallelism. These actions, with the default Oracle initialization parameter settings shown in "Pre-Upgrade", will consume a total of 32 processes from the Oracle 'processes' initialization parameter count. A summary of Scheduler job id's and statuses will be logged as part of the Atlas upgrade. 

If the upgrade fails, see the log file and resolve the problem. You can repeat the upgrade again if necessary, which will also migrate the SCOPETARGET table. 


Testing the system and resetting initialization parameters 

1. Perform acceptance testing. 

After you complete acceptance testing for Oracle 11.2.0.2 or later with your older version of Atlas Policy Suite, repeat the testing with Oracle 11.2.0.2 or later and IBM Atlas Policy Suite V6.0.3. 

2. Drop your old SCOPETARGET_V602 table to free the space. 

After you complete the testing with IBM Atlas Policy Suite V6.0.3, you can drop the SCOPETARGET_V602 table, which was the copy made of the old table. 

You can also de-allocate the additional storage space that is used to ensure that enough space was available to make the copy. Be sure to drop the SCOPETARGET_V602 table by using the CASCADE CONSTRAINTS option. See the Oracle product documentation for more information. 

3. Restore the Oracle initialization parameters. 

If you made changes to the Oracle initialization parameter values referenced in the Preparing your database section, you can now revert them to your original values.