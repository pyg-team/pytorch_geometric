Title: IBM PJ32652: GLOB: JAPANESE CHARACTER CORRUPTION IN WORKFLOW LAUNCH STEP - United States

Text:
 SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  Japanese characters in workflow subject field is corrupted.
   Related to BPF issue reported against AE.  Copied 744147
   description.
   After create a normal case(Input Japanese characters in Company
   Name, createCase.JPG) in following environment, there is
   corrupt characters when we open that case.
   ENV:
   WebLogic version and patch level:  WL9.2 +
   CR298435_920.jar
   PE Database version and patch level: sql2000sp4
   AE/PE build and patch level:
   p84.0.1(CE:dap430.118,PE:Pe420.034x,AE:Per410.034)
   When we create normal case, we use following code to get
   values from HttpServletRequest and then set those values to
   params , I find that all Japanese characters become corrupted
   after we use these code.
     WcmMimeFormParser parser = new
   WcmMimeFormParser(httpServletRequest);
     Map params =
   parser.getMimeEncodedParameters(dataStore);
   In AE 40, WcmMimeFormParser always get character encoding
   from  HttpServletRequest and then it will know what character
   encoding BPF is using.
   But in AE 401, WcmMimeFormParser does not get character
   encoding (which is used by BPF) from  HttpServletRequest - it
   uses platform default character encoding from system
   (file:WcmMimeFormParser.java). This is the resason result in
   corrupt characters.
   I try to fix the this issus from AE side, so I change AE 401's
   code in file WcmMimeFormParser.java which is in AE
   p8toolkit.jar.(You can also use diff tool to find the
   difference between WcmMimeFormParser.java and
   WcmMimeFormParser_fixed.java), After change these in file
   WcmMimeFormParser.java, this isses is resolved.(right.JPG).
   add
     private String encoding = "";
   in line 61.
   add
         encoding = request.getCharacterEncoding();
         System.out.println("Upload char encoding = " +
   encoding);
         upload.setHeaderEncoding(encoding);
   in line 99.
   change from
     String value = Streams.asString(stream);
   to
     String value = Streams.asString(stream,
   encoding);
   in line 137.
   This proves it is a bug in AE 401 p8toolkit.jar.
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  WorkplaceXT users in Localized environment (JPN)Japanese charact
   Description: After creating a normal case(Input Japanese charact
   Resolved in WorkplaceXT 1.1.1.1 (FP 001)
   
   
    
   
   

PROBLEM CONCLUSION
 *  Resolved in WorkplaceXT 1.1.1.1 (FP 001)
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PJ32652
   
   
 * REPORTED COMPONENT NAME
   WORKPLACE XT
   
   
 * REPORTED COMPONENT ID
   5724R7611
   
   
 * REPORTED RELEASE
   110
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2008-01-11
   
   
 * CLOSED DATE
   2008-02-14
   
   
 * LAST MODIFIED DATE
   2008-02-14
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WORKPLACE XT
   
   
 * FIXED COMPONENT ID
   5724R7611
   
   

APPLICABLE COMPONENT LEVELS
 * R110 PSN
   UP