Title: IBM Modifying the default situation expiration time in the SUF - United States

Text:
SUF TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 The default expiration time for SUF(Situation Update Forwarder) event handling is 59 minutes. This default value can be customized with a SUF configuration update. 

ENVIRONMENT
Bidirectional event synchronization between ITM And Omnibus or TEC. 

For bidirectional event flows, you will be using EIF Forwarding to send events from ITM to Omnibus/TEC and running the ITM Situation Update Forwarder (SUF) component on the Omnibus or TEC server to send event updates to back the ITM Hub TEMS. 



DIAGNOSING THE PROBLEM
When a situation event from a sampled situation is forwarded to the Tivoli Netcool/OMNIbus ObjectServer and that event is later deleted or cleared in the ObjectServer, the behavior of the bidirectional event synchronization architecture is to send a request to the hub Tivoli Enterprise Monitoring Server to acknowledge the situation with a specific timeout. The reason for this behavior is that you cannot close sampled situation events until the monitoring agent determines the situation condition is no longer true. 


If the acknowledgment timeout of the situation expires and the situation is still true, ITM sends an acknowledgement expiration status update event to Netcool/OMNIbus. The status update event causes a new event to be opened in the Netcool/OMNIbus ObjectServer and the Netcool/OMNIbus operator is notified that the event condition has not been resolved. If the situation condition becomes false, then the event is closed in IBM Tivoli Monitoring, and the event remains cleared in the Netcool/OMNIbus ObjectServer. 

The default timeout is 59 minutes. 


RESOLVING THE PROBLEM
To proceed you will need to know the installation directory for the SUF. 


In the examples, the <event_sync_install_dir> is the fully qualified directory for the install location of the SUF under the SitForwarder directory. The default values are:



 * Unix/Linux: /opt/IBM/SitForwarder 
   Windows: C:\Program Files\IBM\SitForwarder 
   Windows(x86): C:\Program Files (x86)\IBM\SitForwarder 

Step 1: Edit the sit_timeouts.conf file to set the default expiration time Edit the sit_timeouts.conf file (<event_sync_install_dir>/etc/sit_timeouts.conf) 

Change the variable value for DEFAULT_SIT_EXPIRE_TIME from 59 to the new value (in minutes) that you want to use as the default expiration time. 

 * 
 * 


Step 2: If you are using Omnibus, edit the errorevent.conf to set the ServerLocation and port of the EIF receiver on the Netcool Server. 

 

The errorevent.conf is located under the <event_sync_install_dir>/omnibus directory. 

By default, the errorevent.conf file will look like this example: 

 * # 
   #================================================================= 
   # Licensed Materials - Property of IBM 
   # "Restricted Materials of IBM" 
   # 
   # Sample program file showing updates for OMNIbus to allow error 
   # events to be sent to EIF probe 
   # 
   # (C) Copyright IBM Corp. 2007 All Rights Reserved. 
   #================================================================= 
   # 
   # 
   ServerName=<EIF probe host name> 
   ServerPort=<EIF probe port> 
   BufferEvents=YES 
   BufEvtPath=/tmp/itm_sync_error.cache 
   BufEvtMaxSize=4096 

 

First, make a backup of the errorevent.conf file for recovery purposes. 

Next modify the file to reflect the hostname or ip address of the EIF Receiver and the listening port for the EIF Receiver. In most cases, this will be the same Netcool Server where your SUF is installed and running. The default value is 9998. If you are unsure of the port number, you can refer to the event destination you have configured in ITM on the Hub TEMS as the values will be the same. 

 

Step 3: Refresh the SUF to set the new expiration value 

First, move to the directory <event_sync_install_dir>/bin 

Then, for Unix/Linux execute the refresh command: 

"./sitconf.sh refresh pathc=<event_sync_install_dir>/etc type=Omnibus" 

 

On Windows, execute the refresh command: 

"sitconf.cmd refresh pathc=<event_sync_install_dir>\etc type=TEC" 

where type is either "Omnibus" or "TEC" depending on your environment. 

The command output should appear similar to the one of the following examples: 

 

On Unix/Linux using type=Omnibus: 

 * 
 * 
 *  cd /opt/IBM/SitForwarder/bin
   
   ./sitconf.sh refresh pathc=/opt/IBM/SitForwarder/etc>
   
   Operating system: AIX 
   Operating system arch: ppc
   Operating system version: 6.1 
   Requested action was: refresh
   Posting event to event listener.
   
   The command that will be run is:
   ../omnibus/postzmsg
   -f 
   ../omnibus/errorevent.conf
   -r
   30
   msg='Sending the Situation Timeout Configuration values.'
   hostname=<hostname>
   situation_name=DEFAULT_SIT_EXPIRE_TIME
   situation_displayitem=10
   OMNIbus_ITM_OM_Situation_Timeout_Config
   Administrator 


On Windows using type=Omnibus:




C:\Program Files (x86)\IBM\SitForwarder\bin>sitconf.cmd refresh pathc="C:\Program Files (x86)\IBM\SitForwarder\etc" type="Omnibus"

C:\Program Files (x86)\IBM\SitForwarder\bin>launch com.ibm.opms.common.sitconfig refresh pathc="C:\Program Files (x86)\IBM\SitForwarder\etc" type="Omnibus"

C:\Program Files (x86)\IBM\SitForwarder\bin>set JAVA_DIR=..

C:\Program Files (x86)\IBM\SitForwarder\bin>set INSTALL_DIR=..

C:\Program Files (x86)\IBM\SitForwarder\bin>set JRE_DIR=..\jre

C:\Program Files (x86)\IBM\SitForwarder\bin>set JRE_CLASSPATH=..\jars\situpdate.jar;..\jars\jlog.jar

C:\Program Files (x86)\IBM\SitForwarder\bin>"..\jre\bin\java.exe" -Djlog.logCmdPort=0 -classpath"..\jars\situpdate.jar;..\jars\jlog.jar" com.ibm.opms.common.sitconfig refresh pathc="C:\Program Files (x86)\IBM\SitForwarder\etc" type="Omnibus"
Operating system: Windows NT (unknown)
Operating system arch: x86
Operating system version: 6.1
Requested action was: refresh
Posting event to event listener.
The command that will be run is:
..\omnibus\postzmsg.exe
-f
..\omnibus\errorevent.conf
-r
30
msg='Sending the Situation Timeout Configuration values.'
hostname=hostname
situation_name=DEFAULT_SIT_EXPIRE_TIME
situation_displayitem=10
OMNIbus_ITM_OM_Situation_Timeout_Config
Administrator  

On Windows using type=TEC:



C:\Program Files (x86)\IBM\SitForwarder\bin>sitconf.cmd refresh pathc="C:\Program Files (x86)\IBM\SitForwarder\etc" type=TEC

C:\Program Files (x86)\IBM\SitForwarder\bin>launch com.ibm.opms.common.sitconfig refresh pathc="C:\Program Files (x86)\IBM\SitForwarder\etc" type=TEC

C:\Program Files (x86)\IBM\SitForwarder\bin>set JAVA_DIR=..

C:\Program Files (x86)\IBM\SitForwarder\bin>set INSTALL_DIR=..

C:\Program Files (x86)\IBM\SitForwarder\bin>set JRE_DIR=..\jre

C:\Program Files (x86)\IBM\SitForwarder\bin>set JRE_CLASSPATH=..\jars\situpdate.jar;..\jars\jlog.jar

C:\Program Files (x86)\IBM\SitForwarder\bin>"..\jre\bin\java.exe" -Djlog.logCmdPort=0 -classpath"..\jars\situpdate.jar;..\jars\jlog.jar" com.ibm.opms.common.sitconfig refresh pathc="C:\Program Files (x86)\IBM\SitForwarder\etc" type=TEC
Operating system: Windows NT (unknown)
Operating system arch: x86
Operating system version: 6.1
Requested action was: refresh
Posting event to event listener.  

 

Once completed and the SUF refreshed, the expiration time will have been reset to the value in the sit_timeouts.conf file.