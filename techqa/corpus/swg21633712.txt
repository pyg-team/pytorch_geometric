Title: IBM Possible malfunction on local adapter - How netmon.cf may help - United States

Text:
tsa; tsamp; rsct; cthats; netmon; :TS_LOC_DOWN_ST; malfunction; crossover; NIC; best practices TECHNOTE (FAQ)

QUESTION
 When the primary server in my 2 node cluster goes down, the network adapter on the standby server starts being reported as malfunctioning or offline as well. This often prevents a failover or causes unexpected outages on the standby server. 

CAUSE
Mar 3 11:33:02 node02 daemon:notice cthats[6684704]: :::TS_LOC_DOWN_ST Possible malfunction on local adapter Adapter interface name en3 Adapter offset 0 Adapter IP address 10.11.12.13

ANSWER
A "link down" problem can be caused by a problem at either end of the link, that is, a problem with either of the individual network adapters (NIC), or it can be a result of problem with a network device in between. In the case where two servers are connected to the same switch or directly connected via a crossover cable, its often impossible for the RSCT's local subsystem to know if its local NIC is the source of the problem or if the NIC on the other server is the problem. This is where the netmon (network monitor) functionality can help. 

You can (and should in the case of a two node cluster) exploit the netmon functionality by creating a file on each node in the cluster called: 

 * 


The netmon.cf file is a simple text file populated as follow : 
- one IP address per line 
- it is generally recommended that there be 5+ pingable IP addresses (if available). 
- the IP addresses do not need to be part of your cluster or know what your cluster is. 
- the IP addresses *do* need to be pingable from all the nodes in the cluster. 

At the very least, include the IP address of the default gateway for your clustered nodes in your netmon.cf file. Copy your netmon.cf file to each node in the domain. There is no need to restart the domain ... the netmon.cf is usable immediately. 

Note that the netmon.cf file is only used when there is a cluster split (where one or more nodes in the cluster can no longer communicate with each other). The "netmon" function will generate pings, using the IP addresses in the local netmon.cf file, in the hopes of generating inbound traffic on the local interface. RSCT does *not* watch specifically for responses to these pings ... it merely sends them out and then watches the interface again for any new traffic coming in ... this is how RSCT can quickly determine if a local NIC is functional or not. 

Refer to the following Technote for a detailed explanation of the netmon process and the netmon.cf file: http://www.ibm.com/support/docview.wss?uid=swg21289897 [http://www.ibm.com/support/docview.wss?uid=swg21289897]