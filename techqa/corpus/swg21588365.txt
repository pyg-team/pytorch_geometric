Title: IBM Clarity Server - The conversion of a varchar data type to a datetime data type resulted in an out-of-range value - United States

Text:
Datetime; date format; 2147217913 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 When only one particular user goes to save on a relational template, he receives the error from "Symptom", but other users are able to use the template and save it just fine. 

SYMPTOM
PostDataTrans.asp Error performing function SaveRelationalData : The conversion of a varchar data type to a datetime data type resulted in an out-of-range value. More error information found in the connection object. Errors found: 2 
Err(0): Description: The conversion of a varchar data type to a datetime data type resulted in an out-of-range value. Source: Microsoft OLE DB Provider for SQL Server Number: -2147217913 
Err(1): Description: The statement has been terminated. Source: Microsoft OLE DB Provider for SQL Server Number: -2147217913: 

[/support/docview.wss?uid=swg21588365&aid=1] [/support/docview.wss?uid=swg21588365&aid=1]

CAUSE
The date format on the user's machine was dd/MM/yyyy, but the template's date format was different (MM/dd/yyyy). This happens because the Windows Regional Settings for the user can be different than the settings for which the template was designed.



ENVIRONMENT
IBM Clarity Server 7.x



DIAGNOSING THE PROBLEM
 

 1. Open the template in Microsoft Excel before the user tries to save it and notice the format of the date; 
 2. Notice the format of the column where the date is stored is different than his format 
 3. Check the Windows Regional Settings (Control Panel) for this user

RESOLVING THE PROBLEM
 

There are two ways to resolve this problem:


 * Change the user's regional settings so that they match the date format required by the template: 


Windows XP: Clock, Language and Region -> Change the date, time, or number format- > additional settings -> date -> short date Windows 7: Region and Language -> Formats tab -> Additional settings -> Date tab and change the short date format to have Month/Day/Year. 

OR 

 * Change the template so that the format of the date inputted by the user is converted to the format required by the database. For example, if the date is inputted in the template based on the Excel formula NOW(), use the TEXT formula in order to convert the result of NOW to whatever format is required (for example: =TEXT(NOW();"m.dd.yyyy hh:mm AM/PM")