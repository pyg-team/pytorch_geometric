Title: IBM Service Bulletin 151: Redefining DNS Server Addresses When Migrating from TPF 4.1 to z/TPF (reissued) - United States

Text:
TPF 4.1; z/TPF; TPF 41; DNS; server address; ZDTCP; PRI; ZDTCP; SEC; TCP/IP; Configuration; Table; 1052 FLASH (ALERT)

ABSTRACT
 Note - This is an updated version of the original Service Bulletin 151. Changes were made to the procedures to follow when migrating a system from TPF4.1 to z/TPF as well as those used to fall back from z/TPF to TPF4.1.

When migrating from a TPF 4.1 system to a z/TPF system or when falling back to a TPF 4.1 system from a z/TPF system, you need to redefine your remote Domain Name System (DNS) server addresses with the ZDTCP DNS PRI and ZDTCP DNS SEC commands. 
There was a change in the TCP/IP Configuration Table format between the TPF 4.1 and the z/TPF versions. 

CONTENT
When migrating from a TPF 4.1 system to a z/TPF system or when falling back to a TPF 4.1 system from a z/TPF system, you need to redefine your remote Domain Name System (DNS) server addresses with the ZDTCP DNS PRI and ZDTCP DNS SEC commands. 
There was a change in the TCP/IP configuration table format between the TPF 4.1 and the z/TPF versions.
This change is defined in the i_tcpc.h header file. The first reserved field in the table increased from 12 bytes to 16 bytes, changing the displacement of the primary and secondary DNS server addresses defined in the table. Because the core copy of the table is built from the TPF 4.1 file copy during z/TPF migration, the z/TPF system defines the secondary DNS server address as the primary, and there is no secondary DNS server address. 

Therefore, you need to do the following when migrating your TPF 4.1 system to a z/TPF system in order to redefine your DNS server addresses:


 * On the TPF 4.1 system, enter the ZDTCP DNS DELPRI and ZDTCP DNS DELSEC commands in CRAS state or above to delete the primary and secondary DNS server addresses from the file copy of the TCP/IP configuration table. 
 * IPL the z/TPF system. 
 * On the z/TPF system, enter the ZDTCP DNS PRI and ZDTCP DNS SEC commands in 1052 state or above to redefine your DNS server addresses. 


When falling back from a z/TPF system to a TPF 4.1 system, the core copy of the TCP/IP configuration table is built from the z/TPF file copy that was created when the system was migrated from TPF 4.1 to z/TPF. As a result, the TPF 4.1 system defines the primary DNS server address as the secondary, and there is no primary DNS server address. If you are able to bring your z/TPF system down cleanly, you need to do the following when falling back from a z/TPF system to a TPF 4.1 system in order to redefine your DNS server addresses: 
 * On the z/TPF system, enter the ZDTCP DNS DELPRI and ZDTCP DNS DELSEC commands in 1052 state or above to delete the primary and secondary DNS server addresses from the file copy of the TCP/IP configuration table. 
 * IPL the TPF 4.1 system. 
 * On the TPF 4.1 system, enter the ZDTCP DNS PRI and ZDTCP DNS SEC commands in CRAS state or above to redefine your DNS server addresses. 


If you are not able to bring your z/TPF system down cleanly, you need to do the following after falling back from a z/TPF system to a TPF 4.1 system in order to redefine your DNS server addresses: 
 * IPL the TPF 4.1 system. 
 * On the TPF 4.1 system, enter ZAREC LIBMMP4.3A 014 0000000000000000 in 1052 state to delete the z/TPF primary and secondary DNS server addresses from the file copy of the TCP/IP configuration table. 
 * Re-IPL the TPF 4.1 system. 
 * On the TPF 4.1 system, enter the ZDTCP DNS PRI and ZDTCP DNS SEC commands in CRAS state or above to redefine your DNS server addresses. 


There are no impacts to the other fields in the core copy of the TCP/IP configuration table because these fields are not built from the file copy of the TPF 4.1 or the z/TPF TCP/IP configuration table. 

For questions or concerns about the information in this service bulletin, send an e-mail to TPFQA@US.IBM.COM. RELATED INFORMATION
 TPF Maintenance Website [http://www.ibm.com/software/htp/tpf/maint/maintztpf.html]