Title: IBM UNIX shell script example which submits a process that checks for the existence of a file on a Windows node before copying (SCI81997) - United States

Text:
STERLINGPRI TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 UNIX shell script example which submits a process that checks for the existence of a file on a Windows node before copying (SCI81997) 

SYMPTOM
Example shell script which submits a process? that checks for the existence of a file on a Windows Snode before copying


RESOLVING THE PROBLEM


Note that the script traps the fact that there was no source file. If you don't want to do this, just remove maxdelay from the submit. This will cause the process to always return 0 unless the submit itself failed.:


export SNODE=<snode_name>
export SOURCEFILE=<source_file_name>
export SOURCEDIR='<source_path>'
export TARGETFILE=$SOURCEFILE
export DELETEFILE=$SOURCEFILE


export CDDIR=/home/support/cs/tbutt1/cdunix/361.base
export NDMAPICFG=$CDDIR/ndm/cfg/cliapi/ndmapi.cfg


$CDDIR/ndm/bin/direct -x << EOJ</P><br/><P>submit maxdelay=unlimited</P><br/><P>fromW2K process snode=$SNODE<BR>? &sfile=$SOURCEFILE<BR>? &sdir=$SOURCEDIR<BR>? &tfile=$TARGETFILE<BR>? &dfile=$DELETEFILE</P><br/><P>/* See if our file is ready for collection... */</P><br/><P>RT01 run task snode (pgm=WinNT)<BR>? sysopts="cmd(dir &sdir\&sfile) desktop(no)"</P><br/><P>/* If there is a file to collect... */</P><br/><P>IF01 if (rt01 NE 0) then /*...and if not... */<BR>? goto step99<BR>else<BR>? /* ...copy it across.. */<BR>? CP01 copy <BR>? from(<BR>? file="&sdir\&sfile" <BR>? sysopts="datatype(text)"<BR>? snode<BR>? )<BR>? to<BR>? (<BR>? file=&tfile<BR>? disp=rpl<BR>? sysopts=":datatype=text:"<BR>? pnode<BR>? )</P><br/><P>IF02 if (CP01 EQ 0) then /* If the copy worked, clean up. */</P><br/><P>? RT02 run task snode (pgm=WinNT)<BR>? ? sysopts="cmd(del &sdir\&sfile) desktop(no)"<BR>? eif<BR>eif<BR>step99 exit<BR>pend;<BR>quit;<BR>EOJ<BR><BR>RC=$?</P><br/><P>if [[ $RC > 0 ]]<BR>then<BR>? if [[ $RC == 1 ]] <BR>? then<BR>? ? echo "Nothing to collect"<BR>? else<BR>? ? echo "failure"<BR>? fi<BR>fi<BR>

 

HISTORICAL NUMBER
 PRI8232 

PRODUCT ALIAS/SYNONYM
 

Fact


Connect:Direct UNIX
all releases 
SCI81997


Goal


How can I verify file existence on a remote Windows node from a UNIX system?