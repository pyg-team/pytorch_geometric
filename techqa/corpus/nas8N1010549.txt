Title: IBM Cannot Start Monitors Because of Messages CPFB92A and CPFB96B - United States

Text:
MSGCPFB92A; MSGCPFB96B; MGTC; monitor TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 When trying to start Management Central Monitors from IBM iSeries Navigator, a connection failure message is given. Also, messages CPFB92A and CPFB96B appear in the job log of the QYPSJSVR Management Central server job each time the job monitors were attempted. 

RESOLVING THE PROBLEM
When trying to start Management Central Monitors from IBM iSeries Navigator, a connection failure message is given. Also, messages CPFB92A and CPFB96B appear in the job log of the QYPSJSVR Management Central server job each time the job monitors were attempted: 

CPFB92A - Unexpected exception occurred during Management Central protocol.

CPFB96B - Message . . . . : Authentication for user profile &1 failed.
Cause . . . . . : The Management Central server on system &3 was not able to verify the user profile from system &2 using protocol &4.
Recovery . . . : Make sure the user profile exists with the appropriate granted authorities and submit the request again.

PCs inside the firewall have no problems starting the Monitors.

This is a firewall issue. Specific monitors attempt to connect back to the PC on a random port. If that port is not open on the firewall, the connection will fail and the above messages are displayed. The solution for this is to specify a port for Management Central to use and then open that port on the firewall. The way to do this is to create a file on the PC called C:\MgmtCtrl.properties and add the following line:

QYPSJ_LOCAL_PORT=5544

The port specified in the above line is arbitrary and can be changed. Port 5544 is listed because that is one of the ports Management Central usually uses and it must be opened on the firewall.

If the firewall uses Network Address Translation (NAT), it might also be necessary to specify the TCP/IP addresses for the PC and Management Central to use. NAT firewalls change the TCP/IP addresses as they pass through the firewall. Static NAT firewalls use a table to change the TCP/IP addresses. Therefore, a TCP/IP address will always be changed in the same way every time. These firewalls can be used successfully with Management Central. Dynamic NAT firewalls do not have this translation consistency and, therefore, cannot be used successfully with Management Central.

With Static NAT firewalls, TCP/IP addresses can be specified using one of the following methods: 

o To specify the TCP/IP address that Management Central will use to communicate with the PC, you must type the following line in the 
C:\MgmtCtrl.properties, where xxx.xxx.xxx.xxx is the NATed TCP/IP address of the PC:

QYPS_HOSTNAME = xxx.xxx.xxx.xxx o To specify the TCP/IP address that the PC will use to communicate with Management Central, you should run the IPCONFIG command on a DOS command prompt to locate the TCP/IP address of the PC.

At V5R4M0, V6R1M0, and V7R1M0: Update the /Qibm/UserData/OS400/Mgtc/Config/McEPConfig.properties on the System i, where xxx.xxx.xxx.xxx is the NATed TCP/IP address of the System i, using the following command:

CALL PGM(QSYS/QYPSCONFIG) PARM(QYPS_HOSTNAME 'xxx.xxx.xxx.xxx') After making changes, Management Central must be restarted. Use the ENDTCPSVR *MGTC and STRTCPSVR *MGTC commands to do this. 

References 
For additional information on using Management Central, refer to the Troubleshooting Management Central Connection Issues [https://www.ibm.com/developerworks/mydeveloperworks/wikis/home?lang=en#/wiki/IBM%20i%20Technology%20Updates/page/Troubleshooting%20Common%20Management%20Central%20Connections%20Issues] document on the developerWorks Web site.  


Cross reference information Segment Product Component Platform Version Edition Operating System IBM i 7.2 Operating System IBM i 7.1 Operating System IBM i 6.1 
HISTORICAL NUMBER
 659199115