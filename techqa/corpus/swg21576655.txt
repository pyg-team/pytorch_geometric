Title: IBM Staring Rational DOORS Rational Quality Manager interface server fails with error "StringIndexOutOfBoundsException" - United States

Text:
RQMi; RQM; StringIndexOutOfBoundsException; RQMi server; error while starting; doesn't start; does not start; fails to start; start up error; startup error; crash; RQMi server startup TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 The IBM Rational DOORS Rational Quality Manager interface (RQMi) server may fail to start, reporting the usual StringIndexOutOfBoundsException that you get when there are password/access problems with the Rational Quality Manager (RQM) user that RQMi is using, even if the credentials are correct and the password does not use any special characters that interfere with RQMi. 

SYMPTOM
You get the following error when starting the IBM Rational DOORS Rational Quality Manager interface server:
Exception in thread "main" java.lang.StringIndexOutOfBoundsException
at java.lang.String.substring(String.java:1088)
at uk.co.stpsoft.exportserver.RemoteRQMWorker.getMoreEntries(Unknown Source)
at uk.co.stpsoft.exportserver.RemoteRQMWorker.get(Unknown Source)
at uk.co.stpsoft.exportserver.RQMRMI.initialiseNextTestPlanId(Unknown Source)
at uk.co.stpsoft.exportserver.RQMRMI.main(Unknown Source) 

You may be able to avoid this error by making configuration changes in Rational Quality Manager.

CAUSE
If the RQMi request URL does not match the RQM response URL, it causes a re-authentication. 


For instance, if RQMi calls https://hostnameX/... but RQM returns a reference for the next page as https://hostnameX.domain/..., then RQMi takes this reference and calls RQM to get the next page. 

Since the HTTPS session was originally created for hostnameX -- without the fully qualified domain name -- RQM will ask RQMi to re-authenticate; however, RQMi assumes that this is not required as it has already authenticated, so it fails to re-authenticate resulting in the StringIndexOutOfBoundsException during RQMi server startup. 

When RQMi uses hostnameX.domain from the beginning, there are no issues.


DIAGNOSING THE PROBLEM
Ensure that you are not getting the StringIndexOutOfBoundsException as a result of credentials problems. Verify the following: 

 * You can log into RQM as the user you set up for use by the RQMi server.
   
   
 * Your RQM password does not have the character ^ or &
   
   
 * The server.properties file has the correct password for your RQM ID
   Note: Run admin -p <RQM_user_password> to set it again, if needed





Once you rule out credentials problems, you need to determine whether you are having the problem discussed in this technote. This requires finding the RQM projects that trigger the problem covered by this technote: 

 1. Increase the RQMi server logging level equal to 2.
    Review technote 1427280: How to enable level 2 logging for Rational DOORS Rational Quality Manager Interface [http://www.ibm.com/support/docview.wss?uid=swg21427280] for more details.
    
    
 2. Restart the RQMi server to reproduce the problem and generate debug logging to the RQMi server exportIntegration.log file.
    
    
 3. In the RQMi server exportIntegration.log file, look for the following message:
    
    <message>get(ResourceType: ALL_TESTPLANS)</message>
    
    Note each project associated with each instance of the above message. 
    
    
 4. Inspect each of the projects listed to see if it has more test plans that can be fetched in a single RQM GET request. RQM fetches 50 test plans in a GET request by default. 
    
    


If you are having the problem indicated above, you will be able to work around the issue by:  * Archiving all projects that have more test plans than can be fetched in a single GET request
   
 * Reconfiguring RQM so that more test plans are fetched in a single GET request, such that all your projects can get all their test plans fetched in a single GET request
   
   


You may decide that it is easier to simply implement the solution, instead of doing the diagnostics described above. Implementing the solution does not have any side effects, so feel free to skip the diagnostics and go straight to the solution if you prefer. 
RESOLVING THE PROBLEM
You can resolve this problem by ensuring that the Rational Quality Manager server name in the DOORS Rational Quality Manager interface server.properties file exactly matches the RQM server name as specified in the RQM-returned URLs. 

If needed, force the RQMi server to always use the fully qualified domain name by adding the rqmi.this.host property to the RQMi server.properties file. Review the technote 1459479: Rational DOORS RQMI client cannot connect to RQMI server [http://www.ibm.com/support/docview.wss?uid=swg21459479] for more details.


RELATED INFORMATION
#StringIndexOutOfBoundsException when starting RQMi [http://www.ibm.com/support/docview.wss?uid=swg21413474]
Integrating DOORS with RQM [http://www.ibm.com/support/docview.wss?uid=swg21450046]






Cross reference information Segment Product Component Platform Version Edition Software Development Rational Quality Manager Integrations: IBM AIX, Linux, Solaris, Windows, z/OS 3.0.1 Standard, Express