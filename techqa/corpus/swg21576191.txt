Title: IBM "(0x800A000D): Type mismatch ... SQL0104N  An unexpected token "END-OF-STATEMENT"" when running database optimise with DB2 - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 User runs a database optimize. User receives error message. 

SYMPTOM
Screen: 

Information
Standard Error
Number: 5
Source: FrangoDirect.AccountD.GenerateSummationStructure#ControllerProxyClient
Description: System.Web.Services.Protocols.SoapException: Server was unable to process request. ---> System.Runtime.InteropServices.COMException (0x800A000D): Type mismatch
at FrAccountBT.AccountTClass.GenerateSummationStructure(String sGuid, String sUser, Recordset& rsAccounts, Boolean& bGenForm, Boolean& bErr, Int32& lErr)
at Cognos.Controller.Proxy.CCRWS.AccountT_GenerateSummationStructure(String sGuid, String sUser, DataSet& rsAccounts, Boolean& bGenForm, Boolean& bErr, Int32& lErr)
--- End of inner exception stack trace ---
at Microsoft.VisualBasic.ErrObject.Raise(Int32 Number, Object Source, Object Description, Object HelpFile, Object HelpContext)
at Cognos.Controller.Forms.Common.clsLinkStr.GenSum(DataSet& rsGenSum, Boolean& bErr, Int32& lErr)
at Cognos.Controller.Forms.Form.frmOptimize.IRun_DoRun()
[OK] 

 

Event Viewer (Application log):
Event Type: Warning
Event Source: VBRuntime
Event Category: None
Event ID: 1
Date: 21/12/2011
Time: 13:27:12
User: N/A
Computer: VMCONTDB2
Description:
The VB Application identified by the event source logged this Application FrSrvFunc: Thread ID: 2940 ,Logged: Error occured at 21/12/2011 13:27:12 in FrSrvFunc, Error No=-2147217900, Source=Server function:Dbp_ExecuteImmediate(..) , Description=[DB2/NT] SQL0104N An unexpected token "END-OF-STATEMENT" was found following "ncate table XSUMTREE". Expected tokens may include: "IMMEDIATE". SQLSTATE=42601
, HelpFile= HelpContext=0

Event Type: Warning
Event Source: Cognos Controller
Event Category: None
Event ID: 0
Date: 21/12/2011
Time: 13:27:12
User: N/A
Computer: VMCONTDB2
Description:
Error occured at 21/12/2011 13:27:12 in IBM Cognos 8 Controller, Error No=5, Source=FrangoDirect.AccountD.GenerateSummationStructure#ControllerProxyClient, Description=System.Web.Services.Protocols.SoapException: Server was unable to process request. ---> System.Runtime.InteropServices.COMException (0x800A000D): Type mismatch
at FrAccountBT.AccountTClass.GenerateSummationStructure(String sGuid, String sUser, Recordset& rsAccounts, Boolean& bGenForm, Boolean& bErr, Int32& lErr)
at Cognos.Controller.Proxy.CCRWS.AccountT_GenerateSummationStructure(String sGuid, String sUser, DataSet& rsAccounts, Boolean& bGenForm, Boolean& bErr, Int32& lErr)
--- End of inner exception stack trace ---, HelpFile= HelpContext=0

CAUSE
The DB2 database server has not been configured correctly. 

 * Specifically the setting "DB2_COMPATIBILITY_VECTOR" has not been changed from the default (not set). 
 * Controller requires this to be set to "ORA".

RESOLVING THE PROBLEM
Reconfigure your DB2 database server so that DB2_COMPATIBILITY_VECTOR=ORA. 

 * TIP: This setting may have adverse consequences for other (non-Controller) software, so please check before making the change.


Steps: 

For step-by-step instructions, see separate IBM Technote #1576185.


RELATED INFORMATION
#1576185 - (0x80040E14): [DB2/NT] SQL0104N An unexpecte [http://www.ibm.com/support/docview.wss?uid=swg21576185]