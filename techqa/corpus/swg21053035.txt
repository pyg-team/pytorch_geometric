Title: IBM Gathering diagnostic information for DB2 SQL Performance Analyzer for z/OS - United States

Text:
SQLPA; SQL/PA; SQL Performance Analyzer; diagnostic; MustGatherDocument TECHNOTE (FAQ)

QUESTION
 How do I report an incident to the SQL PA support team, and what documentation is needed to begin analysis? 

ANSWER
Because problems vary, different diagnostic information is required for different problems. 
In general, the following documentation is required:


 1. SQL PA version, maintenance level, and a list of all applied PTFs and APARs. 
 2. DB2 version and mode 
 3. Complete JES2 output. To get this output, do the following tasks:  1. Set the parameter in ANLPARM to REPORTS ALL 
     2. Add DBTRACE ALL to the top of ANLCNTL 
     3. Run ANLDEBUG job with MSGLEVEL=(1,1) and send in the coplete JES2 output. The ANLDEBUG model is in SANLJCL data set.
    
    
 4. Listings of used ANLCNTL and ANLPARM from SANLPARM


One or more of the following types of information might be required: 
 * For both TSO access and BATCH operations, the first level of diagnostics is to activate the DBTRACE parameter (in ANLCNTL). Set DBTRACE to the DMP value. Send all generated reports (COST, EXPLAIN, TRACE, EASY EXPLAIN, SQL, and LIMITS). 
 * For TSO access, a control parameter in the CLISTs called ANLDEBUG can provide ISPF traces of the TSO execution when it is set to YES in the main CLIST, ANLCANLI.
   ex ‘HLQ.SANLCLST(ANLCANLI)’ ‘ANLDEBUG(YES)’ 
 * Depending on the source of the SQL statements, additional documentation might be required, such as the DDL to create the DB2 objects.


For batch problems (SQL PA):  * Insert a DBTRACE DMP parameter as the first entry in the ANLCNTL file. 
 * Execute the ANLJBUG set of JCL from the SANLJCL library, and send the output (SYSOUT log) as a text file. 
 * If the problem involves DBRM processing, send the DBRM module or library in a binary format. 
 * Send the contents of the ANLCNTL and ANLPARM members that were used when the error occurred. 


For batch problems (EEE):  * Add PARM('/DMP=YES') to the DB2 RUN command in the JCL. 
 * Execute the JCL, and send the output (SYSOUT log) as a text file.


For TSO p r oblems:  * Send screen captures that show the problem. 
 * From ISPF panel 6, run the ANLCANLI ANLDEBUG(YES) CLIST command, and send the ISPF trace output. 
 * If the problem involves DBRM processing, send the DBRM module or library in a binary format. 
 * Send the contents of the ANLCNTL and ANLPARM members that were used when the error occurred.


For stored procedures:  * Send a copy of the WLM application or stored startup procedure. 
 * Send a copy of the isolated (separate file) ANLCNTL parameters file that was used. 
 * Verify the location of the ANLPRC3R and ANLPRE3R load modules, and verify that they are not on the MVS link list and that they are not running from APF-authorized libraries. 
 * Send a sample run of the SQL PA “sample” access programs, or equivalent programs, that show the error or the problem that occurred. 
 * If a problem is not clearly detected, insert the DBTRACE ALL in the ANLCNTL file and rerun the stored procedure. Send the contents of the WLM or DB2 address space. The trace parameter will cause much of the detail trace report and other trace data to appear in the address space itself, which can be browsed by using the SDSF DA (display A/S command) and selecting the stored procedure address space (direct output to print class).


If a dump is required: 
 * SVC dump (or system dump), taken to SYS1.DUMPxx data set, as result of a dump command or a SLIP trap exit that was initiated by an operator:
   
   SLIP SET,ACTION=SVCD,COMP=0C4,JL=(MYJOB,DB2P*) 
   ID=JBW1,ASIDLST=(CU,H,I,P,S),
   SDATA=(ALLNUC,CSA,PSA,RGN,SQA,SWA,LSQA,GRSQ,TRT,SUM,XESDATA), END
   
   Before setting a SLIP trap, ensure that the size of your system trace table is acceptable by running the following MVS command: TRACE ST,512K. 
 * SYSABEND, SYSUDUMP, or SYSMDUMP output 
 * Please follow the directions for submitting documentation in APAR II11652.

RELATED INFORMATION
 1271756 [http://www.ibm.com/support/docview.wss?uid=swg21271756]