Title: IBM PM28356: DEADLOCK IN ORG.ECLIPSE.OSGI.INTERNAL.BASEADAPTOR.              DEFAULTCLASSLOADER - United States

Text:
  FIXES ARE AVAILABLE
6.1.0.37: Java SDK 1.5 SR12 FP3 Cumulative Fix for WebSphere [http://www-01.ibm.com/support/docview.wss?uid=swg24029525]
6.1.0.47: WebSphere Application Server V6.1 Fix Pack 47 [http://www-01.ibm.com/support/docview.wss?uid=swg24035508]
6.1.0.39: Java SDK 1.5 SR12 FP4 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24030426]
6.1.0.41: Java SDK 1.5 SR12 FP5 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24031035]
6.1.0.43: Java SDK 1.5 SR13 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24031963]
6.1.0.45: Java SDK 1.5 SR14 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24033270]
6.1.0.47: Java SDK 1.5 SR16 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24035649]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  This is a standard Java deadlock in org.eclipse.osgi.internal.
   baseadaptor.DefaultClassLoader caused by the following stack.
   
   Found one Java-level deadlock:
   
   =============================
   "WebContainer : 2":
     waiting to lock monitor 0x002a89e8 (object 0x71db0138, a
   org.eclipse.
   osgi.internal.baseadaptor.DefaultClassLoader),
     which is held by "WebContainer : 1"
   "WebContainer : 1":
     waiting to lock monitor 0x002a89a0 (object 0x727d4988, a
   org.eclipse.
   osgi.internal.baseadaptor.DefaultClassLoader),
     which is held by "WebContainer : 2"
   Java stack information for the threads listed above:
   ===================================================
   "WebContainer : 2":
           at
   java.lang.ClassLoader.checkCerts(ClassLoader.java:751)
           - waiting to lock <0x71db0138> (a
   org.eclipse.osgi.internal.
   baseadaptor.DefaultClassLoader)
           at
   java.lang.ClassLoader.preDefineClass(ClassLoader.java:487)
           at
   java.lang.ClassLoader.defineClass(ClassLoader.java:614)
           at
   org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.
   defineClass(DefaultClassLoader.java:160)
           at org.eclipse.osgi.baseadaptor.loader.ClasspathManager.
   defineClass(ClasspathManager.java:550)
           at org.eclipse.osgi.baseadaptor.loader.ClasspathManager.
   findClassImpl(ClasspathManager.java:520)
           at org.eclipse.osgi.baseadaptor.loader.ClasspathManager.
   findLocalClassImpl(ClasspathManager.java:451)
           at org.eclipse.osgi.baseadaptor.loader.ClasspathManager.
   findLocalClass_LockClassName(ClasspathManager.java:430)
   "WebContainer : 1":
           at
   java.lang.ClassLoader.checkCerts(ClassLoader.java:751)
           - waiting to lock <0x727d4988> (a
   org.eclipse.osgi.internal.
   baseadaptor.DefaultClassLoader)
           at
   java.lang.ClassLoader.preDefineClass(ClassLoader.java:487)
           at
   java.lang.ClassLoader.defineClass(ClassLoader.java:614)
           at
   org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.
   defineClass(DefaultClassLoader.java:160)
           at org.eclipse.osgi.baseadaptor.loader.ClasspathManager.
   defineClass(ClasspathManager.java:550)
           at org.eclipse.osgi.baseadaptor.loader.ClasspathManager.
   findClassImpl(ClasspathManager.java:520)
           at org.eclipse.osgi.baseadaptor.loader.ClasspathManager.
   findLocalClassImpl(ClasspathManager.java:451)
           at org.eclipse.osgi.baseadaptor.loader.ClasspathManager.
   findLocalClass_LockClassName(ClasspathManager.java:430)
           at org.eclipse.osgi.baseadaptor.loader.ClasspathManager.
   findLocalClass(ClasspathManager.java:417)
   
   
    
   
   

LOCAL FIX
 *  Setting the following properties as generic jvm arguments should
   avoid this condition (needs to be set on every process in the
   cell)
   
   -XX:+UnlockDiagnosticVMOptions -XX:+UnsyncloadClass
   
   
    
   
   

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED:  IBM WebSphere Application Server V6.1       *
   *                  users who use Sun.                          *
   ****************************************************************
   * PROBLEM DESCRIPTION: Deadlock in                             *
   *                      org.eclipse.osgi.internal.baseadaptor.  *
   ****************************************************************
   * RECOMMENDATION:                                              *
   ****************************************************************
   This is a standard Java deadlock in org.eclipse.osgi.internal.
   baseadaptor.DefaultClassLoader caused by the following stack.
   Found one Java-level deadlock:
   =============================
   "WebContainer : 2":
   waiting to lock monitor 0x002a89e8 (object 0x71db0138, a
   org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader),
   which is held by "WebContainer : 1"
   "WebContainer : 1":
   waiting to lock monitor 0x002a89a0 (object 0x727d4988, a
   org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader),
   which is held by "WebContainer : 2"
   Java stack information for the threads listed above:
   ===================================================
   "WebContainer : 2":
   at java.lang.ClassLoader.checkCerts(ClassLoader.java:751)
   
       * waiting to lock <0x71db0138> (a
         org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader)
         at
   java.lang.ClassLoader.preDefineClass(ClassLoader.java:487)
         at java.lang.ClassLoader.defineClass(ClassLoader.java:614)
         at
   org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.defineC
   lass(DefaultClassLoader.java:160)
         at
   org.eclipse.osgi.baseadaptor.loader.ClasspathManager.defineClass
   (ClasspathManager.java:550)
         at
   org.eclipse.osgi.baseadaptor.loader.ClasspathManager.findClassIm
   pl(ClasspathManager.java:520)
         at
   org.eclipse.osgi.baseadaptor.loader.ClasspathManager.findLocalCl
   assImpl(ClasspathManager.java:451)
         at
   org.eclipse.osgi.baseadaptor.loader.ClasspathManager.findLocalCl
   ass_LockClassName(ClasspathManager.java:430)
         "WebContainer : 1":
         at java.lang.ClassLoader.checkCerts(ClassLoader.java:751)
       * waiting to lock <0x727d4988> (a
         org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader)
         at
   java.lang.ClassLoader.preDefineClass(ClassLoader.java:487)
         at java.lang.ClassLoader.defineClass(ClassLoader.java:614)
         at
   org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.defineC
   lass(DefaultClassLoader.java:160)
         at
   org.eclipse.osgi.baseadaptor.loader.ClasspathManager.defineClass
   (ClasspathManager.java:550)
         at
   org.eclipse.osgi.baseadaptor.loader.ClasspathManager.findClassIm
   pl(ClasspathManager.java:520)
         at
   org.eclipse.osgi.baseadaptor.loader.ClasspathManager.findLocalCl
   assImpl(ClasspathManager.java:451)
         at
   org.eclipse.osgi.baseadaptor.loader.ClasspathManager.findLocalCl
   ass_LockClassName(ClasspathManager.java:430)
         at
   org.eclipse.osgi.baseadaptor.loader.ClasspathManager.findLocalCl
   ass(ClasspathManager.java:417)
   
   
    
   
   

PROBLEM CONCLUSION
 *  The code has been modified to set the following properties as
   generic JVM arguments on all Sun server processes, which
   resolves the problem:
   -XX:+UnlockDiagnosticVMOptions -XX:+UnsyncloadClass
   The fix for this APAR is currently targeted for inclusion in
   version 6.1 fix pack 6.1.0.37. Please refer to the recommended
   updates page for delivery information:
   http://www.ibm.com/support/docview.wss?rs=180&uid=swg2700498 [http://www.ibm.com/support/docview.wss?rs=180&uid=swg2700498]
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PM28356
   
   
 * REPORTED COMPONENT NAME
   WEBS APP SERV N
   
   
 * REPORTED COMPONENT ID
   5724H8800
   
   
 * REPORTED RELEASE
   61S
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2010-12-07
   
   
 * CLOSED DATE
   2011-01-13
   
   
 * LAST MODIFIED DATE
   2011-01-13
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WEBS APP SERV N
   
   
 * FIXED COMPONENT ID
   5724H8800
   
   

APPLICABLE COMPONENT LEVELS
 * R61A PSY
   UP
   
   
 * R61H PSY
   UP
   
   
 * R61I PSY
   UP
   
   
 * R61P PSY
   UP
   
   
 * R61S PSY
   UP
   
   
 * R61W PSY
   UP
   
   
 * R61Z PSY
   UP