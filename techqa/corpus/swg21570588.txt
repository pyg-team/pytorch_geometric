Title: IBM Installing AspectJ Developer Tools plugin gives the "... is not a Java .class file..." error - United States

Text:
AspectJ; byte-weaving; shared classes; JVM eclipse plug-in; not a Java .class file; javasharedresources; package explorer; could not create the view; plug-in org.eclipse.jdt.ui; unable to load class; org.eclipse.jdt.internal.ui.packageview.PackageExplorerPart TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Attempts to install the "AspectJ Developer Tools" plug-in with IBM Rational Application Developer for Websphere Software (RAD) results in "... is not a Java .class file..." and "Could not create the view ..." errors. 

SYMPTOM
Errors such as the following occur when you install AspectJ Developer Tools:



 *  <exception message="org.eclipse.jdt.core.IElementChangedListener is not a Java .class file" type="org.aspectj.apache.bcel.classfile.ClassFormatException">
   
   <trace class="org.aspectj.apache.bcel.classfile.ClassParser" method="readID"/>
   
   
 *  <exception message="org.eclipse.jdt.internal.core.builder.JavaBuilder is not a Java .class file" type="org.aspectj.apache.bcel.classfile.ClassFormatException">
   <trace class="org.aspectj.apache.bcel.classfile.ClassParser" method="readID"/>
   
   
   
 * When opening the Package Explorer view the error is :
   
   
   "Could not create the view : Plug-in org.eclipse.jdt.ui was unable to load class org.eclipse.jdt.internal.ui.packageview.PackageExplorerPart"


The AspectJ repository [http://download.eclipse.org/tools/ajdt/36/update] has been reported to cause the problem.


CAUSE
The shared classes library that RAD created is not compatible with the byte code weaving of the AspectJ plugin. As a result, classes are not loaded properly.

RAD creates this shared classes library upon startup through the following eclipse.ini entry:


-Xshareclasses:name=IBMSDP_%u 






On Microsoft Windows 7, the location is as follows:

C:\Users\Administrator\AppData\Local\javasharedresources



ENVIRONMENT
All Microsoft Windows environments.



RESOLVING THE PROBLEM
SOLUTION 

Follow these steps: 

 

 1. Issue the following command from a command line to destroy the shared cache as follows, while RAD is not running.
    
    
    C:\Documents and Settings\Administrator>"C:\Program Files\IBM\SDP\jdk\bin\java.exe" -Xshareclasses:destroyAll
    
    
 2. Review the output. The expected output looks something like the following:
    
    
    Attempting to destroy all caches in cacheDir C:\Documents and Settings\Administrator\Local Settings\Application Data\javasharedresources\
    
    JVMSHRC256I Persistent shared cache "IBMSDP_Administrator" has been destroyed.
    Could not create the Java virtual machine.
    
    
    
 3. Restart RAD. This re-creates the cache if the eclipse.ini entry above is still present.



NOTE: The AspectJ version must be compatible with RAD's embedded Eclipse version RELATED INFORMATION
 RAD Support for 3rd Party & Open Source Eclipse plugins [http://www.ibm.com/support/docview.wss?uid=swg21600040]
Problem with RAD & AspectJ Developer Tools plugin [https://www.ibm.com/developerworks/community/forums/html/topic?id=77777777-0000-0000-0000-000014816025]