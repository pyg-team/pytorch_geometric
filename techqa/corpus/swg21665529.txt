Title: IBM connect-database fails duing migration of WebSphere Portal from 7002 to Portal 8001 - United States

Text:
Migration; connect-database; WSWS1002E; JCRBSeedbus TECHNOTE (TROUBLESHOOTING)

PROBLEM
As part of the Portal migration, in the step "Migrating Databases" the command ConfigEngine.bat connect-database or ./ConfigEngine.sh connect-database fails when it tries to start/recover the portal with below exception. 

[wplc-get-host-port-in-server] Settings the port: 10039 as ant property: ${portInJMX}
[wplc-get-host-port-in-server] Status = Complete
[echo] check for 'WebSphere_Portal' on 'WC_defaulthost' port configuration: '10039'. XmlAccessPort is set to: '10039'
[echo] 'WebSphere_Portal' seems to be stopped.
[echo] Starting 'WebSphere_Portal'
[exec] ADMU0116I: Tool information is being logged in file
[exec] /opt/IBM/WebSphere/wp_profile/logs/WebSphere_Portal/startServer.log
[exec] ADMU0128I: Starting tool with the wp_profile profile
[exec] ADMU3100I: Reading configuration for server: WebSphere_Portal
[exec] ADMU3200I: Server launched. Waiting for initialization status.
[exec] ADMU3001I: Server WebSphere_Portal open for recovery; process id is 7811
[exec] ADMU3014W: Server recovery complete, problems occurred during recovery. Server
[exec] log files should contain failure information.

BUILD FAILED
/opt/IBM/WebSphere/ConfigEngine/config/includes/serverTargets.xml:454: The following error occurred while executing this line:
/opt/IBM/WebSphere/PortalServer/base/wp.base/config/includes/wp.base_cfg.xml:1842: exec returned: 255

Total time: 3 minutes 24 seconds
FAILURE_LOG_DIR=null
isIseries currently set to: null
Creating failure log in directory: /opt/IBM/WebSphere/wp_profile/ConfigEngine/log
traceFile created /opt/IBM/WebSphere/wp_profile/ConfigEngine/log/failure2013-11-15-08.25.32.log
basepath = /opt/IBM/WebSphere/PortalServer/base/wp.base

commit-admin-changes:
Fri Nov 15 08:25:32 EST 2013
[wplc-commit-admin-changes] Task parameters:
[wplc-commit-admin-changes] Global attributes:
[wplc-commit-admin-changes] cell=""
[wplc-commit-admin-changes] engineinstalllocation="/opt/IBM/WebSphere/wp_profile/ConfigEngine"
[wplc-commit-admin-changes] enginerootdir="/opt/IBM/WebSphere/ConfigEngine"
[wplc-commit-admin-changes] pathseparator=":"
[wplc-commit-admin-changes] osarch="x86"
[wplc-commit-admin-changes] node=""
[wplc-commit-admin-changes] server=""

[wplc-commit-admin-changes] Instance attributes (Set 1 of 1):
[wplc-commit-admin-changes] attribute=[ *** NONE_SPECIFIED *** ]
session discarded... anonymous1384521772249
Status = Complete

stop-wsadmin-listener:
Fri Nov 15 08:25:33 EST 2013

delete-temp-dirs:
Fri Nov 15 08:25:33 EST 2013
[delete] Deleting: /opt/IBM/WebSphere/wp_profile/ConfigEngine/config/work/was/wp_portal.properties
[delete] Deleting: /opt/IBM/WebSphere/wp_profile/ConfigEngine/properties/wkplc_comp_ascii.properties
[delete] Deleting: /opt/IBM/WebSphere/wp_profile/ConfigEngine/properties/wkplc_ascii.properties
[delete] Deleting 5 files from /opt/IBM/WebSphere/wp_profile/ConfigEngine/properties

cleanup-work-dir:
Fri Nov 15 08:25:33 EST 2013
[echo] Cleaning up...
[delete] Deleting directory /opt/IBM/WebSphere/wp_profile/ConfigEngine/config/work
[echo] Done.

cleanup-config:
Fri Nov 15 08:25:33 EST 2013
[echo] executing post-configuration tasks
BUILD FAILED
isIseries currently set to: null 


SYMPTOM
In the ConfigTrace.log file, following exception can be seen 


[11/19/13 15:35:28:562 EST] 00000032 webapp I com.ibm.ws.webcontainer.webapp.WebGroupImpl WebGroup SRVE0169I: Loading Web Module: WebSphere Portal Server.
[11/19/13 15:35:28:598 EST] 00000032 WebServiceUti W CWWWS8010E: The system could not determine the programming model type for the service/WSRPService service reference because the com.ibm.wps.wsrp.consumer.wsdl.WSRPService service interface class did not load correctly.
[11/19/13 15:35:28:606 EST] 00000032 WebServiceUti W CWWWS8010E: The system could not determine the programming model type for the service/WSRPService_v2 service reference because the com.ibm.wps.wsrp.consumer.wsdl.WSRPService_v2 service interface class did not load correctly.
[11/19/13 15:35:28:610 EST] 00000032 WebServiceUti W CWWWS8010E: The system could not determine the programming model type for the service/WSRPService service reference because the com.ibm.wps.wsrp.consumer.wsdl.WSRPService service interface class did not load correctly.
[11/19/13 15:35:28:610 EST] 00000032 WebServiceUti W CWWWS8010E: The system could not determine the programming model type for the service/WSRPService_v2 service reference because the com.ibm.wps.wsrp.consumer.wsdl.WSRPService_v2 service interface class did not load correctly.
[11/19/13 15:35:28:722 EST] 00000032 FfdcProvider W com.ibm.ws.ffdc.impl.FfdcProvider logIncident FFDC1003I: FFDC Incident emitted on /opt/IBM/WebSphere/wp_profile/logs/ffdc/WebSphere_Portal_262ad61_13.11.19_15.35.28.6229040329880690203186.txt com.ibm.ws.injectionengine.processor.ResourceProcessor.loadTypeClass 1142
[11/19/13 15:35:28:722 EST] 00000032 ResourceProce W CWNEN0046W: The com.ibm.wps.datastore.ejb.cleanup.SchedulerManagerHome type specified on the resource-ref, resource-env-ref, or message-destination-ref with the ejb/wpsSchedulerManager name in the wps.war module could not be loaded. Compatibility type checking will not be performed for this resource reference.
[11/19/13 15:35:28:770 EST] 00000032 WASSessionCor I SessionContextRegistry getSessionContext SESN0176I: Will create a new session context for application key default_host/wps
[11/19/13 15:35:28:798 EST] 00000032 jsp W com.ibm.ws.jsp.taglib.TldParser endElement JSPG0235E: The JSP container failed to load the TagExtraInfo class [com.ibm.wps.theme.plugin.tags.ThemeExtensionItemLoopTag$TEI] from /WEB-INF/tld/portal-v6-theme-ext.tld
[11/19/13 15:35:28:802 EST] 00000032 jsp W com.ibm.ws.jsp.taglib.TldParser endElement JSPG0235E: The JSP container failed to load the TagExtraInfo class [com.ibm.wps.theme.plugin.tags.ThemeExtensionItemLoopTag$TEI] from /WEB-INF/tld/portal-v7-theme-ext.tld
[11/19/13 15:35:28:822 EST] 00000032 webapp E com.ibm.ws.webcontainer.webapp.WebApp logError SRVE0293E: [Servlet Error]-[Failed to load listener: com.ibm.wps.engine.SessionListener]: java.lang.ClassNotFoundException: class java.lang.ClassNotFoundException: com.ibm.wps.engine.SessionListener


Also many other errors:

[11/19/13 15:35:27:854 EST] 00000032 WSServerImpl E WSWS1002E: An error occurred while processing the Web services deployment descriptor for module: wps.war with error: java.lang.ClassNotFoundException: oasis.names.tc.wsrp.v1.bind.WSRP_v1_Markup_Binding_SOAPImpl


CAUSE
Its found that, some times JCRBSeedbus may create problem during migration. If the connect-database fails, then the JCRBSeedbus should be deleted during the migration to 8001 from 7002 as its not used in the 8.x version.


RESOLVING THE PROBLEM
Go to the WebSphere Application Server admin page. In that go to "Select Service Integration" and select "Buses". If there is JCRBSeedbus existing, delete it and rerun the connect-database command.