Title: IBM Collect WebSphere MQ MustGather data to solve TLS channel problems on HP NonStop Server - United States

Text:
MustGather; MustGathers Must Gather; MustGatherDocument; Collect Troubleshooting Data; Collect; Trouble; Shooting; SSL/TLS; SSL; TLS; Secure Sockets Layer; Transport Layer Security; Certificate TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 A WebSphere MQ queue manager or incoming client connection is failing to establish a secure channel using TLS (formerly SSL), and you need to collect MustGather data to find a solution. 

ENVIRONMENT
These instructions apply only to WebSphere MQ V5.3.1 and V5.3 on HP NonStop Server. Refer to the IBM MQ Read First page for instructions on other operating systems:



 * IBM MQ Read First [http://www.ibm.com/support/docview.wss?uid=swg21618728]



RESOLVING THE PROBLEM
 

Please answer these questions about the problem and then follow the steps below:



 * What TLS channel problem did you observe on the system?
 * What time did the TLS channel problem start and when did it stop?
 * Which specific channels and certificates are involved in the problem?



STEP 1: GENERATE DATA

If the TLS channel problem is reproducible or is happening right now, generate data to provide more information about the problem:



 1. 
 2. If the problem occurs when starting a sending channel, generate a trace of the queue manager [http://www.ibm.com/support/docview.wss?uid=swg21667375] showing the channel start attempt.
 3. 
 4. 
 5. Generate MQ trace simultaneously at the other end of the channel:
    
     * Linux and UNIX [http://www.ibm.com/support/docview.wss?uid=swg21665357]
     * Windows [http://www.ibm.com/support/docview.wss?uid=swg21666876]
     * IBM i [http://www.ibm.com/support/docview.wss?uid=swg21664990]
    
     * z/OS CHIN trace [http://www.ibm.com/support/docview.wss?uid=swg21665093]
     * z/VSE [http://www.ibm.com/support/docview.wss?uid=swg21666814]
     * HP OpenVMS [http://www.ibm.com/support/docview.wss?uid=swg21667361]
    
    
 6. 



STEP 2: COLLECT DATA
 1.  
 2.  Record the MQ version and maintenance level [http://www.ibm.com/support/docview.wss?uid=swg21621707].
 3.  
 4.  
 5.  Record the operating system version and maintenance level [http://www.ibm.com/support/docview.wss?uid=swg21634678].
 6.  
 7.  
 8.  From a Guardian prompt, display the VPROC output from the MQ amqcctca and amqcctca_r files:
 9.   
     DISPLAYING THE WEBSPHERE MQ COMMUNICATIONS LIBRARY VPROC OUTPUT
     
     TACL> VPROC AMQCCTCA 
     TACL> VPROC AMQCCTCA_R 
 10. 
 11. 
 12. List the contents of the queue manager ssl directory. Guardian users should run the osh TACL command to switch to the OSS environment first and then source the var/mqm/wmqprofile script in order to use WebSphere MQ commands. For example:
 13.  
     DISPLAYING THE KEY STORE DIRECTORY FOR QUEUE MANAGER QMA
     
     osh> . /path/to /var/mqm/wmqprofile 
     osh> cd /path/to /var/mqm/qmgrs/QMA/ssl 
     osh> ls -al 
     
 14. 
 15. 
 16. Display the WebSphere MQ CA certificates, securely passing your actual trust store password as suggested in the following example:
 17.  
     DISPLAYING THE WEBSPHERE MQ CA CERTIFICATES
     
     osh> openssl x509 -noout -in /path/to /var/mqm/qmgrs/QMA/ssl / trust.pem -passin file:<(echo -n "passw0rd") -issuer -subject -dates 
     
 18. 
 19. 
 20. Display the WebSphere MQ personal certificates, securely passing your actual certificate store password as suggested in the following example:
 21.  
     DISPLAYING THE WEBSPHERE MQ PERSONAL CERTIFICATES
     
     osh> openssl x509 -noout -in /path/to /var/mqm/qmgrs/QMA/ssl/cert.pem -passin file:<(echo -n "passw0rd") -issuer -subject -dates 
     
 22. 
 23. 
 24. Use runmqsc to record your queue manager, queues, channels and channel status information. If any command gives an error, carry on with the others:
 25.  
     DISPLAY QMGR ALL 
     DISPLAY QLOCAL(*) ALL 
     DISPLAY QALIAS(*) ALL 
     DISPLAY QREMOTE(*) ALL 
     DISPLAY CHANNEL(*) ALL 
     DISPLAY CHSTATUS(*) ALL 
     
 26. 
 27. 
 28. Use the sdcp script to package your files for IBM [http://www.ibm.com/support/docview.wss?uid=swg21671892], including files containing the output from the commands listed in Step 1 and 2.
 29. 



STEP 3: SEND DATA TO IBM
 1.  
 2.  Send your data to the IBM ECuRep repository [http://www.ibm.com/de/support/ecurep/send.html] by email to websphere_support@ecurep.ibm.com, or by standard or secure HTTP or FTP.
 3.  
 4.  
 5.  While the data is transferring, send an email or use the IBM Service Request tool [http://www.ibm.com/support/servicerequest/] to update your PMR with your description of the problem and of the data you are sending.
 6.  
 7.  
 8.  A good description of the problem and the data is the most important information you can provide to IBM. Please do not send data without providing a description!
 9.  
 10. Contact your country representative [http://www.ibm.com/planetwide/] if you need to speak to an IBM technical support representative, or in the US call 1-800-IBM-SERV. Refer to the IBM Software Support Handbook [http://www14.software.ibm.com/webapp/set2/sas/f/handbook/home.html] for more information on working with IBM.
 11. 

Back to top

 

PRODUCT ALIAS/SYNONYM
 WebSphere MQ WMQ