Title: IBM Rational License Key Server Administration and Reporting Tool does not report license usage for the new licenses added to Rational License Key Server - United States

Text:
rlks; SQLCODE=-359; ERROR ... [...][com.ibm.rcl.data.LicenseDataManager][388] - Failed for this feature LicenseServerFeatureSupportFact [...]; ERROR; [; ][com; ibm; rcl; data; LicenseDataManager][388] - Failed for this feature LicenseServerFeatureSupportFact [; ]; com.ibm.db2.jcc.am.SqlIntegrityConstraintViolationException: DB2 SQL Error: SQLCODE=-359; SQLSTATE=23522; SQLERRMC=null; DRIVER=4.18.60; com; db2; jcc; am; SqlIntegrityConstraintViolationException: DB2 SQL Error: SQLCODE=-359; DRIVER=4; 18; 60 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 IBM® Rational® License Key Server (RLKS) Administration and Reporting Tool (ART) V8.1.5 does not report license usage for licenses added to IBM Rational License Key Server after you start the reporting on an agent. 

SYMPTOM
If you are experiencing license usage issues, the following errors can display in the RLKS_ART.log file, available in the RLKSAdmin/work/rcladmin/logs directory: 


SQLCODE=-359 


ERROR ... [...][com.ibm.rcl.data.LicenseDataManager][388] - Failed for this feature LicenseServerFeatureSupportFact [...]


com.ibm.db2.jcc.am.SqlIntegrityConstraintViolationException: DB2 SQL Error: SQLCODE=-359, SQLSTATE=23522, SQLERRMC=null, DRIVER=4.18.60



CAUSE
The range of values for the IDENTITY COLUMN LICENSE_ID in LICENSE table is exhausted. For more details, see SQLCODE=-359 [https://www.ibm.com/support/knowledgecenter/en/SSEPEK_11.0.0/codes/src/tpc/n359.html]. 


DIAGNOSING THE PROBLEM
 

 1. Setup Rational License Server Administration and Reporting Tool V8.1.5 with the Rational License Key Server.
    Important:  * Rational License Key Server serves licenses that Rational License Key Server Administration and Reporting Tool does not support. 
     * Rational License Key Server has existing license logs. 
     * Rational License Key Server restarts or runs lmreread command frequently.
    
    
 2. Start reporting on the Rational License Key Server Administration Agent configured with the Rational License Key Server. 
 3. Import new license into the Rational License Key Server. Ensure license usages are logged for new licenses.
    
    You can see error logs in the RLKS_ART.log file with SQLCODE=-359 after one hour of new license usage.

RESOLVING THE PROBLEM
 

 1. (Optional) Backup your Rational License Key Server Administration and Reporting Tool data using DB2 db2 export or db2 backup CLP commands.
    
 2. Download the following compressed files with the files attached to the bottom of this technote:  * regenerate_keys_rcl_db2.bat 
     * regenerate_keys_rcl_db2.sh 
     * regenerate_keys_rcl_db2.sql
       
    
    
 3. Run the .bat or .sh files depending on your operating system:  * Windows: Run the batch file (.bat) as administrator user. 
     * Linux: Place the.sh and.sql files in the home folder of the DB2 instance user. 
       For example, in the /home/rcldb2i1 directory and run as thercldb2i1 user. 
       This creates a log file (.log) with the same name as the SQL file, for example- (regenerate_keys_rcl_db2sql.log). Ensure that there are no errors in the log file.
       
    
    
 4. Remove the .sh, .bat, and .sql compressed files. 

[/support/docview.wss?uid=swg22005684&aid=2]regenerate_keys_rcl_db2.bat [/support/docview.wss?uid=swg22005684&aid=1] 
[/support/docview.wss?uid=swg22005684&aid=4]regenerate_keys_rcl_db2.sh [/support/docview.wss?uid=swg22005684&aid=3] 

[/support/docview.wss?uid=swg22005684&aid=6]regenerate_keys_rcl_db2.sql [/support/docview.wss?uid=swg22005684&aid=5]