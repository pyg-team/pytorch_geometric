Title: IBM PK46689: "PATHNOTFOUNDEXCEPTION WHILE SYNDICATING A DELETED ITEM" - United States

Text:
 
APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  "PathNotFoundException while syndicating a deleted item"
   
   
    
   
   

LOCAL FIX
 *  NA
   
   
    
   
   

PROBLEM SUMMARY
 *  Detailed Problem Description:
   
   The following scenario exhibits the problem:
   Create a new library and create items in the library
   Create a syndicator / subscriber pair and rebuild the syndicator
   Stop portal on both machines
   From <wps>/config on both the syndicator and subscriber run:
   WPSconfig[.sh|.bat] wcm-reset-event-log
   Start portal on both machines
   Rebuild the syndicator
   Update items on the first library and create a second library
   with some items that reference into first library.  For example,
   create contents in the second library using authoring templates
   from the first.
   Edit the syndicator to add the new library
   Update the syndicator.  The syndication is successful, but the
   following exception appears in the log:
   [6/8/07 3:57:11:797 PDT] 0000003a VersioningSer E
   /7d7c070045a25314879defddc740cc36/0/jcr:versionedNode
   
   javax.jcr.PathNotFoundException:
   /7d7c070045a25314879defddc740cc36/0/jcr:versionedNode
    at com.ibm.icm.jcr.NodeImpl.getNode(NodeImpl.java:1013)
    at com.ibm.icm.jcr.NodeImpl.getNode(NodeImpl.java:926)
    at
   com.ibm.icm.jcr.service.version.VersionServiceImpl.restoreToRela
   tivePath(VersionServiceImpl.java:1226)
    at
   com.ibm.icm.jcr.service.version.VersionImpl.restoreToAbsolutePat
   h(VersionImpl.java:680)
    at
   com.ibm.workplace.wcm.services.versioning.VersioningServiceImpl.
   restoreToAbsolutePath(VersioningServiceImpl.java:2891)
    at
   com.ibm.workplace.wcm.services.versioning.VersioningServiceImpl.
   getDeletedVersionAsControllable(VersioningServiceImpl.java:6226)
    at
   com.ibm.workplace.wcm.services.versioning.VersioningServiceImpl.
   getDeleted(VersioningServiceImpl.java:4883)
    at
   com.ibm.workplace.wcm.services.versioning.VersioningServiceImpl.
   getDeleted(VersioningServiceImpl.java:4773)
    at
   com.ibm.workplace.wcm.services.versioning.VersioningServiceUtils
   .getDeletedForSyndication(VersioningServiceUtils.java:887)
    at
   com.aptrix.deployment.syndicator.ItemDispatcher.fetchItemVersion
   (ItemDispatcher.java:363)
    at
   com.aptrix.deployment.syndicator.ItemDispatcher.fetchItem(ItemDi
   spatcher.java:643)
    at
   com.aptrix.deployment.syndicator.ItemDispatcher.dispatchItem(Ite
   mDispatcher.java:261)
    at
   com.aptrix.deployment.syndicator.ItemDispatcher.process(ItemDisp
   atcher.java:209)
    at
   com.presence.connect.business.module.ModuleManager.launchBusines
   s(ModuleManager.java:121)
    at
   com.presence.connect.business.module.ModuleManager.launchBusines
   s(ModuleManager.java:384)
    at
   com.presence.connect.RequestExecutable.execute(RequestExecutable
   .java:84)
    at com.presence.connect.dispatcher.Task.run(Task.java:151)
    at
   com.presence.connect.ConnectClient.processSynchronous(ConnectCli
   ent.java:167)
    at
   com.presence.connect.ConnectServlet.process(ConnectServlet.java:
   298)
    at
   com.presence.connect.ConnectServlet.doGet(ConnectServlet.java:12
   0)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:743)
    at
   javax.servlet.http.HttpServlet.service(HttpServlet.java(Compiled
   Code))
    at
   com.ibm.ws.webcontainer.servlet.ServletWrapper.service(ServletWr
   apper.java(Compiled Code))
    at
   com.ibm.ws.webcontainer.servlet.ServletWrapper.handleRequest(Ser
   vletWrapper.java(Compiled Code))
    at
   com.ibm.ws.webcontainer.servlet.CacheServletWrapper.handleReques
   t(CacheServletWrapper.java(Compiled Code))
    at
   com.ibm.ws.webcontainer.WebContainer.handleRequest(WebContainer.
   java(Compiled Code))
    at
   com.ibm.ws.webcontainer.channel.WCChannelLink.ready(WCChannelLin
   k.java(Compiled Code))
    at
   com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.handleDiscr
   imination(HttpInboundLink.java(Compiled Code))
    at
   com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.handleNewIn
   formation(HttpInboundLink.java(Compiled Code))
    at
   com.ibm.ws.http.channel.inbound.impl.HttpICLReadCallback.complet
   e(HttpICLReadCallback.java(Compiled Code))
    at
   com.ibm.ws.tcp.channel.impl.WorkQueueManager.requestComplete(Wor
   kQueueManager.java(Compiled Code))
    at
   com.ibm.ws.tcp.channel.impl.WorkQueueManager.attemptIO(WorkQueue
   Manager.java(Compiled Code))
    at
   com.ibm.ws.tcp.channel.impl.WorkQueueManager.workerRun(WorkQueue
   Manager.java(Compiled Code))
    at
   com.ibm.ws.tcp.channel.impl.WorkQueueManager$Worker.run(WorkQueu
   eManager.java(Compiled Code))
    at
   com.ibm.ws.util.ThreadPool$Worker.run(ThreadPool.java(Compiled
   Code))
   
   
    
   
   

PROBLEM CONCLUSION
 *  Problem Analysis:
   
   Sometimes the base version in the JCR has the same timestamp as
   the first real version.  If this is true, the base version will
   be returned when retrieving a version by date.  The base version
   is not usable for retrieving the actual versions of WCM items
   and trying to use it in that manner causes the exception.
   
   Failing Module: WCM - Web Content Management (General)
   
   Problem Solution:
   
    If a retrieved version is the base version, the succeeding
   versions are retrieved until one with the same timestamp is
   retrieved.
   
   
   Affected Users: All Users
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PK46689
   
   
 * REPORTED COMPONENT NAME
   WRKPLC WEB CON
   
   
 * REPORTED COMPONENT ID
   5724I2900
   
   
 * REPORTED RELEASE
   60A
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2007-06-07
   
   
 * CLOSED DATE
   2007-08-30
   
   
 * LAST MODIFIED DATE
   2007-08-30
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WRKPLC WEB CON
   
   
 * FIXED COMPONENT ID
   5724I2900
   
   

APPLICABLE COMPONENT LEVELS
 * R601 PSY
   UP
   
   
 * R60C PSY
   UP