Title: IBM Application Deployment fails: java.lang.IllegalStateException. Error is Platform not running. - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Application Deployment fails: java.lang.IllegalStateException. Error is Platform not running. This could happen during InfoSphere Information Server: 

- fix pack installation
- patch installation
- Information Services Director application deployment 
- upgrading InfoSphere Information Server from version 8.7 to version 9.1

after installation of WebSphere or after application of a WebSphere fix pack. It can occur with any of the following WebSphere versions: 7.x, 8.0.x and 8.5.


SYMPTOM
This error can occur during deployment of an application to WebSphere. Application deployment is done as part of InfoSphere Information Server: 

- product installation 
- fix pack installation 
- patch installation, 
- Information Services Director application deployment
- upgrading InfoSphere Information Server


 

The following exception can be seen in the WebSphere SystemOut.log: 


[7/25/12 2:08:29:498 EDT] 000000b8 DeployEJBTask I ADMA0158I: [EJBDeploy] Error executing deployment: java.lang.IllegalStateException. Error is Platform not running.
[7/25/12 2:08:29:501 EDT] 000000b8 DeployEJBTask I ADMA0158I: [EJBDeploy] java.lang.IllegalStateException: Platform not running
[7/25/12 2:08:29:585 EDT] 000000b8 DeployEJBTask I ADMA0158I: [EJBDeploy] at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:374)
[7/25/12 2:08:29:590 EDT] 000000b8 DeployEJBTask I ADMA0158I: [EJBDeploy] at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
[7/25/12 2:08:29:590 EDT] 000000b8 DeployEJBTask I ADMA0158I: [EJBDeploy] at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48)
[7/25/12 2:08:29:619 EDT] 000000b8 DeployEJBTask I ADMA0158I: [EJBDeploy] at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
[7/25/12 2:08:29:620 EDT] 000000b8 DeployEJBTask I ADMA0158I: [EJBDeploy] at java.lang.reflect.Method.invoke(Method.java:600)
[7/25/12 2:08:29:621 EDT] 000000b8 DeployEJBTask I ADMA0158I: [EJBDeploy] at com.ibm.etools.ejbdeploy.batch.impl.BootLoaderLoader.run(BootLoaderLoader.java:494)
[7/25/12 2:08:29:623 EDT] 000000b8 DeployEJBTask I ADMA0158I: [EJBDeploy] at com.ibm.etools.ejbdeploy.batch.impl.BatchDeploy.execute(BatchDeploy.java:114)
[7/25/12 2:08:29:625 EDT] 000000b8 DeployEJBTask I ADMA0158I: [EJBDeploy] at com.ibm.etools.ejbdeploy.EJBDeploy.execute(EJBDeploy.java:107)
[7/25/12 2:08:29:626 EDT] 000000b8 DeployEJBTask I ADMA0158I: [EJBDeploy] at com.ibm.etools.ejbdeploy.EJBDeploy.deploy(EJBDeploy.java:348)
[7/25/12 2:08:29:627 EDT] 000000b8 DeployEJBTask I ADMA0158I: [EJBDeploy] at com.ibm.etools.ejbdeploy.EJBDeploy.main(EJBDeploy.java:310)
[7/25/12 2:08:29:628 EDT] 000000b8 DeployEJBTask I ADMA0158I: [EJBDeploy] EJBDeploy level: @build@
[7/25/12 2:08:29:718 EDT] 000000cc SystemOut O com.ibm.etools.ejbdeploy.EJBDeploymentException: Error executing EJBDeploy
[7/25/12 2:08:29:719 EDT] 000000cc SystemOut O at com.ibm.etools.ejbdeploy.EJBDeploy.execute(EJBDeploy.java:252)
[7/25/12 2:08:29:719 EDT] 000000cc SystemOut O at com.ibm.ejs.util.deployment.deploywrapper.DeployUtil$1.run(DeployUtil.java:316)
[7/25/12 2:08:29:719 EDT] 000000cc SystemOut O at com.ibm.ws.security.util.AccessController.doPrivileged(AccessController.java:118)
[7/25/12 2:08:29:719 EDT] 000000cc SystemOut O at com.ibm.ejs.util.deployment.deploywrapper.DeployUtil.deployModule(DeployUtil.java:311)
[7/25/12 2:08:29:719 EDT] 000000cc SystemOut O at com.ibm.ejs.util.deployment.deploywrapper.DeployUtil.deploy(DeployUtil.java:90)
[7/25/12 2:08:29:719 EDT] 000000cc SystemOut O at com.ibm.ws.management.application.task.DeployEJBTask.ejbDeploy(DeployEJBTask.java:386)
[7/25/12 2:08:29:719 EDT] 000000cc SystemOut O at com.ibm.ws.management.application.task.DeployEJBTask.install(DeployEJBTask.java:237)
[7/25/12 2:08:29:719 EDT] 000000cc SystemOut O at com.ibm.ws.management.application.task.DeployEJBTask.performTask(DeployEJBTask.java:134)
[7/25/12 2:08:29:719 EDT] 000000cc SystemOut O at com.ibm.ws.management.application.SchedulerImpl.run(SchedulerImpl.java:294)
[7/25/12 2:08:29:719 EDT] 000000cc SystemOut O at java.lang.Thread.run(Thread.java:736)

CAUSE
During the install of WebSphere Application Server or application of a WebSphere fix pack update, the EJBDeploy application may not have been correctly installed or refreshed. In particular, even though a WebSphere Application Server fix pack install has succeeded, the OSGi configuration cache may not have been purged/cleared as expected. 



DIAGNOSING THE PROBLEM
Check for the specified messages in the Information Server install log or the WebSphere SystemOut.log. 



RESOLVING THE PROBLEM
To resolve the problem, complete the following steps: 


1. Delete/Remove the contents of the following directory EXCEPT for the 'config.ini' file, if it exists (the paths are different depending on your WAS version):

WebSphere Application Server v6.1.x: <profile root>/deploytools/configuration

WebSphere Application Server v7.0.x, v8.x: <profile root>/ejbdeploy/configuration

Cluster Environments: Do this for both the DMGR profile and each of the node profiles.

Note: The deploytools and ejbdeploy directories may not exist on all nodes. They are created when ejbdeploy is executed successfully for the first time. If it has never been executed successfully in your environment, then the directories will not be there.

2. Retry the operation that failed.

An alternative option is to follow step 1 above to clean up the OSGi configuration cache before starting the installation or upgrade process.