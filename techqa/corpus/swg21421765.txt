Title: IBM How to diagnose VMM user/group synchronization issues - United States

Text:
TPAESECURITY; LDAP; MSAD; Active Directory; UserMapping; GroupMapping; VMMSYNC; LDAPSYNC; Maximo; TSRM; SCCD; VMM; Websphere Application Server; WAS; ldapsearch; Virtual Member Manager TECHNOTE (FAQ)

QUESTION
 How do I diagnose Maximo user and group synchronization issues with VMMSYNC? 

ANSWER
As this tech note applies to all products which use Tivoli Process Automation Engine (Maximo Base Services) I will be referring to the application you are running as Maximo. 

Basic assumptions: 

 * You are running under WebSphere Application Server (WAS) 
 * You have one or more LDAP repositories federated in WAS Virtual Member Manager facility (this is the default out-of-the-box setup when running under WAS)  * These LDAP repositories could be Microsoft Active Directory, or Tivoli Directory Server 
    * VMMSYNC is your synchronization Cron Task of choice under Maximo
   
   

Basic WebSphere Application Server (WAS) checks from Integrated Solution Console (ISC): 

 1. Go to Applications | Enterprise Applications > MAXIMO > Security role to user/group mapping and check for the maximouser role the mapped group (by default maximousers) that All Authenticated is selected.  1. If this option is not selected then only users in the group called maximousers in LDAP will be allowed to login to Maximo.
    
    
 2. Go to Security | Secure administration, applications, and infrastructure > Federated repositories:  1. Make sure the basedn is correctly set for your environment. 
     2. Select Supported entity types and check:  1. Group entity property is set to cn 
         2. PersonAccount entity property is set to uid
        
        
    
    
 3. Go to Users and Groups | Manage Users and try to list any users which are not synchronizing  1. If WAS VMM cannot find the users from here then they will not synchronize
    
    
 4. Go to Users and Groups | Manage Groups and try to list any groups which are not synchronizing  1. If WAS VMM cannot find the groups from here then they will not synchronize
    
    


Basic VMMSYNC Cron Task checks from Maximo:  1. Login to Maximo with maxadmin or equivalent administrative id. 
 2. Go to Database Configuration (under System Configuration | Platform Configuration).  1. From Select Action menu select Manage Admin Mode. 
     2. If the dialog indicates that the server is currently in admin mode then turn it off as no cron tasks will run in this state.
    
    
 3. Go to Cron Task Setup (under System Configuration | Platform Configuration).  1. List all cron tasks and select VMMSYNC. 
     2. Select active VMMSYNC instance (default is VMMSYNC01) and ensure history is enabled. 
     3. Check the instance Schedule. Default is a run every 5 minutes. 
     4. In Parameters tab:  1. Check Principal exists in your LDAP repository and Credential is the correct password. Note that these values are required to be present and valid whether or not your LDAP repository allows unauthenticated reads. 
         2. GroupSearchAttribute should match Group entity property from WAS Supported entity types (default is cn). 
         3. UserSearchAttribute should match PersonAccount entity property from WAS Supported entity types (default is uid). 
         4. If group synchronization is not working then select GroupMapping and check:  1. <basedn> setting specifies correct LDAP location containing all objects you wish to synchronize 
             2. <filter> setting is correct as per http://www-01.ibm.com/support/docview.wss?uid=swg21364002 [http://www-01.ibm.com/support/docview.wss?uid=swg21364002]
            
            
         5. If user synchronization is not working then select UserMapping and check the same settings as above.
        
        
     5. In History tab check for last cron task run time and any resulting errors. 
    
    


Set the VMMSYNC Cron Task into debug mode in Maximo  1. Go to the Logging application (under System Configuration | Platform Configuration). 
 2. Find and select the crontask root logger (not crontaskmgr) in the upper Root Loggers pane. 
 3. Find and select the VMMSYNC logger in the lower Loggers pane.  1. If one does not already exist (as it doesn't come out of the box) then add it:  1. Click the New Row button in Loggers pane while the crontask Root Logger is selected. 
         2. In the resulting pane click the Detail Menu icon for the Logger parameter. 
         3. Select VMMSYNC from the Select Value dialog.
        
        
    
    
 4. Click the Select Value button on the Log Level parameter. 
 5. Select DEBUG from the Select Value dialog. 
 6. Save the record. 
 7. Select Apply Settings from the Select Action menu.


Review VMMSYNC debug messages:  1. Wait for at least twice the VMMSYNC cron task instance run schedule. 
 2. Go to the WebSphere Application Server MXServer SystemOut.log.  1. This will usually reside in <WAS_HOME>/AppServer/profiles/ctgAppSrv01/logs/MXServer
    
    
 3. Find messages that look similar to those documented in http://www-01.ibm.com/support/docview.wss?uid=swg21364002 [http://www-01.ibm.com/support/docview.wss?uid=swg21364002] 
 4. Look for "E" suffixed error messages.


Search for users and groups which are not being synchronized within the relevant LDAP repository itself. If the LDAP repository is on a different machine from the WAS server then it is best to run these queries from the WAS server itself. This then tests network connectivity as well as looking inside LDAP.  1. If running WAS on a Linux or Unix machine then the ldapsearch command may be used  1. This command is commonly installed with the base - on Red Hat Enterprise Linux it is part of the openldap-clients package 
     2. Examples of some commonly used commands:  1. Search ldap.dummy.com in the maximousers OU for the user with the email address demo@dummy.comwhere no read level authentication is required:
            ldapsearch -x -h ldap.dummy.com -b ou=maximousers,ou=users,o=dummy.com mail=demo@dummy.com 
         2. Search ldap.dummy.com in the maximogroups OU for the group with the name starting with MAX where no read level authentication is required:
            ldapsearch -x -h ldap.dummy.com -b ou=maximogroups,ou=groups,o=dummy.com cn=MAX* 
         3. Search ldap.dummy.com in the maximousers OU for all person objects with name starting with fred where read level authentication is required and dummyid/dummypasswd is defined in the LDAP repository:
            ldapsearch -x -h ldap.dummy.com -b ou=maximousers,ou=users,o=dummy.com -D dummyid -w dummypasswd '(&(objectClass=person)(cn=fred*))'
            NB: RFC-2254 type filtering is supported by ldapsearch but not in VMMSYNC. See http://www-01.ibm.com/support/docview.wss?uid=swg21364002 [http://www-01.ibm.com/support/docview.wss?uid=swg21364002] for more details.
        
        
    
    
 2. If running WAS on Windows then a LDAP browser must be installed  1. Softerra have a free one available from http://www.ldapbrowser.com/download.htm [http://www.ldapbrowser.com/download.htm].
    
    

 

Cross reference information Segment Product Component Platform Version Edition Systems and Asset Management Tivoli Change and Configuration Management Database Not Applicable AIX, AIX 64bit, HP-UX, Linux, Solaris, Windows 7.1, 7.2 All Editions Systems and Asset Management Maximo Asset Management Cron Task Setup AIX, HP-UX, Linux, Solaris, Windows Version Independent All Editions Systems and Asset Management Maximo Asset Management Essentials Systems and Asset Management Tivoli Asset Management for IT