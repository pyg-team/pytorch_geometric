Title: IBM IV60728: WRT AGENT GETS WRM_DECRYPT_FAILURE WITH INCORRECT PMS SIZE IF SSL VERSION CHANGES DURING HANDSHAKE - United States

Text:
  READMES ARE AVAILABLE
IBM Tivoli Composite Application Manager for Transactions Response Time 7.4 Fix Pack 1 README 7.4.0.0-TIV-CAMRT-FP0001 [http://www-01.ibm.com/support/docview.wss?uid=isg400002231]
IBM Tivoli Composite Application Manager for Transactions Response Time 7.4 Interim Fix 11 README 7.4.0.1-TIV-CAMRT-IF0011 [http://www-01.ibm.com/support/docview.wss?uid=isg400002816]
IBM Tivoli Composite Application Manager for Transactions Response Time 7.3.0.1 Interim Fix 39 README 7.3.0.1-TIV-CAMRT-IF0039 [http://www-01.ibm.com/support/docview.wss?uid=isg400002819]
IBM Tivoli Composite Application Manager for Transactions Response Time 7.3.0.1 Interim Fix 40 README 7.3.0.1-TIV-CAMRT-IF0040 [http://www-01.ibm.com/support/docview.wss?uid=isg400002834]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  In this case, we have seen:
   1) Client Hello
            Content Type: Handshake (22)
            Version: SSL 3.0 (0x0300)
      2) Then server sent back a ServerHello, Certificate, Server
   Hello Done with
            Version:TLS 1.0 (0x0301)
      3) Client then sent a Client Key Exchange using the version
   that the server suggested:
            Version: TLS 1.0 (0x0301)
   The SSL data created internally by WRT is using the first
   version number, which is 0x0300. When it gets to
   ProcessClientKeyExchange_RSA, it attempts to extract the
   premaster secret based on SSL data version (which is from the
   first Client Hello). For TLS 1.0 and later, premaster secret is
   prepended by a 2-byte length of the encrypted secret, whereas
   older SSL 3.0 does not. In this case, it is treating the 2-byte
   length + pms as the pms and attempted to decrypt that ->
   decryption failure.
   
   
    
   
   

LOCAL FIX
 *  N/A
   
   
    
   
   

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED: Potentially affects all users using WRT to
   * decode HTTPS.
   ****************************************************************
   * PROBLEM DESCRIPTION:
   * WRT attempts to decode all SSL messages using the initial
   * version the client specified in the SSL handshake, but the
   * server may choose to change the version. As a result the
   * decoding fails and following error message is logged:
   * Incorrect PMS size. Decryption key may be incorrect.
   ****************************************************************
   * RECOMMENDATION:
   * There is no known workaround.
   ****************************************************************
   
   
    
   
   

PROBLEM CONCLUSION
 *  * WRT will now use the SSL version from the current packet which
   * will handle cases where the server chooses a different SSL
   * version than initially sent in the Client Hello.
   
   The fix for this APAR is contained in the following maintenance
   packages:
               | fix pack | 7.4.0.0-TIV-CAMRT-FP0001
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IV60728
   
   
 * REPORTED COMPONENT NAME
   ITCAM TRANSACT
   
   
 * REPORTED COMPONENT ID
   5724S79WB
   
   
 * REPORTED RELEASE
   740
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt / Xsystem
   
   
 * SUBMITTED DATE
   2014-05-21
   
   
 * CLOSED DATE
   2014-09-12
   
   
 * LAST MODIFIED DATE
   2014-09-12
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   ITCAM TRANSACT
   
   
 * FIXED COMPONENT ID
   5724S79WB
   
   

APPLICABLE COMPONENT LEVELS
 * R740 PSY
   UP