Title: IBM LDAP connection handling on the IBM WebSphere DataPower SOA Appliance - United States

Text:
ldap; ldap-search; ldap-simple-query; ldap-authen; timeout; time out; time; connection; pool; rbm; aaa; crl; datapower TECHNOTE (FAQ)

QUESTION
 How are LDAP connections handled on DataPower? 

ANSWER
When an LDAP connection attempt fails, DataPower does not retry the connection. In the case that DataPower is able to successfully establish a connection and send a request to the LDAP server, prior to the 6.0 firmware release, there is no way to timeout the LDAP connection while DataPower is waiting on a response from the LDAP server. This means that, the LDAP connection(s) will remain open until the LDAP server closes the connection or some network event causes the connection to close. This can therefore lead to increased/high response times or possibly manifest as continuous memory growth issue on DataPower if there is slowness on the network or LDAP server.
What configurations will see this behavior: 

DataPower configurations such as AAA policy, CRL update policy, RBM (when configured to use LDAP) and all LDAP extension functions will experience this behavior. Due to this behavior, plan accordingly to get appropriate timeout values defined on the LDAP server or other levels of the network like on a Load balancer that sits in front of the LDAP server(s).



Starting in the 6.0 firmware, the ability to timeout the LDAP connections have been made available as a new feature called LDAP Connection Pool [http://pic.dhe.ibm.com/infocenter/wsdatap/v6r0m0/topic/com.ibm.dp.xi.doc/ldapconnectionpool.html] and a read timeout parameter that can be used with the LDAP extension functions: ldap-authen() [http://pic.dhe.ibm.com/infocenter/wsdatap/v6r0m0/topic/com.ibm.dp.xi.doc/ldap-authen_cryptographicfunction.html], ldap-search() [http://pic.dhe.ibm.com/infocenter/wsdatap/v6r0m0/topic/com.ibm.dp.xi.doc/ldap-search_cryptographicfunction.html], and ldap-simple-query() [http://pic.dhe.ibm.com/infocenter/wsdatap/v6r0m0/topic/com.ibm.dp.xi.doc/ldap-simple-query_cryptographicfunction.html].