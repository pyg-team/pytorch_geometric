Title: IBM PK92508: WMQ V7 MDBS USING BEAN-MANAGED TXNS OR SETTING THE NOTSUPPORTED TRANSACTION ATTRIBUTE FAIL ON Z/OS WITH THE BINDINGS TRANSPORT - United States

Text:
  FIXES ARE AVAILABLE
6.1.0.31: Java SDK 1.5 SR11 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24026453]
6.1.0.33: Java SDK 1.5 SR12 FP1 Cumulative Fix for WebSphere [http://www-01.ibm.com/support/docview.wss?uid=swg24027786]
6.1.0.35: Java SDK 1.5 SR12 FP2 Cumulative Fix for WebSphere [http://www-01.ibm.com/support/docview.wss?uid=swg24028574]
6.1.0.37: Java SDK 1.5 SR12 FP3 Cumulative Fix for WebSphere [http://www-01.ibm.com/support/docview.wss?uid=swg24029525]
6.1.0.47: WebSphere Application Server V6.1 Fix Pack 47 [http://www-01.ibm.com/support/docview.wss?uid=swg24035508]
6.1.0.39: Java SDK 1.5 SR12 FP4 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24030426]
6.1.0.41: Java SDK 1.5 SR12 FP5 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24031035]
6.1.0.43: Java SDK 1.5 SR13 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24031963]
6.1.0.45: Java SDK 1.5 SR14 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24033270]
6.1.0.47: Java SDK 1.5 SR16 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24035649]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  Messages are erroneously rolled back by message-driven bean
   applications, in WebSphere Application Server Version 6.1 for
   z/OS listener ports using connection factories with a BINDINGS
   transport type connecting to a WebSphere MQ Version 7.0 for
   z/OS queue manager.  The stack of the problem is shown here:
   
   BBOO0221W: WMSG0031E: Exception processing
   JMS Message for MDB QueueReceiver, JMSDestination jms/Q1 :
   javax.ejb.TransactionRolledbackLocalException:  ; nested
   exception is:
   com.ibm.websphere.csi.CSITransactionRolledbackException:
   com.ibm.websphere.csi.CSITransactionRolledbackException:
   com.ibm.ejs.csi.TranStrategy.commit(TranStrategy.java:901)
   com.ibm.ejs.csi.TranStrategy.postInvoke(TranStrategy.java:228)
   com.ibm.ejs.csi.NotSupported.postInvoke(NotSupported.java:133)
   com.ibm.ejs.csi.TransactionControlImpl.postInvoke(TransactionC
   ontrolImpl.java:561)
   
   The problem only affects message-driven bean applications
   deployed using bean-managed transactions or container-managed
   transactions with the NotSupported transaction attribute
   specified on the onMessage method.
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED:  Users of IBM WebSphere Application Server   *
   *                  for z/OS Version 6.1, using WebSphere MQ    *
   *                  for z/OS Version 7.0 as a JMS messaging     *
   *                  provider with message-driven beans (MDBs)   *
   ****************************************************************
   * PROBLEM DESCRIPTION: Messages are incorrectly rolled back    *
   *                      when MDBs using bean-managed            *
   *                      transactions consume from               *
   *                      WebSphere MQ V7.0 queues in BINDINGS    *
   *                      mode on z/OS                            *
   ****************************************************************
   * RECOMMENDATION:                                              *
   ****************************************************************
   Symptoms include messages remaining uncommitted on
   WebSphere MQ queues until the application server is restarted,
   and messages being rolled back onto WebSphere MQ queues even
   though the onMessage method of the message-driven bean
   completed successfully.
   
   This problem affects message-driven bean applications using
   bean-managed transactions, or specifying a transaction
   qualifier of NotSupported on the onMessage method.
   
   The problem is a result of the acknowledgment-mode and
   transaction parameters being interpreted more strictly by the
   WebSphere MQ Version 7.0 JMS client on z/OS in BINDINGS mode,
   than in previous WebSphere MQ versions.
   
   
    
   
   

PROBLEM CONCLUSION
 *  The fix for this APAR resolves the problem by correcting the
   acknowledgment-mode and transaction parameters passed from the
   listener port to the WebSphere MQ JMS client, to be applicable
   to both WebSphere MQ Version 6.0 and WebSphere MQ Version 7.0.
   
   The fix for this APAR is currently targeted for inclusion in
   fix pack 6.1.0.31.  Please refer to the Recommended Updates
   page for delivery information:
   http://www.ibm.com/support/docview.wss?rs=180&uid=swg27004980 [http://www.ibm.com/support/docview.wss?rs=180&uid=swg27004980]
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PK92508
   
   
 * REPORTED COMPONENT NAME
   PLAT MSG COM
   
   
 * REPORTED COMPONENT ID
   620600101
   
   
 * REPORTED RELEASE
   200
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2009-07-28
   
   
 * CLOSED DATE
   2009-10-26
   
   
 * LAST MODIFIED DATE
   2009-10-26
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
    PM06824 [http://www-01.ibm.com/support/docview.wss?uid=swg1PM06824]
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   PLAT MSG COM
   
   
 * FIXED COMPONENT ID
   620600101
   
   

APPLICABLE COMPONENT LEVELS
 * R200 PSY
   UP