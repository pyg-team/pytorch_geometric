Title: IBM JRules decision monitoring and Common Event Infrastructure - United States

Text:
 TECHNOTE (FAQ)

QUESTION
 How to generate Common Event Infrastructure events from the rule executions ? 
How to monitor rule executions with WebSphere Business Monitor ? 

ANSWER
The decision trace captured for JRules Decision Warehouse (DW) can be customized so that Common Event Infrastructure (CEI) events are emitted whenever a ruleset, a task or a rule is executed. Based on the rule execution CEI event format, a business rule monitoring model can be defined with the WebSphere Business Monitor Development Toolkit 7.0 in WebSphere Integration Developer 7.0.
A dashboard can then present the information in Business Space., with graphs such as:

[/support/docview.wss?uid=swg21440000&aid=1] [/support/docview.wss?uid=swg21440000&aid=1]


Instructions to generate CEI events from rule execution events:
jrules-ceitrace.zip [/support/docview.wss?uid=swg21440000&aid=3] [/support/docview.wss?uid=swg21440000&aid=2] 

 1. Unzip the attached sample jrules-ceitrace.zip to a local folder 
 2. Edit the file jrules-ceitrace/build.xml and modify properties to reflect your environment : jrules.home should point to the base folder of your JRules installation and wps.home to WebSphere Process Server ( or corresponding WebSphere Integration Developer test environment ) 
 3. By default this sample generates CEI events without saving the decision trace in DW. If you want to have both DW persistence and CEI events emitted, replace the content of the file jrules-ceitrace/src/dvs-dw.properties with the file jrules-ceitrace/src/dvs-dw-both-dw-and-cei.properties 
 4. From a command line execute : ant build 
 5. Bundle the library jrules-ceitrace/build/jrules-ceitrace.jar with the application executing rules:  * If you are using JRules Hosted Transparent Decision Service (HTDS), in jrules-res-htds-<appserver>.ear/jrules-res-htds-<appserver>.war/WEB-INF/lib 
     * If you are using JRules Scenario Service Provider (SSP) in jrules-ssp-<appserver>.ear/jrules-ssp-server.war/WEB-INF/lib 
     * If you are executing rules from your application, the sample should be packaged alongside the RES session library that your application already bundles 
    
    
 6. On the ruleset(s) that you wish to monitor set the properties:  * monitoring.enabled =true 
     * ruleset.trace.sequential.enabled = true (if you are using sequential rule tasks)
    
    


Instructions to monitor rule CEI events with WebSphere Business Monitor 7: 
wbm-jrules.zip [/support/docview.wss?uid=swg21440000&aid=5] [/support/docview.wss?uid=swg21440000&aid=4]  1. Import the attached sample wbm-jrules.zip in "WebSphere Integration Developer 7 .0 with WebSphere Business Monitor Development Toolkit 7.0" 
 2. Right-click on BusinessRulesMonitoring.mm monitoring model, and select Generate Monitor JEE Projects 
 3. Deploy the generated BusinessRuleMonitoringApplication 
 4. Launch Business Space, create a new page named "Business Rules" and add an "Instances" and a "Dimensions" widget 
 5. Configure the widgets to use "Business Rule Monitoring" as the monitoring model and choose the "Rule MC" monitoring context. Choose to display information such as "Rule Name" and "Execution Date". 
 6. The CEI events generated with the jrules-ceitrace sample above can then be monitored through these widgets in Business Space. A simple setup is presented here: 

wbm-jrules.png [/support/docview.wss?uid=swg21440000&aid=7] [/support/docview.wss?uid=swg21440000&aid=6] 


Notes:  * Because of issue JR35504 an installation of WebSphere Business Monitor v7.0.0.0 should be upgraded to fix pack 2, for more information see: WebSphere Business Monitor V7.0 Fix Pack 2 (7.0.0.2) [http://www-01.ibm.com/support/docview.wss?uid=swg24026057] 
 * The creation of CEI events may require eventCreator credentials, for which either option below can be used :  * the thread invoking ruleset executions (and generating CEI events) is authenticated and has an eventCreator role 
    * the invocation of ruleset executions happens through an EJB ( or a servlet ) with a runAs configuration to grant an eventCreator role 
    * through the WebSphere Administration console, allow everyone to create CEI events by going in Service integration > Common Event Infrastructure > Event service > Security role to user/group mapping then select eventCreator role and map special subject Everyone 
   
   

,  


Cross reference information Segment Product Component Platform Version Edition Business Integration IBM Operational Decision Manager Platform Independent 8.6, 8.5, 8.0, 7.5