Title: IBM PM54740: WMQ 7.0.1 RECIEVES A CSQX620E CSQXRCTL SYSTEM SSL ERROR. FUNCTION 'GSK_SECURE_SOCKET_MISC' RC=410 - United States

Text:
z/os  A FIX IS AVAILABLE
Obtain the fix for this APAR.


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  The customer experienced a CSQX620E CSQXRCTL System
   SSL error message.
   .
   CSQX620E +cpf CSQXRCTL System SSL error,
    channel DQMSSL.CSQF.TO.MQGP,
    connection MQxxx (xxx.xxx.xxx.xxx)
    function 'gsk_secure_socket_misc' RC=410
   CSQX599E +cpf CSQXRCTL Channel DQMSSL.CSQF.TO.MQGP
   ended abnormally
   IEA041I SDUMP SCHEDULED FOR REMOTE SLIP TRAP ID=GSK2
   FROM SYSTEM XX
   .
   The "410 -  means SSL message format is incorrect"
   .
   From the dump, you can see that the channel is
   sending an SSL handshake flow to the partner system,
   and receives a response which is 0x45 bytes long.
   .
   SSL reads the first 5 bytes of the flow (to determine
   the flow type and data length), and then requests
   the subsequent 0x40 bytes to complete the handshake.
   .
   The internal buffering code detects that the
   fResetComplete flag has been enabled and so it does
   not return the remainder of the buffer to SSL
   (but keeps it buffered) and the handshake is not
   completed.
   SSL interprets the lack of data as a socket-closed
   error and returns RC 420.
   .
   This socket-closed is then interpreted as an
   end-of-key-reset, and the  channel carries on sending
   data to the partner.
   .
   After the next batch of messages is sent, and the
   channel issues a recv, anticipating a response to
   the recently sent confirm flow.
   Instead because the partial 0x40 bytes of data is
   still buffered, this is given the the SSL read call,
   which examines the first byte, determines that the
   0x1E content-type is invalid, and returns error
   410 (GSK_ERR_BAD_MESSAGE) and the channel is
   terminated as a result.
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED: All users of WebSphere MQ for z/OS Version 7 *
   *                 Release 0 Modification 1.                    *
   ****************************************************************
   * PROBLEM DESCRIPTION: SSL channels may terminate with message *
   *                      CSQX620E System SSL Error.              *
   ****************************************************************
   * RECOMMENDATION:                                              *
   ****************************************************************
   When using the SSL Key reset feature for SSL channels, a
   channel may rarely terminate, issuing message CSQX620E.
   
   This is caused by internal monitoring of the reset sequence
   misinterpreting some encrypted data content as an SSL header.
   
   
    
   
   

PROBLEM CONCLUSION
 *  SSL channel reset processing has been amended so that it
   always checks that it is examining an SSL header, rather
   than the encrypted body, when monitoring for the end of
   an SSL key reset.
   010Y
   AMQCCIHA
   CSQXCCIH
   CSQXGIOC
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PM54740
   
   
 * REPORTED COMPONENT NAME
   WMQ Z/OS V7
   
   
 * REPORTED COMPONENT ID
   5655R3600
   
   
 * REPORTED RELEASE
   010
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2011-12-20
   
   
 * CLOSED DATE
   2012-02-10
   
   
 * LAST MODIFIED DATE
   2013-12-10
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
    PM57537 [http://www-01.ibm.com/support/docview.wss?uid=swg1PM57537] UK76069
   
   

MODULES/MACROS
 *  AMQCCIHA CSQXCCIH CSQXGIOC
   
   
    
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WMQ Z/OS V7
   
   
 * FIXED COMPONENT ID
   5655R3600
   
   

APPLICABLE COMPONENT LEVELS
 * R010 PSY UK76069 [HTTPS://WWW14.SOFTWARE.IBM.COM/WEBAPP/SET2/ORDERMEDIA/SHOPCART?PTFS=UK76069]
   UP12/02/24 P F202
   
   

FIX IS AVAILABLE
 * SELECT THE PTF APPROPRIATE FOR YOUR COMPONENT LEVEL. YOU WILL BE REQUIRED TO SIGN IN. DISTRIBUTION ON PHYSICAL MEDIA IS NOT AVAILABLE IN ALL COUNTRIES.