Title: IBM BigFix Wake-On-Lan Troubleshooting - United States

Text:
tem; wol; power management; magic packet; BIOS; NIC; beswolmedic.exe; beswolmedic; Wake-On-LAN; SOAP; googlebigfix TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Wake-On-LAN (WOL) does not appear to be working correctly and some of the machines do not wake up from the Powered Off state. 

RESOLVING THE PROBLEM
From BigFix Console perspective check the following: 

==============================
Under the Systems Lifecycle Domain:

- Check to see that there are no warnings identified. 

 

- Check the Setup and Configuration: 

Make sure the results of following analyses have no errors: 

Analyses ID: 45 BigFix Wake-on-LAN Analysis 

Analyses ID: 27 Standby Settings Analysis 

 

- Check which systems are currently applicable to these tasks: 

Task ID: 28 Designate Wake-on-LAN Forwarders: 

If a Subnet does not have an active Wake-on-LAN packet forwarder, TEM will not be able to awaken machines in that Subnet using On-Demand Wake-on-LAN. 

Task ID: 54 Enable Wake-from-Standby by Magic Packet : 

Network adapters can be configured to wake a computer from standby if they receive a Wake-on-LAN Magic Packet. This Fixlet will set all capable network adapters to wake from standby only when a Wake-on-LAN packet is received. 

 

- Make sure WOL is enabled. 

WOL enablement is included in Power Management dashboard. WOL feature is enabled after viewing the Power Management dashboard the first time. 

 

- Make sure there are Last Man Standing computers in the same Subnet : 

When a computer is designated to be a "Last Man Standing" computer, its power profile is set to never enter the system Standby, Hibernate, or hard-disk power management modes, and the computer is excluded from TEM BigFix Power Management actions that would turn the computer off. Designating at least one computer in each Subnet to be a "Last Man Standing" computer increases the likelihood that a wake-up point will be available in each Subnet to power on other computers.  * 


- After enabling WOL, make sure the “built in” WOL works.Right click the computer in the console and send a WOL command. If the “right click” method does not work, schedule WOL will not work too. 


- Make sure BES Server Plugin works well. 
 * 
 * 
 * http://www-304.ibm.com/support/docview.wss?uid=swg21506199
 * 
 * 
 * 
 * 
 * 
 * 

Note: 

The WOLMedic utility runs every five minutes. 
You can configure this if needed. If the interval is too long, for example 1 hour then this means that if the computer is scheduled to be woken up at 9:00 AM, it may get woken up at 10 AM. If the interval is too short, for example 10 seconds, depending on the size of your deployment, 10 seconds may not be enough to process the entire request. If you want, you can take a look at the log and calculate exactly how long it takes to run this command and adjust your interval according. In most cases, default value is the best value. 

[/support/docview.wss?uid=swg21596591&aid=1] [/support/docview.wss?uid=swg21596591&aid=1] 
Run the WOL Medic manually: 

1. Open cmd prompt with local administrator privileges.
2. Run the sample command. You have to substitute the actual information here: 
"C:\Program Files (x86)\BigFix Enterprise\BES Server\Applications\BESWoLMedic\BESWoLMedic.exe" -besserver http://TEMBigFixSvr:52311 -webreports http://TEMBigFixSvr/webreports -u TBFMO1 -p TEMbigfix > WOLmanual.txt
a. -besserve specifies the server name in the masthead 
b. -webreport specifies the URL you get when you click "Launch Web report" from the console 
c. -u specifies the user name of the web report user 
d. -p specifies the password of the webreport user 

What do I need to further debug Schedule WOL?

1. Take a screenshot of the “Schedule Wake-On-LAN” wizard
2. Go to C:\Program Files (x86)\BigFix Enterprise\BES Server\Applications\Config\ BESWoLMedic.xml. Open it up with a notepad and add –d flag to the command line. The utility will run every 5 minutes and get the log. 

 * 
 * <Command>"C:\Program Files (x86)\BigFix Enterprise\BES Server\Applications\BESWoLMedic\BESWoLMedic.exe" -besserver %BESHTTP% -webreports %WRHTTP% -u %SOAPUSERNAME% -p %SOAPPASSWORD%</Command> 

 * 
 * <Command>"C:\Program Files (x86)\BigFix Enterprise\BES Server\Applications\BESWoLMedic\BESWoLMedic.exe" -besserver %BESHTTP% -webreports %WRHTTP% -u %SOAPUSERNAME% -p %SOAPPASSWORD% -d </Command> 


Remember to remove the –d from the config file after the issues is resolved. 



From a hardware/system perspective: 
============================== 
Try running a Wireshark capture ( http://www.wireshark.org/ [http://www.wireshark.org/]) on one of the endpoints you are trying to wake up (it will need to be powered on to do this) and check to see if it receives the magic packet. This is what one will look like http://wiki.wireshark.org/WakeOnLAN [http://wiki.wireshark.org/WakeOnLAN]. 

You can confirm that the WOL forwarding machine sent the magic packet by running Wireshark and capturing outgoing traffic. 

On the endpoint machine, Wake On LAN needs to be enabled in a few places in order to work properly. Most PCs these days have an integrated Ethernet NIC. 

To set it up for WOL, do the following: 

1. Open your computer's BIOS settings. This may be accessed by pressing delete or one of the function keys during the POST boot up, please check your computers manufacture instructions for further assistance. 

2. Look for a setting that relates to enabling WOL. For example, there is a setting for "Remote Wake Up." Enable WOL here. This will allow the computer to be turned on from the "Off" state. 

3. Save your settings and exit the BIOS setup. 

4. Allow Windows to boot. 

5. Open the Control Panel. 

6. Open Network Connections 

7. Open your NIC's properties. 

8. Click the Configure button. 

9. Click the Advanced tab. 

10. Look for Wake On LAN in the properties list. This may not be listed explicitly as WOL. Set it to wake from "Magic Packet" if available. 

11. Click the Power Management tab. 

12. Check the boxes for "Allow the computer to turn off this device to save power" and "Allow this device to bring the computer out of standby." This will allow WOL to turn the computer on from a suspended or hibernated state. 

13. Click OK.