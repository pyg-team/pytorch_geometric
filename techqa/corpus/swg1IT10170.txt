Title: IBM IT10170: JMS PUBSUB MESSAGE SELECTOR LOST AFTER MULTI-INSTANCE QUEUE MANAGER FAILOVER - United States

Text:
 SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  After a multi-instance queue manager failover, an IBM MQ v8
   classes for JMS application using the Automatic Client Reconnect
   feature stops honouring the configured message selection string
   when consuming messages from a Topic destination.
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  ****************************************************************
   USERS AFFECTED:
   This issue affects all users of the:
   
     - WebSphere MQ v7.1 classes for JMS
     - WebSphere MQ v7.1 classes for Java
   
     - WebSphere MQ v7.5 classes for JMS
     - WebSphere MQ v7.5 classes for Java
   
     - IBM MQ v8 classes for JMS
     - IBM MQ v8 classes for Java
   
   who use a message selection string when consuming messages from
   a Topic destination with an application configured to use the
   Automatic Client Reconnect function.
   
   
   Platforms affected:
   MultiPlatform
   
   ****************************************************************
   PROBLEM DESCRIPTION:
   As an example, an IBM MQ classes for JMS application can specify
   a message selector when creating a MessageConsumer such that
   only messages matching the selection String are consumed by the
   application. Such a MessageConsumer can be created, for example,
   using a call to:
   
     javax.jms.Session.createConsumer(Destination, String, boolean)
   
   where the second parameter is the message selection expression.
   
   If an IBM MQ classes for JMS application consumed messages from
   a Topic destination using a message selector and the Automatic
   Client Reconnect function was invoked, for example because a
   multi-instance queue manager failed over or the queue manager to
   which it was connected to was stopped using the "endmqm -r"
   command, then the IBM MQ classes for JMS would attempt to
   reestablish connectivity to other queue managers it has been
   configured with (via a Client Channel Definition Table, CCDT, or
   the JMS Connection Factory property CONNECTIONNAMELIST). After
   the connection was reestablished, the message selector
   originally used to create the MessageConsumer would no longer be
   honoured. As a result, any messages that were published to the
   Topic destination would then be consumed by the application,
   including those not matching the specified selection expression.
   
   The same issue existed when consuming message from a Topic
   destination using the classes for Java API.
   
   
    
   
   

PROBLEM CONCLUSION
 *  The WebSphere MQ classes for JMS, WebSphere MQ classes for Java,
   IBM MQ classes for JMS and IBM MQ classes for Java have been
   updated such that, for Topic destinations, subscriptions created
   after Automatic Client Reconnection occurs matches that of the
   initial subscription with regard to message selectors, thereby
   ensuring that the application continues to receive only messages
   which match the selector specified.
   
   See APAR IV33459 [http://www-01.ibm.com/support/docview.wss?uid=swg1IV33459] for the equivalent change in MQ 7.0.1
   
   ---------------------------------------------------------------
   The fix is targeted for delivery in the following PTFs:
   
   Version    Maintenance Level
   v7.1       7.1.0.8
   v7.5       7.5.0.6
   v8.0       8.0.0.4
   
   The latest available maintenance can be obtained from
   'WebSphere MQ Recommended Fixes'
   http://www-1.ibm.com/support/docview.wss?rs=171&uid=swg27006037 [http://www-1.ibm.com/support/docview.wss?rs=171&uid=swg27006037]
   
   If the maintenance level is not yet available information on
   its planned availability can be found in 'WebSphere MQ
   Planned Maintenance Release Dates'
   http://www-1.ibm.com/support/docview.wss?rs=171&uid=swg27006309 [http://www-1.ibm.com/support/docview.wss?rs=171&uid=swg27006309]
   ---------------------------------------------------------------
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IT10170
   
   
 * REPORTED COMPONENT NAME
   WMQ BASE MULTIP
   
   
 * REPORTED COMPONENT ID
   5724H7251
   
   
 * REPORTED RELEASE
   800
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt / Xsystem
   
   
 * SUBMITTED DATE
   2015-07-17
   
   
 * CLOSED DATE
   2015-08-25
   
   
 * LAST MODIFIED DATE
   2015-12-07
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WMQ BASE MULTIP
   
   
 * FIXED COMPONENT ID
   5724H7251
   
   

APPLICABLE COMPONENT LEVELS
 * R800 PSY
   UP