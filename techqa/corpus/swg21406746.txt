Title: IBM **Troubleshooting** 'OutOfMemoryException' errors when running Excel link (XLS) reports - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 User opens Excel spreadsheet (.XLS file). User clicks 'Controller - Logon', and logs onto the Controller database. User clicks F9 on the keyboard (or clicks 'Controller - Reports - Refresh'). An error message appears. 

SYMPTOM
There are several potential error messages which contain the phrase 'OutOfMemoryException'. Below is one of the possible errors that you may see: 

 

 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * Exception of type 'System.OutOfMemoryException' was thrown.


CAUSE
There are many potential causes for 'OutOfMemoryException' errors. For example: 

Scenario #1 - Memory leak in old versions (8.2/8.3) of Controller. For example:  * Code production problems in Controller 8.3.x, reference# 513876 & 59959  * see separate IBM Technote #1347553 for full details
   
   
 * Code production problem (ref#588487) in Controller 8.3 RTM and earlier - see separate IBM Technote #1365104 for more details 
 * Code production problem ref#584704 in Controller 8.3.x and earlier. - see separate IBM Technote #1365168 for full details

Scenario #2 - Excel report is too complex for the version of Excel that it is being run on. For example, it has run out of memory buffers Scenario #3 - Excel link is not optimally designed, so it is performing an unnecessarily large amount of calculations Scenario #4 - Excel link report is larger / more-complex than Controller is fundamentally designed to cope with.  * For example, it may contain an extraordinarily large (for example 300,000+) number of fGetVal formulae

Scenario #5 - Microsoft bug in their Excel 2007 product Scenario #6 - Excel report is very complex, but the report has not been configured to take advantage of Enhanced Reporting Optimisation (ERO - also known as "Optimise2") Scenario #7 - Default memory allocation settings of Microsoft's SQL Server product Scenario #8 - The report requires BULKCOMPRESS to be enabled Scenario #9 - Code production problem (APAR 62878) in Controller 10.1.1306 and earlier. Scenario #10 - Code production problem (APAR PM84020) in Controller 10.1.1308 to 10.1.2163 (inclusive) Scenario #11 - Code production problem (APAR PM74241) in Controller 10.1.1308 to 10.2.713 (inclusive). RESOLVING THE PROBLEM
Fix: 

 * Scenario #1 - Upgrade to Controller 10.1.2659 or later  * For more information, see separate IBM Technotes such as #1347915 & 1588281.
   
   
 * Scenario #2 - Upgrade to a later version of Microsoft Office (typically MS Office 2003 or Office 2007)  * For more information, see separate IBM Technote #1347205
   
   
 * Scenario #3 - Redesign your Excel spreadsheet, so that the memory usage is optimised  * For more information, see separate IBM Technotes #1347497
   
   
 * Scenario #4 - Simplify your Excel spreadsheet  * For more information, see separate internal IBM Technote #1403278.
   
   
 * Scenario #5 - If using Excel 2007, then ensure that you have upgraded to the recommended Microsoft Office patch level  * For more information, see separate IBM Technote #1433301
   
   

 * Scenario #6 - Enable ERO ("Optimise2") inside the 'bad' spreadsheet/report.  * For more information, see separate IBM Technote #1498830 (and 1347048)
   
   
 * Scenario #7 - Reduce the value of the setting "Maximum server memory (in MB)" on the SQL server so that the SQL Service uses less RAM.  * For more information, see separate IBM Technote #1506563.
   
   

 * Scenario #8 - Enable BULKCOMPRESS Server Preference  * For more information, see separate IBM Technote #1588640.
   
   

 * Scenario #9 - Upgrade to Controller 10.1.1308 or later.  * For more information, see separate IBM Technote #1588281.
   
   
 * Scenario #10 - Upgrade to Controller 10.1.2659 or later.  * For more information, see separate IBM Technote #1619285.
   
   
 * Scenario #11 - Upgrade to Controller 10.2.2021 or later.  * For more information, see separate IBM Technote #1610976.
   
   


Workaround: 
In some circumstances, the problem/errors can be solved by using F10 (instead of F9) to run/refresh the spreadsheet  * For more information, see separate IBM Technote #1508826.

RELATED INFORMATION
 1347915 - Error 'CAM-AAA-0027 - The function call to 'C [http://www.ibm.com/support/docview.wss?uid=swg21347915]
1347205 - Standard Error #7: 'Out of Memory.' [http://www.ibm.com/support/docview.wss?uid=swg21347205]
1347497 - Controller 8.x Excel Report Performance Tips [http://www.ibm.com/support/docview.wss?uid=swg21347497]
1347048 - What is Optimise2 (ERO / Enhanced Reporting O [http://www.ibm.com/support/docview.wss?uid=swg21347048]
1347553 - 'Exception of type 'System.OutOfMemoryExcepti [http://www.ibm.com/support/docview.wss?uid=swg21347553]
1365015 - Error 'Not enough memory' when Refreshing (F9 [http://www.ibm.com/support/docview.wss?uid=swg21365015]
1433301 - "OutOfMemoryException: Insufficient memory to [http://www.ibm.com/support/docview.wss?rs=0&uid=swg21433301]
1498830 - "mscorlib ... Exception of type 'System.OutOf [http://www.ibm.com/support/docview.wss?rs=0&uid=swg21498830]
1506563 - "System.OutOfMemoryException" errors when usi [http://www.ibm.com/support/docview.wss?uid=swg21506563]
1508826 - Using F9 or F10 to update/run a Controller Ex [http://www.ibm.com/support/docview.wss?uid=swg21508826]
1588640 - How to reduce "Out Of Memory" errors when usi [http://www.ibm.com/support/docview.wss?uid=swg21588640]
1588281 - "Out of memory / 'System.OutOfMemoryException [http://www.ibm.com/support/docview.wss?uid=swg21588281]
1619285 - Intermittent "Standard error ... -2147467261 [http://www.ibm.com/support/docview.wss?uid=swg21619285]
1610976 - "Out of memory" when repeatedly running (F9) [http://www.ibm.com/support/docview.wss?uid=swg21610976]