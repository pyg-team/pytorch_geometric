Title: IBM NFS z/OS Server ls issue with MVS Datasets mounted via NFS Client (Linux) - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Newly created MVS dataset under NFS-mounted High Level Qualifier
not listed when NFS client issues the ls command. 

SYMPTOM
ls command does not show the newly created dataset under the mounted High Level Qualifier (HLQ) when the dataset is created outside of NFS control, i.e. not created through the NFS mount


CAUSE
Since there is no directory for NFS-mounted MVS datasets, typical UNIX directory attributes must be artificially created by the z/OS NFS Server. The modification time directory attribute for NFS-mounted MVS datasets is always the same; it is not updated when a new dataset is created under the HLQ. Only when the NFS Server attribute timeout occurs is the time altered, allowing the ls command to list the new MVS dataset (the altered time indicates to the NFS Client that a new readdir request should be sent to the NFS Server) . Until then, the NFS client uses its own directory cache. When it does a get attribute for the "directory", the modification time does not change, so the Linux Client never issues a readdir to get the updated list of datasets, preventing the new dataset from being returned in the results.

ENVIRONMENT
z/OS NFS Server, Linux NFS Client, other NFS clients may have the same issue.

DIAGNOSING THE PROBLEM
 1. Linux NFS Client mounted MVS datasets via z/OS NFS Server.


 2. ls or ls -l command issued, shows list of datasets.
3. New dataset is created under the mounted High Level Qualifier name.
4. Repeated ls commands do not show the new dataset for some time.


RESOLVING THE PROBLEM
The attrtimeout attribute on the z/OS NFS Server needs to be changed, the default is 120 seconds. Reduce the attrtimeout value. to between 10 and 30 seconds, You will need to wait this amount of time before the ls command will show the newly created dataset.