Title: IBM Migration of macro FCT to RDO file definition when using forward recovery with CICSVR for VSE - United States

Text:
DFHCSDUP VSE CICSVR/VSE ; CICS VR; forward recovery options ; 564805400 RA0P R410 R110 RB0P R411 R111 5648-054 5648054 568602601 R14X R14V R14W R230 5686-026 5686026 568601101 R1NL 1NL 5686-011 KIXINFO ; kixdcfcic411 retention111 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 You are upgrading from CICS/VSE V2.3 to CICS Transaction Server for VSE/ESA (CICS TS) V1.1.1, and migrating your macro file control table (FCT) definitions to resource definition online (RDO). You are also using CICS VSAM Recovery for VSE (CICSVR). You would like to know what you should specify for JOURNAL, RECOVER, FWDRECOVLOG, and the other JNL options. 

SYMPTOM
You defined files in the Macro FCT to use forward recovery with CICSVR for VSE. The Recovery and Restart Guide under Defining File, indicates RECOVERY(ALL) and FWDRECOVLOG(number) are needed for forward recovery. Since CICS VSAM Recovery for VSE (CICSVR) does not support automatic journaling and the CICSVR Users Guide and Reference affirms these options, you believe you must set JOURNAL to NO.

The files are defined in the MACRO FCT to be used with FORWARD RECOVERY with CICSVR for VSE. 
Macro definitions are: 

FILE01 DFHFCT TYPE=DATASET,
DATASET=FILE01,
STRNO=2,
ACCMETH=(VSAM),
RSL=PUBLIC,
LSRPOOL=3,
LOG=YES,
JID=SYSTEM,
JREQ=(WU,WN),
SERVREQ=(UPDATE,ADD,DELETE,BROWSE)

DFHCSDUP translates the important definitions for FORWARD RECOVERY LOG=YES, JID=SYSTEM and JREQ=(WN,WU to: 
RECOVERY(BACKOUTONLY) , JOURNAL(1) , JNLADD(BEFORE), JNLUPDATE(YES) as the Resource Definition Guide describes under Macro to RDO.

DFHCSDUP has correctly migrated the FCT based on the CICS/VSE V2.3 definitions and created the equivalent of the macro FCT. 

Auto journalling was used in the past for forward recovery. A new option RECOVERY(ALL) was introduced with CICS TS, to combine both logging for backout and forward recovery journalling. Recovery did not exist in the macro FCT, so it will not be set when migrating the FCT.

CAUSE
DFHCSDUP migration of the FCT does not automatically handle the new RECOVER parameter.



RESOLVING THE PROBLEM
When migrating MACRO FCT entries to RDO, you must manually change the RDO definitions. How you change the RDO FILE definition depends on if your are using CICS logging or if you are using automatic journaling. 

 

 * If you are using CICS logging:
   Specify JOURNAL=NO, RECOVER(ALL) and FWDRECOVLOG(n) for CICS logging. (The before records are written to the system log for backout, and after images are written to the journal specified in the FWDRECOVLOG parameter)
   
   
 * If you are using automatic journaling:
   Specify JOURNAL=(value) JNLAdd(ALL). JNLA(ALL) writes before and after records to the Journal(n). Using automatic journaling requires that you use the CICSVR RECOVER command with keyword FORMAT(OLD).


The CICSVR Change Team recommends the new definition using CICS logging JOURNAL=NO, RECOVER(ALL) and FWDRECOVLOG(n). 
RELATED INFORMATION
#File definition [http://publibfi.boulder.ibm.com/cgi-bin/bookmgr/BOOKS/DFHWA407/4.2.4?SHELF=dfhwsh0q&DT=20040413135708]




PRODUCT ALIAS/SYNONYM
 CICS/VSE CICS VSE CICS/TS CICS TS CICS Transaction Server