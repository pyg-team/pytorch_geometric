Title: IBM PI42870: MQRC_CONTEXT_HANDLE_ERROR IS RETURNED WRITING ON DLQ, BUT THERE IS NO EVIDENCE OF THIS ERROR IN THE CICS LOG. - United States

Text:
z/os  A FIX IS AVAILABLE
Obtain the fix for this APAR.


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  Cics acts as webservice provider over MQ transport.
   A client put a message on the receive queue, that is triggered.
   Trigger monitor, then, writes on the INITQ and CPIL is attached
   because it is a SOAP message.
   CPIL  performs a MQGET on the receive queue. In the MQ message
   there is a replyDestination.
   CPIL then, starts CPIQ and it performs a MQPUT1 on the
   replyToQueue.
   But this queue is put-inhibited that cause to be returned:
   DFHPI0114 CPIQ The pipeline MQ transport mechanism failed
   because a call to WebSphere MQ function MQPUT1 returned with
   reason code 2051 MQRC_PUT_INHIBITED) x'803'
   .
   At this point CICS should write the message on Dead Letter
   Queue as described in the CICS manuals.
   .
   CPIQ issues a MQPUT1 on DLQ with PASS_ALL_CONTEXT but it fails
   with MQRC_CONTEXT_HANDLE_ERROR.
   No errors messages are sent for this error.
   
   
    
   
   

LOCAL FIX
 *  n/a
   
   
    
   
   

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED: All CICS users.                              *
   ****************************************************************
   * PROBLEM DESCRIPTION: CICS webservice request using WMQ       *
   *                      transport fails with 2097 on DLQ        *
   *                      when attempting to write to the DLQ.    *
   ****************************************************************
   * RECOMMENDATION:                                              *
   ****************************************************************
   A CICS webservice request using WMQ transport fails because the
   specified reply-to queue is put disabled, (MQRC=2051) meaning
   the reply message cannot be written. The reply message should
   then be placed on the dead letter queue, but this also fails
   with a context handle error (MQRC 2097).
   
   Keyword(s): MQRC_CONTEXT_HANDLE_ERROR MQRC_PUT_INHIBITED
   
   
    
   
   

PROBLEM CONCLUSION
 *  DFHPITQ1 has been altered so that the MQPUT1 which writes
   to the dead letter queue uses the mq_pmo.Option of
   MQPMO_SET_ALL_CONTEXT instead of MQPMO_PASS_ALL_CONTEXT.
   Additionally, the module is also changed so that whenever
   an MQPUT1 fails the failing message is written to the dead
   letter queue immediately.
   
   
    
   
   

TEMPORARY FIX
 *  FIX AVAILABLE BY PTF ONLY
   
   
    
   
   

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PI42870
   
   
 * REPORTED COMPONENT NAME
   CICS TS Z/OS V4
   
   
 * REPORTED COMPONENT ID
   5655S9700
   
   
 * REPORTED RELEASE
   700
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt / Xsystem
   
   
 * SUBMITTED DATE
   2015-06-12
   
   
 * CLOSED DATE
   2016-03-21
   
   
 * LAST MODIFIED DATE
   2016-04-05
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
    PI48932 [http://www-01.ibm.com/support/docview.wss?uid=swg1PI48932] PI56444 [http://www-01.ibm.com/support/docview.wss?uid=swg1PI56444] UI36458
   
   

MODULES/MACROS
 *  DFHPITQ1
   
   
    
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   CICS TS Z/OS V4
   
   
 * FIXED COMPONENT ID
   5655S9700
   
   

APPLICABLE COMPONENT LEVELS
 * R700 PSY UI36458 [HTTPS://WWW14.SOFTWARE.IBM.COM/WEBAPP/SET2/ORDERMEDIA/SHOPCART?PTFS=UI36458]
   UP16/04/01 P F603
   
   

FIX IS AVAILABLE
 * SELECT THE PTF APPROPRIATE FOR YOUR COMPONENT LEVEL. YOU WILL BE REQUIRED TO SIGN IN. DISTRIBUTION ON PHYSICAL MEDIA IS NOT AVAILABLE IN ALL COUNTRIES.