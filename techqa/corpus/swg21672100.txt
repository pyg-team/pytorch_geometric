Title: IBM Security Bulletin: Local escalation of privilege vulnerability in IBM® DB2® (CVE-2014-0907). - United States

Text:
CVE-2014-0907 DB2 elevated privilege SECURITY BULLETIN

SUMMARY
 A vulnerability in IBM DB2 for Linux, Unix and Windows could allow a local user to gain elevated privilege. 

VULNERABILITY DETAILS
CVE ID: CVE-2014-0907 [http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=2014-0907]
DESCRIPTION:
The IBM DB2 products listed below contain a security vulnerability which allows a malicious user to gain root privilege. This vulnerability can only be exploited by users through a local system account login. There are two DB2 components that are vulnerable out of which one does not affect a DB2 Client installation. One of the vulnerable component is Backup and Restore which exists at the DB2 server, only. The other vulnerable component is in DB2 install and exists at both the DB2 client and server.

CVSS:
CVSS Base Score: 6.9
CVSS Temporal Score: See https://exchange.xforce.ibmcloud.com/vulnerabilities/91869 [https://exchange.xforce.ibmcloud.com/vulnerabilities/91869] for the current score
CVSS Environmental Score*: Undefined
CVSS String: (AV:L/AC:M/Au:N/C:C/I:C/A:C)

AFFECTED PRODUCTS AND VERSIONS
The following IBM DB2 and DB2 Connect V9.5, V9.7, V10.1 and V10.5 editions running on AIX, Linux, HP and Solaris are vulnerable. DB2 V9.5 before FP9 is not vulnerable. DB2 running on Windows is not vulnerable.

IBM DB2 Express Edition
IBM DB2 Workgroup Server Edition
IBM DB2 Enterprise Server Edition
IBM DB2 Connect™ Application Server Edition 
IBM DB2 Connect Application Server Advanced Edition 
IBM DB2 Connect Enterprise Edition
IBM DB2 Connect Unlimited Edition for System i® 
IBM DB2 Connect Unlimited Edition for System z®
IBM DB2 Connect Unlimited Advanced Edition for System z
IBM DB2 10.1 pureScale Feature
IBM DB2 10.5 Advanced Enterprise Server Edition
IBM DB2 10.5 Advanced Workgroup Server Edition
IBM DB2 10.5 Developer Edition for Linux, Unix and Windows

The following IBM V9.8 editions running on AIX and Linux:

IBM® DB2® pureScale™ Feature for Enterprise Server Edition


The IBM data server client and driver types are as follows: 

IBM Data Server Driver Package
IBM Data Server Driver for ODBC and CLI 
IBM Data Server Runtime Client
IBM Data Server Client

REMEDIATION/FIXES
The recommended solution is to apply the appropriate fix for this vulnerability. 

FIX:
The fix for this vulnerability for the DB2 server is available for download for DB2 and DB2 Connect release V10.1 FP4 from Fix Central. Releases V9.7 FP9, V10.1 FP3, and V10.5 FP3 has been updated with the fix and are available from Fix Central as V9.7 FP9a, V10.1 FP3a, and V10.5 FP3a, respectively. 

A special build with an interim patch for this issue may be requested for DB2 and DB2 Connect V9.5 FP9 & FP10, V9.7 FP8, V9.8 FP5 and V10.5 FP2. Please contact your service representative to request the special build and reference the APAR number for the release you want. Customers on fixpack levels lower than those listed above should update to a fixed fix pack level.




Release APAR Download URL V9.5 IT00627 [http://www-01.ibm.com/support/docview.wss?uid=swg1IT00627] Please contact technical support. V9.7 FP9a IT00684 [http://www-01.ibm.com/support/docview.wss?uid=swg1IT00684] http://www.ibm.com/support/docview.wss?uid=swg24037559 [http://www.ibm.com/support/docview.wss?uid=swg24037559] V9.8 IT00685 [http://www-01.ibm.com/support/docview.wss?uid=swg1IT00685] Please contact technical support. V10.1 FP3a IT00686 [http://www-01.ibm.com/support/docview.wss?uid=swg1IT00686] http://www.ibm.com/support/docview.wss?uid=swg24037557 [http://www.ibm.com/support/docview.wss?uid=swg24037557] V10.1 FP4 IT00686 [http://www-01.ibm.com/support/docview.wss?uid=swg1IT00686] http://www.ibm.com/support/docview.wss?uid=swg24037466 [http://www.ibm.com/support/docview.wss?uid=swg24037466] V10.5 FP3a IT00687 [http://www-01.ibm.com/support/docview.wss?uid=swg1IT00687] http://www.ibm.com/support/docview.wss?uid=swg24037555 [http://www.ibm.com/support/docview.wss?uid=swg24037555] 
Contact Technical Support: In the United States and Canada dial 1-800-IBM-SERV 
View the support contacts for other countries [http://www.ibm.com/planetwide/] outside of the United States. 
Electronically open a Service Request [http://www.ibm.com/software/data/db2/support/db2_9/probsub.html] with DB2 Technical Support. 

Note: IBM’s statements regarding its plans, directions, and intent are subject to change or withdrawal without notice at IBM’s sole discretion. Information regarding potential future products is intended to outline our general product direction and it should not be relied on in making a purchasing decision. The information mentioned regarding potential future products is not a commitment, promise, or legal obligation to deliver any material, code or functionality. Information about potential future products may not be incorporated into any contract. The development, release, and timing of any future features or functionality described for our products remains at our sole discretion.

WORKAROUNDS AND MITIGATIONS
The following remediation instructions will remove the vulnerability without side-effects. The user executing the commands must be root and the instructions must be repeated for each DB2 instance and in the DB2 install directory. 

The following example will use /home/db2inst1/sqllib as the DB2 instance install directory. You should replace the sample directory with your DB2 instance install directory. Repeat the procedure with the DB2 install directory which is under /opt/ibm/db2/<db2_release_name> or /opt/IBM/db2/<db2_release_name>, depending on the platform. 

 

The following will fix the install component that exists at the DB2 client and server. 


cd /home/db2inst1/sqllib
bin/db2chglibpath -s '\.:' -r '' adm/db2iclean


The following is required if you have enabled "DB2 Advanced Copy Services (ACS)" and does not affect the DB2 client. ACS is vulnerable in DB2 V9.5 and V9.7 but not in V9.8, V10.1 and V10.5. We would recommend you execute the remediation instructions regardless if ACS is enabled for V9.5 and V9.7. You will get the following harmless error if ACS was not enabled: "db2chglibpath: Unable to open (read-mode) file: 'acs/XXXXX': error: 2(No such file or directory)" . 

cd /home/db2inst1/sqllib
bin/db2chglibpath -s '\.\./\.\.' -r '/opt' acs/acscim
bin/db2chglibpath -s '\.\./\.\.' -r '/opt' acs/acsnsan
bin/db2chglibpath -s '\.\./\.\.' -r '/opt' acs/acsnnas 

 

GET NOTIFIED ABOUT FUTURE SECURITY BULLETINS
 Subscribe to My Notifications [ http://www-01.ibm.com/software/support/einfo.html] to be notified of important product support alerts like this. 

REFERENCES
Complete CVSS v2 Guide [http://www.first.org/cvss/v2/guide] 
On-line Calculator v2 [http://nvd.nist.gov/CVSS-v2-Calculator] 

RELATED INFORMATION
IBM Secure Engineering Web Portal [http://www.ibm.com/security/secure-engineering/bulletins.html] 
IBM Product Security Incident Response Blog [http://www.ibm.com/blogs/psirt] 

ACKNOWLEDGEMENT
Tim Brown from Portcullis Computer Security Ltd. 

CHANGE HISTORY
 May 26, 2014: Original version published
June 10, 2014: Correction: V9.1 is not vulnerable.
June 16, 2014: Updated to indicate DB2 Client installs are affected.
June 20, 2014: Updated to indicate workaround needs to be applied to DB2 install directory as well.
June 25, 2014: DB2 V9.5 before FP9 is not vulnerable.
Sept 30, 2014: Client packages have been updated with fix.
October 27, 2014: Updated "Workaround and Migiations" 

*The CVSS Environment Score is customer environment specific and will ultimately impact the Overall CVSS Score. Customers can evaluate the impact of this vulnerability in their environments by accessing the links in the Reference section of this Security Bulletin. 

DISCLAIMER
According to the Forum of Incident Response and Security Teams (FIRST), the Common Vulnerability Scoring System (CVSS) is an "industry open standard designed to convey vulnerability severity and help to determine urgency and priority of response." IBM PROVIDES THE CVSS SCORES "AS IS" WITHOUT WARRANTY OF ANY KIND, INCLUDING THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. CUSTOMERS ARE RESPONSIBLE FOR ASSESSING THE IMPACT OF ANY ACTUAL OR POTENTIAL SECURITY VULNERABILITY. 





Cross reference information Segment Product Component Platform Version Edition Information Management DB2 Connect AIX, HP-UX, Linux, Solaris 9.7, 9.5, 10.1, 10.5 Application Server, Enterprise Server, Personal, Unlimited for System i, Unlimited for System z