Title: IBM The reason for configuring 'Alternate server hostname' on DB2 HADR server - United States

Text:
 TECHNOTE (FAQ)

QUESTION
 Why do we need to configure 'Alternate server hostname' on DB2 HADR server in addition to JDBC properties configuration on DB2 client side ? 

ANSWER
After HADR takeover is done for a database, 
if the following error happens on DB2 JDBC client side, 
it's necessary to check both DB2 server side and JDBC client side configuration.

"java.sql.SQLException: DB2 SQL Error: SQLCODE=-1776, SQLSTATE= ,
SQLERRMC=1,....."

This error means DB2 client still tries to connect to new HADR standby server(Old Primary) 
without rerouting to new HADR primary server.

In an HADR setup, the alternateServer configuration at the WebSphere Application Server level is needed 
so that JDBC driver knows where to go in case the very first connection to the primary DB2 server fails.

Following properties are two main parameter to set in JDBC client side.

clientRerouteAlternateServerName
clientRerouteAlternatePortNumber

But once connection to a primary DB2 server succeeds, the driver expects to receive information 
about the Alternate Server from the primary server. 
In a properly configured HADR, DB2 servers (both primary and alternate) send down information 
about their alternates to the driver. 

If a database does not send down it's alternate server information,
the driver assumes that HADR is not enabled for this database and therefore it does not reroute the connection on -1776 message.

To solve this problem, use the "UPDATE ALTERNATE SERVER FOR DATABASE.." to update the alternate server information for the target database.

db2 update alternate server for database <dbname> using hostname <hostname or IP addreas> port <port number>

The change can be verified by the following command.

db2 list db directory



RELATED INFORMATION
 Configuring WebSphere JDBC Data Sources for DB2 HADR [http://www-01.ibm.com/support/docview.wss?uid=swg21665033]


 


Cross reference information Segment Product Component Platform Version Edition Information Management DB2 for Linux- UNIX and Windows