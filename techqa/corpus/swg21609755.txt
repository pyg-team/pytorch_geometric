Title: IBM Upgrading Jazz Team Server to v4.0 fails during -addTables command - United States

Text:
CRJAZ0683I An error occurred during the post-import handler for the "com.ibm.team.repository" namespace; CRJAZ0683I An error occurred during the post-import handler for the "com; ibm; team; repository" namespace; CRJAZ0683I TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Upgrading IBM Jazz Team Server 3.0.1 to 4.0 fails while trying to add tables when upgrading IBM Rational Team Concert. 

SYMPTOM
 

The following error is seen: 
2012-07-14 23:47:53,629 CRJAZ0683I An error occurred during the post-import handler for the "com.ibm.team.repository" namespace.
com.ibm.team.repository.common.InternalRepositoryException: Deferred operation failed
...
Caused by: com.ibm.team.repository.common.TeamRepositoryException: Unknown origin
at com.ibm.team.repository.service.internal.RdbRepositoryDataMediator.wrapWithOrigin(RdbRepositoryDataMediator.java:1700)
at com.ibm.team.repository.service.internal.RdbRepositoryDataMediator.preCommitNotify(RdbRepositoryDataMediator.java:1660)
... 73 more
Caused by: com.ibm.team.repository.common.InternalRepositoryException: CRJAZ0329I SQL statement execution failedSyntax error or access rule violation
SQL: Insert Into {REPOSITORY.CONTEXT_SUBCONTEXTS} ({CONTEXT_UUID}, {SUBCONTEXT_UUID}, {OWNING_CONTEXT_UUID}, {REVISION_NUMBER}) select ?, ?, ?, ? from sysibm.sysdummy1 where not exists (select * from {REPOSITORY.CONTEXT_SUBCONTEXTS} where {CONTEXT_UUID}=? and {SUBCONTEXT_UUID}=? and {OWNING_CONTEXT_UUID}=?)
SQL Exception #1
SQL Message: DB2 SQL Error: SQLCODE=-418, SQLSTATE=42610, SQLERRMC=null, DRIVER=3.57.82
SQL State: 42610
Error Code: -418
SQL Exception #2
SQL Message: DB2 SQL Error: SQLCODE=-727, SQLSTATE=56098, SQLERRMC=2;-418;42610;, DRIVER=3.57.82
SQL State: 56098
Error Code: -727
Exception Details: Vendor specific exception
SQL Exception #3
SQL Message: DB2 SQL Error: SQLCODE=-727, SQLSTATE=56098, SQLERRMC=2;-418;42610;, DRIVER=3.57.82
SQL State: 56098
Error Code: -727
Exception Details: Vendor specific exception
Class: com.ibm.team.repository.service.internal.db.util.SubContextTableCreateRootRowInserter

CAUSE
This fails on IBM DB2 9.5 because 9.5 has stricter rules about untyped parameter markers. DB2 9.7 improved the logic to deal with these parameter markers. Refer to the following topic for further information: 

http://pic.dhe.ibm.com/infocenter/db2luw/v9r7/topic/com.ibm.db2.luw.wn.doc/doc/c0053519.html [http://pic.dhe.ibm.com/infocenter/db2luw/v9r7/topic/com.ibm.db2.luw.wn.doc/doc/c0053519.html]


ENVIRONMENT
IBM Rational Team Concert (RTC) 3.0.1 (upgrading to 4.0) 

DB2
Linux x86 64 version 9055
Microsoft Windows Server 2008 R2


RESOLVING THE PROBLEM
If you see this error during the addTables command, you need to upgrade DB2 to a supported level. DB2 9.5 is not supported in CLM 4.0. 


Refer to the IBM Collaborative Lifecycle Management (CLM) 2012 System Requirements: https://jazz.net/library/article/811/ [https://jazz.net/library/article/811/]



Leverage the Jazz Community Jazz and Rational Team Concert have an active community that can provide you with additional resources. Browse and contribute to the User forums, contribute to the Team Blog and review the Team wiki.
Refer to technote 1319600 [http://ibm.com/support/docview.wss?uid=swg21319600] for details and links.