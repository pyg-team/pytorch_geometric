Title: IBM While attempting to upgrade Portal 7.0.0.2 to CF29 you receive the following wasadmin error, "One or more files is write protected or locked" - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM
While attempting to upgrade Portal 7.0.0.2 to CF29 it fails and you see the following...

[wsadmin]
org.eclipse.jst.j2ee.commonarchivecore.internal.exception.SaveFailureExc
eption: Cannot write to file:
/tmp/VirtualPortal.zip4374324232943413816.tmp
[wsadmin] One or more files is write protected or locked:
[wsadmin] /tmp/VirtualPortal.zip4374324232943413816.tmp

SYMPTOM
The ConfigTrace.log shows the following...
Target started: action-export-vp-asset

action-export-vp-asset:
[wsadmin] *sys-package-mgr*: processing new jar,
'/webhost/WAS7/opt/WebSphere/v700-64/lib/startup.jar'
[wsadmin] *sys-package-mgr*: processing new jar,
'/webhost/WAS7/opt/WebSphere/v700-64/lib/bootstrap.jar'
[wsadmin] *sys-package-mgr*: processing new jar,
'/webhost/WAS7/opt/WebSphere/v700-64/lib/lmproxy.jar'

....


[wsadmin] *sys-package-mgr*: processing new jar,
'/webhost/WAS7/opt/WebSphere/v700-64/deploytool/itp/plugins/com.ibm.etoo
ls.ejbdeploy/runtime/batch.jar'
[wsadmin] *sys-package-mgr*: processing new jar,
'/webhost/WAS7/opt/WebSphere/v700-64/deploytool/itp/plugins/com.ibm.etoo
ls.ejbdeploy/runtime/ejbdeploy.jar'
[wsadmin] *sys-package-mgr*: processing new jar,
'/webhost/WAS7/opt/WebSphere/v700-64/deploytool/itp/plugins/com.ibm.etoo
ls.ejbdeploy/runtime/ejbmapvalidate.jar'
[wsadmin] WASX7209I: Connected to process "dmgr" on node Dmgr
using SOAP connector; The type of process is: DeploymentManager
[wsadmin] WASX7303I: The following options are passed to the
scripting environment and are available as arguments that are stored in
the argv variable: "[VirtualPortal.zip,
/ucbpreg1/WPS7/wps/70/Portal/profiles/Node/ConfigEngine
/config/work/VirtualPortal.zip]"
[wsadmin] WASX7017E: Exception received while running file
"/ucbpreg1/WPS7/wps/70/Portal/binaries/PortalServer/installer/wp.oob.ba
sic/config/jython/vp_export_asset.jython"; exception information:
com.ibm.wsspi.management.bla.op.OpExecutionException: Exception saving
asset during exportAsset:
com.ibm.wsspi.management.bla.framework.DeployContentException:
org.eclipse.jst.j2ee.commonarchivecore.internal.exception.SaveFailureExc
eption: Cannot write to file:
/tmp/VirtualPortal.zip4374324232943413816.tmp
[wsadmin] One or more files is write protected or locked:
[wsadmin] /tmp/VirtualPortal.zip4374324232943413816.tmp

[wsadmin]
com.ibm.wsspi.management.bla.framework.DeployContentException:
org.eclipse.jst.j2ee.commonarchivecore.internal.exception.SaveFailureExc
eption: Cannot write to file:
/tmp/VirtualPortal.zip4374324232943413816.tmp
[wsadmin] One or more files is write protected or locked:
[wsadmin] /tmp/VirtualPortal.zip4374324232943413816.tmp

[wsadmin]
org.eclipse.jst.j2ee.commonarchivecore.internal.exception.SaveFailureExc
eption: Cannot write to file:
/tmp/VirtualPortal.zip4374324232943413816.tmp
[wsadmin] One or more files is write protected or locked:
[wsadmin] /tmp/VirtualPortal.zip4374324232943413816.tmp


Target finished: action-export-vp-asset
Target finished: action-fixup7001-vp-asset
Target finished: invoke-server-action
Target finished: CONFIG-WP-PTF-CF


CAUSE
In this case, the problem occurred because the Deployment Manager, the Portal Server, and the Portal update installer were running as different OS users. This was causing a permissions issue during the upgrade.


ENVIRONMENT
Portal 7.0.0.2 

AIX


RESOLVING THE PROBLEM
Start the Deployment Manager and Portal Server as root. Run the Portal Update Installer as root and then re-attempt the upgrade.