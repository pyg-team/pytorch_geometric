Title: IBM Command syntax runs from a window, but not from Production Mode or INCLUDE. - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 I have an open syntax window, and the command syntax in it runs just fine (For example, I've pasted an ODBC database capture). I would like to re-use that syntax. I have saved it to an .SPS file, but when I try to use it in Production Mode, I get error messages. The same thing happens if I use "INCLUDE" to run it from within another command syntax job. How can I get the file to run? 

RESOLVING THE PROBLEM
Command syntax in a batch job (in an INCLUDE file, or run with Production Mode) is interpreted with rules which are different, and much stricter, than the rules for interpreting syntax run interactively (in a command syntax window). 

Syntax rules for production Facility:
- Each command must begin in the first column of a new line
- Continuation lines much be indented by at least 1 space
- The period at the end of the command is optional

These rules are found on page 501 of the Version 11 SPSS Users guide

ODBC captures in particular are difficult to edit so that they will run in batch. 

Rather than try to edit the file extensively, you can use a SCRIPT command in your batch job to open the file in a command syntax window, run the window invisibly, and then proceed with the batch.

Suppose that in your batch job, you were trying to use the following line:

INCLUDE "c:\program files\spss\capture1.sps" .

Please note the details differ somewhat depending on which version of SPSS for Windows you 
are using.

In SPSS for Windows 7.5, you may need to use a different script for each capture.

Open a new Script window (Cancel when SPSS asks you to open a Starter
Script). The Script window will open with a blank Sub Main ... End 
Sub. Modify it so it looks like this:

Sub Main
'Edit the following to the complete path and filename 
'of the syntax file to be included: 
With objSpssApp.OpenSyntaxDoc ("c:\program files\spss\capture1.sps")
.Run
.Close
End With
End Sub

When the script looks as above (but with the correct path to your 
file) save it, let's say as

"c:\program files\spss\scripts\capture1.sbs"

Then change the INCLUDE command in your syntax file to:

SCRIPT "c:\program files\spss\scripts\capture1.sbs" .

Your batch job should now run as intended.

RELATED INFORMATION
 Need more help? Our Statistics forum is Live! [https://developer.ibm.com/answers/topics/statistics.html?smartspace=predictive-analytics]


 

HISTORICAL NUMBER
 17358