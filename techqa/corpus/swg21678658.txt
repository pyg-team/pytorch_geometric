Title: IBM Generate a Core File and Extract Stacktrace for TM1 Server Crash on AIX - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 This Technote explains how to configure AIX to generate a core file during a TM1 Server crash and extract stack trace information from that core file. The stack trace informatiom must be extracted on the same AIX system where the TM1 Server crash happened. 

Both the core file and stack trace information may be required by IBM Support to determine the root cause of a TM1 Server crash on AIX. 

ENVIRONMENT
AIX

RESOLVING THE PROBLEM
To generate a core file during a TM1 Server crash 

 * To ensure that a core files is created whenever the tm1s.exe process crashes use the AIX ulimits may need to be adjusted to allow larger core files. 
   
   To examine all current ulimits settings. 
    * ulimit â€“a
    * 
   
   
   The following command can be used to set the maximum corefile size and maximum file set to unlimited. 
    * ulimit -c unlimited 
    * 
    * ulimit -f unlimited 
   
   
   If core files are not generated during after setting the ulimits you may also need to use 
   chcore and lscore commands to set or view core compression, path, location, and naming options for core files. 
   
   Review the /etc/security/limits file and change limits to -1 for 'core' and 'filesize'. 
   
   You can also use the smitty chgsys to enable full cores 
   
   
   
   Extracting the stack trace after the core has been generated 
   
   Run the attached dbxtrace_aix.sh script along with these instructions. 
   
   1 - Create a directory to store diagnostic files 
    * mkdir /home/user/diagnostic
    * 
    * cd /home/user/diagnostic
   
   
   2 - Locate the core dump by executing the following command. 
    * errpt -a | more
   
   
   Find the entry with the correct Date/Time, and look for the core file name. 
   
   3 - Generate a checksum for the core file from the first crash. 
   
   sum /opt/ibm/cognos/tm1/bin64/core.12345 | tee core-2017-01-01.sum.txt 
   
   4 - Copy the core to the diagnostic directory. Make sure to change the name so that there's no chance the core can be overwritten by another crashing program. 
    * cp /opt/ibm/cognos/tm1/bin64/core.12345 /home/user/diagnostic/core-2011-01-31
   
   
   5 - Validate that the core file is a valid core file 
    * dbx /opt/ibm/cognos/tm1/bin64/tm1s.exe /home/user/diagnostic/core-2011-01-31
   
   
   You should not see a message saying that the core file is invalid or ignored. Use quit to close dbx. 
    * (dbx) quit
   
   
   6 - Run the attached dbxtrace_aix.sh script. The generated output contains a stacktrace that may be useful to IBM Support even without a full core dump. If a full core dump was requested, then proceed with the next steps. 
    * ksh ./dbxtrace_aix.sh /opt/ibm/cognos/tm1/bin64/tm1s.exe ./core-2011-01-31 | tee threads-2011-01-31.txt
    * 
   
   7 - Use snapcore to collect the core file and system information 
    * snapcore -d ./. ./core-2011-01-31 /opt/ibm/cognos/tm1/bin64/tm1s.exe
    * 
    * 
    * mv snapcore_[pid].pax.Z snapcore_[pid]-2011-01-31.pax.Z
    * 
    * 
    * sum snapcore_[pid]-2011-01-31.pax.Z | tee snapcore_[pid]-2011-01-31.pax.Z.sum.txt
   
   
   
   
   Providing files to IBM Support 
   
   
   To provide the TM1 Server crash core file and extracted stacktrace details to IBM Support please see http://www-01.ibm.com/support/docview.wss?uid=swg21153852 [http://www-01.ibm.com/support/docview.wss?uid=swg21153852] 
   
   

dbxtrace_aix.sh [/support/docview.wss?uid=swg21678658&aid=2]dbxtrace_aix.sh [/support/docview.wss?uid=swg21678658&aid=1]