Title: IBM Db2 Analytics Accelerator for z/OS V7.1.0.1 GA-Refresh: Release Notes - United States

Text:
 RELEASE NOTES

ABSTRACT
 The release notes contain the latest information about IBM Db2 Analytics Accelerator for z/OS V7.1.0.1, GA-Refresh. 

CONTENT
 

 * Lifted restrictions and solved problems
 * Known issues and restrictions




 

LIFTED RESTRICTIONS AND SOLVED PROBLEMS
Lifted restrictions 
 * You can now run more than 30 query threads in parallel.
 * You can now run more than 15 mixed threads in parallel, such as adding tables, loading or reloading tables, removing tables, or retrieving table information.
   Our quality assurance team successfully ran 50 threads with various management operations in parallel.
 * You can now run more than 10 load threads and more than 20 query threads at the same time.
   Our quality assurance team successfully ran mixed workloads of 30 load threads and 60 query threads in parallel. 
 *  There is no longer a risk of failure if many thousand tables are added, loaded, or dropped at the same time. 

 Solved problems


 *  Queries end with error message SQL0727N when submitted while an ALTER TABLE command or when a table load operation is in progress:
   SQL0727N An error occurred during implicit system action type "3". Information returned for the error includes SQLCODE "-204", SQLSTATE "42704" and message tokens "DB2INST1.DBNAME". SQLSTATE=56098 
 *  The removal of an accelerator or the removal of a large set of tables might fail with the following error message:
   AQT10050E An internal error occurred on the accelerator: Lock for object for transaction in mode "SHARED" has not been granted within timeout "1800000" 
 *  After an accelerator restart, a table cannot be removed because the DB2 catalog table SYSACCEL.SYSACCELERATEDTABLES and the accelerator catalog are out of sync with regard to the specified table. 



 

KNOWN ISSUES AND RESTRICTIONS
 

GENERAL RECOMMENDATIONS
 *  Under very high load the accelerator may appear slow or might run into timeouts.  Recommendation
   Do not run more than 30 load threads in parallel. 
   
   

ADDING TABLES
 *  The stored procedure SYSPROC.ACCEL_ADD_TABLES fails with the message:
   DSNT408I SQLCODE = -913, ERROR: UNSUCCESSFUL EXECUTION CAUSED BY DEADLOCK OR TIMEOUT. REASON CODE 00C9008E  Recommendation
   Try to add the tables again. Reduce the size of the table set or the number of operations run in parallel on the accelerator. 
   
   
 *  If the stored procedure SYSPROC.ACCEL_ADD_TABLES is called with a table set containing more than 5000 tables, the accelerator might restart and a core dump is written.  Recommendation
   Reduce the number of tables in the table set. 
   
   

CREATING ACCELERATOR-ONLY TABLES
 *  Creating an accelerator-only table fails with a message indicating that the accelerator-only table is not available.  Recommendation
   Retry the operation. 
   
   

QUERIES
 *  A query runs for hours while the reload of a referenced table is in progress.  Recommendation
   Cancel the query and wait until table statistics have been generated for new or reloaded tables. 
   
   
 *  Queries might not be routed to a newly paired accelerator shortly after the pairing.
   THE STATEMENT CANNOT BE EXECUTED BY DB2 OR IN THE ACCELERATOR (REASON 13). SQLCODE=-4742, SQLSTATE=560D5, DRIVER ...  Recommendation
   Wait 30 seconds after pairing a new subsystem with an accelerator before you route queries to it. 
   
   
 *  Queries do not return results after the following sequence of events:
    * The reload of a table with the option forceFullReload=true
    * The termination of the load process through task cancellation
    * A reload of the same table with the option forceFullReload=false
   
    Recommendation
   Remove the affected table from the accelerator and add it again. 
   
   

LOADING TABLES
 *  If many load requests, that is, calls to the stored procedure SYSPROC.ACCEL_LOAD_TABLES are requested in parallel the stored procedures might hang, and no more Db2 connections are allowed.  The number of additional Db2 connections for the stored procedure is 4 times the value of the AQT_MAX_UNLOAD_IN_PARALLEL environment variable. If this number exceeds the number of available connections in Db2 according to the CTHREADS ZPARM, the SYSPROC.ACCEL_LOAD_TABLES stored procedure will hang and no more Db2 connections are allowed. 
   
   Recommendation
   Set AQT_MAX_UNLOAD_IN_PARALLEL to a lower value, or do not run the stored procedure SYSPROC.ACCEL_LOAD_TABLES in parallel. Consider fewer calls with more tables. 
   
   
 *  The stored procedure SYSPROC.ACCEL_LOAD_TABLES fails with SQLCODE=-430 or SQLCODE=-471 if many stored procedures are running at the same time.  Recommendation
   Reduce the NUMTCB setting for the WLM address space to 30 or less to avoid this situation. 
   
   
 *  A table load fails if the stored procedure SYSPROC.ACCEL_LOAD_TABLES is called repeatedly with 50 or more tables in the table set.
   Error message:
   AQT10050I - An internal error occurred on the '[...]' accelerator: ODBC operation SQLExecDirect failed with code -1 when Executing statement: /* IBM_DWA */ CREATE OR REPLACE VIEW "DWA[...]"."[...]" AS
   SELECT [...] FROM "DWADWBDB12"."OID-ID_15368-V1"
   WHERE "DWA_Partition_ID (hidden)" <= 100000:
   <ODBCDiagnostics>
       <SQLSTATE>40001</SQLSTATE>
       <SQLCODE>-911</SQLCODE>
       <Tokens num="1">
           <Token>68</Token>
       </Tokens>
       <Message>[IBM][CLI Driver][DB2/LINUXX8664] SQL0911N  The current transaction has been rolled back because of a deadlock or timeout.  Reason code "68".  SQLSTATE=40001</Message>
   </ODBCDiagnostics>
   
   
   - or - AQT10071I - The accelerated table "[...]"."[...]" is in 'INITIAL LOAD 
   IN PROGRESS' state, which does not allow the attempted
   operation. Diagnostic information: operation: 'State change to UPDATE IN PROGRESS
   by task of type 2'
   
   
    Recommendation
   Run SYSPROC.ACCEL_LOAD_TABLES once more after a short period of time. If it fails again, remove the table from the accelerator and add it again. 
   
   
 *  The stored procedure SYSPROC.GET_TABLES_INFO fails with the message AQT10200E as in this example:
   AQT10200E - The FETCH operation failed. Error information: "DSNT408I SQLCODE = -183, ERROR: AN ARITHMETIC OPERATION ON A DATE OR TIMESTAMP HAS A RESULT THAT IS NOT WITHIN THE VALID RANGE OF DATES DSNT418I SQLSTATE = 22008 SQLSTATE RETURN CODE DSNT415I SQLERRP = DSNXRDTF SQL PROCEDURE DETECTING ERROR DSNT416I SQLERRD = -795 0 0 -1 0 0 SQL DIAGNOSTIC INFORMATION DSNT416I SQLERRD = X'FFFFFCE5' X'00000000' X'00000000' X'FFFFFFFF' X'00000000' X'00000000' SQL DIAGNOSTIC INFORMATION ". The unsuccessful operation was initiated by the following statement: "SELECT A.NAME, A.CREATOR, A.REMOTENAME, A.REMOTECREATOR, A.ENABLE, A.ARCHIVE, A.SUPPORTLEVEL, B.TYPE, B.ALTEREDTS-CURRENT TIMEZONE, A.ALTEREDTS-CURRENT TIMEZONE,HEX(B.DBID) || HEX(B.OBID), B.VERSION INTO :h :h, :h, :h, :h, :h, :h :h :h :hFROM SYSACCEL.SYSACCELERATEDTABLES A LEFT OUTER JOIN SYSIBM.SYSTABLES B ON A.NAME=B.NAME AND A.CREATOR=B.CREATOR WHERE ACCELERATORNAME = :accelName AND A.NAME = :h AND A.CREATOR = :hFETCH FIRST 1 ROWS ONLY".  Recommendation
   Run the following query:
   SELECT NAME FROM SYSIBM.SYSTABLES WHERE ALTEREDTS='0001-01-01 00:00:00' 
   
   Remove the tables being output of this query by calling the stored procedure SYSPROC.ACCEL_REMOVE_TABLES for them.
   
   
 *  The stored procedure SYSPROC.ACCEL_LOAD_TABLES or SYSPROC.ACCEL_ALTER_TABLES fails with message:
   SQL0289N Unable to allocate new pages in table space.  Recommendation
   Remove the tables that have been altered frequently and add them again after a period of 60 minutes. 
   
   Note: As shown in the description, this problem also occurs if you alter tables. 
   
   

REMOVING TABLES AND ACCELERATORS
 *  A table removal fails with the error message AQT10076W, which indicates that an entry for the table does not exist in the table SYSACCEL.SYSACCELERATEDTABLES, but that the table is none the less present on the accelerator.  Recommendation
   Remove the table by using IBM Db2 Analytics Accelerator Studio or the stored procedure SYSPROC.ACCEL_REMOVE_TABLES. 
   
   

MONITORING
 *  An incorrect table size is shown in IBM Db2 Analytics Accelerator Studio and IFI records. 

TRACING
 *  If an accelerator is restarted during a table load, very large trace files are created. As a consequence, the collection of trace information takes a long time.  Recommendation
   Do not restart an accelerator while the stored procedure SYSPROC.ACCEL_LOAD_TABLES is running. 
   
   

MISCELLANEOUS
 *  Stored procedures threads are not cancelled after closing IBM Db2 Analytics Accelerator Studio.  The -DISPLAY THREAD command on the z/OS console shows active threads although IBM Db2 Analytics Accelerator Studio has been closed. 
   
   
 *  The accelerator server might crash if it is shut down while asynchronous load operations are running. Symptoms: the server is restarted and a core dump is created.  Recommendation
   Do not shut down the server from the Db2 Analytics Accelerator Console as long as asynchronous load operations are running. (Check this with the List tasks function before.) 
   
   

ISSUES SPECIFIC TO IBM DB2 ANALYTICS ACCELERATOR STUDIO
 *  A refresh of the accelerator view takes very long after adding a very high number of tables in a short time.