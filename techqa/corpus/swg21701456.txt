Title: IBM Errors QE-DEF-0285,QE-DEF-0321,RQP-DEF-0068,UDA-SQL-0031 when reports based on DB2 data source are scheduled. - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

THIS DOCUMENT APPLIES ONLY TO THE FOLLOWING LANGUAGE VERSION(S):
 English 

PROBLEM(ABSTRACT)
 When user schedules the reports that are based on DB2 data source, below errors are observed in run history of the scheduled report.

Cognos Errors : QE-DEF-0285,QE-DEF-0321,RQP-DEF-0068,UDA-SQL-0031

DB2 Error : '[IBM][CLI Driver] SQL1224N The database manager is not able to accept new requests, has terminated all requests in progress, or has terminated the specified request because of an error or a forced interrupt. SQLSTATE=55032' 


SYMPTOM
The scheduled reports that are based on the DB2 data source fail to run with below error in run history. 

QE-DEF-0285 The logon failed. QE-DEF-0321 The userID or password is either missing or invalid. RQP-DEF-0068 Unable to connect to at least one database during a multi-database attach to 2 database(s) in: Audit ISAS UDA-SQL-0031 Unable to access the "<db2_alias>" database. Check that the connection parameters to the database are configured correctly. For example, ensure that the data source connection contains the signon information, such as a password, to connect to the database. UDA-SQL-0129 Invalid login information was detected by the underlying database. [IBM][CLI Driver] SQL1224N The database manager is not able to accept new requests, has terminated all requests in progress, or has terminated the specified request because of an error or a forced interrupt. SQLSTATE=55032

Cognos BI and DB2 server are installed on same AIX machine. 

Test data source connection succeeds from IBM Cognos Administration.


CAUSE
TCP/IP loopback was not set on DB2 database. The reason why we require TCP/IP loopback is as explained below:

By default, AIX does not allow 32-bit applications to attach to more than 11 shared memory segments per process, of which a maximum of 10 can be used for local DB2 connections. As Cognos BI and DB2 server are hosted on same AIX machine, Cognos uses DB2 CLI (Call Level Interface) to connect to DB2 data source using shared memory. When shared memory segment limit is exceeded beyond 10, if DB2 CLI tries making a local connection to the database, AIX will report an error. So Cognos server fails to connect to the data source. 


ENVIRONMENT
AIX



DIAGNOSING THE PROBLEM
1. <Cognos Install Dir>/logs/cogserver.log will have the above error message. 

 2. Run below command on db2 to check if there is TCP IP loopback set up on DB2 side . 

 * 
 * 
 * 
 * 
 * 
 * 
 * 
   
 * [/support/docview.wss?uid=swg21701456&amp;aid=1]
 * 
 * 
 * 
 * 
 * Indirect
 * 
 * Remote
 * 

RESOLVING THE PROBLEM
Setup TCP IP loopback connectivity on DB2 Database by following below steps: 


a) db2 uncatalog database <database alias> 
-- Above command is to uncatalog . Alias name should be same as the one which is already catalogged. It can be obtained by executing the command "db2 list db directory". 

b) db2 catalog tcpip node <nodename> remote <hostname/ip> server <portnumber> 
-- remote word is key over here as this parameter specifies that it needs to setup TCP IP loopback. 

Example :- db2 catalog tcpip node cogdb remote test_host server 50000 
-- Node name can be anything 

c) db2 catalog database <dbname> as <alias> at node <nodename> 

Example :- db2 catalog database ReportDB as RptDB at node cogdb 
-- Node name should be exactly the same as what has been mentioned in step(b). 
-- Alias name can be anything. You can specify whatever you would like to have. 
-- dbname should be your database name. 

d) db2 terminate 

Once the above commands are executed on db2, execute below command to check if the TCP IP loopback is set for the database alias specified. 

db2 list db directory 

The value for Directory entry type should now be set to Remote . 

After having the TCP IP loopback set on db2, the reports run fine in all formats.