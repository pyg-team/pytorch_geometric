Title: IBM Error 'Server was unable to process request - Object was open' when using 'Import flat files' - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 User launches 'Transfer - External Data - Import from Flat Files'. User chooses an 'Import Specification'. User browses to the data file, and clicks on the 'import' button. 

User receives error message. 

SYMPTOM
Screen: 

 
Information
Standard Error
Source: ControllerProxyClient
Description: System.Web.Services.Protocols.SoapException: Server was unable to process request. --->
System.Runtime.InteropServices.COMException (0x80040E05): Object was open.
at FrDImportBT.clsExtImportClass.DoImport(String sGuid, String sUser, Boolean bCaseExpVal, Int32 LBatchID,
String sSpecName, String sStructureType, String sPrompts, Int32 ILLocale, Boolean& bError, Int32& IError, String&
sErrorMsg, Recordset rsFileDataAndInfo, Recordset& rsRecon, Recordset& rsLog)
at Cognos.Controller.Proxy.CCRWS.clsExtImport_DoImport(String sGuid, String sUser, Boolean bCaseExpVal,
Int32 iBatchId, String sSpecName, String sStructureType, String sPrompts, Int32 iLLocale, Beelean& bError, Int32&
iError, String& sErrorMsg, DataSet dsFileDataAndInfo, DataSet& dsRecon, DataSet& dsLog)
--- End of inner exception stack trace ---

Event Viewer (Application Log):

Event Type: Warning
Event Source: VBRuntime
Event Category: None
Event ID: 1
Date: 28/11/2007
Time: 09:06:45
User: N/A
Computer: SERVERNAME
Description:
The VB Application identified by the event source logged this Application FrSrvFunc: Thread ID: 532 ,Logged: Error occured at 11/28/2007 10:06:45 AM in FrSrvFunc, Error No=-2147217915, Source=Server function:Dbp_GetSql(..) , Description=Object was open., HelpFile= HelpContext=0 

and:
Description:
The VB Application identified by the event source logged this Application FrSrvFunc: Thread ID: 532 ,Logged: Error occured at 11/28/2007 10:06:45 AM in FrSrvFunc, Error No=-2147217915, Source=Server function:Db_GetSql(..) , Description=Object was open., HelpFile= HelpContext=0

and:
The VB Application identified by the event source logged this Application FrDImportBT: Thread ID: 532 ,Logged: Error occured at 11/28/2007 10:06:45 AM in FrDImportBT, Error No=-2147217915, Source=FrDIImportBT.clsPostProcess.PostEngine, Description=Object was open., HelpFile= HelpContext=0 

and:
The VB Application identified by the event source logged this Application FrDImportBT: Thread ID: 532 ,Logged: Error occured at 11/28/2007 10:06:45 AM in FrDImportBT, Error No=-2147217915, Source=FrDIImportBT.clsPostProcess.PostEngine#clsDIengine.SendDataToPostProcess, Description=Object was open., HelpFile= HelpContext=0


CAUSE
There are several potential causes for this problem: 

 * Scenario #1 - Temporary memory resource problem on Controller application server  * For example, can be caused by known memory leaks in older versions of Controller, such as 8.3.x 
    * This scenario is most likely if the problem is intermittent, and is solved by rebooting the application server
   
   
 * Scenario #2 - Import file too large/complex for Controller to successfully handle.  * This is most likely if the problem is not intermittent, and is not solved by rebooting the application server
   
   

DIAGNOSING THE PROBLEM
To diagnose the probable cause: 

 1. Obtain a short period of downtime (no users on the system) 
 2. Reboot the Controller application server 
 3. Immediately logon to Controller (without allowing other users on the system yet) 
 4. Import data file

 * If the import is successful, then the likely cause is probably scenario #1 (temporary memory resource problem on Controller application server) 
 * If the import is unsuccessful, then the likely cause is probably scenario #2 (import file too large/complex for Controller to successfully handle).


RESOLVING THE PROBLEM
Scenario #1 - Memory issue (for example memory leak) in Controller application server 

 * Ensure you are running the latest version of Controller (to cure known memory leaks, such as those in Controller 8.3.x) 
 * Modify the COM+ and ASP.NET memory settings to regularly recycle memory.  * For the steps to do this, contact IBM Support.
   
   

Scenario #2 - Import file too large/complex for Controller to successfully handle 

 * Reduce the size of the file imported  * In other words, import the data in smaller chunks 
    * For example, instead of importing 12 periods of data simultaneously, perhaps import 6 or 3 periods at a time.
   
   

 

HISTORICAL NUMBER
 1037409