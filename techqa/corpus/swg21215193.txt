Title: IBM Setting up WebSphere Extended Deployment (XD) Generic Server Cluster - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 This is a detailed example of how to set up a WebSphere Extended Deployment (XD) Generic Server Cluster, which will do the following:

1. Route traffic using WebSphere XD to the non-XD server,
2. Monitor the throughput to the non-WebSphere XD server using the WebSphere XD Runtime Operations facilities. 

RESOLVING THE PROBLEM
Assume you have the following installed: 

 1. A non-WebSphere Extended Deployment server. 
 2. WebSphere Extended Deployment (XD) V6.1.


You want to route traffic using WebSphere XD to the non-WebSphere XD server, and you want to monitor throughput to the non-WebSphere XD server using the WebSphere XD Runtime Operations facilities. 

WebSphere XD On Demand Router (ODR) and the WebSphere XD Deployment Manager (dmgr) is installed on machine ODRMachine. 

WebSphere Application server, non-XD and unfederated, installed on machine ServerMachine. Port 9081 is used for the applications. The Defaultapplication.ear is installed. The snoop application is used for testing (URI pattern is "/snoop"). 

The following are the steps for setting up a Generic Server Cluster for this environment:  1.  Install and start the WebSphere Extended Deployment mixed server environment.  1.  Install WebSphere ND V6.1 on the ODRMachine. 
      2.  Define the dmgr profile on the ODRMachine and start the dmgr. 
      3.  Define the ODRNode profile as a custom profile and federate it to the dmgr; for simplicity, the profile and Node have both been named "ODRNode". 
      4.  Stop the dmgr, and stop the ODRNode nodeagent. 
      5.  Install WebSphere XD V6.1. 
      6.  Start the dmgr, and start the ODRNode nodeagent. 
      7.  Install the odr server within the ODRNode. 
      8.  Start the odr server. 
      9.  Take note of the target application server port to which you want to route work.
          In this example, AppSrv01 on ServerMachine, uses port 9081 for wc_defaulthost. The application Defaultapplication.ear is installed on AppSrv01. 
      10. Start the target server.
          
          
     
     
 2.  Test to ensure that you can access your application directly (without ODR routing) after you have started the server.
     
     For example,
     For snoop: http://ServerMachine:9081/snoop 
     
 3.  Define a Generic Server Cluster and its associated target host and port.  1. Expand Servers and click Generic Server Cluster. 
      2. Click New to define a new server. 
      3. Type the name for the new server; (for example, “gscA” for generic server cluster “A”); allow default of Protocol to remain http; click OK. 
      4. Click on the Generic Server Cluster you defined. 
      5. Under Additional properties, click on Ports. 
      6. Click New. 
      7. Specify Host and Port values (for example, ServerMachine and 9081). 
      8. Click OK, save, and the Synchronize changes with nodes.
         
         
     
     
 4.  Define the Service Policy and Transaction Class.  1.  Expand Operational policies and click Service policies. 
      2.  Click New to define a new Service policy. 
      3.  Type the name for the new Service policy (for example: gscA_SP). 
      4.  For Goal type (for example, select Average response time). 
      5.  Click Next. 
      6.  Type Goal value, select time interval and select Importance (for example, type Goal value of “200”, select “Milliseconds”, and select importance of “High”). 
      7.  Click Next. 
      8.  On the Define Service Policy Memberships panel, click New. 
      9.  For the Name, type the name you want for your Transaction class (for example, gscA_TC). 
      10. Click Next and Finish (which returns you to the Service policy dialogue) and Next. 
      11. Review the Confirm Service Policy Creation summary and click Finish. 
      12. Click Save, Synchronize changes with nodes.
          
          
     
     
 5.  Define the Work Class and associated routing rule within the ODR.  1.  Expand Servers and click on On Demand Routers. 
      2.  Click on your ODR server name. 
      3.  Under On Demand Router Settings, expand On Demand Router Properties. 
      4.  Click Generic Server Cluster Routing Policies. 
      5.  Expand Work Classes for HTTP Requests. 
      6.  Click New. 
      7.  Type the Name of your new Work Class (for example, gscA_WC). 
      8.  Click Finish. 
      9.  Expand Work Classes for HTTP Requests. 
      10. Expand your new Work Class definition. 
      11. Type in the URI patterns for which you want to monitor (for example, /snoop ). 
      12. Under If no routing rules apply, select Permit routing to. 
      13. Under Under generic server cluster, select your generic cluster (for example, gscA). 
      14. Click OK at the top of the panel. 
      15. Click Save, Synchronize changes with nodes.
          
          
     
     
 6.  Define the Work Class and the associated Service Policy within the ODR.  1.  Click on our ODR server name. 
      2.  Under On Demand Router Settings, expand On Demand Router Properties. 
      3.  Click Generic Server Cluster Service Policies. 
      4.  Expand Work Classes for HTTP Requests. 
      5.  Click New. 
      6.  Type the Name of your new Work Class (for example, gscA_WC). 
      7.  Click Finish. 
      8.  Expand Work Classes for HTTP Requests. 
      9.  Expand your new Work Class definition. 
      10. Type in the URI patterns for which you want to monitor (for example, /snoop). 
      11. Allow For Virtual Host default to default_host. 
      12. Under If no classification rules apply…, select your generic cluster Service Policy / Transaction Class (for example, “gscA_TC(gscA_SP)”). 
      13. Click OK at the top of the panel. 
      14. Click Save, Synchronize changes with nodes.
          
          
     
     
 7.  Test to ensure the application works on the internal port for the server node.
     
     For example:
     http://ServerMachine:9081/snoop
     
     
 8.  Test that snoop works on port 80 using the ODRNode as the host name.
     
     For example:
     http://ODRMachine:80/snoop http://ODRMachine/snoop
     
     
 9.  Expand Runtime Operations and click on Runtime Topology.
     
     
 10. Select the following:  1. Data Scope of Generic Server Cluster. 
      2. Data Name of gscA. 
      3. Data Set Type of Application Server.
         
         
     
     
 11. The data should begin to be plotted for your server.
     
     
 12. Invoke the snoop application several times to see actual data plots for the Average Response time.