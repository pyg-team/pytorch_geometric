Title: IBM Unexpected exception during upgrade to 7.1.x.x - United States

Text:
mdineen MJD14 ZZ71 install TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Upgrading a production AIX Cluster from 6.3.x.x to 7.1.x.x. the active node was upgraded without issue but the passive node failed with not enough space in the filesystem. 

SYMPTOM
 <message>Error backing up files from /opt/IBM/IBMIMShared/native/com.tivoli.dsm.server.db2.aix.ppc64_10.5.301.86.zip 

java.io.IOException: There is not enough space in the file system.</message>


CAUSE
The installer uses/var/ibm/InstallationManager/adapters/native to save the backup files. It will attempt to save the file(s) in /var


DIAGNOSING THE PROBLEM
Per the Tivoli Storage Manager 7.1 server installation guide the following minimum values for disk space: 

 * 
 * 
 * 512 MB for the /var directory <-------- HERE
 * 
 * 5 GB for the installation directory
 * 
 * 2 GB for the /tmp directory
 * 
 * 300 MB for the /usr directory
 * 
 * 2 GB in the home directory
 * 
 * Tip: Expect to use more space for problem determination.
 * 
 * 2 GB for the shared resources area


When looking at the df -k you see all filesystems meet the minimum requirements with both free space and total space  * 
 * > df -k
 * 
 * Filesystem 1024-blocks Free %Used Iused %Iused Mounted on
 * 
 * /dev/hd4 1572864 1099476 31% 14268 6% / 
 * 
 * /dev/hd2 10223616 2463040 76% 88238 14% /usr
 * 
 * /dev/hd9var 2621440 
 * 1015916
 * 
 * 62% 13562 6% /var <--- HERE
 * 
 * /dev/hd3 7602176 4278524 44% 2173 1% /tmp
 * 
 * /dev/hd1 2097152 297588 86% 2909 5% /home 
 * 
 * /proc - - - - - /proc 
 * 
 * /dev/hd10opt 16777216 8595404 49% 102569 6% /op
 * t 
 * 
 * 


The file that can not be backed up is just over 1GB:  * 
 * ls -ltr /opt/IBM/IBMIMShared/native/com.tivoli.dsm.server.db2.aix.ppc64_10.5.301*
 * 
 * 
 * -rw-r--r-- 1 root system 1075023171 Nov 16 13:09


Per the df -k output /var has less than 1GB free space and is the cause of the failure though the installation guide indicates /var has sufficient space. 

RESOLVING THE PROBLEM
Add ample space to /var in case additional files need to be backed up. Once the upgrade has completed the space can be reduced as needed.

 

PRODUCT ALIAS/SYNONYM
 TSM ADSM ITSM IBM Spectrum Protect