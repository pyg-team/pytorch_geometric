Title: IBM "Argument 'Number' is not a valid value" and "ORA-25137: Data value out of range" when using 'Reconcile between Accounts and Opening Balances' - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 User clicks'Company - 'Reconcile - between Accounts and Opening Balances'. The 'Reconcile - Between Accounts/Opening Balances' window appears. User enters the relevant parenters, and clicks 'preview'. User receives error message.

The same problem occurs when user clicks 'Group - Reconcile - Between Accounts/Opening Balances for Groups...' and performs the same actions. 

SYMPTOM
Screen: 

Cognos 8 Controller
Unhandled exception has occurred in a component in your application. If you click Continue, the application will ignore this error and attempt to continue.
Argument 'Number' is not a valid value.
[Details] [Continue] 

 

Event Viewer (Application Log):
Event Type: Warning Event Source: Cognos Controller Event Category: None Event ID: 0 Date: 2010-01-14 Time: 12:36:07 User: N/A Computer: SERVERNAME Description: Error occured at 2010-01-14 12:36:07 in Cognos Controller, Error No=5, Source=FrangoDirect.ReconcileAccOBD.RecAccOBRepAnalyse#ControllerProxyClient, Description=System.Web.Services.Protocols.SoapException: Server was unable to process request. ---> System.Runtime.InteropServices.COMException (0x80040E14): ORA-25137: Data value out of range at FrReconcileBT.ReconcileAccOBTClass.RecAccOBRepAnalyseCRN(String sGuid, String sUser, Int32 lLocale, String sPerakt, String sCloVer, String sContrVer, Boolean bBtwAcc, Boolean bOB, String sConsType, String sGroup, Recordset rsCompany, Boolean bCurrTypeAccordingToGroup, String sCurrType, Boolean bShowOnlyDiff, Int32 lSubmission, Object sXmlDoc) at Cognos.Controller.Proxy.CCRWS.ReconcileAccOBT_RecAccOBRepAnalyseCRN(String sGuid, String sUser, Int32 lLocale, String sPerakt, String sCloVer, String sContrVer, Boolean bBtwAcc, Boolean bOB, String sConsType, String sGroup, DataSet rsCompany, Boolean bCurrTypeAccordingToGroup, String sCurrType, Boolean bShowOnlyDiff, Int32 lSubmission, Object sXmlDoc) --- End of inner exception stack trace ---, HelpFile= HelpContext=0 For more information, see Help and Support Center at http://go.microsoft.com/fwlink/events.asp [http://go.microsoft.com/fwlink/events.asp]. 

Event Type: Warning Event Source: Cognos Controller Event Category: None Event ID: 0 Date: 2010-01-14 Time: 12:36:07 User: N/A Computer: SERVERNAME Description: Error occured at 2010-01-14 12:36:07 in Cognos Controller, Error No=5, Source=Microsoft.VisualBasic:FrangoClient.clsStandardReports.CreateReports:FrangoClient.clsStandardReports.PreviewReports, Description=Argument 'Number' is not a valid value., HelpFile= HelpContext=0 



CAUSE
Oracle schema (user) does not have sufficient permissions and/or the Oracle database has an unsupported character set. 

 
More information:
If using Oracle, Controller requires two DIFFERENT types of database: 
(1) ContentStore 

 * Character Set (~collation) must be "Unicode"  * On Window Servers:  * Use “Unicode” and “AL32UTF8” (you could use AL16UTF16) 
       * Choose National Character Set AL16UTF16 (not UTF8, which is your only other option) 
      
      
   
   


(2) Controller application repository = Character Set (~collation) must be " NON-Unicode"  * Ensure that you choose WE8MSWIN1252 as the Database character set 
 * NOTE: The National Character set should be AL16UTF16


So, for example, you must NOT use your 'content store database' for storing the Controller financial information, because it will be 'Unicode' (bad)! 

In addition, the Controller application database repository's Oracle schema must have the following permissions: connect, resource, create session, alter session, create table, create database link, create sequence, create trigger, create view, create procedure, create materialized view, create synonym, create job, select_catalog_role, unlimited tablespace, GRANT execute ON DBMS_LOCK 
ENVIRONMENT
Controller database hosted on Oracle 10G database server.



RESOLVING THE PROBLEM
 Obtain a short period of downtime, and then: 

 1. If necessary, create a new Oracle database with the correct character set 
 2. Create a brand-new Oracle schema (user), with the correct permissions. 
 3. Export the data from the old (bad) schema using the Oracle EXP utility, into a DMP file 
 4. Import the data from the DMP file into the new (good) schema, using the Oracle IMP utility 
 5. Reconfigure Controller to point to the new (good) schema.

RELATED INFORMATION
#1347701 - Error 'ORA-00942: table or view does not exis [http://www.ibm.com/support/docview.wss?uid=swg21347701]