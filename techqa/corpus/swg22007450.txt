Title: IBM Report Data Synchronization failing with ORA-12899 exception - United States

Text:
adhoc reporting data synchronization ORA-12899 exception TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 When using Oracle as the ITIM Database and having group names containing special (for example, Arabic) characters, the Report Data Synchronization might fail with an ORA-12899 exception. 

CAUSE
Although ISIM is trimming the strings to 255 characters before storing them into the database, the database should not convert any characters, as this could exceed the set character limit.

DIAGNOSING THE PROBLEM
When Report Data Synchronization fails, the trace.log might show records like:

<Trace Level="MIN">
<Time Millis="1501580280662"> 2017.08.01 13:38:00.662+04:00</Time>
<Server Format="IP">xyz</Server>
<ProductId>CTGIM</ProductId>
<Component>com.ibm.itim.adhocreport.synchronization</Component>
<ProductInstance>ISIMVa_APP_MEMBER</ProductInstance>
<LogText><![CDATA[ORA-12899: value too large for column "ITIMUSER"."GROUPZ"."ERGROUPID" (actual: 320, maximum: 300)]]></LogText>
<Source FileName="com.ibm.itim.adhocreport.synchronization.AdhocSyncDataMessageReceiver" Method="onMessage"/>
<Thread>SIBJMSRAThreadPool : 0</Thread>
<Exception><![CDATA[com.ibm.itim.apps.ApplicationException: ORA-12899: value too large for column "ITIMUSER"."GROUPZ"."ERGROUPID" (actual: 320, maximum: 300)

RESOLVING THE PROBLEM
First, make sure that Oracle property NLS_LENGTH_SEMANTICS is not specified as BYTE but as CHAR. If not, then please check technote from the link in Related information section below first, because this would be the preferred solution. If that does not help, then continue.


Make use of the following property in adhocreporting.properties file to specify the column length:

#########################################
# Specify the value of the column length to be set while creating reporting tables
# during data synchronization. These values determine the maximum amount of information
# that will be stored in the database for that attribute and displayed on the reports.
#
# List the entity and its attribute names with required column length values.
# The properties must be in the following format.
#
# entity.column.<entity_name>.<attribute_name>.length=<length_of_column>
# Example :
# entity.column.systemrole.description.length=500
#
# The unit of the value specified for the property is in BYTE. For Oracle
# database the unit CHAR is as specified for the parameter NLS_LENGTH_SEMANTICS.
#
# The default value for the column length is 255. All the attribute values that are not
# specified using this property will have a default column length of 255. Permissible
# values are in the range 1 and 4000. The default value is used for invalid values.
#
# It is recommended not to set the column length value less than default value unless
# it is required. And set less than default value only for the attributes that
# are manually mapped using the schema mapping and not for implicitly mapped attributes.
#
# The column length of the default attributes that are added in the parent table for each
# entity such as DN, CONTAINERDN, SUPERVISOR, OWNERDN, SELFDN, TARGETCLASS cannot be
# configured using this property. The only column length of the attributes that can be
# mapped using the report schema mapping can be configured. The ACI and AUDIT related
# reporting tables column length values cannot be configured.
#
# The column length value of existing tables for already mapped attributes are not
# changed during the incremental synchronization. Full data synch must be run to
# reconfigure the existing tables.
#########################################
# entity.column.systemrole.description.length=500

where table_name to entity_name mappings can be found in entity_column table. entity_name for Groupz table_name is Group, therefore for the problem above the correct syntax is:

entity.column.GROUP.ERGROUPID.length=500

ISIM restart and Full data synch must be run for the changes to take effect.

RELATED INFORMATION
 Report Data Synchronization failing with ORA-12899 [http://www-01.ibm.com/support/docview.wss?uid=swg21574175]