Title: IBM Warning error when opening an Excel 2002 or a CSV output in Excel 2007 and up - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 When opening an Excel 2002 or CSV format report output, the browser will open it in Excel. If the client has Excel 2007 and up version, a warning message will appear. 

SYMPTOM
When trying to open the file, Excel will show a warning message: 

"The file you are trying to open, ‘.xls’ is in a different format than specified by the file extension. Verify that the file is not corrupted and is from a trusted source before opening the file. Do you want to open the file now?"

Click OK and the report will open.


CAUSE
The error message seems to be related to a new feature in Office 2007 versions and up called "ExtensionHardening". If a file with extension xls, but which format is not xls is to be opened in Excel, you get this warning:
http://support.microsoft.com/kb/948615 [http://support.microsoft.com/kb/948615]


RESOLVING THE PROBLEM
By default, a CSV output will open with extension xls when running the report interactively. 

This is by Design. Dispatcher creates the content-disposition header based on the content type. If it looks like excel, even csv, it uses a .xls extension. The .xls file generated conforms to the CSV standard, and users can change the extension to .csv if that is the desired extension.

There is also an alternate method for saving with a .csv extension if needed. To do so please follow these steps: 
1. Save the report in question to cognos connection.
2. In cognos connection, click "Run with options" (blue arrow)
3. Click advanced options
4. Select "run in the background"
5. Select "Delimited text (CSV)", deselecting HTML
6. Click run
7. Select "view output versions" (stack of pages icon)
8. Click the small computer icon beside the CSV report to download
with a CSV extension. 

Excel 2002 output is an mht file. If the advanced parameter RSVP.FILE.EXTENSION.XLS is set, the file will be created with extension .xls as well.

As per the warning, review Microsoft technote, it provides the steps to disable the feature by modifying the registry. Note that Microsoft technote specifies that this behavior is 'Design intent'.