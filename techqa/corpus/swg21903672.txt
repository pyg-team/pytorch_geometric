Title: IBM Specifying Oracle listeners and services to monitor - United States

Text:
5724V09ORTR TECHNOTE (FAQ)

QUESTION
 How can ITCAM Extended Oracle agent be configured to monitor only specific services and listeners? 

CAUSE
The listener.ora file has several listener definitions. By default, the monitoring agent monitors status of all the listeners in that file, but you want the agent to monitor only specific listeners. 
Similarly, the tnsnames.ora file has several services defined. By default, the monitoring agent monitors status of all the services in that file, and you want to monitor only specific services.

ANSWER
The ITCAM Extended Oracle agent provides settings, so that monitoring of specific listeners and services can be configured. 

These settings are available in 6.3.1 FP2 and higher versions of the agent. 

Settings for filtering listeners: 

Agent uses following default settings which specify that the agent should exclude none of the listeners, and should include all of the listeners found in listener.ora for monitoring.

KRZ_LISTENER_EXCLUDE='^[\s]+' 
KRZ_LISTENER_INCLUDE='.+' 

Scenario 1: You want to monitor all of the listeners in listener.ora file, except the one listener called TEST_LISTENER. 
Steps to achieve this are as follows:
Edit rz_<instance>.config file located at ITMHOME/config directory.

#KRZ_LISTENER_EXCLUDE='^[\s]+' <--- Comment out this line
KRZ_LISTENER_EXCLUDE='TEST_LISTENER' <--- Tell agent to exclude TEST_LISTENER
KRZ_LISTENER_INCLUDE='.+' <--- Leave this as is

Scenario 2: You want to monitor only specific listeners, say LISTENER and NEW_LISTENER
Steps to achieve this are as follows:
Edit rz_<instance>.config file located at ITMHOME/config directory.
KRZ_LISTENER_EXCLUDE='^[\s]+' <--- Leave this as is
#KRZ_LISTENER_INCLUDE='.+' <--- Comment out this line
KRZ_LISTENER_INCLUDE='LISTENER,NEW_LISTENER' <--- Tell agent to include these two listeners.


Settings for services:
Similarly for including and excluding services from tnsnames.ora, following settings are available: 

KRZ_TNS_INCLUDE='.+' 

KRZ_TNS_EXCLUDE='^[\s]+' 

 

Note: You can use other 'sed' editor style regular expressions to include and exclude the listeners and services. 

For example, the following setting excludes all services which begin with character ORCL:
KRZ_TNS_EXCLUDE='^ORCL.*'


Example: 

Before excluding any listeners and services, the Net Services workspace includes all listeners and services, as seen in the screen print below. 

 

[/support/docview.wss?uid=swg21903672&aid=1] [/support/docview.wss?uid=swg21903672&aid=1] 

To exclude listener named TEST_LISTENER, and services named ORCL and ORCL_A, do the following. 

Edited rz_<instance>.config file to exclude listener TEST_LISTENER and services ORCL and ORCL_A as follows: 

#KRZ_LISTENER_EXCLUDE='^[\s]+'
KRZ_LISTENER_EXCLUDE='TEST_LISTENER'
KRZ_LISTENER_INCLUDE='.+'


#KRZ_TNS_EXCLUDE='^[\s]+'
KRZ_TNS_EXCLUDE='ORCL,ORCL_A'
KRZ_TNS_INCLUDE='.+'

Restart the agent. Net Service Connection workspace now excludes the excluded listener and services as seen in the screen print below:
[/support/docview.wss?uid=swg21903672&aid=2] [/support/docview.wss?uid=swg21903672&aid=2]

RELATED INFORMATION
 Overview of Regular Expression Syntax [https://www.gnu.org/software/sed/manual/html_node/Regular-Expressions.html]