Title: IBM Unable to convert secured PDF file with the Convert actions in IBM Datacap - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Attempts to convert secured PDF file using Convert.PDFFREDocumentToImage action result in the error: "Conversion exception encountered: Invalid PDF file." 

SYMPTOM
Datacap complies with this setting 

16:07:00.857 (234) t:1FC4 p:2E90E18 1 An error was encountered while converting the image. Decription : Invalid PDF file: \\xxxx\Datacap\xxxxx\batches\2016xxxx.000189\tm000001.pdf. , , at FREngine.IEngine.IsPdfWithTextualContent(String FileName, IImagePasswordCallback Callback) at Datacap.Libraries.Convert.PdfFRE.ExtractTIFFsFromPDFEx(String filePath, 
Boolean useFastBinarization, Int32 jpegQuality, Int32 resolution, Int32 compressionBW, Int32 compressionColor, Int32 compressionGray, String extensionBW, String extensionColor, String extensionGray, Int32 convertMode) 
16:07:00.857 (0) t:1FC4 p:2E90E18 1 PDF to TIF extraction complete. 
16:07:00.857 (0) t:1FC4 p:2E90E18 1 Conversion exception encountered: Invalid PDF file: 
\\xxxx\Datacap\xxxxx\batches\2016xxxx.000189\tm000001.pdf. 
16:07:00.857 (0) t:1FC4 p:2E90E18 1 Setting the batch to abort... 
16:07:00.857 (0) t:1FC4 p:2E90E18 1 result 1[1] = false 
16:07:00.857 (0) t:1FC4 p:2E90E18 1 action returned false 


DIAGNOSING THE PROBLEM
Review the PDF page security properties. (Adobe File | Properties | Security) "Content Copying" are not allowed. 


RESOLVING THE PROBLEM
The PDF document security does not allow for extraction of pages. Datacap complies with this setting. 
Two solutions: 
1. The security will need to be change on the PDF, so that security settings will not interfere with the extraction. 
2. Use the PDFDocumentToImage action, since it does not follow the same behavior as the PDFFREDocumentToImage action. The PDFDocumentToImage action allows the conversion of secured PDF files. 

 a. Note that the PDFDocumentToImage action was changed in 9.1.1 to default to using the Abby engine as well. You can re-enable use of the VeryPDF engine in 9.1.1 +hotfix or 9.1.3 or higher by setting a variable named SelectPDFEngine to a value of 1 (e.g. rrset("1","@P.SelectPDFEngine")). If the variable is present and set to 1, then PDFDocumentToImage will use the VeryPDF engine. Otherwise, the Abby engine will be used.