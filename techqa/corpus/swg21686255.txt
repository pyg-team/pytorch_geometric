Title: IBM APMUI 7.7 - REST data provider tracing - United States

Text:
5724G70UITR SCAPMUI troubleshooting TECHNOTE (FAQ)

QUESTION
 What are the steps to enable tracing of REST data provider for Application Performance Management User Interface (APMUI)? 

CAUSE
APMUI gets applications data from REST provider. The REST data provider runs on the eWAS server. The eWAS server is started with Tivoli Enterprise Portal Server (TEPS). If there are REST provider errors in APMUI logs, or if agent application is not discovered, IBM Support may require traces from the TEPS and eWAS server.

ANSWER
Instructions to enable APMUI data provider traces consist of enabling traces at TEPS and eWAS server. 

1) Enable TEPS traces: 

Follow these steps to enable traces at TEPS: 

1.1 Enable KBB_RAS1 trace on TEPS:
Update following TEPS configuration file:
On UNIX: <install path>/config/cq.ini
On Windows: <install path>\CNPS\KFWENV 

KBB_RAS1=ERROR (UNIT:ctsql IN,ER) (UNIT:ctpub IN,ER) (UNIT:ctdatabus IN,ER) 

Note: the most important is the (UNIT:ctpub IN,ER). It shows requests from the data provider coming into the TEPS (Kfwservices.exe). 
1.2 In order to ensure that the logs don't wrap, increase the size and number of generated TEPS logs. Set the log size to 50 MB by changing LIMIT setting, the number of logs to 20 by changing COUNT setting in the KBB_RAS1_LOG line of cq.ini. 

If the problem is quickly recreated, then you can set the LIMIT to 20 and COUNT can be at 10. 

On UNIX: 

Edit the cq.ini and increase the LIMIT setting in KBB_RAS1_LOG line to 20 MB, and LIMIT to 50, as shown below:
KBB_RAS1_LOG=^(CTIRA_LOG_PATH)/$RUNNINGHOSTNAME$_$PRODUCTCODE$_^(systask)_^(sysutcstart)-.log INVENTORY=^(CTIRA_LOG_PATH)/$RUNNINGHOSTNAME$_$PRODUCTCODE$_^(systask).inv COUNT=20 LIMIT=50 PRESERVE=1 MAXFILES=9


On Windows: 

Open Manage Tivoli Enterprise Monitoring Services (MTMS) program. Right click the TEPS entry and select Advanced-> Edit Trace Parms. Change the RAS1 Filters, Max Log Size Per File (MB), and Maximum Number of Log Files Per Session fields. 

[/support/docview.wss?uid=swg21686255&aid=1] [/support/docview.wss?uid=swg21686255&aid=1] 

Make sure that you have enough disk space for the logs. 

2) Enable eWAS administration: 

Skip this step if you have already enabled eWAS administration. 

On UNIX: 

a) From the command prompt, change to the scripts directory - for example: /opt/IBM/ITM/lx8266/iw/scripts 
and enter the following command, where true starts the console and false stops the console: 
./enableISCLite.sh true

Example:
[root@nc9042037046 scripts]# ./enableISCLite.sh true
WASX7209I: Connected to process "ITMServer" on node ITMNode using SOAP connector; The type of process is: UnManagedProcess
WASX7303I: The following options are passed to the scripting environment and are available as arguments that are stored in the argv variable: "[true]"
ISClite is not running
ISClite started

b) Run following command from the same scripts directory: Where <password> is the password you want to set for the admin console.
./updateTEPSEPass.sh wasadmin <password>

[root@nc9042037046 scripts]# ./updateTEPSEPass.sh wasadmin password
WASX7209I: Connected to process "ITMServer" on node ITMNode using SOAP connector; The type of process is: UnManagedProcess
WASX7303I: The following options are passed to the scripting environment and are available as arguments that are stored in the argv variable: "[wasadmin, password]"
TEPSEWASBundle loaded. 

On Windows:
Enable the TEPS/e Administration as follows: 

 * Open 'Manage Tivoli Enterprise Monitoring Services' window. 
 * Select 'Tivoli Enterprise Portal Server', click right, select 'Advanced-> TEPS/e Administration Password'. 
 * Enter the password user wants to use to logon to the TEPS eWAS admin console. 
 * Select 'Tivoli Enterprise Portal Server', click right, select 'Advanced-> Enable TEPS/e Administration'. 


After some time, the eWAS administration will be enabled. 3) Enable eWAS traces as follows: 

3.1 Once you have enabled eWAS administration, access the administrative console for eWAS, where <host> is your REST provider ipaddress or host: 

For example, access following URL for eWAS admin console if the admin port of the 
http://<host>:15205/ibm/console 

To determine the ports of eWAS admin console, refer to following file, and look for WC_adminhost and WC_adminhost_secure. Accessing eWAS admin console at WC_adminhost port will redirect it to secure admin port. 

On UNIX: 

<ITMHOME>/<arch>/iw/profiles/ITMProfile/config/cells/ITMCell/nodes/ITMNode/serverindex.xml 

Where <arch> is the architecture directory, such as lx8266. 

On Windows: 

<ITMHOME>\CNPSJ\profiles\ITMProfile\config\cells\ITMCell\nodes\ITMNode\serverindex.xml 


3.2 On the eWAS admin console login page, type in user 'wasadmin' and the password you have set in step 2.
You will log into 'Websphere Integrated Solutions console'.
In the left navigation, click "Troubleshooting-> Logs and trace"
In the right pane, select 'ITMServer'.
Select 'Diagnostic Trace'
Under 'Additional Properties', on the right click " Change log detail levels"
Default is *=info
Expand All Components and just click on 'com.ibm.tivoli.monitoring.provider.*'
A menu page is displayed where user can select the level of tracing.
Select "All Messages and Traces"
This will add a trace like : com.ibm.tivoli.monitoring.provider.*=all


3.3 Traces at eWAS can be set on a case by case basis, as determined by support team. 
For example, following trace will print the actual CURI requests coming from the CURI libraries in eWAS that get forwarded to the data provider. 

com.ibm.tivoli.rest.*=all
com.ibm.usmi.*=all
com.ibm.sysmgmt.utils=all
org.apache.wink.*=all
com.ibm.tivoli.rest=finest

3.4 The detail traces will be written to 'trace.log' in the same directory where 'SystemOut.log' for eWAS server is located.
The location of eWAS logs is the following: 

On UNIX: 

<ITMHOME>/<arch>/iw/profiles/ITMProfile/logs/ITMServer 

For example, for linux architecture lx8266, the trace.log will be generated in the following directory: /opt/IBM/ITM/lx8266/iw/profiles/ITMProfile/logs/ITMServer. 

On Windows: 

<ITMHOME>\CNPSJ\profiles\ITMProfile\logs\ITMServer

3.5 Screen shots for eWAS trace enablement are as follows:

Access eWAS admin console page: http://<host>:15205/ibm/console
Log in: wasadmin and password.
Access the page shown, default setting is info as shown below. 

[/support/docview.wss?uid=swg21686255&aid=2] [/support/docview.wss?uid=swg21686255&aid=2] 

 

Select 'com.ibm.tivoli.monitoring.provider.*' and then select "All Messages and Traces" from the context menu. 

[/support/docview.wss?uid=swg21686255&aid=3] [/support/docview.wss?uid=swg21686255&aid=3] 

 

The tracing will be set as follows: 

[/support/docview.wss?uid=swg21686255&aid=4] [/support/docview.wss?uid=swg21686255&aid=4]