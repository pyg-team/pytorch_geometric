Title: IBM PI56624: DFHSR0601 WITH SYSTEM TASK TCP IN CONTROL. - United States

Text:
z/os  A FIX IS AVAILABLE
Obtain the fix for this APAR.


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  One symptom of this problem is:
   
   DFHSR0601 CICSPROD PROGRAM INTERRUPT OCCURRED WITH SYSTEM TASK
   TCP IN CONTROL
   .
   The stack of the TCP task shows that the program check occurred
   while DFHZRAC was in control.
   .
   The program interrupt is an abend0C1 caused by a wild branch.
   the PSW is a below-the-line address and it is in AMODE 24.  The
   PSW address is based on a 31-bit address in R14.  For example,
   R14 is 00000000_BA41C226 and the PSW address is 0041C228.
   .
   R13 is the CSA address. R14 and R3 and R5 point within DFHSTTD.
   .
   Trace shows that an EXEC CICS EXTRACT STATISTICS RESTYPE(
   TDQUEUE ) was being processed on an L8 TCB while DFHZRAC was in
   control on the QR TCB.
   .
   Another symptom of the problem is:
   DFHSR0622 CICSPROD AN ATTEMPT TO OVERWRITE THE ERDSA HAS CAUSED
   THE ABEND WHICH FOLLOWS
   .
   The stack of the abending task shows the problem happened at
   the DFHZIS2 stack level.
   .
   The Kernel Error Data shows the problem is an abend0C4 with the
   PSW pointing at +x'986' into the UI30326 level of DFHZIS2. The
   failing instruction is 50F0514C .  Regs 3 and 5 are base
   registers for program DFHSTTD .
   .
   Trace shows that an EXEC CICS EXTRACT STATISTICS is running on
   an L8 while DFHZIS2 is running for a different task on the QR.
   Also, trace shows that the EXTRACT STATISTICS is gathering data
   on a TDQUEUE and DFHSTTD is involved.
   
   Additional Symptom(s) Search Keyword(s): KIXREVDWZ
   
   
    
   
   

LOCAL FIX
 *  Force all programs that do EXEC CICS COLLECT STATISTICS
   RESTYPE(TDQUEUE) to run on the QR TCB.
   
   
    
   
   

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED:                                              *
   * All CICS users                                               *
   ****************************************************************
   * PROBLEM DESCRIPTION:                                         *
   * CICS region abended with DFHSR0601 with system task TCP in   *
   * control.                                                     *
   ****************************************************************
   * RECOMMENDATION:                                              *
   * .                                                            *
   ****************************************************************
   The CICS system task TCP was running under the QR TCB. DFHZRAC
   had saved its registers into CSAOSRSA before calling exit code.
   At the same time, an openapi required program was executing
   under an L8 TCB and issued EXEC CICS EXTRACT STATISTICS for
   transient data. This command is threadsafe, so DFHSTTD was
   called under the open TCB. When it drove DFHAMSIG to return
   resource signature information, the macro saved DFHSTTD's
   registers into the RSA 12 bytes into register 13. Since DFHSTTD
   is part of the AP domain, R13 addressed the CSA and so the save
   area at CSAOSRSA was overlaid with DFHSTTD's registers. When the
   TCP task issued its subsequent LM instruction to restore its
   register environment, it picked up the registers for DFHSTTD.
   This led to a wild branch and program check. CICS issued
   DFHSR0601 and terminated.
   KEYWORDS: SR0601 0601 601 MSG0601
   
   
    
   
   

PROBLEM CONCLUSION
 *  DFHSTTD has been changed to switch from the CSA to the stack
   environment around the calls to DFHAMSIG, then switch back to
   the CSA environment afterwards.
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PI56624
   
   
 * REPORTED COMPONENT NAME
   CICS TS Z/OS V5
   
   
 * REPORTED COMPONENT ID
   5655Y0400
   
   
 * REPORTED RELEASE
   000
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   YesHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt / Xsystem
   
   
 * SUBMITTED DATE
   2016-02-04
   
   
 * CLOSED DATE
   2016-02-17
   
   
 * LAST MODIFIED DATE
   2016-03-02
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
    PI54434 [http://www-01.ibm.com/support/docview.wss?uid=swg1PI54434]
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
    UI35418
   
   

MODULES/MACROS
 *  DFHSTTD
   
   
    
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   CICS TS Z/OS V5
   
   
 * FIXED COMPONENT ID
   5655Y0400
   
   

APPLICABLE COMPONENT LEVELS
 * R000 PSY UI35418 [HTTPS://WWW14.SOFTWARE.IBM.COM/WEBAPP/SET2/ORDERMEDIA/SHOPCART?PTFS=UI35418]
   UP16/02/26 P F602 Â¢
   
   

FIX IS AVAILABLE
 * SELECT THE PTF APPROPRIATE FOR YOUR COMPONENT LEVEL. YOU WILL BE REQUIRED TO SIGN IN. DISTRIBUTION ON PHYSICAL MEDIA IS NOT AVAILABLE IN ALL COUNTRIES.