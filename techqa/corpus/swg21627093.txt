Title: IBM Upgrade fails during Portal server restart - United States

Text:
Portal server start startup restart fail failure fails upgrade install installation action-start-portal-server-standard cumulative_fix.xml wp.update.fix_cfg.xml wp.base_cfg.xml startServer TECHNOTE (TROUBLESHOOTING)

PROBLEM
The Portal server may be restarted several times during an upgrade. If the user has edited the startServer.sh script in any way, it could affect the behavior during an upgrade and cause it to fail.

SYMPTOM
Error in ConfigTrace.log: 

=========================================
action-start-portal-server-standard:
[logmsg] [01/22/13 16:26:35.387 EST] EJPCA3163I: Starting Server "WebSphere_Portal"
[echo] check for 'WebSphere_Portal' on host 'localhost' and port '10039'.
[wplc-get-host-port-in-server] Task parameters:
[wplc-get-host-port-in-server] Global attributes:
[wplc-get-host-port-in-server] cell="MyCell"
[wplc-get-host-port-in-server] engineinstalllocation="/opt/IBM/WebSphere/wp_profile/ConfigEngine"
[wplc-get-host-port-in-server] enginerootdir="/opt/IBM/WebSphere/ConfigEngine"
[wplc-get-host-port-in-server] pathseparator=":"
[wplc-get-host-port-in-server] osarch="amd64"
[wplc-get-host-port-in-server] node="MyNode"
[wplc-get-host-port-in-server] server="WebSphere_Portal"

[wplc-get-host-port-in-server] Instance attributes (Set 1 of 1):
[wplc-get-host-port-in-server] endPointName="WC_defaulthost"
[wplc-get-host-port-in-server] attribute=[ *** NONE_SPECIFIED *** ]
[wplc-get-host-port-in-server] end point: WC_defaulthost found
[wplc-get-host-port-in-server] Settings the host: * as ant property: ${hostInJMX}
[wplc-get-host-port-in-server] Settings the port: 10039 as ant property: ${portInJMX}
[wplc-get-host-port-in-server] Status = Complete
[echo] check for 'WebSphere_Portal' on 'WC_defaulthost' port configuration: '10039'. XmlAccessPort is set to: '10039'
[echo] 'WebSphere_Portal' seems to be stopped.
[echo] Starting 'WebSphere_Portal'
[exec] ADMU0116I: Tool information is being logged in file
[exec] /opt/IBM/WebSphere/wp_profile/logs/WebSphere_Portal/startServer.log
[exec] ADMU0128I: Starting tool with the wp_profile profile
[exec] ADMU3100I: Reading configuration for server: WebSphere_Portal
[exec] ADMU3200I: Server launched. Waiting for initialization status.
[exec] ADMU3000I: Server WebSphere_Portal open for e-business; process id is 26191


--- Exception Thrown ---
/opt/IBM/WebSphere/PortalServer/base/wp.base/config/includes/wp.base_cfg.xml:1578: exec returned: 1
at org.apache.tools.ant.taskdefs.ExecTask.runExecute(ExecTask.java:591)
at org.apache.tools.ant.taskdefs.ExecTask.runExec(ExecTask.java:617)
at org.apache.tools.ant.taskdefs.ExecTask.execute(ExecTask.java:452)

BUILD FAILED
/opt/IBM/WebSphere/PortalServer/installer/wp.update/config/includes/cumulative_fix.xml:47: The following error occurred while executing this line:
/opt/IBM/WebSphere/PortalServer/installer/wp.update/config/includes/wp.update.fix_cfg.xml:194: The following error occurred while executing this line:
/opt/IBM/WebSphere/PortalServer/base/wp.base/config/includes/wp.base_cfg.xml:1578: exec returned: 1 

=========================================

CAUSE
The startServer script has been edited and causes the upgrade to fail. In this case, the user had added a pause statement where one would have to it Enter to continue: 

 

=========================================
#!/bin/sh
binDir=`dirname ${0}`
. ${binDir}/setupCmdLine.sh
${WAS_HOME}/bin/startServer.sh "$@"

echo
echo
read -p "Press Enter key to close . . ." anykey 

=========================================



DIAGNOSING THE PROBLEM
1. Check if the server can be restarted manually from <wp_profile root>/bin: 

./startServer.bat|sh WebSphere_Portal 

 

2. Check if the following ConfigEngine task returns BUILD SUCCESSFUL: 

./ConfigEngine.bat|sh action-start-portal-server-standard 

 

Be sure Portal is stopped before trying either step.



RESOLVING THE PROBLEM
Remove any customization to the startServer script found here: 

<wp_profile root>/bin




 * 
 *