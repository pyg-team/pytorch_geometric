Title: IBM PK36471; 6.0.2.17: Application WPSMGR failed to start on ND cluster - United States

Text:
PK36471; PK36471; PK36471; WPS DOWNLOADABLE FILES

ABSTRACT
 DataSource created by IBM速 WebSphere速 Process Server extension code at the cluster scope during cluster member creation does not exist after the command is completed. 

DOWNLOAD DESCRIPTION

APAR PK36471 is Superseded by APAR PK42667 .

PK36471 resolves the following problem:

ERROR DESCRIPTION: 
Application WPSMGR failed to start on Network Deployment cluster. 

LOCAL FIX: 

PROBLEM SUMMARY

USERS AFFECTED:
IBM速 WebSphere速 Application Server version 6.0.2 users who have applications installed on a cluster.

PROBLEM DESCRIPTION:
DataSource created by WebSphere Process Server extension code at the cluster scope during
cluster member creation does not exist after the command is completed.

RECOMMENDATION:
None

Application fails to start on a Network Deployment cluster. The application works correctly on a single server and stand-alone server.

You would see an exception in the dmgr trace.

Expected result:
wpsFEMgr should be started correctly.
Actual result:
wpsFEMgr can not be started correctly.
You will see the following message in SystemOut.log
[12/6/06 14:55:07:766 CST] 0000002b RALifeCycleMa E J2CA0052E:
The lookup of the ActivationSpec with JNDI Name manual recovery failed due to exception javax.naming.
NameNotFoundException: Context: idler1Cell01/clusters/clustera,
name: manualrecovery: First component in name manualrecovery not found.
Root exception is org.omg.CosNaming.NamingContextPackage.NotFound:
IDL:omg.org/CosNaming/NamingContext/NotFound:1.0
at com.ibm.ws.naming.ipcos.WsnOptimizedNamingImpl.do_resolve_complete_info(WsnOptimizedNamingImpl.java:543)
at com.ibm.ws.naming.cosbase.WsnOptimizedNamingImplBase.resolve_complete_info(WsnOptimizedNamingImplBase.java:2213)
at com.ibm.WsnOptimizedNaming._NamingContextStub.resolve_complete_info(Unknown Source)
at com.ibm.ws.naming.jndicos.CNContextImpl.cosResolve(CNContextImpl.java:4043)
at com.ibm.ws.naming.jndicos.CNContextImpl.doLookup(CNContextImpl.java:1746)
at com.ibm.ws.naming.jndicos.CNContextImpl.doLookup(CNContextImpl.java:1707)
at com.ibm.ws.naming.jndicos.CNContextImpl.lookupExt(CNContextImpl.java:1412)
at com.ibm.ws.naming.jndicos.CNContextImpl.lookup(CNContextI mpl.java:1290)
at com.ibm.ws.naming.util.WsnInitCtx.lookup(WsnInitCtx.java: 145)
at javax.naming.InitialContext.lookup(InitialContext.java:36 1)
at com.ibm.ejs.j2c.RALifeCycleManagerImpl.activateEndpoint(RALifeCycleManagerImpl.java:1345)
at com.ibm.ejs.container.MessageEndpointFactoryImpl.activateEndpoint(MessageEndpointFactoryImpl.java:256)
at com.ibm.ws.runtime.component.EJBContainerImpl.install(EJBContainerImpl.java:2886)
at com.ibm.ws.runtime.component.EJBContainerImpl.start(EJBContainerImpl.java:3548)
at com.ibm.ws.runtime.component.ApplicationMgrImpl.start(ApplicationMgrImpl.java:1245)
at com.ibm.ws.runtime.component.DeployedApplicationImpl.fireDeployedObjectStart(DeployedApplicationImpl.java:1067)
at com.ibm.ws.runtime.component.DeployedModuleImpl.start(DeployedModuleImpl.java:547)
at com.ibm.ws.runtime.component.DeployedApplicationImpl.start(DeployedApplicationImpl.java:751)
at com.ibm.ws.runtime.component.ApplicationMgrImpl.startApplication(ApplicationMgrImpl.java:909)
at com.ibm.ws.runtime.component.ApplicationMgrImpl$AppInitializer.run(ApplicationMgrImpl.java:2020)
at com.ibm.ws.runtime.component.ComponentImpl$_AsynchInitializer.run(ComponentImpl.java:304)
at com.ibm.ws.util.ThreadPool$Worker.run(ThreadPool.java:1471)

WebSphere Process Server code extends createApplicationServer command to insert cluster scope resources when a cluster member is created. When a cluster member is created using createClusterMember command, the createApplicationServer command is called first. At this time the WebSphere Process Server extension code adds a cluster scope resource. Later, when the createApplicationServer command completes, the createClusterMember command copies a different
set of resources and overwrites what was added by WebSphere Process Server code.

This is the sequence of flow:

createClusterMember ( member1)
1. beforeStepsExecuted() of createClusterMember command calls createApplicationServer command to create the member first
2. createApplicationServer ( member1) is called.
3. beforeStepsExecuted() method of createApplicationServer creates the member and then all the extended steps are called.
4. Extension steps is creating resource under cluster scope
5. beforeStepsExecuted() method of createClusterMember(member1) calls promoteServerResources() to cluster scope.

This copies the server side resources to cluster scope. This does not contain the new resources created by WebSphere Process Server. This overwrites what was created in step 4.

PROBLEM CONCLUSION: 
The solution to this problem is: Do not promote the server scope resources to cluster scope when a cluster member is created. Step 5. above is removed from the code. 

The fix for this APAR is currently targeted for inclusion in fixpack 6.0.2.19. 

Please refer to the recommended updates page for delivery information: 
http://www.ibm.com/support/docview.wss?rs=180&uid=swg27004980 [http://www.ibm.com/support/docview.wss?rs=180&uid=swg27004980]

PREREQUISITES
Please download the UpdateInstaller below to install this fix.

URL LANGUAGE SIZE(Bytes) UpdateInstaller [http://www.ibm.com/support/docview.wss?rs=180&uid=swg21205991] US English 7250000 
INSTALLATION INSTRUCTIONS
Please review the readme.txt for detailed installation instructions.

URL LANGUAGE SIZE(Bytes) Readme [ftp://public.dhe.ibm.com/software/websphere/appserv/support/fixes/PK36471/readme.txt] US English 8679 
DOWNLOAD PACKAGE


Download RELEASE DATE LANGUAGE SIZE(Bytes) Download Options 
What is DD? [http://www6.software.ibm.com/dldirector/doc/DDfaq_en.html] 6.0.2.17-WS-WAS-IFPK36471 01-10-2007 US English 42360 FTP [ftp://public.dhe.ibm.com/software/websphere/appserv/support/fixes/PK36471/6.0.2.17-WS-WAS-IFPK36471.pak] DD 
TECHNICAL SUPPORT
 Contact IBM Support using SR (http://www-306.ibm.com/software/support/probsub.html [http://www-306.ibm.com/software/support/probsub.html]), visit the WebSphere Application Server Support Web site (http://www.ibm.com/software/webservers/appserv/was/support/ [http://www.ibm.com/software/webservers/appserv/was/support/]), or contact 1-800-IBM-SERV(U.S. only). 

Cross Reference information Segment Product Component Platform Version Edition Application Servers Runtimes for Java Technology Java SDK 
 [/support/docview.wss?uid=swg24014590&aid=1]Problems (APARS) fixed [/support/docview.wss?uid=swg24014590&aid=2]Problems (APARS) fixed
PK36471