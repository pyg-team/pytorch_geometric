Title: IBM PM09542: ABND=0C4 LOC=DSNIDM.DSNIDBGC+ 18A2 DURING DB2 RESTART - United States

Text:
z/os  A FIX IS AVAILABLE
Obtain the fix for this APAR.


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  ABND=0C4 LOC=DSNIDM.DSBIDBGC+ 18A2 during DB2 restart
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED: All DB2 data sharing users of objects with   *
   *                 more than 200 partitions (including NPIs     *
   *                 with more than 200 logical partitions)       *
   ****************************************************************
   * PROBLEM DESCRIPTION: ABEND0C4-00000004                       *
   *                      LOC=DSNIDM.DSNIDBGC+18A2                *
   *                                                              *
   *                      ABEND04E RC0090101                      *
   *                      LOC=DSNIDM.DSNIDBDF:5320                *
   ****************************************************************
   * RECOMMENDATION:                                              *
   ****************************************************************
   A non-zero return code was issued by an internal DBET macro but
   was not checked by the calling module.  As a result, an abend
   was encountered later on because an output pointer from the
   macro was never set.
   
   The reason the macro issued the non-zero return code was
   that the partition being processed was higher than the maximum
   partition known to the local (member's) DBET.  Therefore, no
   DBET appendage matching the partition being processed could be
   found.
   
   The inconsistency was introduced by an orphaned base DBET SCA
   record.  This orphaned SCA record had an incorrect maximum
   partition number, higher than what it should have been.
   
   Investigation showed that during an earlier SCA update, the
   check to control the loop of cleaning up base SCA records was
   incorrect.  Since the check was incorrect, the cleanup was
   incomplete, leaving behind the last base DBET SCA record.
   Later on, a restart of DB2 picked up this orphaned base DBET
   SCA record and built the local (member's) DBET incorrectly.
   
   
    
   
   

PROBLEM CONCLUSION
 *  DB2 has been modified to correct the loop which left the last
   base SCA record orphaned.
   
   Also, code has been modified to check the return code from the
   internal DBET macro and abend with DSNIDBGC ERQUAL5005, instead
   of allowing the code path to proceed and abend later with
   ABEND0C4 / ABEND04E.
   
   Please note that this APAR would only prevent DBET base SCA
   records from being orphaned in the future.  While at the time
   of writing this issue has not been reported by any customers,
   existing orphaned DBET base SCA records if any can be resolved
   by rebuilding the SCA structure, with the following procedure:
   
   1.  Check the status of all the objects in DBET by running
       -DISPLAY DATABASE(*) SPACENAM(*) LIMIT(*) RESTRICT and
       -DISPLAY DATABASE(*) SPACENAM(*) LIMIT(*) ADVISORY on
       any one member.  If there are any objects shown, please
       resolve their exception state (e.g. running REORG if
       object is in REORP state).
   
       Once exception states on all the objects have been
       resolved, from local DBETs, repeat the two DISPLAY commands
       but this time on all the members of the data sharing
       group, to make sure that all the states are gone and that
       all the members are in synch.
   
   2.  Rebuild SCA by issuing the SETXCF command (it typically
       takes a few seconds):
         SETXCF START,REBUILD,STRNM=strname
   
       For example: SETXCF START,REBUILD,STRNM=DSNCAT_SCA
   
   
    
   
   

TEMPORARY FIX
 *  *********
   * HIPER *
   *********
   
   
    
   
   

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PM09542
   
   
 * REPORTED COMPONENT NAME
   DB2 OS/390 & Z/
   
   
 * REPORTED COMPONENT ID
   5740XYR00
   
   
 * REPORTED RELEASE
   910
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   YesHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2010-03-09
   
   
 * CLOSED DATE
   2010-05-26
   
   
 * LAST MODIFIED DATE
   2010-07-01
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
    UK57307 UK57308
   
   

MODULES/MACROS
 *  DSNIDBGC DSNIDBHK
   
   
    
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   DB2 OS/390 & Z/
   
   
 * FIXED COMPONENT ID
   5740XYR00
   
   

APPLICABLE COMPONENT LEVELS
 * R810 PSY UK57307 [HTTPS://WWW14.SOFTWARE.IBM.COM/WEBAPP/SET2/ORDERMEDIA/SHOPCART?PTFS=UK57307]
   UP10/06/11 P F006
   
   
 * R910 PSY UK57308 [HTTPS://WWW14.SOFTWARE.IBM.COM/WEBAPP/SET2/ORDERMEDIA/SHOPCART?PTFS=UK57308]
   UP10/06/11 P F006
   
   

FIX IS AVAILABLE
 * SELECT THE PTF APPROPRIATE FOR YOUR COMPONENT LEVEL. YOU WILL BE REQUIRED TO SIGN IN. DISTRIBUTION ON PHYSICAL MEDIA IS NOT AVAILABLE IN ALL COUNTRIES.