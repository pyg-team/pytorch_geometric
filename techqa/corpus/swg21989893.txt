Title: IBM EthSw unreachable shows under nzhw -issues on IBM PureData System for Analytics - United States

Text:
nz switch nzhw ethsw unreachable TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 When issuing the command # nzhw -issues it shows ethernet switch(s) unreachable but the spus are working fine. 

SYMPTOM
Hardware healthcheck or nzhw -ssues shows ethernet switch not reachable but spus are working.


CAUSE
The NPS system constantly logs into the ethernet swiches to check statistics, health and vital statistics. It uses telnet to do some of these tasks. 

The host could abandon the telnet request, the switch could not release the telnet request... and if enough of these telnet sessions are open and not released the NPS system is unable to login over telnet. Thus the switch is marked as unreachable.


ENVIRONMENT
Netezza PDA Appliance



DIAGNOSING THE PROBLEM
Given the following output ... 

# nzhw -issues
EthSw 1008 spa2.ethsw2 Secondary Unreachable N/A

First determine the switch is responding over the network.
# ping gigsw02b

If ping responds fine.. the switch network layer is up and running.
If ping does not respond a PMR should be opened with support to investigate further.

Next try to telnet into the switch...
# telnet gigsw02b

If you get the message that there are too many open telnet connections the switch will need to be restarted to recover from this condition. 

The NPS must be offline to reset the SPA ethernet switches.


RESOLVING THE PROBLEM
Stop NPS 

# nzstop 

 

Next power cycle the switch. The switch needing to be reset will depend on the message in nzhw output. You may map the message from nzhw -issues to the switch needing reset by looking in the hardware replacement guide for your appliance. 

 

In the case of EthSw 1008 spa2.ethsw2 Secondary Unreachable N/A we will be power cycling spa 2 gig switch 2 which would be gigsw02b. 

 

# ssh mm002 power -cycle -T system:switch[9] 

 

Ping the switch to know when the switch has completed post and ready for access. 

 

# ping gigsw02b 

 

Once it will ping .. test telnet ... 

# telnet gigsw02b 

 

If the switch prompts for login , you are ready to bring NPS back up. 

# nzstart 

 

If the switch does not prompt for login... give the switch a few more minutes to complete power up.