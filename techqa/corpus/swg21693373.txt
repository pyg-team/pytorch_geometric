Title: IBM Toolbar playback yields ObjectNotFoundException - United States

Text:
ROCR24804; ListaConMenu TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Attempts to playback an RFT 8.6.0.1 script against a .NET toolbar result in "Could not find a ToolBar with name ... ". 

SYMPTOM
The full error message is as follows.


Could not find a ToolBar with name ContextMenuStrip1.
com.rational.test.ft.ObjectNotFoundException
at com.rational.test.ft.object.interfaces.ClientTestObject.invokeProxy(ClientTestObject.java:411)
at com.rational.test.ft.object.interfaces.StatelessGuiSubitemTestObject.click(StatelessGuiSubitemTestObject.java:166)
at ListJava1.testMain(ListJava1.java:37)
at org.eclipse.equinox.internal.app.EclipseAppContainer.callMethodWithException(EclipseAppContainer.java:587)
at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:198)
at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)
at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)
at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:353)
at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:180)
at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:629)
at org.eclipse.equinox.launcher.Main.basicRun(Main.java:584)
at org.eclipse.equinox.launcher.Main.run(Main.java:1438)
at org.eclipse.equinox.launcher.Main.main(Main.java:1414)
at org.eclipse.core.launcher.Main.main(Main.java:34)



The script you playback reads as follows. 

 



Disclaimer All source code and/or binaries attached to this document are referred to here as "the Program". IBM is not providing program services of any kind for the Program. IBM is providing the Program on an "AS IS" basis without warranty of any kind. IBM WILL NOT BE LIABLE FOR ANY ACTUAL, DIRECT, SPECIAL, INCIDENTAL, OR INDIRECT DAMAGES OR FOR ANY ECONOMIC CONSEQUENTIAL DAMAGES (INCLUDING LOST PROFITS OR SAVINGS), EVEN IF IBM, OR ITS RESELLER, HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.



public void testMain(Object[] args) 
{

// Window: ListWithMenu.exe: Form1
listBox1list().click(RIGHT);

// 
contextMenuStrip1toolBar().click(atPath("New"));
}




CAUSE
The recording did not yield proper code for this control.



RESOLVING THE PROBLEM
Consider the following rewrite of the script. 




public void testMain(Object[] args) 
{
startApp("ListWithMenu");
sleep(3);

// Window: ListaWithMenu.exe: Form1
listBox1list().click(RIGHT, getPoint(listBox1list()));
sleep(1);
contextMenuStrip1toolBar().click(atPath("New")); 
}

Point getPoint(TestObject to) {
Rectangle bounds = (Rectangle) to.getProperty("Bounds");
int x = (int) bounds.getCenterX();
int y = (int) bounds.getCenterY();
return new Point(x, y);
}