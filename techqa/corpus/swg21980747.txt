Title: IBM ** Troubleshooting ** Cannot save data changes inside Data Entry forms - no error message, but changes not saved - United States

Text:
cannot save changes inside data entry forms changes lost inside data entry forms data entry forms do not work TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 User clicks "Company - Data Entry - Reported Values" and opens a form. 

User enters some data (for example changes a value in one cell) and presses save.

User then re-opens that same data entry form. The change has not been saved - in other words, the original value is displayed. 

SYMPTOM
In one real-life example, user performed the following steps: 

1. Click "Company - Data Entry - Reported Values"
2. Open a form:
[/support/docview.wss?uid=swg21980747&aid=1] [/support/docview.wss?uid=swg21980747&aid=1]

3. Change the current value of cell F9 (for example, from 100 to 123):
[/support/docview.wss?uid=swg21980747&aid=2] [/support/docview.wss?uid=swg21980747&aid=2]

4. Click 'Save' (either at the top-left corner, or alternatively inside the 'Data Entry Tools' menu)

5. Then click 'Reload Form':
[/support/docview.wss?uid=swg21980747&aid=3] [/support/docview.wss?uid=swg21980747&aid=3]

Notice how the data has changed back to the original (100):
[/support/docview.wss?uid=swg21980747&aid=4] [/support/docview.wss?uid=swg21980747&aid=4]


6. As a different test, change the current value of cell F9 from 100 to 200:
[/support/docview.wss?uid=swg21980747&aid=5] [/support/docview.wss?uid=swg21980747&aid=5]

7. Click 'Save'

8. Then close the Data Entry form, and re-open it (in the same way as steps 1 & 2) 

 * Notice how the value in F9 has *again* changed back to the original (100)


CAUSE
There are several possible causes for the same symptoms: 

 * Scenario #1 - Microsoft bug in early versions of Excel 2007

 * Scenario #2 - Controller application repository database (the one that stores the financial data) using an unsupported (UNICODE) character set.  * In one real-life customer example, the database had the character set: AL32UTF8 character set (and AL16UTF16 NCHAR character set). 
   
   

 * Scenario #3 - Defect (reference APAR PI71027), triggered if one of the accounts requires a mandatory comment, but the user forgets to enter one).


More Information on Scenario #2: 
The Controller system requires two different databases:  * ContentStore - contains the Cognos BI (Report Server) configuration. This is used inside 'Cognos Configuration' 
 * Application Repository - contains all the Controller financial data. This is used inside 'Controller Configuration'


These two databases require different character sets.  * TIP: For full details, see separate Technote #1347750.

ENVIRONMENT
Scenario #2 

Both of the following are true: 

 * Customer's database hosted on Oracle 
 * The database's character set is UNICODE (unsupported).

DIAGNOSING THE PROBLEM
To check your Oracle database's character set, use the instructions inside Technote #1347750.



RESOLVING THE PROBLEM
Scenario #1: 

Patch the client device with the latest Microsoft Office 2007 service pack. 

 * See separate IBM Technote #1506469.


Scenario #2: 
Move the Controller application repository database to a database with a supported character set, specifically:  * NLS_CHARACTERSET = WE8MSWIN1252 
 * NLS_NCHAR_CHARACTERSET = AL16UTF16


After you move your schema to the new (supported character set) database, you will still see the same symptoms.  * This is because there is invalid/corrupt (UNICODE) data in the temporary tables.


The solution is to remove ('drop') these 'bad' temporary tables (which contain the corrupt/UNICODE data). 
 * Steps to remove 'bad' temporary tables:
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * no users in the system
 * 
 * 
 * 
 * 
 *  Due to a defect in Controller (see separate IBM Technote #1978834), after closing Controller there may still be 'processes' stuck inside Oracle. In other words, the Oracle database server may still have Controller-related locks on some of the temporary tables. This can cause the script (see later) to fail Therefore, in an ideal world, the Oracle DBA should now restart the entire Oracle database (containing the schema that Controller is using) immediately before continuing. Naturally, this will cause downtime for any other system that uses the same Oracle database that Controller does.  * Alternatively, you may need to wait for some time (for example an hour or so) for all the Controller-related processes to stop locking the Oracle database tables.
   
   
 * 
 * 
 * 
 * 
 * 
 * using the same user (schema name) as Controller does
 * 
 * 
 * 
 * IMPORTANT
 * 
 *  In other words, use the same user that is mentioned inside the 'User ID' section (inside Controller Configuration), for example: 
 * [/support/docview.wss?uid=swg21980747&amp;aid=6]
 * 
 * 
 * 
 * 
 * 
 * select 'DROP TABLE ' || table_name || '; ' from user_tables where temporary = 'Y' and instrb(table_name,'$') > 0;
 * 
 * 
 * 
 * 
 * [/support/docview.wss?uid=swg21980747&amp;aid=7]
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 *  [/support/docview.wss?uid=swg21980747&amp;aid=8] 
 * 
 * 
 * IMPORTANT
 * 
 * Script Output
 * 
 * 
 *   * 
    * 
    * 
    * 
    * 
    * 
    * 
    * 
    * 
    * 
    * 
    * 
    * 
    * 
    * 
    * 
    * 
    * 
    * 
   
   
 * 
 * 
 * 
 * 
 * 
 *  Ideally get downtime and reboot the entire Oracle database (see above for the reason why), then re-run the same script afterwards  * Or wait for some more time (for example 1 hour or so) and then re-run the same script afterwards
   
   Finally, re-check the 'Script Output' for 'already in use' errors (you can ignore any other messages telling you that the tables no longer exist). 
 * 
 * 
 * 

Scenario #3: 
Upgrade to a future version of Controller which contains a fix for this defect.  * Workaround #1 - User must remember to create a comment *before* saving the data. 
 * Workaround #2 - Untick mandatory comment for the relevant account.


TIP: For full details, see separate IBM Technote #1692574. RELATED INFORMATION
 1978834 - Large number of inactive Oracle processes cre [http://www.ibm.com/support/docview.wss?uid=swg21978834]
1347750 - How to check the Oracle database character se [http://www.ibm.com/support/docview.wss?uid=swg21347750]
1506469 - Data (numbers/figures) are not stored after s [http://www.ibm.com/support/docview.wss?uid=swg21506469]
1692574 - Not possible to save data (inside a Form in D [http://www.ibm.com/support/docview.wss?uid=swg21692574]