Title: IBM System Log messages cannot be viewed after upgrading to Content Manager OnDemand V8.4.1 and running arssyscr -l - United States

Text:
 FLASH (ALERT)

ABSTRACT
 After upgrading to IBM® Content Manager OnDemand server V8.4.1 and running the command, arssyscr [-I <OD_INSTANCE>] -l, OnDemand System Log messages cannot be viewed. The system console throws similar errors:

DB Error: [IBM][CLI Driver] [DB2/AIX64] SQL0421N The operands of a set operator or a VALUES clause do not have the same number of columns. SQLSTATE=42826 -- SQLSTATE=42826, SQLCODE=-421, File=arsdoc.c, Line=2345

DB Error: [IBM][CLI Driver] CLI0102E Invalid conversion. SQLSTATE=07006 -- SQLSTATE=07006, SQLCODE=-99999, File=arsdoc.c, Line=2440 

CONTENT
The database errors are caused by two deprecated System Log columns, DOC_TYPE and RES_COMP_TYPE. Prior to becoming a program product, OnDemand was a services asset that used these columns. 

To update the System Log application group to support a 2000 character message text, the arssyscr [-I <OD_INSTANCE>] -l command replaces the old System Log application group by creating a new updated System Log application group. This new application group will have an application group identifier (AGID) value higher then 5000. The two deprecated columns are only ignored if the AGID is below 5000.

To resolve this issue, perform the following steps:



 1. Confirm the AGID of the new System Log is over 5000. 
    
    SELECT agid FROM arsag WHERE name = 'System Log'
    
    If the AGID value returned is lower then 5000, no action is required. Otherwise, proceed to step 2.
    
    
 2. Backup your OnDemand database.
    
    
 3. Identify the System Log data tables with the deprecated columns:  1. List the System Log data tables:
        
        SELECT table_name FROM arsseg WHERE agid = (SELECT agid FROM arsag WHERE name='System Log')
        
     2. The System Log data tables that contain 20 columns instead of 18 contain the deprecated columns.
        
        
    
    
 4. For each table identified in step 2, drop the two deprecated columns, DOC_TYPE and RES_COMP_TYPE:
    
    ALTER TABLE table_nameDROP COLUMN DOC_TYPE DROP COLUMN RES_COMP_TYPE
    
    Note: It is fine to run this command against System Log data tables that do not contain the deprecated columns. A database error will be thrown, which can be ignored.
    
    
 5. Reorganize each table altered in step 3. For example, in a DB2® database:
    
    REORG TABLE table_name