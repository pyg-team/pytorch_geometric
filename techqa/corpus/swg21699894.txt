Title: IBM Sun ONE LDAP Server DSM Configuration - United States

Text:
Sun ONE LDAP; DSM Configuration TECHNOTE (FAQ)

QUESTION
 This techncial note describes how to configure a QRadar log source to collect events from Sun ONE LDAP servers using the Log File protocol. 

ANSWER
The Sun ONE LDAP DSM for QRadar accepts multiline UDP access and LDAP events from Sun ONE Directory Servers with the log file protocol. 


Configuration overview 

 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * Note
 * 



Step 1: Enabling the event log for Sun ONE Directory Server 
To collect events from Sun ONE Directory Server, you must enable the event log to write events to a file. 

 * Procedure
 *  Log in to your Sun ONE Directory Server console. Click the Configuration tab. From the navigation menu, select Logs. Click the Access Log tab. Select the Enable Logging check box. Type or click Browse to identify the directory path for your Sun ONE Directory Server access logs. Click Save. The configuration of the access log for Sun ONE Directory Server is complete. 
   
   


Step 2: Configuring a Log Source in QRadar 
An administrator must manually create a log source for your Sun ONE Directory Server as QRadar does not automatically discover log file protocol events. 

 * Procedure
 *  Log in to QRadar as an administrator. Click the Admin tab. Click the Log Sources icon. Click Add. In the Log Source Name field, type a name for your log source. In the Log Source Description field, type a description for your log source. From the Log Source Type list box, select Sun ONE LDAP. From the Protocol Configuration list box, select Log File. From the Event Generator list box, select ID-Linked Multiline. In the Message ID Pattern field, type conn=(\d+) as the regular expression that defines your multiline events. Configure the following values: Parameter Description Log Source Identifier Type an IP address, hostname, or name to identify the event source. Service Type From the list box, select the protocol you want to use when retrieving log files from a remove server. The default is SFTP.
    * SFTP - SSH File Transfer Protocol 
    * FTP - File Transfer Protocol 
    * SCP - Secure Copy
      
   
   Note: The underlying protocol used to retrieve log files for the SCP and SFTP service type requires that the server specified in the Remote IP or Hostname field has the SFTP subsystem enabled. Remote IP or Hostname Type the IP address or hostname of the device storing your event log files. Remote Port Type the TCP port on the remote host that is running the selected Service Type. The valid range is 1 to 65535. 
   
   The options include:
    * FTP - TCP Port 21 
    * SFTP - TCP Port 22 
    * SCP - TCP Port 22
   
   
   If the host for your event files is using a non-standard port number for FTP, SFTP, or SCP, you must adjust the port value accordingly. Remote User Type the user name necessary to log in to the host containing your event files. Remote Password Type the password necessary to log in to the host. Confirm Password Confirm the password necessary to log in to the host. SSH Key File If you select SCP or SFTP as the Service Type, this parameter allows you to define an SSH private key file. When you provide an SSH Key File, the Remote Password field is ignored. Remote Directory Type the directory location on the remote host from which the files are retrieved, relative to the user account you are using to log in.
   
   Note: For FTP only. If your log files reside in the remote userâ€™s home directory, you can leave the remote directory blank. This is to support operating systems where a change in the working directory (CWD) command is restricted. Recursive This check box to allow FTP or SFTP connections to recursively search sub folders of the remote directory for event data. Data collected from sub folders is dependent on matches to the regular expression in the FTP File Pattern. 
   
   The Recursive option is not available for SCP connections. FTP File Pattern If you select SFTP or FTP as the Service Type, this option allows you to configure the regular expression (regex) required to filter the list of files specified in the Remote Directory. All matching files are included in the processing.
   
   For example, if you want to list all files starting with the word log, followed by one or more digits and ending with tar.gz, use the following entry: log[0-9]+\.tar\.gz. Use of this parameter requires knowledge of regular expressions (regex). For more information, see the following website: http://download.oracle.com/javase/tutorial/essential/regex/ [http://download.oracle.com/javase/tutorial/essential/regex/] FTP Transfer Mode This option only appears if you select FTP as the Service Type. The FTP Transfer Mode parameter allows you to define the file transfer mode when retrieving log files over FTP.
   
   From the list box, select the transfer mode you want to apply to this log source: 
    * ASCII - Select ASCII for log sources that are standard line-by-line text files. You must select NONE for the Processor parameter and LINEBYLINE the Event Generator parameter when using ASCII as the FTP Transfer Mode. 
    * Binary - Select Binary for log sources that have logs in binary format or are compressed, such as zip, gzip, tar, or tar+gzip archive files.
   
   SCP Remote Files If you select SCP as the Service Type you must type the file name of the remote file. Start Time Type the time of day you want the processing to begin. This parameter functions with the Recurrence value to establish when and how often the Remote Directory is scanned for files. Type the start time, based on a 24 hour clock, in the following format: HH:MM. Recurrence Type the frequency, beginning at the Start Time, that you want the remote directory to be scanned. Type this value in hours (H), minutes (M), or days (D). For example, 2H if you want the directory to be scanned every 2 hours. The default is 1H. Run On Save Select this check box if you want the log file protocol to run immediately after you click Save. After the Run On Save completes, the log file protocol follows your configured start time and recurrence schedule. EPS Throttle Type the number of Events Per Second (EPS) that you do not want this protocol to exceed. The valid range is 100 to 5000. Processor Select None.
   
   This value is used when the files located on the remote host are stored in a zip, gzip, tar, or tar+gzip archive format. Ignore Previously Processed Files Select this check box to track files that have already been processed and you do not want the files to be processed a second time. 
   
   This only applies to FTP and SFTP Service Types. Change Local Directory Select this check box to define the local directory on your QRadar that you want to use for storing downloaded files during processing. Event Generator Select ID-Linked Multiline to process to the retrieved event log as multiline events.
   
   The ID-Linked Multiline format processes multiline event logs that contain a common value at the start of each line in a multiline event message. This option displays the Message ID Pattern field that uses regex to identify and reassemble the multiline event in to single event payload. Message ID Pattern Type conn=(\d+) as the regular expression that defines your multiline events. Folder Separator Type the character used to separate folders for your operating system. The default value is /. 
   
   Most configurations can use the default value in Folder Separator field. This field is only used by operating systems that use an alternate character to define separate folders. For example, periods that separate folders on mainframe systems. Click Save. Click Deploy Changes.