Title: IBM How can I eliminate duplicate records for the same entity in the 'EMAIL_ADDR' table in Identity Insight? - United States

Text:
Identity Insight; EMAIL_ADDR; EMAIL_ADDRESS; EMAIL_ADDR_KEY; BUSKEY; DQM Rule 600 TECHNOTE (FAQ)

QUESTION
 How can I eliminate duplicate records for the same entity in the 'EMAIL_ADDR' table in Identity Insight? 

CAUSE
While adding duplicate data for the same entity, the 'EMAIL_ADDR' table can get populated with duplicate records. This may lead to redundant data in the database if the 'EMAIL ADDRESS' check is not performed against duplicate email addresses for the same entity, which may further lead to performance issues. 

ANSWER
Testing concluded that this issue is related to the DQM rule 600 Data Key. Adding a data key to the email table prevents duplicate entries for the same UMF data.





Steps taken to add a data key to the email table: 

1) Drop and recreate the 'EMAIL_ADDR' table 

Note: This test was done on DB2 so the SQL may be different for Oracle & SQL Server. Also, if records exist in the e-mail table they will need to be exported followed by an import after the table/indexes are recreated. 

bold text is what has changed from the original DDL 

CREATE TABLE "DB2ADMIN"."EMAIL_ADDR" (
"DSRC_ACCT_ID" BIGINT NOT NULL , 
"ADDR_TYPE" VARCHAR(100) NOT NULL , 
"EMAIL_ADDR_ID" BIGINT NOT NULL , 
"ENTITY_ID" BIGINT NOT NULL , 
"EMAIL_ADDR_KEY" VARCHAR(40) NOT NULL,
"EMAIL_ADDR" VARCHAR(255) NOT NULL , 
"EMAIL_NAME" VARCHAR(100) , 
"EMAIL_HOST" VARCHAR(100) , 
"EMAIL_DOMAIN" VARCHAR(100) , 
"COUNTRY_CODE" VARCHAR(3) , 
"EMAIL_HASH" VARCHAR(255) , 
"ADDR_STAT" CHAR(1) NOT NULL , 
"ADDR_STAT_DT" TIMESTAMP , 
"QC_STAT" SMALLINT NOT NULL , 
"VALID_FROM_DT" DATE , 
"VALID_THRU_DT" DATE , 
"SYS_CREATE_DT" TIMESTAMP NOT NULL , 
"SYS_LSTUPD_DT" TIMESTAMP NOT NULL , 
"SYS_DELETE_DT" TIMESTAMP , 
"SYS_DELETE_STAT" CHAR(1) ) 
IN "USERSPACE1" ; 

ALTER TABLE "DB2ADMIN"."EMAIL_ADDR" 
ADD CONSTRAINT "PK_EMAIL_ADDR_BUSKEY" PRIMARY KEY
("ENTITY_ID",
"DSRC_ACCT_ID",
"ADDR_TYPE",
"EMAIL_ADDR_KEY"); 


-- DDL Statements for indexes on Table "DB2ADMIN"."EMAIL_ADDR" 

CREATE INDEX "DB2ADMIN"."IX_EMAIL_ACCT_ID" ON "DB2ADMIN"."EMAIL_ADDR" 
("DSRC_ACCT_ID" ASC)
ALLOW REVERSE SCANS; 

-- DDL Statements for indexes on Table "DB2ADMIN"."EMAIL_ADDR" 

CREATE INDEX "DB2ADMIN"."IX_EMAIL_ADDR" ON "DB2ADMIN"."EMAIL_ADDR" 
("EMAIL_ADDR" ASC)
ALLOW REVERSE SCANS; 

-- DDL Statements for indexes on Table "DB2ADMIN"."EMAIL_ADDR" 

CREATE UNIQUE INDEX "DB2ADMIN"."IX_EMAIL_ADDR_ID" ON "DB2ADMIN"."EMAIL_ADDR" 
("EMAIL_ADDR_ID" ASC)
ALLOW REVERSE SCANS; 

-- DDL Statements for indexes on Table "DB2ADMIN"."EMAIL_ADDR" 

CREATE INDEX "DB2ADMIN"."IX_EMAIL_HASH" ON "DB2ADMIN"."EMAIL_ADDR" 
("EMAIL_HASH" ASC)
ALLOW REVERSE SCANS; 

-- DDL Statements for indexes on Table "DB2ADMIN"."EMAIL_ADDR" 

CREATE INDEX "DB2ADMIN"."PK_EMAIL_BUSKEY" ON "DB2ADMIN"."EMAIL_ADDR" 
("ENTITY_ID" ASC,
"DSRC_ACCT_ID" ASC,
"ADDR_TYPE" ASC,
"EMAIL_ADDR" ASC)
ALLOW REVERSE SCANS;
================================================================== 


2) Add the DQM Rule 600 Key Data to UMF > DQM Rules > EMAIL_ADDR 

General
----------
Segment: EMAIL_ADDR
Oder: 30
UMF Tag Name: EMAIL_ADDR
Function: 600 - Data Key
Correctable: Yes
Status: Active 

Parameters
--------------
Destination UMF Tag: EMAIL_ADDR_KEY
Remove Punctuation: Y
Hash Source UMF Tag 1: EMAIL_ADDR 

Save Changes
==============================


3) Add row in the 'UMF_LOADER_CONFIG' table 

 

./EMAIL_ADDR 1 EMAIL_ADDR EMAIL_ADDR_KEY BUSKEY Char ./EMAIL_ADDR_KEY N Y Save your changes and restart Identity Insight. Please note that the example above is using a DB2 database table. Please contact IBM Identity Insight Support if you are using another database and need assistance modifying the script.