Title: IBM IV91530: ITM KRZ AGENT DOES NOT CORRECTLY LOCATE ALERT LOG FILE IN ORACLE DB 12C - United States

Text:
  FIXES ARE AVAILABLE
ITCAM Extended Agent for Oracle Database: 6.3.1.2-TIV-ITM_KRZ-IF0005 [http://www-01.ibm.com/support/docview.wss?uid=swg24044064]
ITCAM Extended Agent for Oracle Database: 6.3.1.2-TIV-ITM_KRZ-IF0006 [http://www-01.ibm.com/support/docview.wss?uid=swg24044606]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  When the Oracle Database Extended agent monitors Oracle 12c
   database, the query issued to discover the database alert log
   does not correctly locate the database's Alert Log path. This
   only applies to 12c.
   
   
    
   
   

LOCAL FIX
 *  1) Stop the agent
   2) Go to the <AGENT_HOME>/TMAITM_x64 directory
   3) Backup the krzsql.xml file
   4) Modify the following
   
   <SQLInfo ID="GetAlertLogDefinedInformation">
   <DatabaseType value="DG"/>
   <DatabaseType value="ASM"/>
   <DatabaseType value="RDB"/>
     <SQL DBVersion="101">
       <SQLText>
   select  i.instname, p.dump_dir, i.hostname, p.db_name from
   (
   select inst_id, instance_name instname, host_name hostname from
   gv$instance) i,
   (select inst_id, max(case when name='db_name' then value end)
   db_name,
     max(case when name='background_dump_dest' then value end)
   dump_dir from gv$parameter
     where name in ('db_name', 'background_dump_dest') group by
   inst_id
   ) p
   where i.inst_id = p.inst_id
   </SQLText>
       <BaseTable QueryName="GV$INSTANCE"
   GrantName="GV_$INSTANCE"/>
       <BaseTable QueryName="GV$PARAMETER"
   GrantName="GV_$PARAMETER"/>
     </SQL>
   </SQLInfo>
   
   
   To the following
   
   
   <SQLInfo ID="GetAlertLogDefinedInformation">
   <DatabaseType value="DG"/>
   <DatabaseType value="ASM"/>
   <DatabaseType value="RDB"/>
     <SQL DBVersion="101">
       <SQLText>
   select  i.instname, p.dump_dir, i.hostname, p.db_name from
   (
   select inst_id, instance_name instname, host_name hostname from
   gv$instance) i,
   (select inst_id, max(case when name='db_name' then value end)
   db_name,
     max(case when name='background_dump_dest' then value end)
   dump_dir from gv$parameter
     where name in ('db_name', 'background_dump_dest') group by
   inst_id
   ) p
   where i.inst_id = p.inst_id
   </SQLText>
       <BaseTable QueryName="GV$INSTANCE"
   GrantName="GV_$INSTANCE"/>
       <BaseTable QueryName="GV$PARAMETER"
   GrantName="GV_$PARAMETER"/>
     </SQL>
      <SQL DBVersion="120">
       <SQLText>
     select a.instance_name instname,b.value dump_dir,a.host_name
   hostname,c.db_name from
     (select inst_id,instance_name,host_name from gv$instance) a,
     (select inst_id,value from gv$diag_info where name = 'Diag
   Trace') b,
     (select inst_id, max(case when name='db_name' then value end)
   db_name from gv$parameter where name in ('db_name') group by
   inst_id) c
         where a.inst_id=b.inst_id and b.inst_id=c.inst_id
         </SQLText>
       <BaseTable QueryName="GV$INSTANCE"
   GrantName="GV_$INSTANCE"/>
       <BaseTable QueryName="GV$PARAMETER"
   GrantName="GV_$PARAMETER"/>
       <BaseTable QueryName="GV$DIAG_INFO"
   GrantName="GV_$DIAG_INFO"/>
     </SQL>
   </SQLInfo>
   
   5) Save the file
   6) start the agent
   
   
    
   
   

PROBLEM SUMMARY
 *  The issue was caused by oracle changing their alert log location
    in 12c. We updated a query to check the the correct version on
   12c
   
   
    
   
   

PROBLEM CONCLUSION
 *  This request has been resolved in patch
   6.3.1.2-TIV-ITM_KRZ-IF0005. The documentation can be found here:
   https://www-01.ibm.com/support/docview.wss?uid=swg24044064 [https://www-01.ibm.com/support/docview.wss?uid=swg24044064]
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IV91530
   
   
 * REPORTED COMPONENT NAME
   ITCAM EXT AGNT
   
   
 * REPORTED COMPONENT ID
   5724V09OR
   
   
 * REPORTED RELEASE
   631
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt / Xsystem
   
   
 * SUBMITTED DATE
   2016-12-15
   
   
 * CLOSED DATE
   2017-10-19
   
   
 * LAST MODIFIED DATE
   2017-10-19
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   ITCAM EXT AGNT
   
   
 * FIXED COMPONENT ID
   5724V09OR
   
   

APPLICABLE COMPONENT LEVELS
 * R631 PSY
   UP