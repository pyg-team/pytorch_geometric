Title: IBM Weak Hashing Algorithm vulnerability reported on Security Network IPS running firmware 4.x - United States

Text:
weak; certificate; sha1; md5; lmi; cert; hash TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Many vulnerability scanners report "SSL Certificate Signed using Weak Hashing Algorithm" for the certificate, which is retrieved when connecting to the Security Network IPS (GX) on port 443. 

CAUSE
The certificate that is used for SSL by the Proventia Manager Web Interface (commonly referred to as the Local Management Interface or LMI) is preserved when an appliance is upgraded from an earlier version of the software to firmware 4.x. MD5 hashing algorithm was used for older firmware versions, which is now considered vulnerable by most of the scanners.

DIAGNOSING THE PROBLEM
On a Linux server with an openssl client installed, you can run following commands to verify the algorithms that are used by the certificate: 

 1. echo "quit\n" > quit.txt
    
 2. openssl s_client -connect appliance _IP_Address:443 2>&1 < quit.txt | sed -n '/BEGIN CERT/,/END CERT/p' | openssl x509 -text -certopt no_signame | grep "Signature Algorithm"
    
 3. rm -f quit.txt


If you see that the md5 algorithm is in use and you want to use SHA1 instead, follow the instructions in the Resolving the problem section. 
RESOLVING THE PROBLEM
To update the LMI's SSL certificate to use SHA1 as the hashing algorithm, the certificate must be regenerated by running the following command:


genselfcert -i lmi -n appliance_hostname






[/support/docview.wss?uid=swg21514751&aid=1] [http://ibm.biz/KC-SNIPS] [/support/docview.wss?uid=swg21514751&aid=2] [http://ibm.biz/InfraSecForumTechnote] [/support/docview.wss?uid=swg21514751&aid=3] [http://ibm.biz/SecSuptUTube] [/support/docview.wss?uid=swg21514751&aid=4] [http://ibm.biz/InfraSecFixes] [/support/docview.wss?uid=swg21514751&aid=5] [http://ibm.biz/FlexLicLogin] [/support/docview.wss?uid=swg21514751&aid=6] [http://ibm.biz/MyNotification] [/support/docview.wss?uid=swg21514751&aid=7] [http://ibm.biz/ContactSecSupport]