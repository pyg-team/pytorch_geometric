Title: IBM Items migrated from ImagePlus to DB2 Content Manager on z/OS are not being deleted. - United States

Text:
ICMSTITEMSTODELETE; CM; RESOURCEFLAG TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Items migrated from ImagePlus to DB2 Content Manager on z/OS (CM) are not being deleted when requested. The meta data in the Library Server is correctly being deleted. On these requests, no data is being written to the ICMSTITEMSTODELETE table when the api is called to delete the item. All others items types are being placed in the table correctly on a delete request.. 

SYMPTOM
Item meta data is removed from the library server as expected, but no data is being placed in the ICMSTITEMSTODELETE table so the resource manager asynchronous delete job is unable to delete it from OAM.


CAUSE
Third party code that was used to do the migration failed to set the RESOURCEFLAG in the ICMUT000030001 table correctly. If the RESOURCEFLAG has an odd value, like a 65, then the last bit of the flag is off. This bit controls whether the item is considered to be CM controlled or not. If the bit is off, then CM does not control the item and will not delete the item. If it is on, then CM will delete the item and put a record in the ICMSTITEMSTODELETE table for the deleted item.

ENVIRONMENT
z/OS

DIAGNOSING THE PROBLEM
No data in the ICMSTITEMSTODELETE table for a migrated item that has been deleted.

RESOLVING THE PROBLEM
The following are the steps you should do.





 * Using spufi on TSO, check the value of the RESOURCEFLAG in the ICMUT0000300001. 
 *  If it is an odd values like a 65, it needs to be changed to 66. 
 *  Using spufi, do an UPDATE to change the resourceflag for the migrated items to an even number usually one higher than the current odd value. 
 * Once that is done, you should be able to do a delete of the item via your user code or one of the CM clients.