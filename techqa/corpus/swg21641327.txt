Title: IBM WMQ V7 Queue manager on Linux crashes due to a SIGBUS signal sent to process amqrmppa - United States

Text:
SIGBUS crash clusterworkloadexit; XC130004 XC130003 xehExceptionHandler TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 WebSphere MQ (WMQ) V7 for Linux queue manager crashes in amqrmppa process. Cluster workload exit code gets FDCs with probe id XC130004 and/or XC130003 reporting the xehExceptionHandler was called due to SIGBUS errors in clusterworkloadexit. 

SYMPTOM
Multiple queue manager crashes with SIGBUS errors. The issues started with exceptions or crashes in a cluster workload exit. FDC files are generated with the following: (note that the MQM Function stack has rfxCallClusterWorkloadExit just before the FFST is generated.) 


Probe Id :- XC130004 
Probe Id :- XC130003 
Component :- xehExceptionHandler 

Probe Description :- AMQ6109: An internal WebSphere MQ error has occurred.
Comment1 :- SIGBUS: non-existent physical address(0x2aaab8014560) 

MQM Function Stack 
zlaMainThread 
zlaProcessMessage 
zlaProcessMQIRequest 
zlaMQPUT 
zsqMQPUT 
kpiMQPUT 
kqiPutIt 
kqiFastnetSetResolvedQ 
kqiFastnetChooseQueue 
kqiFastnetChooseQueue2 
rfxChooseQ 
rfiChooseOne 
rfxCallWLM 
rfiCallWLMFast 
rfxCallClusterWorkloadExit 
xcsFFST 



CAUSE
This can be caused by any auxiliary scripts or utilities which access the files that are also being used by your exit code. In this case, you had scripts that cleaned up files, which were still in use by your clusterworkloadexit code, causing the exception.


ENVIRONMENT
WebSphere MQ V7.x, Linux



DIAGNOSING THE PROBLEM
FDCs all pointed to crash in clusterworkloadexit.
See Technote 1263631 - Debugging XC130003 [http://www.ibm.com/support/docview.wss?uid=swg21263631] for additional details on diagnosing this type of error. 




RESOLVING THE PROBLEM
The solution is to ensure that your WebSphere MQ exit code has finished accessing any files, before any auxiliary utilities process the files. In cases like this, where the crash is in your exit code, WebSphere MQ trace does not help; you must debug your own exit code.