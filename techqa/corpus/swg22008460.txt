Title: IBM Duplicate Applicability Fixlets and Check Fixlets might cause import errors in BigFix Compliance (BFC Analytics, previously SCA) - United States

Text:
Compliance; sentinel Fixlets; Applicability Fixlets; Check Fixlets; duplicate content; import failure TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 BigFix Compliance (BFC Analytics, previously SCA) users might encounter import errors caused by duplicate Applicability Fixlets and Check Fixlets.

The BigFix Compliance product does not allow a single site to contain multiple copies of the same Applicability or Check Fixlet. To avoid creating duplicate content, it is recommended to use the provided custom checklist wizard to create your custom sites.

The import logs state the error and the ID that can be used to identify the duplicate. 

SYMPTOM
BigFix Compliance does not allow duplicate content within the same site. A common point of import failure in 1.9 ends up being the existence of live duplicates. Duplicate rows that are marked as deleted should not be an issue for import. 

User-created custom checks (that are not simply custom copies of external site check Fixlets) should have uniquely generated SCM-ID fields. These fields are not visible in the BigFix console and the data is embedded in MIME fields. Custom checks should be edited outside of the console environment. 
User creation of custom checks is only recommended for advanced users of the Compliance product or with the proper guidance. 

To view SCM-IDs, export the content into a text editor or run various queries against the BigFix database.

Note:PCI content is unique in that it must be globally unique. Other content only need to be unique within a site.


CAUSE
Duplicate sentinels (Applicability Fixlets) and duplicate checks (Check Fixlets) might cause import failures.


DIAGNOSING THE PROBLEM
The import logs would state detected duplication of either the Applicability Fixlets or the Check Fixlets. 

Note: There are minor wording differences in the import log for sentinel Fixlets between 1.9.73 (patch 2) and 1.9.91 (patch 3).


RESOLVING THE PROBLEM
Since there can be many reasons why duplicates exist, we leave resolving the duplication to the user.

Sentinel Fixlets
Import failures due to duplicate sentinels (also called Applicability Fixlets) happen in the SCM::RawSentinel stage of the ETL. 

The import log would contain a message similar to the following: 

 

 * 
 * 
 * 
 * 
 * 


The ID is the Fixlet ID to make it easier to find the duplication within the console. 

When exporting a sentinel Fixlet, the ID can be found by searching for <Name>x-fixlet-scm-sentinel-id</Name> 

The following query should detect duplicate sentinels: 


select 
ID, 
Sitename, 
dbo.fn_ExtractField('CustomSiteName', 0, Fields) as custom_site_name, 
ParentID, 
Name, 
dbo.fn_ExtractField('MIME_x-fixlet-scm-sentinel-id', 0, Fields) as sentinel_id 
into #sentinels 
from BES_OBJECT_DEFS 
where 
ContentType = 0 
and IsFixlet = 1 
and ParentID = 0 
and dbo.fn_ExtractField('MIME_x-fixlet-scm-sentinel-id', 0, Fields) is not null 
create index sentidx on #sentinels (ID, sentinel_id, Sitename, custom_site_name) 
select f1.ID, f1.sentinel_id, f1.custom_site_name, f1.Name, f2.ID, f2.sentinel_id, f2.custom_site_name, f2.Name 
from #sentinels f1 join #sentinels f2 on f1.sentinel_id = f2.sentinel_id and f1.Sitename = f2.Sitename and f1.custom_site_name = f2.custom_site_name and f1.ID != f2.ID 



Check Fixlets 
Import failures due to duplicate checks (also called Check Fixlets) happen in the SCM::Check stage of the ETL. The import log would contain a message similar to this: 
 * 
 * 
 * 
 * 
 * 


When exporting a check Fixlet, the ID can be found by searching for <Name>x-fixlet-scm-id</Name> 

The following query should detect duplicate check Fixlets:  * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 *