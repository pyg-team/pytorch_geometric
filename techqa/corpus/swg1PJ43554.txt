Title: IBM PJ43554: OPENING CONTENT ENGINE HEALTH PAGE CAUSES LATER SECURITY_ANONYMOUS_DISALLOWED EXCEPTION - United States

Text:
 SUBSCRIBE TO THIS APAR
By subscribing, you receive periodic emails alerting you to the status of the APAR, along with a link to the fix after it becomes available. You can track this item individually or track all items by product.

Notify me when this APAR changes.

Notify me when an APAR for this component changes.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  Opening Process Engine (PE) ping page will generate a
   SECURITY_ANONYMOUS_DISALLOWED exception, if the P8 Health page
   has been previously opened.  There will be no visible errors
   within PE ping page, but the Content Engine error logs will
   contain the following error:
   
   2015-04-24T14:24:22.140 D4236BD9 ENG  FNRCS0001E - ERROR method
   name: <init> principal name:  Global Transaction: null User
   Transaction: null Exception Info: Access to Content Engine was
   not allowed because the request was made anonymously instead of
   by an authenticated user. The application server reported that
   the user was anonymous.
   com.filenet.api.exception.EngineRuntimeException: FNRCS0001E:
   SECURITY_ANONYMOUS_DISALLOWED: Access to Content Engine was not
   allowed because the request was made anonymously instead of by
   an authenticated user. The application server reported that the
   user was anonymous.
       at
   com.filenet.engine.context.SecurityContext.<init>(SecurityContex
   t.java:152)
       at
   com.filenet.engine.context.ServerCallContext.<init>(ServerCallCo
   ntext.java:171)
       at
   com.filenet.engine.context.ServerCallContext.newInstance(ServerC
   allContext.java:1254)
       at
   com.filenet.engine.context.ServerCallContext.newInstance(ServerC
   allContext.java:1248)
       at
   com.filenet.engine.jca.impl.RequestBrokerImpl.getObjects(Request
   BrokerImpl.java:704)
       at
   com.filenet.engine.ejb.EngineCoreBean._getObjects(EngineCoreBean
   .java:208)
       at
   com.filenet.engine.ejb.EngineCoreBean.getObjects(EngineCoreBean.
   java:175)
       at
   com.filenet.engine.ejb.EJSLocalStatelessEngineCore_22877cb1.getO
   bjects(Unknown Source)
       at
   com.filenet.engine.ejb.EngineBean.getObjects(EngineBean.java:448
   )
       at
   com.filenet.apiimpl.transport.ejbstubs.EJSRemoteStatelessEngine_
   2e64c374.getObjects(Unknown Source)
       at
   com.filenet.apiimpl.transport.ejbstubs._Engine_Stub.getObjects(U
   nknown Source)
       at
   com.filenet.apiimpl.transport.ejb.EJBSession$EJBImpl._getObjects
   (EJBSession.java:638)
       at
   com.filenet.apiimpl.transport.ejb.EJBSession$EJBImpl.run(EJBSess
   ion.java:542)
       at
   java.security.AccessController.doPrivileged(AccessController.jav
   a:366)
       at javax.security.auth.Subject.doAs(Subject.java:572)
       at
   com.ibm.websphere.security.auth.WSSubject.doAs(WSSubject.java:19
   5)
       at
   com.ibm.websphere.security.auth.WSSubject.doAs(WSSubject.java:15
   2)
       at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown
   Source)
       at
   sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethod
   AccessorImpl.java:55)
       at java.lang.reflect.Method.invoke(Method.java:619)
       at
   com.filenet.apiimpl.util.J2EEUtilWS.doAs(J2EEUtilWS.java:239)
       at
   com.filenet.apiimpl.transport.ejb.EJBSession$EJBImpl.getObjects(
   EJBSession.java:571)
       at
   com.filenet.apiimpl.transport.ejb.EJBSession.getObjects(EJBSessi
   on.java:471)
       at
   com.filenet.apiimpl.util.SessionHandle.getObjects(SessionHandle.
   java:346)
       at
   com.filenet.apiimpl.core.Session.callGetObjects(Session.java:94)
       at
   com.filenet.apiimpl.core.Session.executeGetObject(Session.java:3
   02)
       at
   com.filenet.apiimpl.core.Session.getProperty(Session.java:425)
       at
   com.filenet.apiimpl.core.Session.getProperty(Session.java:1015)
       at
   com.filenet.api.core.Factory$User.fetchCurrent(Factory.java:294)
       at
   filenet.vw.server.rpc.JAASContext$1.run(JAASContext.java:173)
       at
   filenet.vw.server.rpc.JAASContext$1.run(JAASContext.java:169)
       at
   java.security.AccessController.doPrivileged(AccessController.jav
   a:366)
       at javax.security.auth.Subject.doAs(Subject.java:572)
       at
   com.ibm.websphere.security.auth.WSSubject.doAs(WSSubject.java:19
   5)
       at
   com.ibm.websphere.security.auth.WSSubject.doAs(WSSubject.java:15
   2)
       at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown
   Source)
       at
   sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethod
   AccessorImpl.java:55)
       at java.lang.reflect.Method.invoke(Method.java:619)
       at
   com.filenet.apiimpl.util.J2EEUtilWS.doAs(J2EEUtilWS.java:239)
       at
   com.filenet.api.util.UserContext.doAs(UserContext.java:142)
       at
   filenet.vw.server.rpc.JAASContext.<init>(JAASContext.java:169)
       at
   filenet.vw.server.rpc.JAASContext.getJAASContext(JAASContext.jav
   a:475)
       at
   filenet.jpe.rpc.appserver.PEEngineServlet.authenticate(PEEngineS
   ervlet.java:310)
       at
   filenet.jpe.rpc.appserver.PEEngineServlet.doGet(PEEngineServlet.
   java:384)
       at
   javax.servlet.http.HttpServlet.service(HttpServlet.java:575)
       at
   javax.servlet.http.HttpServlet.service(HttpServlet.java:668)
       at
   com.ibm.ws.webcontainer.servlet.ServletWrapper.service(ServletWr
   apper.java:1230)
       at
   com.ibm.ws.webcontainer.servlet.ServletWrapper.handleRequest(Ser
   vletWrapper.java:779)
       at
   com.ibm.ws.webcontainer.servlet.ServletWrapper.handleRequest(Ser
   vletWrapper.java:478)
       at
   com.ibm.ws.webcontainer.servlet.ServletWrapperImpl.handleRequest
   (ServletWrapperImpl.java:178)
       at
   com.ibm.ws.webcontainer.filter.WebAppFilterManager.invokeFilters
   (WebAppFilterManager.java:1111)
       at
   com.ibm.ws.webcontainer.servlet.CacheServletWrapper.handleReques
   t(CacheServletWrapper.java:87)
       at
   com.ibm.ws.webcontainer.WebContainer.handleRequest(WebContainer.
   java:914)
       at
   com.ibm.ws.webcontainer.WSWebContainer.handleRequest(WSWebContai
   ner.java:1662)
       at
   com.ibm.ws.webcontainer.channel.WCChannelLink.ready(WCChannelLin
   k.java:200)
       at
   com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.handleDiscr
   imination(HttpInboundLink.java:463)
       at
   com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.handleNewRe
   quest(HttpInboundLink.java:530)
       at
   com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.processRequ
   est(HttpInboundLink.java:316)
       at
   com.ibm.ws.http.channel.inbound.impl.HttpICLReadCallback.complet
   e(HttpICLReadCallback.java:88)
       at
   com.ibm.ws.tcp.channel.impl.AioReadCompletionListener.futureComp
   leted(AioReadCompletionListener.java:175)
       at
   com.ibm.io.async.AbstractAsyncFuture.invokeCallback(AbstractAsyn
   cFuture.java:217)
       at
   com.ibm.io.async.AsyncChannelFuture.fireCompletionActions(AsyncC
   hannelFuture.java:161)
       at
   com.ibm.io.async.AsyncFuture.completed(AsyncFuture.java:138)
       at
   com.ibm.io.async.ResultHandler.complete(ResultHandler.java:204)
       at
   com.ibm.io.async.ResultHandler.runEventProcessingLoop(ResultHand
   ler.java:775)
       at
   com.ibm.io.async.ResultHandler$2.run(ResultHandler.java:905)
       at
   com.ibm.ws.util.ThreadPool$Worker.run(ThreadPool.java:1865)
   
   
    
   
   

LOCAL FIX
 *  Do not open P8 Health page
   
   
    
   
   

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED:                                              *
   * Users at sites that make frequent use of the CE Health Page  *
   * servlet with 5.1.0.6-P8CE-FP006 and prior.                   *
   ****************************************************************
   * PROBLEM DESCRIPTION:                                         *
   * A problem in the CE Health Page servlet can corrupt CE Java  *
   * API thread-local storage for web-container worker threads.   *
   * Later web requests that make CE Java API calls can then      *
   * sometimes become confused by that incorrect information,     *
   * leading to intermittent failures or other unexpected         *
   * behavior.                                                    *
   ****************************************************************
   * RECOMMENDATION:                                              *
   * Upgrade promptly to a CE fix pack containing this fix        *
   * 5.1.0.7-P8CE-FP007 or higher. In the meantime, the problem   *
   * can be avoided by not using the CE Health Servlet.           *
   ****************************************************************
   
   
    
   
   

PROBLEM CONCLUSION
 *  The coding error in the Content Engine (CE) Health Page servlet
   has been corrected and the problem eliminated.
   Upgrade to 5.1.0.7-P8CE-FP007 and higher
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PJ43554
   
   
 * REPORTED COMPONENT NAME
   CONTENT ENGINE
   
   
 * REPORTED COMPONENT ID
   5724R8101
   
   
 * REPORTED RELEASE
   510
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt / Xsystem
   
   
 * SUBMITTED DATE
   2015-09-09
   
   
 * CLOSED DATE
   2017-08-11
   
   
 * LAST MODIFIED DATE
   2017-08-11
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
    PJ43446 [http://www-01.ibm.com/support/docview.wss?uid=swg1PJ43446]
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   CONTENT ENGINE
   
   
 * FIXED COMPONENT ID
   5724R8101
   
   

APPLICABLE COMPONENT LEVELS
 * R510 PSY
   UP