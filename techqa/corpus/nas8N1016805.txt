Title: IBM Changing the Logging Level for Host Server Jobs That Are Running as BCI Jobs - United States

Text:
HOSTSERVERS; JOB; JOBLOG; JOBS TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 This document contains an in-depth discussion and an example of changing job settings for server jobs that run as batch immediate rather than prestart jobs. 

RESOLVING THE PROBLEM
Background Information 

When a client using the database host server makes a connection to the IBM i, at least two jobs are involved: the host server daemon job for the function being used and (normally) the prestart job that services the incoming request. Realistically, more than two jobs are involved because other functions (such as signon, licensing, and so on) must also be called to make the connection. However, in this document we will consider only the primary function being called.

Examples



Function / service Daemon Job Server Job Database Access QZDASRVSD QZDASOINIT Remote Command QZRCSRVSD QZRCSRVS 
The host server daemon jobs are started with the STRHOSTSVR command. All the host server daemon jobs can be started by running the STRHOSTSVR *ALL command. Or, selected daemon jobs can be started by prompting the command and specifying only the services to start (*DATABASE, *RMTCMD, and so on). 

The prestart jobs are normally configured to start automatically when the subsystem they run in is started. Or, they can be started manually using the STRPJ command; for example, STRPJ SBS(QUSRWRK) PGM(QZDASOINIT). 

On IBM OS/400 R450 and later, many prestart jobs that had formerly run in other subsystems have been changed so they now run in the QUSRWRK subsystem. If these prestart jobs cannot start in QUSRWRK, they default to starting as BCI (Batch Immediate) jobs in the subsystem that the server daemon for the same function runs in (QSYSWRK for most servers). 

Example: What happens if the QUSRWRK subsystem is not started (using the system's default values): 

A request is received for a database access connection. The system finds the QZDASRVSD daemon job that is running as a BCH (Batch job) in the QSERVER subsystem. The system checks the QYSMSVRE user index to determine where connections of this type from this TCP/IP address should be routed. 

The default for the database access server is a QZDASOINIT prestart job in the QUSRWRK subsystem. Because the QUSRWRK subsystem is not active, the system does not find any QZDASOINIT prestart jobs. The daemon will check the QYSMSVRE index for the alternate action to take when the prestart job is not available. The default action is to run in the default subsystem (the same subsystem that the daemon job is runs in) as a BCI job. The daemon will evoke a batch immediate QZDASOINIT job in the QSERVER subsystem. The BCI job is created using the QZDASRVSD BCH job as a model and all attributes of the new QZDASOINIT BCI job are identical to those of the existing QZDASRVSD batch job. 

The Problem: This can cause confusion when trying to change attributes for the host server BCI jobs. This document addresses the need to change the logging level for a host server job. The default logging level for the QZDASOINIT jobs is set at 4 00 *NOLIST. The text, *NOLIST, tells the system not to spool a job log if the job ends normally. Because many error conditions do not cause a job to end abnormally, it is sometimes desirable to have a job log spooled even though the job ended normally. To do this, the logging level for the job must be set at 4 00 *SECLVL. 

If the QZDASOINIT jobs in the previous example were running as prestart jobs in the QUSRWRK subsystem, the following steps are taken (from an operating system command line) to change the logging level of the prestart jobs: 1. On the operating system command line, type the following:

WRKJOB JOB(QZDASOINIT) 2. Select Option 1 to select any active QZDASOINIT job, and press the Enter key. 3. Select Option 2 to Display job definition attributes, and press the Enter key. 4. Make a note of the Job Description being used and the library it is in (for QZDASOINIT this is typically QDFTJOBD in QGPL). 5. Press the Enter key to leave the Display Job Definition Attributes screen. 6. On the operating system command line, type the following:

WRKJOBD JOBD(QGPL/QDFTJOBD) 7. Select Option 2 to Change QDFTJOBD, and press the Enter key. 8. Press F10 for Additional Parameters, 9. Page down, and locate Message Logging. 10. Make a note of the current value for Message Logging text (you will want to return to this value after collecting your JOBLOG). 11. Change the text value to *SECLVL, and press the Enter key. After making the change, the QZDASOINIT prestart jobs must be ended and restarted for the change to take effect. You might want to do this at a time when no one is using the database host server functions so you do not inadvertently end someone's job. To end and restart the prestart jobs, do the following: a. On the operating system command line, type the following:

ENDPJ SBS(QUSRWRK) PGM(QZDASOINIT) OPTION(*IMMED) b. Once the jobs have ended, on the operating system command type the following:

STRPJ SBS(QUSRWRK) PGM(QZDASOINIT) The newly started prestart jobs will be using a logging level of 4 00 *SECLVL. 

The series of steps above will not work to change the logging level of QZDASOINIT jobs that are running as BCI jobs. The steps are similar. To change the logging level of the QZDASOINIT batch immediate jobs, do the following: 1. On the operating system command line, type the following:

WRKJOB JOB(QZDASRVSD) 2. Select Option 1 to select the active QZDASRVSD job, and press the Enter key. 3. Select Option 40 to Change the job, and press the Enter key. 4. Press F10 for Additional Parameters. 5. Page down, and locate Message Logging. 6. Make a note of the current value for Message Logging text (you will want to return to this value after collecting your job log). 7. Change the text value to *SECLVL, and press the Enter key. Because newly started BCI job attributes are identical to the job attributes of the daemon job (in this case, QZDASRVSD), the daemon job will revert back to its original settings if the daemon is ended and restarted. If the desired outcome is to make a more permanent change to the behavior of the BCI jobs, change the setting in the job description used by the daemon job. 

Summary 

The steps are the same for the other host server functions. Job names, subsystems, and job descriptions vary depending on which function is being configured to create a job log.  


Cross reference information Segment Product Component Platform Version Edition Operating System IBM i 6.1 Operating System IBM i 7.1 
HISTORICAL NUMBER
 28310354