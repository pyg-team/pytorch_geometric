Title: IBM MustGather: DNS Server Issues on the IBM i - United States

Text:
DNS; SERVER TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Data collection for general analysis on DNS Servers for the IBM i operating system. Obtaining this MustGather information before calling IBM Support will help familiarize you with the troubleshooting process and will save time. 

RESOLVING THE PROBLEM
Please use this MustGather document for obtaining all data necessary for troubleshooting DNS issues when the DNS server is located on the IBM System i. You must have access to Client Access for Windows for the DNS GUI interface using iNavigator and a 5250 session screen for releases R610 and R540. 

For anything R710 and above, it is IMPORTANT to know that as of V7R1 the method of updating the DNS configuration has been changed and it is not recommended you use the PC-based System i Navigator. Instead, support has been added to the web-based navigator that runs out of our HTTP ADMIN server. This is the supported mechanism moving forward for all System I Navigator functionality (no further updates will be coming out for the PC-based client). It is important to note that if ANY other method is used, it can cause corruption to the config file.




Note: Refer to Rochester Support Center Knowledgebase document N1017417, Installing iSeries Access From the iSeries for information on installing Client Access for Windows.

Current versions of Client Access for Windows for iOS versions:
V7R3 console, you will need to move to Access client solutions product. [http://www.ibm.com/support/docview.wss?uid=nas8N1010341]

V7R1 (latest can be obtained here [http://www-03.ibm.com/systems/power/software/i/access/windows_sp.html] - note that there is nothing beyond V7R1 as of this writing)
V6R1 SI42423 [http://w3.rchland.ibm.com/projects/CA400/Win32/process/express/drivers/pool/v6r1m0/v0001/SI42423_32.exe] 
V5R4 SI37892 [http://w3.rchland.ibm.com/projects/CA400/Win32/process/express/drivers/v5r4m0/SI37892.exe]

DNS Server general issues specific MustGather information:





1. Determine which DNS Server instance is the primary issue. - There are two easy methods for determining the DNS Server instances on your iSeries:
 *  Method 1 
   Log in to a 5250 session, and do the following: 
   
   1. Copy and paste the following command: 
   
   WRKLNK '/QIBM/USERDATA/OS400/DNS' 
   
   2. Press Enter 
   3. Type 5 on DNS folder 
   4. Press Enter 
   
   List of DNS server in folder [/support/docview.wss?uid=nas8N1010614&aid=1] [/support/docview.wss?uid=nas8N1010614&aid=1] 
   Listed in this directory are folders that contain one or more of your DNS server instances. With the exception of any STMF files or _DYN and collectorfiles (may not exist) folders, one of these is the name of your instance. Now that you know the name of your instance, you can use this information to verify if your instance is currently running in WRKACTJOB or, if required, when a technician needs to obtain data using IBM DNS Collector Tool. 
 *  Note: The job name in WRKACTJOB will be listed as QTOBDXXXXX where XXXXX is the name of your DNS server instance. 

 *  Method 2 
   Another method of obtaining the location or name of your DNS server instance is by using iNavigator. Client Access for Windows will be required for this function. You will want to log in to your iNavigator instance using QSECOFR or equivalent. 
    * Step 1
    * 
    * 
    * 
    * 
    * 
    * iNavigator opened to  [/support/docview.wss?uid=nas8N1010614&amp;aid=2]
    * 
   
   

 *   * Step 2
    * 
    * 
    * 
    * Configuration
    * 
    * Forward Lookup Zone
    * 
    * 
    * 
    * DNS configuration page by right clicking on  [/support/docview.wss?uid=nas8N1010614&amp;aid=3]
   
   

 * 
 * 
 * 
 * Note:
 * 
 *  QTOBDXXXXX 
 * 
 * XXXXX
 * 




2. Turn DNS logging on, if logging is currently off and recreate the error.
How to enable logging for a DNS Server instance  * You can determine if DNS Server logging by verifying your current configuration: 
   
   1. Bring up the Global Properties page for the DNS server: 
   
   DNS instance property selected within iNavigator [/support/docview.wss?uid=nas8N1010614&aid=4] [/support/docview.wss?uid=nas8N1010614&aid=4] 

 * 2. Select the General tab and verify the current debug level. 
   
   General Tab with debug level 5 set within properties page. [/support/docview.wss?uid=nas8N1010614&aid=5] [/support/docview.wss?uid=nas8N1010614&aid=5] 

 * If this has been set to anything other than 5, you should follow the IBM Support Center Knowledgebase document N1010883 , DNS Debugging and Logging: [http://www.ibm.com/support/docview.wss?uid=nas8N1010883] After logging has been properly enabled, you will want to re-create the error. If the main issue is that the DNS instance does not start, you should try to start with logging enabled; logs are still created and may be beneficial to finding a solution. 

 *  Note: DNS instances need to be stopped prior to adjusting any Global Settings. You should refer to the section Enabling Logging Level in IBM Support Center Knowledgebase document N1010883 [http://www.ibm.com/support/docview.wss?uid=nas8N1010883] , DNS Debugging and Logging: which describes proper method for turning on your DNS logging. 



3. Collecting data for your DNS instance.
How to collect data for the iSeries DNS Server instance.  * Ensure that DNS logging is enabled. If you have not reviewed Appendix B of this document, you should do so prior to running the DNS Collector Tool. 
   
   Note: Link to DNS Collector Tool [ftp://public.dhe.ibm.com/services/us/igsc/ews/collectors/DNSCollectorTool.zip] 
   
   1. Type STRQSH 
   2. Type mkdir '/home/dnscollector' 
   3. FTP/Upload DNSCollectorTool.zip file into '/home/dnscollector' 
   4. Type cd /home/dnscollector and press Enter 
   5. Type jar -xf DNSCollectorTool.zip and press Enter 
   6. Type DNSCollector.sh and press Enter 
   
   This script may throw errors; however, you should let it fully run. You will know that it completed successfully when you see the name of the file it created towards the end of the program (for example, /home/prosen/PHIL.0108-0905.DNSCollect.zip. 
   
   This references the 
   Instance name PHIL, 
   Date 0108 
   Time at 9:05 AM. 
   You will also see a $ at the bottom of your screen, notifying you that the collector has completely finished. 


The easiest method to quickly send DNS Collector zip files is by using the automated upload sequence during the beginning process of the DNS collector program. However, if this is unsuccessful, please contact a representative who will be able to assist you. 



Cross reference information Segment Product Component Platform Version Edition Operating System IBM i 6.1 Operating System IBM i 7.1 
HISTORICAL NUMBER
 655030945