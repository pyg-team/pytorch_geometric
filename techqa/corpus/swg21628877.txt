Title: IBM OutOfMemory crashes and heap dumps created due to Crontask instances running on a very small interval - United States

Text:
TPAEPERFORMANCE; OutOfMemory; GC; Crontask; interval TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 On a JVM running cron tasks it crashes with OutOfMemory error and heap dumps created will likely show psdi.server.DBManage instance taking a large amount of the JVM area. 

SYMPTOM
JVM runs out of memory area due to lots of objects added by cron task instance's runs on a too short time interval not letting Garbage Collection (GC) to release them in timely fashion. We will see GC running too frequently and likely high CPU usage followed for a crash with OutOfMemory and heap dump file creation.


CAUSE
The likely reason for the OutOfMemory on such scenario is that JVM Garbage Collection (GC) will be running against the JVM releasing the JVM area for the sessions already finished (cron task instance runs) for more than 10 seconds (if recommended JVM general argument is in place: -Dsun.rmi.dgc.ackTimeout=10000) and it takes a reasonable amount of time for scanning all the JVM area (Maximum Java heap size : 4096m recommended for 64-bits OS) and in the meanwhile for every second (or configured small slice of time) the cron task runs keep adding died sessions to the JVM. GC process will not be able to release the memory on JVM in timely fashion at the speed the objects are added to it. At the end we will get OOM issue on that JVM.

The head dump files will likely reflect the cumulative JVM objects due the cron task runs (likely resultsets of operations against the database) showing psdi.server.DBManage instance taking a large amount of JVM memory area.

ENVIRONMENT
Maximo 7.1 and Maximo 7.5 running over WebSphere.

DIAGNOSING THE PROBLEM
On the SystemOut showing the OutOfMemory issue, we will see cron tasks running on a too short interval. For instance (sample):

[3/17/13 19:08:42:842 CST] 0000003b SystemOut O 17 Mar 2013 19:08:42:842 [INFO] [ibmsample] [] BMXAA6372I - Host name: 99.999.99.999. Server name: ibmsample. Cron task name: IBMCRONSAMPLE.INSTANCE. Last run: 2013-03-17 19:10:16.0

[3/17/13 19:09:42:873 CST] 0000003b SystemOut O 17 Mar 2013 19:09:42:873 [INFO] [ibmsample] [] BMXAA6372I - Host name: 99.999.99.999. Server name: ibmsample. Cron task name: IBMCRONSAMPLE.INSTANCE. Last run: 2013-03-17 19:11:16.0

[3/17/13 19:10:42:919 CST] 0000003b SystemOut O 17 Mar 2013 19:10:42:919 [INFO] [ibmsample] [] BMXAA6372I - Host name: 99.999.99.999. Server name: ibmsample. Cron task name: IBMCRONSAMPLE.INSTANCE. Last run: 2013-03-17 19:12:16.0

By checking on the logs we can see that the cron task schedule run (IBMCRONSAMPLE.INSTANCE) is set to every 1 minute.

RESOLVING THE PROBLEM
Change Crontask instance run schedule for a higher and reasonable interval value so that GC can release the JVM area in timely fashion.