Title: IBM How to collect Tivoli System Automation for Multiplatforms (TSAMP) diagnostics when trace spooling is enabled in an IBM Smart Analytic System? - United States

Text:
trace spooling; ISAS; TSAMP; Tivoli SA MP; IBM Smart Analytics System; spoolto; spoolfrom TECHNOTE (FAQ)

QUESTION
 How to collect Tivoli System Automation for Multiplatforms (TSAMP) diagnostics when trace spooling is enabled in an IBM Smart Analytic System? 

CAUSE
After you configure trace spooling to capture more trace data, you will limit the amount of formatted data by adding the "spoolto" and "spoolfrom" parameters to the getsadata command line.
When trace spooling is configured, more data is available for the diagnostic collection but the formatted data captured by getsadata can grow very large. By default, getsadata will attempt to find 4 days of trace data if no parameters are provided. This document provides example syntax on using timestamp parameters (-spoolfrom YYYY-MM-DD.hh:mm and -spoolto YYYY-MM-DD.hh:mm) to limit the data collected. 

You should use -spoolfrom and -spoolto providing timestamps at or near the time of the problem you are experiencing to limit the size of the getsadata output and avoid extremely long upload times. 

If you need to configure trace spooling, refer to "How to Configure Tivoli System Automation for Multiplatforms (TSAMP) Trace Spooling on an IBM Smart Analytics System" [http://www.ibm.com/support/docview.wss?rs=71&&uid=swg21654104].


ANSWER
How to capture TSAMP spool data for upload to IBM 


The following procedure demonstrates how to capture diagnostic data for TSAMP using the "spoolto" and "spoolfrom" syntax to limit the amount of trace data that is formatted. 

The procedure will capture getsadata as root on the master node first, then capture getsadata on all nodes in parallel. 

1. Determine which machine is master for the Tivoli SA MP cluster

AIX:
dsh -n $BCUADMIN "lssamctrl -V | grep -i master "

Linux:
dsh -N BCUADMIN "lssamctrl -V | grep -i master "

2. Login to the machine acting as the master.

ssh <TSAMP_master_node>

3. Determine the approximate begin and end time of the problem to populate YYYY-MM-DD.hh:mm. Then as root, run 

/<full_path>/getsadata -all -spoolfrom YYYY-MM-DD.hh:mm -spoolto YYYY-MM-DD.hh:mm 

4. Set a Unix environment variable, BCUTEMP, to list the remaining nodes. 

As root on management node, 
export BCUTEMP=<list_of_remaining_nodes_comma_seperated_no_spaces> 

For example, on a cluster with 1 administration node and 3 data nodes. To exclude bcudata02, as root on the management node, run

export BCUTEMP=bcuadmin01,bcudata01,bcudata03

NOTE: After setting a UNIX environment variable, it is valid only in the current session which you set the variable. 

5. Verify BCUTEMP is set correctly. Verify all remaining hosts return output.
In the same session on the management node, run

dsh -n $BCUTEMP hostname

NOTE: AIX and Linux use the same dsh syntax when using Unix environment variables. 

6. Use the approximate begin and end time of the problem to populate YYYY-MM-DD.hh:mm. 
In the same session on the management node, run 

dsh -n $BCUTEMP /<full_path>/getsadata -noprompt -all -spoolfrom YYYY-MM-DD.hh:mm -spoolto YYYY-MM-DD.hh:mm 

7. Use the following link to submit data to IBM. 

"Submitting diagnostic information to IBM Technical Support for problem determination". [http://www.ibm.com/support/docview.wss?rs=71&&uid=swg21243808]

RELATED INFORMATION
 Submit diagnostic data to IBM technical support [http://www.ibm.com/support/docview.wss?uid=swg21243808]
How to configure Tivoli System Automation for Multiplat [http://www.ibm.com/support/docview.wss?uid=swg21654104]