Title: IBM Stopping logger writes for ADRDSSU RESTORE of sphere defined with FRLOG ALL, UNDO or REDO - United States

Text:
DFSMSdss; DFSMShsm; DFSMS; DUMP; COPY; RESTORE; dataset; vsam; sphere; log; logger; logging; logstream; logstreamid; frlog; 5655H9101 R330 5655-H91 5655H91 FMID HCCV330 5655-P30 5655P30 5655P3000 5655Y24 5655-Y24 5655Y2400 R510 HCCV510 HCCV410 HCCV420 HCCV430 TECHNOTE (FAQ)

QUESTION
 You are using the DFSMSdss utility program ADRDSSU to RESTORE a VSAM sphere to a target dataset defined with FRLOG ALL, UNDO, or REDO. You would like to know: Does an ADRDSSU RESTORE to the CICS VSAM Recovery for z/OS (CICSVR) recoverable dataset result in MVS logger activity to the logstream associated with the target VSAM sphere? 

ANSWER
The DFSMSdss ADRDSSU RESTORE command for a VSAM dataset defined in the catalog with the FRLOG(ALL), FRLOG(UNDO), or FRLOG(REDO), will not result in logging activity by CICSVR.

The determination to bypass logging occurs in DFSMS VSAM module(s) IDA0192A (VSAM OPEN string) and IDA019R4 (VSAM Keyed/Addressed Access) by checking the VSAM ACB field ACBNOCVR.

CICSVR can invoke IBM restore utilities as part of the recovery, for example DFSMSdss, DFSMShsm, or ABARS. The DFSMSdss VSAM IO module ADRIOWVS is invoked for all VSAM OPEN, CLOSE, and I/O requests, and sets the ACBNOCVR bit when the ACB is opened to inform VSAM not to invoke CICSVR for logging. DFSMShsm and ABARS use DFSMSdss, so the RESTORE will not call CICSVR for logging. 

Any other utility that uses VSAM macros to perform the restore, will be subject to VSAM checking to see if it needs to invoke CICSVR batch logging. Following are the only other methods to stop logging, other than altering the catalog entry to remove the FRLOG recoverable attributes for the dataset to be restored: 

 * Set the ACBNOCVR flag in the VSAM ACB during OPEN ACB processing.
   
 * Allocate the NEWSPHERE DD in your RESTORE JCL, and specify no logging in the AMP DD FRLOG=NONE subparamter. For example: 
   
   //DS1 DD DSNAME=RESTDSN,AMP=('FRLOG=NONE')
   


If your RESTORE utility only allows for internal dynamic allocation and if you have access to an OPEN exit routine for your RESTORE utility, you can set the ACBNOCVR bit and VSAM will not call CICSVR for logging. RELATED INFORMATION
#Restore commands for DFSMSdss [http://pic.dhe.ibm.com/infocenter/zos/v2r1/topic/com.ibm.zos.v2r1.adru000/restorec.htm]
Aggregate Backup and Recovery Support (ABARS) [http://pic.dhe.ibm.com/infocenter/zos/v2r1/topic/com.ibm.zos.v2r1.arcf000/abarsp.htm]
IDCAMS DEFINE CLUSTER - FRLOG() operand [http://pic.dhe.ibm.com/infocenter/zos/v2r1/topic/com.ibm.zos.v2r1.idat300/defclu.htm]
MVS JCL AMP subparameter options including FRLOG [http://pic.dhe.ibm.com/infocenter/zos/v2r1/topic/com.ibm.zos.v2r1.ieab600/iea3b6_Subparameter_definition1.htm]





Cross reference information Segment Product Component Platform Version Edition Storage Software DFSMS DFSMSdss Storage Software DFSMS DFSMShsm Storage Software DFSMS CICSVR 
PRODUCT ALIAS/SYNONYM
 CICSVR CICS VR