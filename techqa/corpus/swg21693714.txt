Title: IBM Microsoft Exchange agent fails to start after the ITM upgrade to 6.3 - United States

Text:
kdebe module unavailable GSKit global security kit GSK7 GSK8 registry start fails stop terminate path TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 After the upgrade of the OS agent to version 6.3, the Microsoft Exchange agent (EX) fails to start.

The Windows OS agent is starting up fine, so this is a problem with the installation of ITM 6.3, where the Microsoft Exchange agent has troubles to handle GSKit v8. 

SYMPTOM
Agent log shows:

(5487F18D.001E-FC4:kdebprc.c,1309,"static_constructor") SSL interface module kdebe unavailable
...
(5487F18D.0020-FC4:kde1lsd.c,708,"bind_setup") Transport not found: IP.SPIPE
(5487F18D.0021-FC4:kde1lsd.c,708,"bind_setup") Transport not found: SNA
(5487F18D.0022-FC4:kde1lsd.c,708,"bind_setup") Transport not found: IP6.SPIPE
(5487F18D.0023-FC4:kde1kwd.c,115,"KDE1I_Keyword") KDE_TRANSPORT error, "use:n" ignored
(5487F18D.0024-FC4:kde1kwd.c,118,"KDE1I_Keyword") Status 1DE00043=KDE1_STC_KEYWORDVALUEIGNORED
...


CAUSE
In the Windows registry, the agent configuration is still pointing to the old GSKit v7.

ENVIRONMENT
ITM 6.3 and ITCAM for MS Applications 6.3 or 6.3.1 agents

DIAGNOSING THE PROBLEM
The PATH in the registry key HKEY_LOCAL_MACHINE\SOFTWARE\Candle\KEX\Ver610\hostname\Environment is still pointing to GSK7 instead of GSK8.




For example:
PATH="C:\IBM\ITM\GSK7\lib;C:\IBM\ITM\TMAITM6;C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbem;C:\IBM\ITM\bin;C:\IBM\ITM\TMAITM6;C:\IBM\ITM\InstallITM;C:\IBM\ITM\InstallITM"


RESOLVING THE PROBLEM
Go into the registry, and modify the above registry value so that it points to GSK8 instead of GSK7, for example: 

PATH="C:\IBM\ITM\GSK8\lib;C:\IBM\ITM\TMAITM6;C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbem;C:\IBM\ITM\bin;C:\IBM\ITM\TMAITM6;C:\IBM\ITM\InstallITM" 

 

For 64-bit agent, it will need to become: 

PATH="C:\IBM\ITM\GSK8_x64\lib64;C:\IBM\ITM\TMAITM6_x64;C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbem;C:\IBM\ITM\bin;C:\IBM\ITM\TMAITM6;C:\IBM\ITM\InstallITM" 


Next, reconfigure the Microsoft Exchange agent and start it. 

 

Additional comments:
The PATH has to be updated because the installer on the Exchange agent CD/DVD (and any other ITCAM for MS Apps agent) is not at the latest level, causing the PATH and PATH! variables in the ENV file to be sequenced incorrectly.
The fix has been made to the installer, and the ITCAM for MS Applications agents must pick up the fix in order for the variables to be sequenced correctly.
The APAR is IV44123 and it was included in 6.2.3 FP5 and 6.3.0 FP3.

As far as the Exchange agent is concerned the MS APPs installer needs to be updated in the next major release. APAR IV74419 has been opened to track this issue for the ITCAM for MS Apps agents.

 

PRODUCT ALIAS/SYNONYM
 ITM ITCAM Exchange agent