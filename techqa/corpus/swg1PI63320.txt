Title: IBM PI63320: AUTHORING TEMPLATE CAN'T BE SAVED IF REFERRED BY INVALID ITEM - United States

Text:
  A FIX IS AVAILABLE
Fixes integrated in WebSphere Portal 8.5.0.0 Combined Cumulative Fixes [http://www-01.ibm.com/support/docview.wss?uid=swg24037786]



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  Authoring template can't be saved if it is referred by any
   
   invalid item which doesn't exist in repository any more. The
   
   following Exception can be seen when WCM traces are enabled.
   
   
   
   [13/05/16 10:10:03:691 CEST] 00001d0c VersionNode   1
   
   REPOS_EXCEPTION_CAUGHT_DURING_SAVE
   
   com.ibm.workplace.wcm.services.repository.RepositoryException:
   
   Nachricht: PrivilegedActionException caught, Ursache:
   
   com.ibm.icm.jcr.ReferentialIntegrityException: RT0002E: Fehler
   
   beim Aufruf der Funktion updateItems vom PLS-Datenmanager:
   
   RT0002E: Fehler beim Aufruf der Funktion updateItems vom
   
   PLS-Datenmanager
   
   at com.ibm.workplace.wcm.services.repository
   
   .PACServiceImpl.handleUnrestrictedException(PACServiceImpl
   
   .java:1946)
   
   at com.ibm.workplace.wcm.services.repository
   
   .PACServiceImpl.runAsPrivileged(PACServiceImpl.java:1888)
   
   at com.ibm.workplace.wcm.services.transaction.steps
   
   .versioning.VersionNode.versionNode(VersionNode.java:340)
   
   at com.ibm.workplace.wcm.services.transaction.steps
   
   .versioning.VersionNode.execute(VersionNode.java:219)
   
   at com.ibm.workplace.wcm.services.transaction
   
   .CompositeTransactionStep.execute(CompositeTransactionStep
   
   .java:159)
   
   at com.ibm.workplace.wcm.services.transaction.steps
   
   .repository.RepositoryUpdate.execute(RepositoryUpdate.java:246)
   
   
   Caused by: com.ibm.icm.jcr.ReferentialIntegrityException:
   
   RT0002E: Fehler beim Aufruf der Funktion updateItems vom
   
   PLS-Datenmanager: RT0002E: Fehler beim Aufruf der Funktion
   
   updateItems vom PLS-Datenmanager
   
   at com.ibm.icm.jcr.NodeImpl.save(NodeImpl.java:2795)
   
   at com.ibm.icm.jcr.NodeImpl.save(NodeImpl.java:2523)
   
   at com.ibm.workplace.wcm.services.transaction.steps
   
   .versioning.VersionNode$1.run(VersionNode.java:394)
   
   at com.ibm.wps.ac.impl.UnrestrictedAccessImpl
   
   .run(UnrestrictedAccessImpl.java:84)
   
   at com.ibm.wps.command.ac.ExecuteUnrestrictedCommand
   
   .execute(ExecuteUnrestrictedCommand.java:90)
   
   at com.ibm.workplace.wcm.services.repository
   
   .PACServiceImpl.runAsPrivileged(PACServiceImpl.java:1878)
   
   ... 144 more
   
   
   
   Analysis:the reference list should be scanned to remove invalid
   reference.
   
   
   Solution: WCM Configuration property template.checkreference
   was introduced.
   
   
   If template.checkreference=true, the reference list will be
   always scanned before the authoring template is saved.
   
   
    
   
   

LOCAL FIX
 *  None available
   
   
    
   
   

PROBLEM SUMMARY
 *  Authoring template can't be saved if it is referred by any
   invalid item which doesn't exist in repository any more. The
   following Exception can be seen when WCM traces are enabled.
   
   
   [13/05/16 10:10:03:691 CEST] 00001d0c VersionNode   1
   
   REPOS_EXCEPTION_CAUGHT_DURING_SAVE
   
   com.ibm.workplace.wcm.services.repository.RepositoryException:
   
   Nachricht: PrivilegedActionException caught, Ursache:
   
   com.ibm.icm.jcr.ReferentialIntegrityException: RT0002E: Fehler
   
   beim Aufruf der Funktion updateItems vom PLS-Datenmanager:
   
   RT0002E: Fehler beim Aufruf der Funktion updateItems vom
   
   PLS-Datenmanager
   
   at com.ibm.workplace.wcm.services.repository
   
   .PACServiceImpl.handleUnrestrictedException(PACServiceImpl
   
   .java:1946)
   
   at com.ibm.workplace.wcm.services.repository
   
   .PACServiceImpl.runAsPrivileged(PACServiceImpl.java:1888)
   
   at com.ibm.workplace.wcm.services.transaction.steps
   
   .versioning.VersionNode.versionNode(VersionNode.java:340)
   
   at com.ibm.workplace.wcm.services.transaction.steps
   
   .versioning.VersionNode.execute(VersionNode.java:219)
   
   at com.ibm.workplace.wcm.services.transaction
   
   .CompositeTransactionStep.execute(CompositeTransactionStep
   
   .java:159)
   
   at com.ibm.workplace.wcm.services.transaction.steps
   
   .repository.RepositoryUpdate.execute(RepositoryUpdate.java:246)
   
   
   Caused by: com.ibm.icm.jcr.ReferentialIntegrityException:
   
   RT0002E: Fehler beim Aufruf der Funktion updateItems vom
   
   PLS-Datenmanager: RT0002E: Fehler beim Aufruf der Funktion
   
   updateItems vom PLS-Datenmanager
   
   at com.ibm.icm.jcr.NodeImpl.save(NodeImpl.java:2795)
   
   at com.ibm.icm.jcr.NodeImpl.save(NodeImpl.java:2523)
   
   at com.ibm.workplace.wcm.services.transaction.steps
   
   .versioning.VersionNode$1.run(VersionNode.java:394)
   
   at com.ibm.wps.ac.impl.UnrestrictedAccessImpl
   
   .run(UnrestrictedAccessImpl.java:84)
   
   at com.ibm.wps.command.ac.ExecuteUnrestrictedCommand
   
   .execute(ExecuteUnrestrictedCommand.java:90)
   
   at com.ibm.workplace.wcm.services.repository
   
   .PACServiceImpl.runAsPrivileged(PACServiceImpl.java:1878)
   
   ... 144 more
   
   
   
   Analysis:the reference list should be scanned to remove invalid
   reference.
   
   
   Solution: WCM Configuration property template.checkreference
   was introduced.
   
   
   If template.checkreference=true, the reference list will be
   always scanned before the authoring template is saved.
   
   
    
   
   

PROBLEM CONCLUSION
 *  A code fix for this issue is integrated into the WebSphere
   Portal & WCM Combined Cumulative Fix 12 (PI64037) for Portal
   8.5.0.0 available from Fix Central:
   
   
   http://www-933.ibm.com/support/fixcentral/swg/selectFixes?parent
   =ibm/WebSphere&product=ibm/WebSphere/WebSphere+Portal&release=Al [http://www-933.ibm.com/support/fixcentral/swg/selectFixes?parent=ibm/WebSphere&product=ibm/WebSphere/WebSphere+Portal&release=Al]
   l&platform=All&function=aparId&apars=PI64037
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PI63320
   
   
 * REPORTED COMPONENT NAME
   LOTUS WEB CONT
   
   
 * REPORTED COMPONENT ID
   5724I2900
   
   
 * REPORTED RELEASE
   850
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt / Xsystem
   
   
 * SUBMITTED DATE
   2016-05-30
   
   
 * CLOSED DATE
   2016-09-11
   
   
 * LAST MODIFIED DATE
   2016-09-11
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   LOTUS WEB CONT
   
   
 * FIXED COMPONENT ID
   5724I2900
   
   

APPLICABLE COMPONENT LEVELS
 * R850 PSY
   UP