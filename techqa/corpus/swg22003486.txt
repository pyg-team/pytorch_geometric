Title: IBM MustGather: Collecting data for Guardium v10 Windows S-TAP - United States

Text:
S-TAP; WIndows; Mustgather; v10 TECHNOTE (FAQ)

QUESTION
 If there is a problem with the Guardium v10 Windows S-TAP, what information must be gathered before contacting IBM Support? 

ANSWER



YouTube Video Collecting data for Guardium v10 Windows S-TAP (8:14) How to collect must gather information for Guardium v10 Windows S-TAP. Watch the video on YouTube [https://www.youtube.com/watch?v=iKbhN12VWmI&list=PLFip581NcL2WzC2LpTMT28rml3br5WO9V] (8:14) 

There are two types of must gather diagnostic for the v10 Windows S-TAP. "Snap" Files 

Provide a snapshot of what the S-TAP is capturing and how it is behaving for a specific duration. When running a snap diagnostic it is important to run the activity you wish to troubleshoot during this duration. Files look like:
drv.wstap.<S-TAP host>.<Date_time log was run>.ctl
snap.wstap.<S-TAP host>.<Date_time log was run>.log


"Diag" Files 

Provide configuration information and static logs about the S-TAP and server. File looks like:
diag.wstap.<S-TAP host>.<Date_time log was run>.diag

Or when obtained directly from the Windows Server, there are a number of files in:
<S-TAP install directory>/bin/diag


How to run from the collector where the S-TAP is connected 

Combined snap and diag 

1. Navigate to GUI -> Manage -> Activity Monitoring -> S-TAP Control 

2. For the S-TAP host in question select the "send command" icon ([/support/docview.wss?uid=swg22003486&amp;aid=1]) and select "STAP Logging" in the dropdown. 

3. Set the level to 7 to provide the best level of logging detail for the snap files. 

4. Set the duration to a number of seconds where you can reproduce the problem. 

5. Set the filters that will apply to the traffic captured in the snap diag. For example to collect only traffic from a specific client ip, enter that ip in the "Client Ip" field. If you are unsure of the filters it is better to not apply any, to be sure the problem is captured. 

6. "Format" relates to the display of data in the logs, do not change this unless directed by support. 

7. Select "Run Diagnostics" to include the diag files. 

8. Select "Create STAP Memory Dump" if directed by support. In most cases it is not required. 

9. "Apply" to start the diag. After the duration is completed and logs have been sent to the appliance they will be available in GUI -> Manage -> Maintenance -> Support Information Results 

 

How to run directly on the Windows server 

Snap files 

1. Create a file in <S-TAP install directory>/bin. The file should be called: 

<level (7 unless otherwise directed)>.<duration in seconds>.snap 

for example: 7.60.snap 

Be sure the file does not have any other extension e.g. .txt otherwise it will not be recognized. 

2. If the S-TAP is running it will periodically check for this file and start the diag if it exists. The .snap file will disappear at this point. 

3. Collect the files from the Collector GUI (point 9 above) or if there is no connection, from <S-TAP install directory>/logs 

Diag files 

1. Run the "diag.bat" batch file from <S-TAP install directory>/bin 

or 

Run the "Run Diagnostics" program from the Start Menu 

2. A cmd window will pop up showing the progress. When it is done, collect all the files from <S-TAP install directory>/diag. 

Note for diag run direct on the server, the files will not be uploaded to the collector.

RELATED INFORMATION
 Diag.bat details [http://www-01.ibm.com/support/docview.wss?uid=swg21579969]
v9 S-TAP Mustgather [http://www-01.ibm.com/support/docview.wss?uid=swg21606592]