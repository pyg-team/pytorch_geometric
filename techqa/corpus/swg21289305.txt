Title: IBM DWWBAJFS not started by CICS VR after cancelling recoverable VSAM batch job - United States

Text:
undo; redo; automatic; sync; cont; abend; DWWBAJFS DWW267I DWW268I 73050090 RC24 ; RC 24; 00000024 ; 4.2 R420 R42E R42K HCCV420 JCCV42E JCCV42K 4.3 5655P3000 R430 R43E R43K 5655-P30 5655P30 FMID HCCV430 JCCV43E JCCV43K 5.1 5655Y2400 R510 R51C R51E R51K 5655-Y24 5655Y24 FMID HCCV510 JCCV51E JCCV51K TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 You cancel a batch job that is processing a VSAM file defined with the FRLOG(ALL) attribute. However, CICS VSAM Recovery (CICS VR) does not submit automatic recovery job DWWBAJFS. You receive message DWW267I and DWW268I with with reason code 73050090 (RSN73050090).



SYMPTOM
Your CICS VR server is started with options CICSVR_UNDOLOG_CONTROL(ENABLE CONT) and CICSVR_BACKOUT_CONTROL(SUBMIT ABEND) in SYS1.PARMLIB member IGDSMSxx.

Following are the messages you receive:
DWW267I VSAM BATCH REDO LOGGING FAILED.
ASID (IN HEX): 0033 
RETURN CODE (IN HEX): 00000024
REASON CODE (IN HEX): 73050090

DWW268I VSAM BATCH UNDO LOGGING FAILED.
ASID (IN HEX): 0033
RETURN CODE (IN HEX): 00000024
REASON CODE (IN HEX): 73050090


CAUSE
The logger address space was processing on behalf of the batch job at the time it was cancelled resulting in a logger failure.

DIAGNOSING THE PROBLEM
The processing logic for automatic batch backout processing at the CICS VR begins when DWW1SEOX runs for End-of-Task in the user address space. When DWW1SEOX runs it does the following: 

 * A PC to the CICS VR server address space 
 * A Call to the VBLEndOfTASKProcesso procedure to write the EBAI record to the RCDS


DWW3GREM in the CICS VR server Backout_Submit routine will issue a DWW3CVRM macro to run the DWWBAJFS batch job. The key here appears to be the DWW267I and DWW268I logger failure messages for the REDO and UNDO logs respectively. The reason code x'73050090' indicates some type of logger failure in addition to the job being cancelled. 
RESOLVING THE PROBLEM
The only method to improve the ability to perform automatic undo logging is to set the CICSVR_UNDOLOG_CONTROL string to ENABLE SYNC. This ensures that the VSAM updates will be successfully written to the logstream. 


With ENABLE CONT it is possible that records might not have been successfully written to the undo logstream so an automatic backout is not possible. In this case, the VSAM sphere would need to be restored from a backup and recovered.


See the following note in the CICS VR Implementation Guide and Reference in the CICS TS 5.1 information center in section Setting the CICS VR backout control string [http://pic.dhe.ibm.com/infocenter/cicsts/v5r1/index.jsp?topic=%2Fcom.ibm.cics.cvr.doc%2Fdwwig%2Fdwwig000101.html]: 


 * Note:
 *  In the situation where
 *  SUBMIT ABEND is the currently active backout control string ENABLE SYNC is the currently active undo logging control string 
 * and an undo logging error occurs, CICS VR cancels the batch job, and attempts to automatically submit a batch backout job to remove the updates that were made to the VSAM spheres by the batch job step which was in progress when the logging error occurred.
 * 


Here is how you would specify these parameters:  * 
 * ENABLE SYNC
 * 
 * 
 * 
 * SUBMIT ABEND
 * 
 * 


Running with ENABLE SYNC does add significant overhead when running the batch job. 



RELATED INFORMATION
#Activating CICSVR batch logging overview [http://pic.dhe.ibm.com/infocenter/cicsts/v5r1/index.jsp?topic=%2Fcom.ibm.cics.cvr.doc%2Fdwwig%2Fdwwig00080.html]




PRODUCT ALIAS/SYNONYM
 CICSVR CICS VR