Title: IBM modify-servlet-path-portlets fails with ConnectorNotAvailableException - United States

Text:
ConnectorNotAvaliableException; EJPXA0043E; configEngine task fails; Portal URI TECHNOTE (TROUBLESHOOTING)

PROBLEM
Changing the Portal URI fails on the step when running modify-servlet-path-portlets task. The configTrace.log will note an xmlaccess exception ConnectorNotAvailableException

SYMPTOM
modify-servlet-path-portlets configengine task fails and configTrace.log notes:

[xmlaccess] EJPXB0006I: Connecting to URL

localhost:10039/<new context root>/config/

[xmlaccess] EJPXB0002I: Reading input file
/opt/IBM/WebSphere/Profiles/wp_profile/ConfigEngine/config/work/AllPortl
ets_modified.xml
[xmlaccess] <?xml version="1.0" encoding="UTF-8"?>
[xmlaccess] <!-- IBM WebSphere Portal/8.0.0.1 build wp8001CF09_001_27
exported on Fri Jan 24 17:27:19 EST 2014 from nn00413/10.134.65.44 -->
[xmlaccess] <request build="wp8001CF09_001_27" type="update"
version="8.0.0.1" xmlns:xsi="<url removed>"

xsi:noNamespaceSchemaLocation="PortalConfig_8.0.0.xsd">
[xmlaccess] <status element="[web-app Z1_CGAH47L00OKOF0I7MORRUO20K1
uid=com.ibm.wps.banner]" result="failed">
[xmlaccess] <message id="EJPXA0043E">EJPXA0043E: An error
occurred while creating or updating the resource.</message>
[xmlaccess] <message id="EJPPD0015E">EJPPD0015E: Portlet
application manager failed when user xmlaccess scripting user executed
command UpdateWebApplication.</message>
[xmlaccess] <message id="EJPPE0001E">EJPPE0001E: Instantiation
of the WebSphere Application Server administration manager
failed.</message>
[xmlaccess] <message id="EJPPH0007E">EJPPH0007E: Instantiation
of the administration module for Portal context failed.</message>
[xmlaccess] <message id="EJPPH0010E">EJPPH0010E: Failed to
retrieve and initialize administration runtime variables from
Application Server.</message>
[xmlaccess]
<message>com.ibm.websphere.management.exception.ConnectorNotAvailableExc
eption</message>
[xmlaccess] <stacktrace><![CDATA[
[xmlaccess] com.ibm.wps.command.xml.XmlCommandException: EJPXA0043E: An
error occurred while creating or updating the resource. [web-app
Z1_CGAH47L00OKOF0I7MORRUO20K1 uid=com.ibm.wps.banner]
[xmlaccess] at
com.ibm.wps.command.xml.ConfigItem.doUpdate(ConfigItem.java:610)
[xmlaccess] at
com.ibm.wps.command.xml.UpdateEngine.processItem(UpdateEngine.java:216)
[xmlaccess] at
com.ibm.wps.command.xml.UpdateEngine.updateTopLevelItem(UpdateEngine.jav
a:171)
...
[xmlaccess] Caused by:
com.ibm.websphere.management.exception.ConnectorNotAvailableException
[xmlaccess] at
com.ibm.ws.management.discovery.Utils.getParentAdminClient(Utils.java:16
7)



CAUSE
The reason this error occurs is the initial IPv6 lookup times out after 30 seconds and then reverts to IPv4 which works.

ENVIRONMENT
Portal v8.0.0.1 CF09 on Linux OS

DIAGNOSING THE PROBLEM
Reviewing the wpcollector output, the SystemOut.log noted the Portal Server starts up, but the node discovery occurs after the task fails so explains why we see the com.ibm.websphere.management.exception.ConnectorNotAvailableException message.

[1/28/14 20:01:17:835 EST] 00000000 WsServerImpl A WSVR0001I: Server WebSphere_Portal open for e-business
... 30 seconds later ...
[1/28/14 20:01:47:878 EST] 00000041 DiscoveryMBea I ADMD0023I: The system discovered process (name: nodeagent, type: NodeAgent, pid: 19611)


RESOLVING THE PROBLEM
To resolve the problem we need to set the configuration so that IPv4 is preferred.

This is done by setting -Djava.net.preferIPv4Stack=true for all JVMs in the cell:

Information can be found in following link:

www-01.ibm.com/support/docview.wss?uid=swg21170467