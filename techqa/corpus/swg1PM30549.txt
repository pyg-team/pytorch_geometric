Title: IBM PM30549: WHEN USING JMS V7 CODE WITH WAS THE INCORRECT USERID IS BEING PASSED AND CAUSING MANY ICH408I AND RC=2035 - United States

Text:
z/os SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS DUPLICATE OF ANOTHER APAR.
    
   
   

ERROR DESCRIPTION
 *  The customer upgraded one of their queue managers in the
   development environment a few months ago but left the HFS at
   v6.0.2.6 due to compatibility issues with their current version
   of WAS. Once they upgraded their WAS to 6.1.0.32, they upgraded
   the HFS to 7.1.0. The WAS regions were cycled after the HFS
   upgrade. All WAS regions on that system are getting receiving
   ICH408I RACF violations in the MSTR. WAS log shows the
   following entries:
   .
   +BBOO0222I: J2CA0056I: The Connection Manager received a fatal
   connection error from the Resource Adapter for resource
   jms/MQ_CONNECTION.  The exception which was received is
   com.ibm.msg.client.jms.DetailedJMSSecurityException:
   JMSWMQ2008: Failed to open MQ queue 'MY.REQUEST.QUEUE'. JMS
   attempted to perform an MQOPEN, but WebSphere MQ reported an
   error. Use the linked exception to determine the cause of this
   error. Check that the specified queue and queue manager are
   defined correctly.:com.ibm.mq.MQException: JMSCMQ0001:
   WebSphere MQ call  failed with compcode '2' ('MQCC_FAILED')
   reason '2035'
   +BBOO0156I CONTINUATION 0001 FOR BBOO0222I ON TCB=007C0718  577
   ('MQRC_NOT_AUTHORIZED').
   .
   The customer found that different userids are being passed
   depending on the level of JMS code is used:
   With V6.0.2.6 - Service userid is passed which is expected
   With V7.0.1.2 - The WAS address space userid is passed
   .
   The change team has been able to reproduce this issue on their
   test systems, and have confirmed that the issue is caused by
   the MQ JMS code. At MQ V701 the JMS code does not correctly set
   the necessary options to allow the queue manager to populate a
   JMS Session's connection with the userid established when the
   JMS Connection was created.
   .
   This results in the application server's userid being used for
   all MQ work performed by JMS Sessions.
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY

PROBLEM CONCLUSION

TEMPORARY FIX

COMMENTS
 *  Problem summary:
   Users of the WebSphere MQ V7 classes for Java Message Service
   (JMS) in WebSphere Application Server for z/OS can use the RunAs
   and Sync-To-Thread settings to associate the userid of the
   current application with bindings mode connections to MQ.
   
   When these options are used, the WMQ V7 classes for JMS fail to
   use the application's userid, and incorrectly associate the
   Application Server's userid with the MQ connections.
   
   This can cause MQ requests requiring authorization to fail with
   reason code 2035 (MQRC_NOT_AUTHORIZED).
   
   Security manager access failure messages (for example ICH408I
   message from RACF) may also be seen for the WSAS server userid
   accessing MQ security profiles.
   
   Problem resolution:
   The WMQ V7 classes for JMS have been updated so that JMS
   Sessions correctly set the userid for their connection to MQ
   when the RunAs and Sync-To-Thread options are used.
   
   This fix changes the Java component of MQ, and will be
   included in FixPack 7.0.1.6 (PM32344 [http://www-01.ibm.com/support/docview.wss?uid=swg1PM32344]).
   
   
    
   
   

APAR INFORMATION
 * APAR NUMBER
   PM30549
   
   
 * REPORTED COMPONENT NAME
   WMQ Z/OS V7
   
   
 * REPORTED COMPONENT ID
   5655R3600
   
   
 * REPORTED RELEASE
   018
   
   
 * STATUS
   CLOSED DUB
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2011-01-14
   
   
 * CLOSED DATE
   2011-02-28
   
   
 * LAST MODIFIED DATE
   2011-07-29
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION

APPLICABLE COMPONENT LEVELS