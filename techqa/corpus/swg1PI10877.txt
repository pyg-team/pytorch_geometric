Title: IBM PI10877: MESSAGES ARE NOT CONSUMED AFTER RESTART OF MESSAGING ENGINE. - United States

Text:
  FIXES ARE AVAILABLE
8.5.5.3: WebSphere Application Server V8.5.5 Fix Pack 3 [http://www-01.ibm.com/support/docview.wss?uid=swg24038133]
8.5.5.4: WebSphere Application Server V8.5.5 Fix Pack 4 [http://www-01.ibm.com/support/docview.wss?uid=swg24038539]
8.5.5.5: WebSphere Application Server V8.5.5 Fix Pack 5 [http://www-01.ibm.com/support/docview.wss?uid=swg24039425]
8.5.5.6: WebSphere Application Server V8.5.5 Fix Pack 6 [http://www-01.ibm.com/support/docview.wss?uid=swg24040035]
8.5.5.7: WebSphere Application Server V8.5.5 Fix Pack 7 [http://www-01.ibm.com/support/docview.wss?uid=swg24040533]
8.5.5.8: WebSphere Application Server V8.5.5 Fix Pack 8 [http://www-01.ibm.com/support/docview.wss?uid=swg24041178]
8.5.5.9: WebSphere Application Server V8.5.5 Fix Pack 9 [http://www-01.ibm.com/support/docview.wss?uid=swg24041819]
8.5.5.10: WebSphere Application Server V8.5.5 Fix Pack 10 [http://www-01.ibm.com/support/docview.wss?uid=swg24042150]
8.5.5.11: WebSphere Application Server V8.5.5 Fix Pack 11 [http://www-01.ibm.com/support/docview.wss?uid=swg24043005]
8.5.5.12: WebSphere Application Server V8.5.5 Fix Pack 12 [http://www-01.ibm.com/support/docview.wss?uid=swg24043844]
8.5.5.13: WebSphere Application Server V8.5.5 Fix Pack 13 [http://www-01.ibm.com/support/docview.wss?uid=swg24044479]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  In WebSphere Application Server V8.5, messages are not
   getting consumed from a queue after the messaging engine is
   restartd. Also the following can be observed:
   
   - Before messaging engine restart, messages are getting
   consumed without any issues.
   - This problem cannot be reproduced every time during
   messaging engine restart.
   - When heavy WebSphere Application Server tracing is enabled
   the problem does not occur.
   
   Also the following NullPointerException may be present in an
   FFDC file:
   
   java.lang.NullPointerException
   at
   com.ibm.ws.sib.processor.impl.MessageProcessor.getMessagingEn
   gineUuid(MessageProcessor.java:2960)
   at
   com.ibm.ws.sib.processor.impl.ConnectionImpl.getMeUuid(Connec
   tionImpl.java:3951)
   at
   com.ibm.ws.sib.ra.inbound.impl.SibRaCommonEndpointActivation.
   dropConnection(SibRaCommonEndpointActivation.java:1384)
   at
   com.ibm.ws.sib.ra.inbound.impl.SibRaCommonEndpointActivation.mes
   sagingEngineQuiescing(SibRaCommonEndpointActivation.java:1282)
   at
   com.ibm.ws.sib.ra.inbound.impl.SibRaMessagingEngineConnection
   $SibRaConnectionEventThread.executeCallback(SibRaMessagingEngine
   Connection.java:1527)
   ..
   ..
   
   
    
   
   

LOCAL FIX
 *  Enabling a heavy WAS trace prevents the problem from occuring.
   For example, this trace worked for one customer:
   *=info:SIBJmsRa*:SIBProcessor=all:WAS.j2c=all:RRA=all:Transactio
   n=all:SIBMessageStore=all
   
   This workaround might not work for all environments.
   
   
    
   
   

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED:  Users of the default messaging provider     *
   *                  for IBM WebSphere Application Server V8.5   *
   ****************************************************************
   * PROBLEM DESCRIPTION: Messages are not getting consumed       *
   *                      after messaging engine (ME) restart.    *
   ****************************************************************
   * RECOMMENDATION:                                              *
   ****************************************************************
   Messages are not getting consumed after ME restart. Customer
   cannot recreate the problem with tracing enabled. This is
   because of a NullPointerException (NPE) which is caused by a
   timing issue between two threads.
   Thread1 -> Removes ME UUID from all the SIBRa endpoint
   listeners (consumers) listening for the destinations under the
   ME.
   Thread2 -> Stops the ME.
   Thread2 stops the ME and resets the message stopre object to
   "Null" before Thread1 completes. Later Thread1 uses the
   message store object, which causes the NPE.
   
   
    
   
   

PROBLEM CONCLUSION
 *  Source code has been added to fix the NullPointerException.
   
   The fix for this APAR is currently targeted for inclusion in
   fix pack 8.5.5.3. Please refer to the Recommended Updates page
   for delivery information:
   http://www.ibm.com/support/docview.wss?rs=180&uid=swg27004980 [http://www.ibm.com/support/docview.wss?rs=180&uid=swg27004980]
   
   
    
   
   

TEMPORARY FIX
 *  This timing issue may disappeare after ME restart especially
   with tracing enabled.
   
   
    
   
   

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PI10877
   
   
 * REPORTED COMPONENT NAME
   WAS SIB & SIBWS
   
   
 * REPORTED COMPONENT ID
   620800101
   
   
 * REPORTED RELEASE
   850
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2014-02-03
   
   
 * CLOSED DATE
   2014-05-16
   
   
 * LAST MODIFIED DATE
   2014-05-16
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WAS SIB & SIBWS
   
   
 * FIXED COMPONENT ID
   620800101
   
   

APPLICABLE COMPONENT LEVELS
 * R850 PSY
   UP