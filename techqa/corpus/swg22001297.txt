Title: IBM Workflows in IBM StoredIQ for Legal: Part 2 - Refined approval workflow - United States

Text:
approval workflow; workflow refinement TECHNOTE (FAQ)

QUESTION
 How can I refine a simple workflow for StoredIQ for Legal with branches and buttons? 

ANSWER


PART 2: APPROVAL TASKS AND BUTTONS
OVERVIEW
This recipe is the second part of a series explaining how workflows are designed for StoredIQ for Legal. It shows how to create a simple approval workflow and introduces buttons.

INGREDIENTS


 * Eclipse [https://eclipse.org/downloads/] with installed Activiti plug-in
 * StoredIQ for Legal
 * The review process definition created in part 1 [http://www.ibm.com/support/docview.wss?uid=swg22001296] of this series

INTRODUCTION
This document focuses on workflows in the context of StoredIQ for Legal. For details about workflows in general and Activiti [https://www.activiti.org/], the workflow engine used by StoredIQ for Legal, refer to the Activiti User Guide [http://www.activiti.org/userguide/index.html].

We start with the workflow process definition generated in the first part [http://www.ibm.com/support/docview.wss?uid=swg22001296] of this series. If you followed that recipe, you can reuse the workflow you created. Alternatively, you can use the definition attached to this document. [https://github.ibm.com/LBREMER/SIQ4L/blob/master/SIQ4L-Workflow-Examples/1%20Review%20Process.bpmn]This definition consists of only one review task for matter closures that can be completed by an attorney. After the attorney completes the review task, the matter is closed by the workflow engine. 

[/support/docview.wss?uid=swg22001297&amp;aid=1]

In this recipe, we will transform the review task into an approval task. In such a task, the attorney has the option to either approve closing the matter or to reject the operation. The matter will only be closed if the attorney approves.

The recipe continues with the following steps:

 * Configuring the process
 * Configuring the approval task
 * Deploying and testing the workflow definition

If you don't want to generate the process definition yourself and simply want to see how the approval task looks in StoredIQ for Legal, you can download the sample workflow definition attached to this document. With that .bpmn file, you can skip the configuration steps and start directly with the deployment of the workflow definition.

STEP-BY-STEP
 1. Configure the ProcessOpen the workflow definition in the Activiti Designer. Click anywhere in the white canvas and select Process in the Properties view. Change the settings as follows:
    
     * Id: approval
     * Name:Approval Process
     * Namespace: Approval
    
    [/support/docview.wss?uid=swg22001297&amp;aid=2] After the namespace is set to Approval, the action that triggers the workflow (matter close, in this example) is only executed when a predefined variable status is set to approved at the time the workflow finishes. If the variable has a different value, the action is not executed. In our example, the matter would stay open.
    
    Process variables are introduced in more detail in a different recipe. For now, it is sufficient to know that each active workflow process contains a set of variables. One of these variables is called status.
    
    
 2. Configure the TaskTo configure the approval task, we first change the name and ID of the review task. To do this, click the user task and, on the General tab in the Properties view, change the ID and the name of the task to attorney-approval and Matter Close Approval, respectively. Then, switch to the Documentation tab and change the description to Please approve the following action: Matter Close.[/support/docview.wss?uid=swg22001297&amp;aid=3]
    
    As mentioned before, the approval workflow only executes the trigger action when the status variable is set to approved. There are multiple ways to modify variables. Here, we will use a button. Buttons are shown in user tasks and allow the user to complete the task. By default, each task contains a Complete button. However, it is possible to configure custom buttons. The default button is no longer shown when custom buttons are present. For the approval task, we want to create two buttons. One to approve and one to decline the request.
    
    Custom buttons are well-defined form properties of a task. To configure a button, go to the Properties view of the task, click Form, and select New to create a new form property. Set the ID to buttons and the type to enum. Now, you can create one or more buttons in the Form Values section. Each button must have an ID and a name. The ID is the value that is set for the status variable, the name is the display name that is shown on the button.
    
    The order of the buttons in the Activiti Designer determines their order in the user interface. The first button will be highlighted. Create the configuration as shown in the following screen capture.
    
    
    
    
    
    
    [/support/docview.wss?uid=swg22001297&aid=4] [/support/docview.wss?uid=swg22001297&aid=4]
    
    
 3. Test the workflowDeploy the new workflow definition in StoredIQ for Legal and activate it. Map Matter - Close as starting action. Note that a starting action can be mapped to only one workflow definition at a time. If you completed part one of this series, you probably still have the matter-close starting action mapped to the review workflow. In that case, you need to remove it from the review process before you can assign it to the approval process definition.
    
    To test the workflow, try to close a matter. As a user with the Attorney role, navigate to the approval task. After you assigned the task to yourself, you will see the two buttons. Depending on which button you click, the matter is closed, or not. 
    
    [/support/docview.wss?uid=swg22001297&aid=5] [/support/docview.wss?uid=swg22001297&aid=5]
    
    
    
 4. 
 5. Conclusion and next steps
 6. In this recipe, we modified the review workflow of the first recipe [http://www.ibm.com/support/docview.wss?uid=swg22001296] and transformed it into an approval workflow. To do so, we configured the namespace property of the process to be Approval. Furthermore, we introduced buttons. These can be used to set the status variable, which defines whether the action that triggered the workflow is executed or not.
 7. In the third recipe [http://www.ibm.com/support/docview.wss?uid=swg22001298], we will refine the approval workflow and convert it into a workflow requiring multiple approvals. We will use this use case to introduce process variables.

StoredIQ_for_Legal_Review_Process.bpmn [/support/docview.wss?uid=swg22001297&aid=7]StoredIQ_for_Legal_Review_Process.bpmn [/support/docview.wss?uid=swg22001297&aid=6] 

[/support/docview.wss?uid=swg22001297&aid=9]StoredIQ_for_Legal_Approval_Process.bpmn [/support/docview.wss?uid=swg22001297&aid=8]