Title: IBM "(0x0040E14): ORA-04098: trigger '<schemaname>.TRG_XDB50' is invalid and failed re-validation" - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 User performs a database optimise by clicking "Maintain - User - Single Mode" then "Maintain - Database - Optimize" then ticking all options. Or user has enabled Audit Log and receives error message. 

SYMPTOM
Screen: 

Information
Standard Error
Number: 5
Source: FrangoDirect.Optimize.DeltePeriodZeroValues#ControllerProxtClient
Description: System.Web.Services.Protocols.SoapException: Server was unable to process request. -->
System.Runtime.InteropServices.COMException (0x0040E14): ORA-04098: trigger 'schemaname.TRG_XDB50' is invalid and failed re-validation
at FrDatabaseBT.OptimiseTClass.DeletePeriodZerioValues...
<...>
[OK]

Event Viewer (Application log)
Log Name: Application
Source: Cognos Controller
Date: 15/02/2012 15:27:17
Event ID: 0
Task Category: None
Level: Warning
Keywords: Classic
User: N/A
Computer: SERVERNAME
Description:
Standard Error
Number: 5
Source: FrangoDirect.Optimize.DeletePeriodZeroValues#ControllerProxyClient
Description: System.Web.Services.Protocols.SoapException: Server was unable to process request. ---> System.Runtime.InteropServices.COMException (0x80040E14): ORA-04098: trigger 'schemaname.TRG_XDB50' is invalid and failed re-validation
at FrDatabaseBT.OptimizeTClass.DeletePeriodZeroValues(String sGuid, String sUser, Int32 nYear)
at Cognos.Controller.Proxy.CCRWS.OptimizeT_DeletePeriodZeroValues(String sGuid, String sUser, Int32 nYear)
--- End of inner exception stack trace ---
at Microsoft.VisualBasic.ErrObject.Raise(Int32 Number, Object Source, Object Description, Object HelpFile, Object HelpContext)
at Cognos.Controller.Common.RaiseErrCli.RaiseError(Int32 lErrNo, String sErrSource, String sErrDesc, String sErrHelpFile, Int32 lErrHelpContext)
at Cognos.Controller.Direct.Optimize.DeletePeriodZeroValues(Int32 nYear)
at Cognos.Controller.Forms.Form.frmOptimize.IRun_DoRun()


CAUSE
The trigger 'TRG_XDB50' is mistakenly enabled.


RESOLVING THE PROBLEM
Fix: 

Ask DBA to recompile the package and then recompile the triggers.

Steps:
The following steps are based on Oracle 11G: 

 1.  From the Start Menu, launch "SQL Developer" and login as the user who ownes the schema. 
 2.  Expand Packages and select PKG_XDBTRICKLE
     
     [/support/docview.wss?uid=swg21584719&amp;aid=1]
     
     
 3.  Create a new SQL File
     
     [/support/docview.wss?uid=swg21584719&amp;aid=2]
     
 4.  Switch to the tab for PKG_XDBTRICKLE and copy the text from "create or replace" to "END PKG_XDBTRICKLE;
     
     [/support/docview.wss?uid=swg21584719&aid=3] [/support/docview.wss?uid=swg21584719&aid=3]
     
     
 5.  Paste it into the New SQL file you made before and run it.
     
     [/support/docview.wss?uid=swg21584719&amp;aid=4]
     
     
 6.  Switch back to the tab for PKG_XDBTRICKLE and copy the second part from "create or replace PACKAGE BODY" to "END PKG_XDBTRICKLE;
     
     [/support/docview.wss?uid=swg21584719&amp;aid=5]
     
 7.   
 8.  Paste it into the New SQL file replacing the text from before, and then run the second part.
     You should now have the following in the Script Output:
     
     [/support/docview.wss?uid=swg21584719&amp;aid=6]
     
 9.  Click on refresh and expand the Packages you should now see that the package is no longer showing an error.
     [/support/docview.wss?uid=swg21584719&amp;aid=7]
     
     
 10. Next right click on Triggers, and select "Compile Invalid" and execute it.
     [/support/docview.wss?uid=swg21584719&amp;aid=8]
     
 11.  
 12. When done you should get no errors.
     [/support/docview.wss?uid=swg21584719&amp;aid=9]



After doing this you should no longer get an error.