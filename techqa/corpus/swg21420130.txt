Title: IBM Sort operator reports: Fatal Error: sharedMemSize too small in IBM InfoSphere DataStage - United States

Text:
APT_TSORT_STRESS_BLOCKSIZE sharedMemSize shared memory tsort TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Parallel jobs in DataStage fail during sort operation with the error:

Sort operator reports: "Fatal Error: sharedMemSize too small." 

CAUSE
APT_TSORT_STRESS_BLOCKSIZE set too small

DIAGNOSING THE PROBLEM
The variable APT_TSORT_STRESS_BLOCKSIZE sets the size of the shared memory block used to pass data between the writer, sorter and merger processes. Each tsort in a job will by default try to mmap 20MB each for their in memory sorting. This amount can be restricted by setting the Restrict Memory Usage in the tsort stages. The APT_TSORT_STRESS_BLOCKSIZE environment variable can be used to set the memory usage in bytes for tsorts at the job or project level. Beware that limiting the memory available to the tsort will mean in some cases that more data will need to written to disk, causing a slowdown in performance.


If the value set for APT_TSORT_STRESS_BLOCKSIZE is too low, parallel jobs doing sort operations will fail with "Fatal Error: sharedMemSize too small."


RESOLVING THE PROBLEM
Either do not set APT_TSORT_STRESS_BLOCKSIZE and let it default to 20MB or set it to a larger number that allows the sort to complete successfully.