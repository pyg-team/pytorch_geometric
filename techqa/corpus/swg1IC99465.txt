Title: IBM IC99465: ISSUES WITH WEBSPHERE MQ V7.5 CLASSES FOR JMS TRACE - United States

Text:
  A FIX IS AVAILABLE
WebSphere MQ V7.5 Fix Pack 7.5.0.4 [http://www-01.ibm.com/support/docview.wss?uid=swg24038252]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  The trace facility provided by the WebSphere MQ V7.5 classes for
   JMS is used by the IBM Support Organization to diagnose customer
   issues. The trace facility is controlled by the WebSphere MQ
   classes for JMS configuration file.
   There are a number of issues with the trace facility:
   - The ability to trace individual packages within the WebSphere
   MQ classes for JMS does not work.
   - The information about the internal WebSphere MQ structures
   that are sent to, and are received from, a queue manager is
   difficult to interpret.
   - When the trace facility is used to collect diagnostic
   information from the WebSphere MQ Resource Adapter, the trace
   level property is ignored.
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  ****************************************************************
   USERS AFFECTED:
   This issue affects users of:
   
   - The WebSphere MQ V7.5 classes for JMS.
   - The WebSphere MQ V7.5 OSGi bundles.
   - The WebSphere MQ V7.5 Resource Adapter.
   
   who are asked by IBM Support Organization to collect a WebSphere
   MQ classes for JMS or WebSphere MQ Resource Adapter trace.
   
   
   Platforms affected:
   MultiPlatform
   
   ****************************************************************
   PROBLEM SUMMARY:
   There were three issues with the trace facility used by the
   WebSphere MQ classes for JMS and the WebSphere MQ resource
   adapter:
   
   Issue 1:
   --------
   The WebSphere MQ classes for JMS trace facility is controlled by
   the WebSphere MQ classes for JMS configuration file. The
   configuration file contains two properties that can be used to
   control the packages within the WebSphere MQ classes for JMS
   that will be traced. These properties are:
   
   com.ibm.msg.client.commonservices.trace.exclude
   com.ibm.msg.client.commonservices.trace.include
   
   If a WebSphere MQ classes for JMS trace was enabled, the
   WebSphere MQ classes for JMS trace facility ignored the values
   of these properties and traced all of the packages within the
   WebSphere MQ classes for JMS.
   
   Issue 2:
   --------
   Trace files generated by the WebSphere MQ classes for JMS and
   WebSphere MQ resource adapter contain information about the
   various WebSphere MQ structures that are passed to, and received
   from, a queue manager. A number of these structures, such as the
   GetMessageOptions, have an options field in them, which
   control the behaviour of the WebSphere MQ API call that uses
   that structure.
   
   When the options field was traced out by the WebSphere MQ
   classes for JMS or WebSphere MQ resource adapter trace
   facilities, it appeared as an integer number, which needs to
   be manually decoded in order to work out the actual options that
   are being used.
   
   For example, the trace point:
   
   c.i.mq.jmqi.MQCNO ----+---- d getOptions() getter [64]
   
   showed that the options field for an instance of an MQCNO
   structure was being set to the value 64. The value 64 actually
   represented MQCNO_HANDLE_SHARE_BLOCK. However, this was not
   obvious from the trace.
   
   Issue 3:
   --------
   WebSphere MQ resource adapter trace can be collected in one of
   three ways:
   
   - By setting the properties traceEnabled and traceLevel on the
   resource adapter object.
   - By setting the Java system properties -DtraceEnabled and
   -DtraceLevel on the application server that the WebSphere MQ
   Resource Adapter has been deployed into.
   - By configuring the application server that the resource
   adapter has been deployed into to load a WebSphere MQ classes
   for JMS configuration file by setting the Java system property
   -Dcom.ibm.msg.client.config.location= on the application server.
   
   If trace was enabled using the WebSphere MQ classes for JMS
   configuration file, the trace level that was set by the
   property:
   
   com.ibm.msg.client.commonservices.trace.level
   
   in the configuration file was ignored. The WebSphere MQ resource
   adapter would always use the trace level specified on the
   resource adapter object.
   
   
    
   
   

PROBLEM CONCLUSION
 *  The following changes have been made to the trace facility
   provided by the WebSphere MQ classes for JMS and the WebSphere
   MQ Resource Adapter:
   
   Change 1:
   ------------
   The ability to trace individual packages, by setting the
   properties:
   
   com.ibm.msg.client.commonservices.trace.exclude
   com.ibm.msg.client.commonservices.trace.include
   
   in the WebSphere MQ classes for JMS configuration file now works
   as expected.
   
   Change 2:
   ------------
   The options fields in the internal WebSphere MQ structures
   that are sent to, and received from, a queue manager are now
   displayed using the strings representing the options that have
   been set, rather than the integer value that represent the
   options. For example, the trace point mentioned in the Problem
   Summary:
   
   c.i.mq.jmqi.MQCNO ----+---- d getOptions() getter [64]
   
   now appears as:
   
   c.i.mq.jmqi.MQCNO ----+---- d getOptions() getter
     [64 (0x40) - MQCNO_HANDLE_SHARE_BLOCK]
   
   Change 3:
   ------------
   The WebSphere MQ Resource Adapter has been updated to allow
   the trace level to be specified using a WebSphere MQ classes for
   JMS configuration file.
   
   ---------------------------------------------------------------
   The fix is targeted for delivery in the following PTFs:
   
   Version    Maintenance Level
   v7.5       7.5.0.4
   
   The latest available maintenance can be obtained from
   'WebSphere MQ Recommended Fixes'
   http://www-1.ibm.com/support/docview.wss?rs=171&uid=swg27006037 [http://www-1.ibm.com/support/docview.wss?rs=171&uid=swg27006037]
   
   If the maintenance level is not yet available information on
   its planned availability can be found in 'WebSphere MQ
   Planned Maintenance Release Dates'
   http://www-1.ibm.com/support/docview.wss?rs=171&uid=swg27006309 [http://www-1.ibm.com/support/docview.wss?rs=171&uid=swg27006309]
   ---------------------------------------------------------------
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IC99465
   
   
 * REPORTED COMPONENT NAME
   WMQ BASE MULTIP
   
   
 * REPORTED COMPONENT ID
   5724H7241
   
   
 * REPORTED RELEASE
   750
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2014-02-19
   
   
 * CLOSED DATE
   2014-02-25
   
   
 * LAST MODIFIED DATE
   2014-02-25
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WMQ BASE MULTIP
   
   
 * FIXED COMPONENT ID
   5724H7241
   
   

APPLICABLE COMPONENT LEVELS
 * R750 PSY
   UP