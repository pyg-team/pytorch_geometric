Title: IBM "Standard Error 5 ... ExcelLinkD.FetchValues ... Object
reference not set to an instance of an object" when using 'fGetVal' in Excel link - United States

Text:
Oracle; fGetVal; excel link TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 User runs an Excel link Controller report, which contains at least one fGetVal formula. User receives error. 

SYMPTOM
Standard Error 

Number: 5
Source: FrangoDirect.ExcelLinkD.FetchValues#ControllerProxyClient
Description: System.Web.Services.Protocols.SoapException: Server was unable to process request. --->'System.NullReferenceException: Object reference not set to an instance of an object.
At Cognos.Controller.Proxy.CCRWS.ExcelLinkB_FetchValues(String sGuid, DataSet, rsKeys, String sMcurr, Boolean blocLang, String sUser, String
sRep,
Boolean bIsLnk, String sSortOrd, Int32 IOptBltSet)
---Eng of inner exception stack trace --- 

CAUSE
There are several possible causes for this error message. 

 * TIP: For more examples, see separate IBM Technote #1461271.


This Technote specifically relates to the scenario where the cause is that there is an invalid Oracle client installation on the Controller application server.  * For example, in one customer's environment, they had installed the Oracle 10G release 1 (R1) client on the application server (instead of the supported R2 version of the client).


When using Oracle, you must:  1. Perform a FULL (Administrator) installation of the Oracle client on the application server. 
 2. Even if using a 64-bit operating system for your application server, you must install use the 32-bit version of the Oracle client onto the application server.

ENVIRONMENT
Controller database hosted on Oracle database server.



RESOLVING THE PROBLEM
Obtain a short period of downtime, and perform the following on the Controller application server: 

 * Uninstall the current Oracle client 
 * Install the correct Oracle client, either:  * Oracle 10G release 2 (R2) 32-bit 
    * or Oracle 11G release 2 (R2) 32-bit
   
   
 * During the client installation wizard, select a full 'administrator' install option 
 * VITAL: Afterwards, apply the IBM-recommended Oracle client patches 
 * Finally, you must reboot the application server after installing this client.


Steps: 

Oracle 10G:  * See attached Proven Practice document "07. Proven Practice - Step-by-Step guide to installing Oracle 10G Client on a Controller 8.3 Application server.pdf".


Oracle 11G:  * See separate IBM Technote #1656559.

RELATED INFORMATION
#1448885 - "Standard Error 5 - (0x800A000D): Type mismat [http://www.ibm.com/support/docview.wss?rs=0&uid=swg21448885]
THIRD PARTY - Oracle 11G R2 downloads [http://www.oracle.com/technetwork/database/enterprise-edition/downloads/112010-win32soft-098987.html]
1461271 - ** TROUBLESHOOTING** - "Standard Error 5 ... [http://www.ibm.com/support/docview.wss?uid=swg21461271]
1656559 - How to install Oracle 11G r2 client (and patc [http://www.ibm.com/support/docview.wss?uid=swg21656559]


07. Proven Practice - Step-by-Step guide to installing Oracle 10G Client on a Controller 8.3 Application server.pdf [/support/docview.wss?uid=swg21347499&aid=2]07. Proven Practice - Step-by-Step guide to installing Oracle 10G Client on a Controller 8.3 Application server.pdf [/support/docview.wss?uid=swg21347499&aid=1]

HISTORICAL NUMBER
 1037268