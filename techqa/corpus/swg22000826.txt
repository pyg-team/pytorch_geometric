Title: IBM Creation of Sterling File Gateway Trading Partner ends with error - contact your system Administrator - United States

Text:
YFS_AUDIT_PK; ORA-01502: index 'YFS_AUDIT_PK' or partition of such index is in unusable state TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Creation of Sterling File Gateway Trading Partner ends with failure


SYMPTOM
UI screen shows "Please contact your system Administrator"

filegateway.log shows an exception stack as below - 


[2017-03-10 22:13:51.873] ERROR YFCException in extendPartner
[2017-03-10 22:13:51.874] ERROR [1489205631874]Error description not available
[2017-03-10 22:13:51.874] ERRORDTL [1489205631874]<?xml version="1.0" encoding="UTF-8"?>
<Errors>
<Error ErrorCode="ORA-1502"
ErrorDescription="ORA-01502: index 'ADMIN.YFS_AUDIT_PK' or partition of such index is in unusable state&#xa;" ErrorRelatedMoreInfo="">
<Attribute Name="ErrorCode" Value="ORA-1502"/>
<Attribute Name="ErrorDescription" Value="ORA-01502: index 'ADMIN.YFS_AUDIT_PK' or partition of such index is in unusable state&#xa;"/>
<Attribute Name="SQLState" Value="72000"/>
<Attribute Name="TransactionIsolationLevel" Value="2"/>
<Attribute Name="SQLStatement" Value="PREPARED STATEMENT - INSERT /*YANTRA*/ INTO YFS_AUDIT(AUDIT_KEY,AUDIT_TRAN_KEY,AUDIT_CONTEXT_ID,REFERENCE_1,REFERENCE_2,REFERENCE_3,REFERENCE_4,REFERENCE_5,REFERENCE_6,TABLE_NAME,TABLE_KEY,AUDIT_XML,OPERATION,LOCKID,CREATETS,MODIFYTS,CREATEUSERID,MODIFYUSERID,CREATEPROGID,MODIFYPROGID) values ( '201703102213513909884','201703102213513909883','0','BUS_EU_TIMEATTENDANCE1',' ',' ',' ',' ',' ','YFS_ORGANIZATION','BUS_EU_TIMEATTENDANCE1','A-Clob-Value','Update',0,'2017-03-10T22:13:51','2017-03-10T22:13:51','e6386w','e6386w','filegateway','filegateway' ) "/>
<Attribute Name="DBErrorCode" Value="1502"/>
<Error ErrorCode="java.sql.SQLException" ErrorDescription="" ErrorRelatedMoreInfo="ORA-01502: index 'ADMIN.YFS_AUDIT_PK' or partition of such index is in unusable state&#xa;">
<Stack>java.sql.SQLException: ORA-01502: index 'ADMIN.YFS_AUDIT_PK' or partition of such index is in unusable state

at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:439)
at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:395)
at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:802)
at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:436)
at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:186)
at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:521)
at oracle.jdbc.driver.T4CPreparedStatement.doOall8(T4CPreparedStatement.java:205)
at oracle.jdbc.driver.T4CPreparedStatement.executeForRows(T4CPreparedStatement.java:1008)
at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1307)
at oracle.jdbc.driver.OraclePreparedStatement.executeInternal(OraclePreparedStatement.java:3449)
at oracle.jdbc.driver.OraclePreparedStatement.executeUpdate(OraclePreparedStatement.java:3530)
at oracle.jdbc.driver.OraclePreparedStatementWrapper.executeUpdate(OraclePreparedStatementWrapper.java:1350)
at com.yantra.shared.dbclasses.YFS_AuditDBHome.insertNoKeyGen(YFS_AuditDBHome.java:835)
at com.yantra.shared.dbclasses.YFS_AuditBase.insertNoKeyGen(YFS_AuditBase.java:1370)
at com.yantra.shared.dbclasses.YFS_AuditDBHome.insert(YFS_AuditDBHome.java:710)
at com.yantra.shared.dbclasses.YFS_AuditBase.insert(YFS_AuditBase.java:1363)
at com.yantra.ycp.common.YCPAuditHandler.generateAuditRecord(YCPAuditHandler.java:114)
at com.yantra.ycp.common.YCPAuditHandler.createAuditForUpdatedRecord(YCPAuditHandler.java:50)
at com.yantra.shared.dbclasses.YFS_OrganizationDBHome.update(YFS_OrganizationDBHome.java:3055)
at com.yantra.shared.dbclasses.YFS_OrganizationDBHome.basicUpdate(YFS_OrganizationDBHome.java:2648)
at com.yantra.shared.dbclasses.YFS_OrganizationDBHome.update(YFS_OrganizationDBHome.java:2688)
at com.yantra.shared.dbclasses.YFS_OrganizationDBCacheHome.update(YFS_OrganizationDBCacheHome.java:355)
at com.yantra.shared.dbclasses.YFS_OrganizationBase.update(YFS_OrganizationBase.java:7358)
at com.yantra.ycp.customdb.YFS_OrganizationImpl.update(YFS_OrganizationImpl.java:870)
at com.sterlingcommerce.fg.migrate.Migrater.normalizeOrganization(Migrater.java:195)
at com.sterlingcommerce.fg.migrate.Migrater.normalizeOrganization(Migrater.java:312)
at com.sterlingcommerce.fg.ui.aftoverlay.forms.FileGatewayTradingPartnerForm.extendPartner(FileGatewayTradingPartnerForm.java:868)
at com.sterlingcommerce.woodstock.uix.dmi.SaveEntity.saveTP(SaveEntity.java:111)
at com.sterlingcommerce.fg.ui.aftoverlay.OverlaySaveEntity.saveTP(OverlaySaveEntity.java:102)
at com.sterlingcommerce.woodstock.uix.dmi.SaveEntity.run(SaveEntity.java:58)
</Stack>
</Error>


CAUSE
Database index "YFS_AUDIT_PK" was corrupted and this index belongs to YFS_AUDIT table


ENVIRONMENT
This occurrence is reported in SB2Bi 5.2.6.3/SFG 2.2.6.3 on Linux OS with Oracle 12c Database. 

But it could theoretically happen on any OS, SFG fixpack, Database combination.


RESOLVING THE PROBLEM
Rebuild Database Index on SFG Database server 

Sample command to rebuild index for Oracle database - 
ALTER INDEX YFS_AUDIT_PK REBUILD ONLINE

 


Cross reference information Segment Product Component Platform Version Edition Commerce Sterling File Gateway