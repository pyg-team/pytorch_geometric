Title: IBM Troubleshooting TM1 Timeouts - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 This document walks you through the usual suspect settings that can trigger unwanted TM1 timeouts. This document is geared for Windows Server 2008 R2, however the majority will still be applicable to other Windows operating systems.



SYMPTOM
You are encountering one or more of the following errors or scenarios in your TM1 environment, whether it be TM1Web, Contributor/Applications, Perspectives, or others: 

 * Server Error in '/TM1Web' Application. Request timed out. 
 * System.Web.HttpException: Request timed out. 
 * ERROR Applix.TM1.Web.Page.TM1WebPageUtils - <Your Web session has timed out. Please login again.> 
 * Session timed out. Please login again… 
 * Error -2 occurred pinging your cognos passport. 
 * Operation Failed


RESOLVING THE PROBLEM
Troubleshooting Steps:
1. Check the tm1s.cfg file of the TM1Server(s) you are having trouble with, and look for the IdleConnectionTimeOutSeconds parameter. If the parameter exists, adjust as desired.


2. Open the Internet Information Services (IIS) Manager. Expand 'ServerName', expand 'Sites. Right-click 'Default Web Site', select 'Manage Web Site' > 'Advanced Settings...'. Expand 'Connection Limits' and adjust the 'Connection Time-out' setting.


3. In IIS, Expand 'ServerName', expand 'Sites' and 'Default Web Site', right-click the 'TM1Web' virtual directory. Select 'Manage Web Site' > 'Advanced Settings...'. Make note of the 'Application Pool' parameter, as this is the Application Pool TM1Web runs on.

In IIS, Expand 'ServerName' and select 'Application Pools'. Right-click the 'Application Pool' TM1Web runs on, and select 'Advanced Settings'. Within 'Process Model', adjust the 'Idle Time-out (minutes)' parameter as desired.


4. Navigate to your TM1Web install directory (\TM1InstallPath\TM1_64\TM1Web), and open the web.config file with Notepad. Look for the following line: <httpRuntime executionTimeout="110" /> . Adjust the httpRuntime executionTimeout as desired.


5. In the same web.config file from Step 3, look for the following line:
<sessionState mode="InProc" stateConnectionString="tcpip=127.0.0.1:42424" sqlConnectionString="data source=127.0.0.1;Trusted_Connection=yes" cookieless="false" timeout="20" /> . Adjust the timeout parameter as desired. 

Using all of the above settings, double-check what you have put in to each to ensure you are consistent and that the values make sense. Also, verify that you set it appropriately for minutes vs. seconds. After you have verified the above, you will need to reset your webserver for the changes to take effect.

To reset your webserver, open Command Prompt (right-click, and select ‘Run as Administrator’), and type ‘iisreset’ and press enter (no quotes). You will be notified when the server has come back online.



Additional Considerations:

CAM Namespace:
If you use a CAM Namespace as your authentication source for TM1, you will want to do the following:

6. Check the tm1s.cfg file of the TM1Server(s) you are having trouble with, and look for the ClientPingCAMPassport parameter. If the parameter exists, make note of the value. 

 * Still in your tm1s.cfg file, look at your ServerCAMURI parameter. It should look similar to http;//server:9300/p2pd/servlet/dispatch<⁄font>. You will need your Cognos BI Administrator to check the Cognos Configuration for this BI server, and verify the ‘Ping timeout in seconds’ and 'Inactivity timeout in seconds' settings - these two should be set about the same (default is 3600). 
 * Back in your tm1s.cfg file, configure the ClientPingCAMPassport to be at least half of what is listed as the Ping timeout in seconds/Inactivity timeout in seconds on your BI Dispatcher, or lower. For example, assuming the dispatcher timeouts are set to 3600, then the tm1s.cfg ClientPingCAMPassport parameter should be set to 1800 or lower (default is 900).
   
   If you made changes to your tm1s.cfg file, you will need to restart your TM1 Server for the changes to take effect.

7. Load Balancing / Network Topology: 
If you have load balancing or a unique network topology in your environment, you need to ensure: 
 * That your Load Balancers are using a ‘sticky’ or ‘persistent’ connection, so that once a session is opened on one server, it remains on that one server until the session has been terminated. 
 * That any third party timeouts are configured to match your desired TM1 Timeout settings. Note, you will likely need to engage your network team to uncover all potential timeouts. For example:  * Siteminder or Webseal IDLE time out settings 
    * F5 timeouts, including ‘Default Forwarding Virtual Timeout’
   
   


Summary: 
After following this document, you should now be familiar with the following timeout parameters:  * IdleConnectionTimeOutSeconds (tm1s.cfg) 
 * Connection Timeout (Default Website Advanced Settings, IIS) 
 * Application Pool Recycling Timeout (AppPool Advanced Settings, IIS 
 * httpRuntime executionTimeout (web.config, TM1Web) 
 * sessionState timeout (web.config, Tm1Web)


Optional Parameters (depending on your configuration):  * ClientPingCAMPassport (tm1s.cfg) 
 * Ping timeout in seconds (Cognos Configuration of BI Dispatcher) 
 * Inactivity timeout in seconds (Cognos Configuration of BI Content Manager) 
 * Load balancing (Sticky / Persistent Sessions) 
 * Load balancing, Siteminder, or Webseal timeouts



If you have additional questions, or are still experiencing issues in your environment, please log a PMR with IBM Support and provide the following information:  * description of timeout problem/error received 
 * tm1s.cfg file 
 * web.config file from TM1Web 
 * screenshots of all configurable IIS settings 
 * version detail of the TM1 environment 
 * tm1web.log 
 * any additional/relevant environment details