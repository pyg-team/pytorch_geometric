Title: IBM Why db2look -z creates GRANT statement for unexpected schema name? - United States

Text:
 TECHNOTE (FAQ)

QUESTION
 Why db2look -z creates GRANT statement for unexpected schema name? 

ANSWER
Here is an example. If save below repro.sh and run it, will generate db2look.out file.
----- repro.sh -----
#!/bin/sh

db2level
db2 -t "drop db testdb"
db2 -v "create db testdb"
db2 -v "connect to testdb"
db2 -v "create schema schema1"
db2 -v "create schema schema2"
db2 -v "create table schema1.t1 (c1 char(10))"
db2 -v "create table schema2.t1 (c1 char(10))"
db2 -v terminate

db2 -v "connect to testdb"
echo 'db2look -d testdb -e -xd -z SCHEMA1 -o db2look.out'
db2look -d testdb -e -xd -z SCHEMA1 -o db2look.out
----------

From db2look.out, we see both schema names SCHEMA1 and SCHEMA2 even if we specify "-z SCHEMA1" as shown below.

$ grep GRANT db2look.out | grep SCHEMA1
-----
GRANT CONTROL ON TABLE "SCHEMA1 "."T1" TO USER "HIDEHY " ;
GRANT CREATEIN ON SCHEMA "SCHEMA1 " TO USER "HIDEHY " WITH GRANT OPTION;
GRANT DROPIN ON SCHEMA "SCHEMA1 " TO USER "HIDEHY " WITH GRANT OPTION;
GRANT ALTERIN ON SCHEMA "SCHEMA1 " TO USER "HIDEHY " WITH GRANT OPTION;
-----

$ grep GRANT db2look.out | grep SCHEMA2
-----
GRANT CREATEIN ON SCHEMA "SCHEMA2 " TO USER "HIDEHY " WITH GRANT OPTION;
GRANT DROPIN ON SCHEMA "SCHEMA2 " TO USER "HIDEHY " WITH GRANT OPTION;
GRANT ALTERIN ON SCHEMA "SCHEMA2 " TO USER "HIDEHY " WITH GRANT OPTION; 
-----

This is an expected behavior of current product.
GRANT statement does not consider -z option only in case of granting authorities on schema. For rest of the authorities we do consider -z option. This will be specific to "GRANT ON SCHEMA".
Users may simply delete unnecessary GRANT statements from db2look output file.

Note:
This behavior might be changed without notice in the future. We can confirm whether this technote
is valid or not by running repro.sh as above.
Please contact your Sales Rep to submit a potential design change towards a future release.


RELATED INFORMATION
 db2look - DB2 statistics and DDL extraction tool comman [http://www-01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.admin.cmd.doc/doc/r0002051.html]
GRANT (schema privileges) statement [http://www-01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.db2.luw.sql.ref.doc/doc/r0000964.html]