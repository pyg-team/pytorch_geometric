Title: IBM PI78879: ABEND 073-00000010 CSQM1PFW,M=CSQGFRCV : 5C6-00E7014F - United States

Text:
z/os  A FIX IS AVAILABLE
Obtain the fix for this APAR.


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  CSQ1,ABN=073-00000010,U=CSQ1CHIN,C=R3600.710.MMC-
   CSQM1PFW,M=CSQGFRCV,PSW=040C10008153CE4E,ASID=0077
   
   CSQ1,ABN=5C6-00E7014F,C=R3600.710.CHIN
             LOC=CSQXADPM.CSQXADPM+05274
    IMS application has issued an MQGET with MQGMO_WAIT against a
   shared queue. The queue-manager has performance events enabled,
   and at the end of the MQGET processing, CSQMGET has invoked
   CSQMIAGM to see if a performance event message is required.
   CSQMIAGM detects that a MQRC_Q_DEPTH_LOW event is required, so
   CSQMIARC is invoked. CSQMIARC temporarily changed Mthr.lASID
   to the asid of the queue-maanger (normally it is expected to
   contain the asid of the application, x03A6 in this case). At the
   same time, a message is put to the SHARED queue by the CHIN
   CSQM1PFW is invoked and detects that the IMS application is
   waiting for a message on the shared queue (although it hasn't
   yet gone into a get-wait). CSQM1PFW then issued a SSAR to the
   getter's address space. However, as Mthr.lASID had been
   temporarily updated, an SSAR for asid x0077 was issued instead
   of x03A6. Subsequent processing in CSQM1PFW then attempted a
   SETLOCK OBTAIN for the application address space, but as an
   SSAR has not been issued for it the S073 abend occurred.
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED: All users of WebSphere MQ for z/OS Version 7 *
   *                 Release 1 Modification 0.                    *
   ****************************************************************
   * PROBLEM DESCRIPTION: Abend 073-00000010 in CSQM1PFW when     *
   *                      putting non-persistent messages out of  *
   *                      syncpoint to a queue with one or more   *
   *                      out of syncpoint getters waiting, if    *
   *                      performance events are enabled and      *
   *                      event queue has been redefined as a     *
   *                      non-local queue (e.g. Alias Queue,      *
   *                      Remote Queue).                          *
   ****************************************************************
   * RECOMMENDATION:                                              *
   ****************************************************************
   An application putting a non-persistent message out of syncpoint
   to a queue with waiting getters attempts to put the message
   directly to an eligible getters buffer. As part of this the
   putter sets the secondary address space to the getters address
   space before requesting the CML lock for that address space. If
   performance events are active, and the last get on the handle
   chosen expired all of the messages on the queue, a queue depth
   low event message is generated. When the event queue
   SYSTEM.ADMIN.PERFM.EVENT is not a local queue, during the put of
   the event the asid associated with the getter's thread is
   temporarily set to the queue manager address space. If a put
   occurs while this is the case, CSQM1PFW incorrectly sets the
   secondary address space to the queue manager's address space
   rather than the getters address space. This results in the
   073-00000010 abend when CSQM1PFW requests the CML lock because
   the putter has no active bind to the getters address space.
   
   
    
   
   

PROBLEM CONCLUSION
 *  CSQM1PFW is changed to use the getter's stoken rather than the
   asid stored in the mthr to determine the asid to set the
   secondary address space to.
   100Y
   CSQM1PFW
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PI78879
   
   
 * REPORTED COMPONENT NAME
   WMQ Z/OS V7
   
   
 * REPORTED COMPONENT ID
   5655R3600
   
   
 * REPORTED RELEASE
   100
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt / Xsystem
   
   
 * SUBMITTED DATE
   2017-03-27
   
   
 * CLOSED DATE
   2017-07-25
   
   
 * LAST MODIFIED DATE
   2017-10-02
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
    UI49064
   
   

MODULES/MACROS
 *  CSQM1PFW
   
   
    
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WMQ Z/OS V7
   
   
 * FIXED COMPONENT ID
   5655R3600
   
   

APPLICABLE COMPONENT LEVELS
 * R100 PSY UI49064 [HTTPS://WWW14.SOFTWARE.IBM.COM/WEBAPP/SET2/ORDERMEDIA/SHOPCART?PTFS=UI49064]
   UP17/09/07 P F709
   
   

FIX IS AVAILABLE
 * SELECT THE PTF APPROPRIATE FOR YOUR COMPONENT LEVEL. YOU WILL BE REQUIRED TO SIGN IN. DISTRIBUTION ON PHYSICAL MEDIA IS NOT AVAILABLE IN ALL COUNTRIES.