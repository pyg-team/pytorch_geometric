Title: IBM Security Bulletin:  TLS padding vulnerability affects IBM® DB2® LUW (CVE-2014-8730) - United States

Text:
 SECURITY BULLETIN

THIS DOCUMENT APPLIES ONLY TO THE FOLLOWING LANGUAGE VERSION(S):
 US English 

SUMMARY
 Transport Layer Security (TLS) padding vulnerability via a POODLE (Padding Oracle On Downgraded Legacy Encryption) like attack affects IBM® DB2® LUW. 

VULNERABILITY DETAILS
CVE-ID: CVE-2014-8730 [http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-8730]


DESCRIPTION: 

Product could allow a remote attacker to obtain sensitive information, caused by the failure to check the contents of the padding bytes when using CBC cipher suites of some TLS implementations. A remote user with the ability to conduct a man-in-the-middle attack could exploit this vulnerability via a POODLE (Padding Oracle On Downgraded Legacy Encryption) like attack to decrypt sensitive information and calculate the plaintext of secure connections.


CVSS Base Score: 4.3
CVSS Temporal Score: See https://exchange.xforce.ibmcloud.com/vulnerabilities/99216 [https://exchange.xforce.ibmcloud.com/vulnerabilities/99216] for the current score
CVSS Environmental Score*: Undefined
CVSS Vector: (AV:N/AC:M/Au:N/C:P/I:N/A:N)

AFFECTED PRODUCTS AND VERSIONS
Customers who have Secure Sockets Layer (SSL) support enabled in their DB2 database system are affected. SSL support is not enabled in DB2 by default. 


All fix pack levels for IBM DB2 V9.5, V9.7, V10.1 and V10.5 editions listed below and running on AIX, Linux, HP, Solaris or Windows are affected :

IBM® DB2® Express Edition
IBM® DB2® Workgroup Server Edition
IBM® DB2® Enterprise Server Edition
IBM® DB2® Advanced Enterprise Server Edition
IBM® DB2® Advanced Workgroup Server Edition
IBM® DB2® Connect™ Application Server Edition 
IBM® DB2® Connect™ Enterprise Edition
IBM® DB2® Connect™ Unlimited Edition for System i® 
IBM® DB2® Connect™ Unlimited Edition for System z®

IBM® DB2® pureScale™ Feature for Enterprise Server Edition, V9.8, running on AIX or Linux is affected.

REMEDIATION/FIXES
The recommended solution is to apply the appropriate fix for this vulnerability. 

FIX:
The fix for DB2 release V9.7 is in FP11, V10.1 is in V10.1 FP5 and V10.5 is in V10.5 FP6, available for download from Fix Central. 

Customers running any vulnerable fixpack level of an affected Program, V9.5 or V9.8 can contact support to obtain a special build containing an interim fix for this issue. These special builds are available based on the most recent fixpack level for each impacted release: DB2 V9.5 FP10 or DB2 V9.8 FP5. They can be applied to any affected fixpack level of the appropriate release to remediate this vulnerability. Additionally fixes based on DB2 V9.5 FP9, DB2 V9.7 FP10, DB2 V10.1 FP4 or V10.5 FP5 will be made available on request. 

Refer to the following chart to determine how to proceed to obtain a needed fixpack or special build. 

Release Fixed in fix pack APAR Download URL V9.5 TBD IT06317 [http://www-01.ibm.com/support/docview.wss?uid=swg1IT06317] Please contact technical support. V9.7 FP11 IT06348 [http://www-01.ibm.com/support/docview.wss?uid=swg1IT06348] http://www-01.ibm.com/support/docview.wss?uid=swg24040935 [http://www-01.ibm.com/support/docview.wss?uid=swg24040935] V9.8 TBD IT06349 [http://www-01.ibm.com/support/docview.wss?uid=swg1IT06349] Please contact technical support. V10.1 FP5 IT06350 [http://www-01.ibm.com/support/docview.wss?uid=swg1IT06350] http://www-01.ibm.com/support/docview.wss?uid=swg24040170 [http://www-01.ibm.com/support/docview.wss?uid=swg24040170] V10.5 FP6 IT06351 [http://www-01.ibm.com/support/docview.wss?uid=swg1IT06351] http://www-01.ibm.com/support/docview.wss?uid=swg24040522 [http://www-01.ibm.com/support/docview.wss?uid=swg24040522] 
Contact Technical Support: In the United States and Canada dial 1-800-IBM-SERV 
View the support contacts for other countries [http://www.ibm.com/planetwide/] outside of the United States. 
Electronically open a Service Request [http://www.ibm.com/software/data/db2/support/db2_9/probsub.html] with DB2 Technical Support. 

Note: IBM’s statements regarding its plans, directions, and intent are subject to change or withdrawal without notice at IBM’s sole discretion. Information regarding potential future products is intended to outline our general product direction and it should not be relied on in making a purchasing decision. The information mentioned regarding potential future products is not a commitment, promise, or legal obligation to deliver any material, code or functionality. Information about potential future products may not be incorporated into any contract. The development, release, and timing of any future features or functionality described for our products remains at our sole discretion.

WORKAROUNDS AND MITIGATIONS
This problem can be mitigated by setting the operating system environment variable GSK_STRICTCHECK_CBCPADBYTES. 

Customers with the fix pack level of V9.7 FP9, V10.1 FP3a, V10.5 GA or higher should follow the instruction below to mitigate the problem. 

Customers with V9.5 should contact DB2 support to obtain V9.5 FP10a and follow the instruction below to mitigate the problem. 

Customers with fix pack level of V9.7 FP8 or lower, all fix pack levels of V9.8 or V10.1 FP3 or lower should upgrade to the latest fix pack. Then follow the instruction below to mitigate the problem. 

Mitigation instructions: 

Customers should set the environment variable GSK_STRICTCHECK_CBCPADBYTES on each DB2 server instance as follow:

On Linux/UNIX: 

1) As the DB2 instance owner, add the following line to the userprofile file that is located under the sqllib directory: 

export GSK_STRICTCHECK_CBCPADBYTES=GSK_TRUE 

2) As a user with DB2 SYSADM privilege, run the following commands: 

export GSK_STRICTCHECK_CBCPADBYTES=GSK_TRUE 

db2set DB2ENVLIST=GSK_STRICTCHECK_CBCPADBYTES 

db2stop
db2start 

The commands above assume that DB2ENVLIST registry variable is not set. If it is set, the environment variable names need to be delimited with a space. For example, if DB2ENVLIST is already set to SOME_ENV, it needs to be set as follows: 

db2set DB2ENVLIST="SOME_ENV GSK_STRICTCHECK_CBCPADBYTES" 

On Windows: 

Set the GSK_STRICTCHECK_CBCPADBYTES environment variable at system level. You will need to restart the DB2 server for the environment variables to be picked up by DB2. 

Variable name: GSK_STRICTCHECK_CBCPADBYTES 

Variable value: GSK_TRUE 



GET NOTIFIED ABOUT FUTURE SECURITY BULLETINS
 Subscribe to My Notifications [ http://www-01.ibm.com/software/support/einfo.html] to be notified of important product support alerts like this. 

REFERENCES
Complete CVSS v2 Guide [http://www.first.org/cvss/v2/guide] 
On-line Calculator v2 [http://nvd.nist.gov/CVSS-v2-Calculator] 

RELATED INFORMATION
IBM Secure Engineering Web Portal [http://www.ibm.com/security/secure-engineering/bulletins.html] 
IBM Product Security Incident Response Blog [http://www.ibm.com/blogs/psirt] 

ACKNOWLEDGEMENT
None 

CHANGE HISTORY
 December 16, 2014: Original Version Published 
December 18, 2014: Added instruction for Windows
March 23, 2015: Updated Recommendation/Fix section
July 10, 2015: Updated with V10.1 FP5 fix info
Aug 13, 2015: Updated with V10.5 FP6 fix info
Oct 2, 2015: Updated with V9.7 FP11 fix info 

*The CVSS Environment Score is customer environment specific and will ultimately impact the Overall CVSS Score. Customers can evaluate the impact of this vulnerability in their environments by accessing the links in the Reference section of this Security Bulletin. 

DISCLAIMER
According to the Forum of Incident Response and Security Teams (FIRST), the Common Vulnerability Scoring System (CVSS) is an "industry open standard designed to convey vulnerability severity and help to determine urgency and priority of response." IBM PROVIDES THE CVSS SCORES "AS IS" WITHOUT WARRANTY OF ANY KIND, INCLUDING THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. CUSTOMERS ARE RESPONSIBLE FOR ASSESSING THE IMPACT OF ANY ACTUAL OR POTENTIAL SECURITY VULNERABILITY. 






Cross reference information Segment Product Component Platform Version Edition Information Management DB2 Connect 9.7, 9.5, 10.1, 10.5