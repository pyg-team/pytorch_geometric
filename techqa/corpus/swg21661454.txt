Title: IBM Unable to connect with SimpleSRM in redirection using ISDM on AIX - United States

Text:
redirection; certificate; expired TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Attempts to connect with SimpleSRM in redirection using IBM Service Delivery Manager on AIX results in the error "SSL0221E: SSL Handshake Failed". 

SYMPTOM
Error message in http.log:

SSL0221E: SSL Handshake Failed, Either the certificate has expired or the system clock is incorrect. 


CAUSE
Cloudburst certificate expired.

DIAGNOSING THE PROBLEM
Get the GSK7 lib in /usr/lib of the NFS machine: 

cd /usr/lib 
for i in `ls -1 /usr/IBM/HTTPServer/gsk7/lib/` 
>do 
>ln -s /usr/IBM/HTTPServer/gsk7/lib/$i 
>done 

Get the GSK7 binary in PATH 
export PATH=$PATH:/usr/IBM/HTTPServer/gsk7/bin/ 

See the details of the certificate 


gsk7capicmd -cert -details -db http_key.kdb -pw <password> -label <label> 
**The default password is password 
** Default label is CLOUDBURSTHTTP 


RESOLVING THE PROBLEM
Procedure: 

 

 1. Run the following command to delete the certificate if it is expired:
    
    gsk7capicmd -cert -delete -db http_key.kdb -pw <password> -label <label> 
    
    
 2. Create a new certificate:
    
    gsk7capicmd -cert -create -db http_key.kdb -pw <password> -label <label> 
    -size 1024 -expire 365 -dn "CN=cloudburst,O=TESTCA,OU=IBM,C=US"
    
    ** This will renew the certificate for 1 year (365 days) 
    
    
 3. Set the certificate as default certificate:
    
    gsk7capicmd -cert -setdefault -db http_key.kdb -pw password -label <label> 
    
    
 4. Copy the plugin-key.sth and plugin-key.kdb from TSAM server:
    
    /usr/IBM/WebSphere/AppServer/profiles/ctgAppSrv01/config/cells/ctgCell01/nodes/ctgNode01/servers/webserver1/ 
    
    to the following folder of the NFS image:
    
    /usr/IBM/HTTPServer/Plugins/etc 
    
    
 5. Restart HTTP server
    
    /usr/IBM/HTTPServer/bin/apachectl -k stop 
    
    /usr/IBM/HTTPServer/bin/apachectl -k start