Title: IBM PI34088: ERROR IN SAML WEB SSO TAI WITH CUSTOM SP-INITIATED SSO - United States

Text:
  FIXES ARE AVAILABLE
8.0.0.11: WebSphere Application Server V8.0 Fix Pack 11 [http://www-01.ibm.com/support/docview.wss?uid=swg24040425]
8.5.5.7: WebSphere Application Server V8.5.5 Fix Pack 7 [http://www-01.ibm.com/support/docview.wss?uid=swg24040533]
PI34088;8.5.5: Error in SAML Web SSO TAI with custom SP-initiated SSO [http://www-01.ibm.com/support/docview.wss?uid=swg24040971]
7.0.0.39: WebSphere Application Server V7.0 Fix Pack 39 [http://www-01.ibm.com/support/docview.wss?uid=swg24041013]
8.5.5.8: WebSphere Application Server V8.5.5 Fix Pack 8 [http://www-01.ibm.com/support/docview.wss?uid=swg24041178]
8.0.0.12: WebSphere Application Server V8.0 Fix Pack 12 [http://www-01.ibm.com/support/docview.wss?uid=swg24041590]
8.5.5.9: WebSphere Application Server V8.5.5 Fix Pack 9 [http://www-01.ibm.com/support/docview.wss?uid=swg24041819]
7.0.0.41: WebSphere Application Server V7.0 Fix Pack 41 [http://www-01.ibm.com/support/docview.wss?uid=swg24041931]
8.5.5.10: WebSphere Application Server V8.5.5 Fix Pack 10 [http://www-01.ibm.com/support/docview.wss?uid=swg24042150]
8.5.5.11: WebSphere Application Server V8.5.5 Fix Pack 11 [http://www-01.ibm.com/support/docview.wss?uid=swg24043005]
8.0.0.13: WebSphere Application Server V8.0 Fix Pack 13 [http://www-01.ibm.com/support/docview.wss?uid=swg24042746]
7.0.0.43: WebSphere Application Server V7.0 Fix Pack 43 [http://www-01.ibm.com/support/docview.wss?uid=swg24043400]
8.5.5.12: WebSphere Application Server V8.5.5 Fix Pack 12 [http://www-01.ibm.com/support/docview.wss?uid=swg24043844]
8.0.0.14: WebSphere Application Server V8.0 Fix Pack 14 [http://www-01.ibm.com/support/docview.wss?uid=swg24044096]
8.5.5.13: WebSphere Application Server V8.5.5 Fix Pack 13 [http://www-01.ibm.com/support/docview.wss?uid=swg24044479]
7.0.0.45: WebSphere Application Server V7.0 Fix Pack 45 [http://www-01.ibm.com/support/docview.wss?uid=swg24044551]
8.0.0.15: WebSphere Application Server V8.0 Fix Pack 15 [http://www-01.ibm.com/support/docview.wss?uid=swg24044734]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  With the SAML Web SSO TAI, when custom code is used to
   simulate SP-initiated SSO, the TAI will fail to validate the
   SAMLResponse with the following error:
   
   CWWSS8006E: InResponseTo must not be present for IdP-Initiated
   unsolicited responses.
   
   
    
   
   

LOCAL FIX
 *  N/A
   
   
    
   
   

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED:  IBM WebSphere Application Server users of   *
   *                  SAML web single sign-on (SSO)               *
   ****************************************************************
   * PROBLEM DESCRIPTION: An error occurs in the SAML Web SSO     *
   *                      TAI with custom SP-initiated SSO        *
   ****************************************************************
   * RECOMMENDATION:  Install a fix pack that includes this       *
   *                  APAR.                                       *
   ****************************************************************
   The SAML web single sign-on (SSO) Trust Association
   Interceptor (TAI) supports identity provider (IdP)-initiated
   SSO only.  If a service provider (SP) attempts to
   do SP-initiated SSO by including a SAMLRequest in the request
   to the IdP, the SP cannot process the SAMLResponse and will
   emit the following error:
   CWWSS8006E: InResponseTo must not be present for IdP-Initiated
   unsolicited responses.
   
   
    
   
   

PROBLEM CONCLUSION
 *  The SAML TAI is updated to provide an option to include a
   SAMLRequest in the request to the IdP by using a plug point,
   and process solicited SAMLResponses corresponding to the
   SAMLRequest. To use this feature, set the following custom
   property to your custom class that implements the
   com.ibm.wsspi.security.web.saml.AuthnRequestProvider SPI:
   
   sso_<id>.sp.login.error.page
   
   
   Following is the interface for
   com.ibm.wsspi.security.web.saml.AuthnRequestProvider:
   
   public interface AuthnRequestProvider extends
   IdentityProviderMapping {
     public static final String AUTHN_REQUEST="authnRequest";
     public static final String REQUEST_ID = "requestId";
     public static final String RELAY_STATE="relayState";
     public static final String SSO_URL="ssoUrl";
   
     /**
      * Maps a HttpServletRequest to a valid URL.
      * This is used to map the HttpServletRequest to a valid URL,
      * so that WebSphere can redirect user to the URL for
      * re-login or receiving error message
      *
      * @para    req the HttpServletRequest
      * @param   errorMsg the String
      * @param   acsUrl the String of AssertionConsumerService URL
      * @param   ssoUrl the ArrayList of Single-SignOn service URLs
      * @return  the URL String of the user which should be
      *          redirected to
      * @exception NotImplementedException if this implementation
      *            is not supported.
      **/
      public HashMap <String, String> getAuthnRequest(
                     HttpServletRequest req,
                     String errorMsg,
                     String acsUrl,
                     ArrayList<String> ssoUrls)
                     throws NotImplementedException;
   }
   
   The fix for this APAR is currently targeted for inclusion in
   fix pack 7.0.0.39, 8.0.0.11 and 8.5.5.7.  Please refer to the
   Recommended Updates page for delivery information:
   http://www.ibm.com/support/docview.wss?rs=180&uid=swg27004980 [http://www.ibm.com/support/docview.wss?rs=180&uid=swg27004980]
   
   Keywords: IBMWL3WSS, SAMLWSSO, FIXEDBYPI47842
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PI34088
   
   
 * REPORTED COMPONENT NAME
   WEBS APP SERV N
   
   
 * REPORTED COMPONENT ID
   5724H8800
   
   
 * REPORTED RELEASE
   700
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt / Xsystem
   
   
 * SUBMITTED DATE
   2015-02-03
   
   
 * CLOSED DATE
   2015-04-28
   
   
 * LAST MODIFIED DATE
   2015-11-18
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WEBS APP SERV N
   
   
 * FIXED COMPONENT ID
   5724H8800
   
   

APPLICABLE COMPONENT LEVELS
 * R700 PSY
   UP
   
   
 * R800 PSY
   UP
   
   
 * R850 PSY
   UP