Title: IBM Collect IBM MQ MustGather data to solve dead letter queue problems on Linux, UNIX, Windows and IBM i - United States

Text:
MustGather; MustGathers Must Gather; MustGatherDocument; Collect Troubleshooting Data; Collect; Trouble; Shooting; Dead Letter Queue; Dead Letter; DLQ TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 An IBM MQ queue manager is placing messages on its dead letter queue, and you need to collect MustGather data to find a solution. 

ENVIRONMENT
These instructions apply only to IBM MQ V9.0 and V8.0, and WebSphere MQ V7.5, V7.1, V7.0 and V6.0 on AIX, HP-UX, Linux, Solaris and Windows, and to IBM MQ V9.0 and V8.0, and WebSphere MQ V7.1, V7.0 and V6.0 on IBM i. Refer to the IBM MQ Read First page for instructions on other operating systems:



 * IBM MQ Read First [http://www.ibm.com/support/docview.wss?uid=swg21229861]



RESOLVING THE PROBLEM
 

Please answer these questions about the problem and then follow the steps below:



 * What dead letter queue problem did you observe on the system?
 * What time did the dead letter queue problem start and when did it stop?
 * Where are the dead letter messages coming from, and what is their intended route?



STEP 1: GENERATE DATA

If messages are going to the dead letter queue right now, or if you can reproduce the problem which cases messages to go there, generate data to provide more information about the problem:



 1. 
 2. Generate a trace of the queue mnager while messages are going to the dead letter queue:
    
     * Linux and UNIX [http://www.ibm.com/support/docview.wss?uid=swg21665357]
     * Windows [http://www.ibm.com/support/docview.wss?uid=swg21666876]
    
     * IBM i [http://www.ibm.com/support/docview.wss?uid=swg21664990]
    
    
 3. 
 4. 
 5. Browse the messages on the dead letter queue using a program like the amqsbcg sample. For example:
 6.  
    BROWSING QMA.DEAD.LETTER.QUEUE ON QUEUE MANAGER QMA
    
    amqsbcg QMA.DEAD.LETTER.QUEUE QMA > QMA.DLQ.browse.txt 
    
 7. 



STEP 2: COLLECT DATA
 1. 
 2. Place the browse output from Step 1 directly in the top-level MQ errors directory. Both the runmqras automation tool and the manual collection steps below collect files found there.
 3. 
 4. 
 5. Collect data automatically with the runmqras command [http://www.ibm.com/support/docview.wss?uid=swg21624944] if you are running IBM MQ V9.0 or V8.0, or WebSphere MQ V7.5, V7.1.0.1 or later, or V7.0.1.8 or later. Be sure to collect the runmqras defs and trace sections, and to specify your PMR number:
 6.  
    COLLECTING RUNMQRAS OUTPUT FROM QUEUE MANAGER QMA
    
    runmqras -section defs,trace -qmlist QMA -pmrno 12345,67R,890 
    
 7. 
 8. 
 9. Alternatively, collect the MQ data manually on both sides of the channel.
    
    COLLECTING MQ DATA MANUALLY
     1.  
     2.  If your system has more than one MQ installation, use the setmqenv command to choose the one with the problem before proceeding:
         
         LINUX AND UNIX
         
         sh> . /path/to/mqm/bin/setmqenv -n InstallationX
         
         WINDOWS
         
         C:\> "C:\ProgramFiles\IBM\MQ\bin\setmqenv" -n InstallationX
         
     3.  
     4.  
     5.  Record the MQ version and maintenance level [http://www.ibm.com/support/docview.wss?uid=swg21621707].
     6.  
     7.  
     8.  Record the operating system version and maintenance level [http://www.ibm.com/support/docview.wss?uid=swg21634678].
     9.  
     10. 
     11. Save the MQ configuration information [http://www.ibm.com/support/docview.wss?uid=swg21621003], for example registry keys and ini files.
     12. 
     13. 
     14. If your system has more than one MQ installation, record your MQ installation details:
         
         LINUX AND UNIX
         
         sh> dspmqinst > /tmp/dspmqinst.txt
         
         WINDOWS
         
         C:\> dspmqinst > %TEMP%/dspmqinst.txt
         
     15. 
     16. 
     17. On MQ V7.1 and later installations, use dmpmqcfg to record the queue manager configuration:
         
         LINUX AND UNIX
         
         sh> dmpmqcfg -m QMA > /tmp/QMA.config.txt
         
         WINDOWS
         
         C:\> dmpmqcfg -m QMA > %TEMP%\QMA.config.txt
         
         IBM I QSHELL
         
         ===> /QSYS.LIB/QMQM.LIB/DMPMQCFG.PGM -m QMA > /tmp/QMA.config.txt
         
     18. 
     19. 
     20. Otherwise, on MQ V7.0 and earlier installations, use runmqsc to record the queue manager configuration [http://www.ibm.com/support/docview.wss?uid=swg21621085]. If any command gives an error, carry on with the others:
         
         DISPLAY QMGR ALL
         DISPLAY Q(*) ALL
         DISPLAY SUB(*) ALL
         DISPLAY TOPIC(*) ALL
         DISPLAY CHANNEL(*) ALL
         DISPLAY SERVICE(*) ALL
         DISPLAY PROCESS(*) ALL
         DISPLAY LISTENER(*) ALL
         DISPLAY NAMELIST(*) ALL
         
     21. 
     22. 
     23. Manually package your files for IBM [http://www.ibm.com/support/docview.wss?uid=swg21671892], including files containing the output from the commands listed in Step 1 and 2.
     24. 
    
    


STEP 3: SEND DATA TO IBM
 1.  
 2.  Send your data to the IBM ECuRep repository [http://www.ibm.com/de/support/ecurep/send.html] by email to websphere_support@ecurep.ibm.com, by standard or secure HTTP or FTP. or by using the IBM Secure Diagnostic Data Upload Utility (SDDUU) Java application.
 3.  
 4.  
 5.  While the data is transferring, send an email or use the IBM Service Request tool [http://www.ibm.com/support/servicerequest/] to update your PMR with your description of the problem and of the data you are sending.
 6.  
 7.  
 8.  A good description of the problem and the data is the most important information you can provide to IBM. Please do not send data without providing a description!
 9.  
 10. Contact your country representative [http://www.ibm.com/planetwide/] if you need to speak to an IBM technical support representative, or in the US call 1-800-IBM-SERV. Refer to the IBM Software Support Handbook [http://www14.software.ibm.com/webapp/set2/sas/f/handbook/home.html] for more information on working with IBM.
 11. 
 12. 
 13. 
 14. Back to top

 

PRODUCT ALIAS/SYNONYM
 IBMMQ WebSphere MQ WMQ