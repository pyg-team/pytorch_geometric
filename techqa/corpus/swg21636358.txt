Title: IBM Unable to update, add, delete or save user role in Tivoli Integrated portal - United States

Text:
TIPL2CONF; not update add delete save user roles TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 A user is given certain roles but user can not perform taks allowed by those roles. If you try to update (add or delete) roles for that user, the roles does not get saved. No error message is displayed. 

CAUSE
This can happen if a user was created in one repository (say the file based repository) and it was assigned certain roles (let us use wasadmin user as an example in this technote). Later this user Id (wasadmin) was deleted from TIP but the roles were not removed from this user before deleting it. This leaves behind entries in Argus policy files. Later you added say OS based repository (which already had a user wasadmin) in Federated repositories. Now when you try to update (delete or add) roles in TIP for the OS user it will not be saved because of mismatched entries in Argus policy files and Federated repository. So even though you see some roles assigned to the user but those roles does not have any effect and user can not perform tasks allowed.

DIAGNOSING THE PROBLEM
Login into TIP using tipadmin account (default user Id) or equivalent id.


 1. Click on "Users and Groups -> Manage Users" in the left Navigation pan 
 2. Search for user Id for which roles can not be updated (eg; wasadmin). 
 3. Make a note of unique name for that user (eg; UID=wasadmin,O=Custom). 
 4. Check if the unique name found in above step matches the entries for that user in the Argus policy files. 
    
    Note: On a Unix machine you can run below command to find entries in the policy files. In the following command change the user id from wasadmin to the user id in question and the <TIPHOME> dir. If you are on a Windows server then you can look into each file manually under isc directory. 

 * 
 * 
 * find . | xargs grep -i wasadmin | awk -F"<" '{for (i=1;i<=NF;i++) printf "%s %s\n", $1,$i}' | grep -i wasadmin | awk -F":" '{print $1 $(NF)}' | awk '{sub(/os\">/," "); print}'
   


6. The above command will produce a list of entries like below. In the following "UID=wasadmin, O=defaultWIMFileBasedRealm" represents unique name (where wasadmin is the user id and defaultWIMFileBasedRealm is the repository where this user exist). This unique name should match unique name found in step 4. If it does not match then proceed to next step to resolve this issue. 

./RPS%3Ahref%3ATIPCell%2Fisc%3Aroles%3Aadministrator.xml UID=wasadmin, O=defaultWIMFileBasedRealm 
./RPS%3Ahref%3ATIPCell%2Fisc%3Aroles%3AchartAdministrator.xml UID=wasadmin, O=defaultWIMFileBasedRealm 
./RPS%3Ahref%3ATIPCell%2Fisc%3Aroles%3AchartCreator.xml UID=wasadmin, O=defaultWIMFileBasedRealm 
./RPS%3Ahref%3ATIPCell%2Fisc%3Aroles%3AchartViewer.xml UID=wasadmin, O=defaultWIMFileBasedRealm 
./RPS%3Ahref%3ATIPCell%2Fisc%3Aroles%3Aconfigurator.xml UID=wasadmin, O=defaultWIMFileBasedRealm 
./RPS%3Ahref%3ATIPCell%2Fisc%3Aroles%3Ainventoryadministrator.xml UID=wasadmin, O=defaultWIMFileBasedRealm 
RESOLVING THE PROBLEM
To resolve this issue we can create a user with same user id (eg; wasadmin) in the same registry where it initially existed. After this we will remove all the roles from this user to clean up the Argus policy files and then delete this newly created user. The idea is to clean up stale entries in the Argus policy files. 

Follow below step to accomplish this: 

1. Click on "User Groups -> Manage Users" and create a new user with the same Id as the user question (eg; wasadmin).
3. Search for that user id from "User Groups -> Manage Roles". You will see two users. 
2. Select the newly created user and remove all the roles from this user. 
3. Now remove the newly created user (eg; wasadmin) created in step 1. 
4. Logout and then loigin to TIP again as tipadmin and assign appropriate roles to user in question (eg; wasadmin). The roles should get saved. 

Logout and then login as wasadmin to confirm if this user can now perform desired tasks.