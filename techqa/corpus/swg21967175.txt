Title: IBM TLS handshake error on usage of SHA-2 showing  DECRYPT_ERROR - United States

Text:
SHA-2 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Secure+ is configured. A SHA-2 certificate is in use (signature algorithm sha224RSA, sha256RSA, sha384RSA, or sha512RSA).




SYMPTOM
On IBM Sterling File Gateway

MSGID=JSKT003E,RC=8,FDBK=1,CLMTHNAME=CdCommMgr.doHandshake,
CDTXT="The Secure+ SSL or TLS handshake operation failed.
Check the error text for SSL/TLS error information and follow
diagnostic and reporting procedures.",
JTXT="com.certicom.net.ssl.c: FATAL Alert:DECRYPT_ERROR - A
cryptographic operation failed

On HPNonStop

MSGID=JSKT003E,RC=8,FDBK=1,CLMTHNAME=CdCommMgr.doHandshake,
CDTXT="The Secure+ SSL or TLS handshake operation failed.
Check the error text for SSL/TLS error information and follow
diagnostic and reporting procedures.",
JTXT="com.certicom.net.ssl.c: FATAL Alert:DECRYPT_ERROR - A
cryptographic operation failed.
Description: Alert Received."
].


CAUSE
The GA version of IBM Sterling Connect.Direct HPNonStop 3.6 is in use. That version used OpenSSL library 0.9.7i, which did not have support for the SHA-2 signature algorithms

ENVIRONMENT
IBM Sterling Connect:Direct for HPNonStop 3.6


DIAGNOSING THE PROBLEM
Check the product version of the NDMSMGR module on C:D HP NonStop. At a TACL prompt on the NonStop system, navigate to the subvolume in which the NDMSMGR module resides, then issue the TACL command "VPROC NDMSMGR". 


Example output:

$CDVOL.NDMOBJ 3> vproc ndmsmgr


$CDVOL.NDMOBJ.NDMSMGR
Binder timestamp: 23FEB2011 16:27:44
Version procedure: T9999H01_CD3600_Jan2011
Version procedure: T8432H02_21MAY2008_CCPLMAIN
TNS/E Native Mode: runnable file
$CDVOL.NDMOBJ 4>

The above information identifies the object version of this executable as 3.6.0 (CD3600) with a binder timestamp of 23 Feb 2011.

Any version with a binder timestamp prior to 27 Feb 2013 (Fix Pack 3.6.0.1) will not support SHA-2 certificates.


RESOLVING THE PROBLEM
Upgrade to Fix Pack 3.6.0.1 or any later GA version to enable support for SHA-2 certificates. It is also recommended that the latest iFixes also be installed to bring the product fully up-to-date. 

The fix pack or GA version must be applied first, then applicable iFixes afterwards, because the iFix package contains only those modules that have changed since the publication of the most recent fix pack or GA version.