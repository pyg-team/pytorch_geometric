Title: IBM The difference between "default" and static routes on the DataPower appliance - United States

Text:
datapower; routing; route; default; static; gateway; default gateway; static route TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 The default route and static routes on the DataPower appliance have different functionality and behavior. 

RESOLVING THE PROBLEM
A static route forces the DataPower appliance to use a specific interface and a specific set of network hops to access a given set of destinations. The "default route" is created by setting the Default Gateway of an interface on a DataPower appliance. 

A default route will be used if a known route does not exist for a given destination address. If multiple default routes are configured, the appliance will randomly pick which interface to use for outbound traffic if a more specific route cannot be found. 

If you want your network traffic to follow a specific route, set a static route and NOT rely on the default gateway. As a general rule, the management interface should not have the default gateway set, as you generally want to restrict the connections that can be made through that interface. 

A general recommendation is to set specific static routes and only ONE default gateway that will catch all traffic not being directed by the static routes. 

Consider the following example after running this command from the CLI: 


xs40# show route



destination interface gateway metric 0.0.0.0/0 eth0 167.91.8.1 0 0.0.0.0/0 eth1 167.91.7.1 0 0.0.0.0/0 mgt0 10.238.77.1 0 10.238.77.0/24 mgt0 [/support/docview.wss?uid=swg21249208&amp;aid=1] 0 167.81.18.0/23 eth0 [/support/docview.wss?uid=swg21249208&amp;aid=1] 0 167.81.18.0/23 eth1 [/support/docview.wss?uid=swg21249208&amp;aid=1] 0 

The output above shows that three default gateways were configured on eth0, eth1, and mgt0 which causes three "default" route to be generated (0.0.0.0/0). If the destination address of your service is 166.84.23.4, the device will randomly choose any one of the default routes as no specific route is configured. If, for example, the gateway picked is 10.238.77.1 and the gateway does not know how to route to the needed backend server ip address, this will cause unexpected connection failures. In the case of such failure, a reboot of the device will lead to a different route to be randomly picked, thus temporarily resolving until the next failure. 

Firmware 3.7.2 and later 

Instructions for setting the default gateway and for setting a static route can be found in the "Managing the appliance" section of the Administrators Guide. The command line commands are ip default-gateway and ip route respectively, and more information is available in the CLI Reference Guide. 

Firmware earlier than 3.7.2 

Instructions for setting the default gateway and static routes can be found in the "Ethernet Interface" appendix of the WebGUI Guide. The command line commands are ip default-gateway and ip route respectively, and more information is available in the CLI Reference Guide. 

To access product documentation, see these instructions. [http://www.ibm.com/support/docview.wss?rs=2362&uid=swg21377654]

 


Cross reference information Segment Product Component Platform Version Edition Business Integration WebSphere DataPower Integration Appliance XI50 Not Applicable Firmware 3.8.2, 3.8.1, 3.8, 3.7.3 Business Integration WebSphere DataPower B2B Appliance XB60 Not Applicable Firmware 3.7.3 Business Integration WebSphere DataPower Low Latency Appliance XM70 Not Applicable Firmware 3.7.3 Business Integration WebSphere DataPower XML Security Gateway XS40 Not Applicable Firmware 3.8.2, 3.8.1, 3.8, 3.7.3 Business Integration WebSphere DataPower XML Accelerator XA35 Not Applicable Firmware 3.8.2, 3.8.1, 3.8, 3.7.3