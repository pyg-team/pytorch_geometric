Title: IBM IC75595: PERMIT HTTPRequestHeader TO BE THE LAST CHILD OF ROOT - United States

Text:
  A FIX IS AVAILABLE
WebSphere Message Broker V7.0 - Fix Pack 7.0.0.4 [http://www-01.ibm.com/support/docview.wss?uid=swg24032332]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  When a SOAP message is processed the last child of root is
   expected to be the SOAP body. When a different part of the
   message is the last child of root then axis2 throws an
   exception stating that it has encountered an invalid character
   (BIP 3701) in the prolog of the document.
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  ****************************************************************
   USERS AFFECTED:
   All users of WebSphere Message Broker version 7 or higher using
   the SOAPRequest node.
   
   Platforms Affected:
   All Platforms
   ****************************************************************
   PROBLEM SUMMARY:
   When a SOAP message is processed the last child of root is
   expected to be the SOAP body. When a different part of the
   message is the last child of root then axis2 throws an
   exception stating that it has encountered an invalid character
   (BIP 3701) in the prolog of the document:
   
   A Java exception was thrown whilst calling the Java JNI method
   ''Axis2Requester_processRequestMessageNonSoap''. The Java
   exception was ''org.apache.axiom.om.OMException:
   javax.xml.stream.XMLStreamException: An invalid XML character
   (Unicode: 0x41) was found in the prolog of the document.''. The
   Java stack trace was ''Frame : 0
   org.apache.axiom.om.OMException:
   javax.xml.stream.XMLStreamException: An invalid XML character
   (Unicode: 0x41) was found in the prolog of the document.
   @:
   org.apache.axiom.om.impl.builder.StAXOMBuilder.next(StAXOMBuilde
   r.java:254)
   @:
   org.apache.axiom.om.impl.llom.OMDocumentImpl.getOMDocumentElemen
   t(OMDocumentImpl.java:132)
   @:
   org.apache.axiom.om.impl.builder.StAXOMBuilder.getDocumentElemen
   t(StAXOMBuilder.java:537)
   @:
   com.ibm.broker.axis2.SoapUtilities.wrapDataInSoapEnvelopeIfRequi
   redAvoidingAxis2(SoapUtilities.java:1715)
   @:
   com.ibm.broker.axis2.Axis2Requester.processRequestMessageNonSoap
   (Axis2Requester.java:1065)
   Frame : 1 javax.xml.stream.XMLStreamException: An invalid XML
   character (Unicode: 0x41) was found in the prolog of the
   document.
   @:
   com.ibm.xml.xlxp2.api.stax.msg.StAXMessageProvider.throwWrappedX
   MLStreamException(StAXMessageProvider.java:76)
   @:
   com.ibm.xml.xlxp2.api.stax.XMLStreamReaderImpl.produceFatalError
   Event(XMLStreamReaderImpl.java:2006)
   @:
   com.ibm.xml.xlxp2.api.jaxb.JAXBXMLStreamReader.produceFatalError
   Event(JAXBXMLStreamReader.java:316)
   @:
   com.ibm.xml.xlxp2.scan.DocumentScanner.reportFatalError(Document
   Scanner.java:4942)
   @:
   com.ibm.xml.xlxp2.scan.DocumentScanner.reportFatalError(Document
   Scanner.java:1205)
   @:
   com.ibm.xml.xlxp2.scan.DocumentScanner.scanProlog(DocumentScanne
   r.java:1770)
   @:
   com.ibm.xml.xlxp2.scan.DocumentScanner.nextEvent(DocumentScanner
   .java:1316)
   @:
   com.ibm.xml.xlxp2.api.stax.XMLStreamReaderImpl.next(XMLStreamRea
   derImpl.java:579)
   @:
   com.ibm.xml.xlxp2.api.stax.XMLInputFactoryImpl$XMLStreamReaderPr
   oxyImpl.next(XMLInputFactoryImpl.java:183)
   @:
   com.ibm.xml.xlxp2.api.wssec.WSSXMLInputFactory$WSSStreamReaderPr
   oxy.next(WSSXMLInputFactory.java:55)
   @:
   org.apache.axiom.om.impl.builder.StAXOMBuilder.parserNext(StAXOM
   Builder.java:632)
   @:
   org.apache.axiom.om.impl.builder.StAXOMBuilder.next(StAXOMBuilde
   r.java:174)
   @:
   org.apache.axiom.om.impl.llom.OMDocumentImpl.getOMDocumentElemen
   t(OMDocumentImpl.java:132)
   @:
   org.apache.axiom.om.impl.builder.StAXOMBuilder.getDocumentElemen
   t(StAXOMBuilder.java:537)
   @:
   com.ibm.broker.axis2.SoapUtilities.wrapDataInSoapEnvelopeIfRequi
   redAvoidingAxis2(SoapUtilities.java:1715)
   @:
   com.ibm.broker.axis2.Axis2Requester.processRequestMessageNonSoap
   (Axis2Requester.java:1065)''.
   
   This is caused by the Broker misinterpreting the
   HTTPRequestHeader as a SOAP body. Because the first character
   is not a "<" character the axis2 engine throws this error.
   
   
    
   
   

PROBLEM CONCLUSION
 *  The SOAPRequest node has been modified so that if the last
   child of root is a HTTPRequestHeader folder then the previous
   child, if it exists, will be used as the SOAP Body and the last
   child will be used as the header. If no previous child exists
   an exception will be thrown. The last child of root will be
   used as the HTTPRequestHeader regardless of the existence of
   any other HTTPRequestHeader folders previously in the message
   tree.
   
   ---------------------------------------------------------------
   The fix is targeted for delivery in the following PTFs:
   
   V7.0 - Maintenance Level 7.0.0.4
   
   The latest available maintenance can be obtained from
   'WebSphere Message Broker Recommended Fixes'
   http://www.ibm.com/support/docview.wss?rs=849&uid=swg27006041 [http://www.ibm.com/support/docview.wss?rs=849&uid=swg27006041]
   
   If the maintenance level is not yet available, information on
   its planned availability can be found in 'WebSphere Message
   Broker Planned Maintenance Release Dates'
   http://www-1.ibm.com/support/docview.wss?rs=849&uid=swg27006308 [http://www-1.ibm.com/support/docview.wss?rs=849&uid=swg27006308]
   ---------------------------------------------------------------
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IC75595
   
   
 * REPORTED COMPONENT NAME
   WEB MESSAGE BRO
   
   
 * REPORTED COMPONENT ID
   5724J0510
   
   
 * REPORTED RELEASE
   700
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2011-04-05
   
   
 * CLOSED DATE
   2011-07-28
   
   
 * LAST MODIFIED DATE
   2011-08-15
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WEB MESSAGE BRO
   
   
 * FIXED COMPONENT ID
   5724J0510
   
   

APPLICABLE COMPONENT LEVELS
 * R700 PSY
   UP