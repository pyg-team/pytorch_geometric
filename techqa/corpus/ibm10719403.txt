Title: IBM Error "org.xml.sax.SAXParseException: An invalid XML character (Unicode: 0x1f) was found in the element content of the document" importing artifacts using the RQM Excel Import Utility - United States

Text:
org.xml.sax.SAXParseException TROUBLESHOOTING

PROBLEM
An error is thrown in IBM Rational Quality Manager (RQM) Excel Import Utility log when attempting to import test artifacts from a Microsoft Excel spreadsheet:

Example:

org.xml.sax.SAXParseException: An invalid XML character (Unicode: 0x1f) was found in the element content of the document 

The importer tool generates XML from the spreadsheet's data to post the content to the RQM server. If the content contains invalid character, the server's XML parser cannot process that data.

SYMPTOM
A generic error in the RQM Excel Import Utility UI:

Error 400 Bad Request

A more detailed error in Mso2Rqm_Debug.log:

Example: org.xml.sax.SAXParseException: An invalid XML character (Unicode: 0x1f) was found in the element content of the document 

CAUSE
The spreadsheet contains characters that are invalid for the utility's XML parser. An example is the unicide 0x1F which is a Unit Separator (US) and used as a delimiter to separate items in text. It is not a valid XML character.

ENVIRONMENT
All supported Rational Quality Manager versions.

DIAGNOSING THE PROBLEM
Review the RQM Excel Import Utility Mso2Rqm_Debug.log closely for the detailed error in the case of a generic "bad request" thrown in the utility user interface."org.xml.sax.SAXParseException: An invalid XML character " indicates that the parser encountered an invalid character.

RESOLVING THE PROBLEM
One possible solution is to save the Excel file as a comma separated text file (CSV) and use a text editor (such as Notepad ++) to find and replace the invalid unicode control characters. Then save the file again in Excel format and it should import if all invalid characters are replaced.

Below is one possible solution using Notepad ++.

Note: This process is not supported by IBM Technical Support.

 1. Save the Excel spreadsheet as .csv (comma separated text file)
 2. Open the .csv file in an editor (such as Notepad++)
 3. Replace the invalid characters:
 4. Select Extended from Search Mode in Notepad ++.
 5. Search for: \x1f and replace with a single space
 6. Save the .csv file in Notepad++
 7. Open the .csv file in Microsoft Excel and save again in .xls format
 8. Attempt to import the spreadsheet again using the RQM Excel Import Utility