Title: IBM PJ43656: CSS FAILS TO EXTRACT (OIT) CERTAIN DOCUMENT TYPES CORRECTLY - United States

Text:
 SUBSCRIBE TO THIS APAR
By subscribing, you receive periodic emails alerting you to the status of the APAR, along with a link to the fix after it becomes available. You can track this item individually or track all items by product.

Notify me when this APAR changes.

Notify me when an APAR for this component changes.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  When using IBM Content Collector (ICC) for indexing through CSS
   it fails to produce expected OIT extraction results from the
   following cases:
   
            XLSM:   Password protected XLSM files give the wrong
   error message when failing textExtraction
            DOC:    A specific MS word DOC file extraction with OIT
   doesn't return its contents
            PDF:    OIT returns wrong error message for password
   protected file
   
   
      Actual Results:
          XLSM: Password protected file returned "unsupported mime
   type"
         DOC:   File is reported in logs to be corrupt with this
   message:
                   "IQQP0032E The parser [OIT Extractor] cannot
   parse the document with id [Report.doc] because the document is
   corrupted. IQQG0020E ExtendedException:
   P9024E.TRANSFORMATION_SERVICE_TEXTEXTRACTION_FAILURE IQQP9024E
   Transformation service failed to extract text. Return code: 9,
   error description: [file is corrupt]."
         PDF: Error reported in logs erroneously:
                  *** Error parsing document!!! , Error level -
   IQQP0032E The parser [OIT Extractor] cannot parse the document
   with id [Tapani\ Plumbing\ 10008279\ -\ Nov12\ Invoice\ for\
   Review.pdf] because the document is corrupted. IQQG0020E
   ExtendedException:
   P9024E.TRANSFORMATION_SERVICE_TEXTEXTRACTION_FAILURE IQQP9024E
   Transformation service failed to extract text. Return code: 9,
   error description: [file is corrupt].
   
      Expected Results:
         XLSM:  Log error similar to this instead:
                   "SEVERE: Task id: 4 ERROR : CODE: IQQP0031E
   DESC:IQQP0031E The parser [OIT Extractor] cannot parse the
   document with id [Summary.xlsm] because the document is password
   protected or encrypted"
        DOC:  Document should be indexed and processed correctly
        PDF: Log error similar to this instead:
                  *** Error parsing document!!! , Error level -
   IQQP0031E The parser [OIT Extractor] cannot parse the document
   with id [Tapani\ Plumbing\ 10008279\ -\ Nov12\ Invoice\ for\
   Review.pdf] because the document is password protected or
   encrypted IQQG0020E ExtendedException:
   P9024E.TRANSFORMATION_SERVICE_TEXTEXTRACTION_FAILURE IQQP9024E
   Transformation service failed to extract text. Return code: 11,
   error description: [file is password protected or encrypted].
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED:                                              *
   * Customer using 5.2.1.2-P8CSS-FP002 or prior Content Search   *
   * Services indexing through IBM Content Collector certain file *
   * types are incorrectly indexing                               *
   ****************************************************************
   * PROBLEM DESCRIPTION:                                         *
   * When using IBM Content Collector (ICC) for indexing Content  *
   * Search Services fails to produce expected OIT extraction     *
   * results from the following cases:                            *
   *                                                              *
   *          XLSM:   Password protected XLSM files give the      *
   * wrong error message when failing textExtraction              *
   *          DOC:    A specific MS word DOC file extraction with *
   * OutsideIn doesn't return its contents                        *
   *          PDF:    OutsideIn returns wrong error message for   *
   * password protected file                                      *
   *                                                              *
   *                                                              *
   *    Actual Results:                                           *
   *        XLSM: Password protected file returned "unsupported   *
   * mime type"                                                   *
   *       DOC:   File is reported in logs to be corrupt with     *
   * this message:                                                *
   *                 "IQQP0032E The parser [OIT Extractor] cannot *
   * parse the document with id [Report.doc] because the document *
   * is corrupted. IQQG0020E ExtendedException:                   *
   * P9024E.TRANSFORMATION_SERVICE_TEXTEXTRACTION_FAILURE         *
   * IQQP9024E                                                    *
   * Transformation service failed to extract text. Return code:  *
   * 9, error description: [file is corrupt]."                    *
   *       PDF: Error reported in logs erroneously:               *
   *                *** Error parsing document!!! , Error level - *
   * IQQP0032E The parser [OIT Extractor] cannot parse the        *
   * document                                                     *
   * with id [Tapani\ Plumbing\ 10008279\ -\ Nov12\ Invoice\ for\ *
   * Review.pdf] because the document is corrupted. IQQG0020E     *
   * ExtendedException:                                           *
   * P9024E.TRANSFORMATION_SERVICE_TEXTEXTRACTION_FAILURE         *
   * IQQP9024E                                                    *
   * Transformation service failed to extract text. Return code:  *
   * 9,                                                           *
   * error description: [file is corrupt].                        *
   *                                                              *
   *    Expected Results:                                         *
   *       XLSM:  Log error similar to this instead:              *
   *                 "SEVERE: Task id: 4 ERROR : CODE: IQQP0031E  *
   * DESC:IQQP0031E The parser [OIT Extractor] cannot parse the   *
   * document with id [Summary.xlsm] because the document is      *
   * password                                                     *
   * protected or encrypted"                                      *
   *      DOC:  Document should be indexed and processed          *
   * correctly                                                    *
   *      PDF: Log error similar to this instead:                 *
   *                *** Error parsing document!!! , Error level - *
   * IQQP0031E The parser [OIT Extractor] cannot parse the        *
   * document                                                     *
   * with id [Tapani\ Plumbing\ 10008279\ -\ Nov12\ Invoice\ for\ *
   * Review.pdf] because the document is password protected or    *
   * encrypted IQQG0020E ExtendedException:                       *
   * P9024E.TRANSFORMATION_SERVICE_TEXTEXTRACTION_FAILURE         *
   * IQQP9024E                                                    *
   * Transformation service failed to extract text. Return code:  *
   * 11,                                                          *
   * error description: [file is password protected or            *
   * encrypted].                                                  *
   ****************************************************************
   * RECOMMENDATION:                                              *
   * Upgrade to 5.2.1.3-P8CSS-FP003 or later.                     *
   ****************************************************************
   
   
    
   
   

PROBLEM CONCLUSION
 *  Fixed in 5.2.1.3-P8CSS-FP003 or later. Update has been made to
   the OutsideIn facility to resolve the file type problems with
   certain XLSM, PDF and DOC file types.
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PJ43656
   
   
 * REPORTED COMPONENT NAME
   CONTENT SEARCH
   
   
 * REPORTED COMPONENT ID
   5724R8109
   
   
 * REPORTED RELEASE
   520
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2015-10-09
   
   
 * CLOSED DATE
   2015-12-14
   
   
 * LAST MODIFIED DATE
   2015-12-14
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   CONTENT SEARCH
   
   
 * FIXED COMPONENT ID
   5724R8109
   
   

APPLICABLE COMPONENT LEVELS
 * R521 PSY
   UP