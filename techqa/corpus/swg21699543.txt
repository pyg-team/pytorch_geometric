Title: IBM Security Bulletin: Vulnerabilities in GSKit affect IBM® DB2® (CVE-2015-0138, CVE-2015-0159 and CVE-2014-6221) - United States

Text:
 SECURITY BULLETIN

SUMMARY
 GSKit is an IBM component that is used by IBM DB2. The GSKit that is shipped with IBM DB2 contains multiple security vulnerabilities including the “FREAK: Factoring Attack on RSA-EXPORT keys" TLS/SSL client and server vulnerability. IBM DB2 has addressed the applicable CVEs. 

VULNERABILITY DETAILS
CVEID: CVE-2015-0138 [http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-0138]
DESCRIPTION: A vulnerability in various IBM SSL/TLS implementations could allow a remote attacker to downgrade the security of certain SSL/TLS connections. An IBM SSL/TLS client implementation could accept the use of an RSA temporary key in a non-export RSA key exchange ciphersuite. This could allow a remote attacker using man-in-the-middle techniques to facilitate brute-force decryption of TLS/SSL traffic between vulnerable clients and servers. You are not affected if you do not use the DB2 LDAP security plugin with SSL connection to LDAP server. 

This vulnerability is also known as the FREAK attack. 

CVSS Base Score: 4.3
CVSS Temporal Score: See http://exchange.xforce.ibmcloud.com/#/vulnerabilities/100691 [http://exchange.xforce.ibmcloud.com/] for the current score
CVSS Environmental Score*: Undefined
CVSS Vector: (AV:N/AC:M/Au:N/C:N/I:P/A:N) 

CVEID: CVE-2015-0159 [http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-0159]
DESCRIPTION: An unspecified error in GSKit usage of OpenSSL crypto function related to the production of incorrect results on some platforms by Bignum squaring (BN_sqr) has an unknown attack vector and impact in some ECC operations. You are not affected if you do not use TLS 1.2. 


CVSS Base Score: 2.6
CVSS Temporal Score: See http://exchange.xforce.ibmcloud.com/#/vulnerabilities/100835 [http://exchange.xforce.ibmcloud.com/] for the current score
CVSS Environmental Score*: Undefined
CVSS Vector: (AV:N/AC:H/Au:N/C:N/I:P/A:N) 

CVEID: CVE-2014-6221 [http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6221]
DESCRIPTION: Random Data Generation using GSKit MSCAPI/MSCNG Interface Code does not generate cryptographically random data. An attacker could use this weakness to gain complete confidentially and/or integrity compromise. You are affected by this vulnerability if you are on Windows systems and you use the keyword GSK_MS_CERTIFICATE_STORE for the keystore file name which configures GSKit to use the Microsoft Certificate Store as the keystore. 


CVSS Base Score: 8.8
CVSS Temporal Score: See http://exchange.xforce.ibmcloud.com/#/vulnerabilities/98929 [http://exchange.xforce.ibmcloud.com/] for the current score
CVSS Environmental Score*: Undefined
CVSS Vector: (AV:N/AC:M/Au:N/C:C/I:C/A:N)

AFFECTED PRODUCTS AND VERSIONS
Customers who have Secure Sockets Layer (SSL) support enabled in their DB2 database system are affected. SSL support is not enabled in DB2 by default. 

All fix pack levels of IBM DB2 V9.5, V9.7, V10.1 and V10.5 editions listed below and running on AIX, Linux, HP, Solaris or Windows are affected. 

IBM® DB2® Express Edition
IBM® DB2® Workgroup Server Edition
IBM® DB2® Enterprise Server Edition
IBM® DB2® Advanced Enterprise Server Edition
IBM® DB2® Advanced Workgroup Server Edition
IBM® DB2® Connect™ Application Server Edition 
IBM® DB2® Connect™ Enterprise Edition
IBM® DB2® Connect™ Unlimited Edition for System i® 
IBM® DB2® Connect™ Unlimited Edition for System z®

The DB2 Connect products mentioned are affected only if a local database has been created. 

IBM® DB2® pureScale™ Feature for Enterprise Server Edition, V9.8, running on AIX or Linux is affected.

The IBM data server client and driver types are as follows: 

IBM Data Server Driver Package
IBM Data Server Driver for ODBC and CLI 
IBM Data Server Runtime Client
IBM Data Server Client 

REMEDIATION/FIXES
The recommended solution is to apply the appropriate fix for this vulnerability. 


FIX:

The fix for DB2 and DB2 Connect V9.7 is in FP11, V10.1 is in V10.1 FP5 and V10.5 is in V10.5 FP6, available for download from Fix Central. 

Customers running any vulnerable fixpack level of an affected Program, V9.5 or V9.8 can contact support to obtain a special build containing an interim fix for this issue. These special builds are available based on the most recent fixpack level for each impacted release: DB2 V9.5 FP10 or DB2 V9.8 FP5. They can be applied to any affected fixpack level of the appropriate release to remediate this vulnerability. Additionally fixes based on DB2 V9.5 FP9, DB2 V9.7 FP10, DB2 V10.1 FP4 or V10.5 FP5 will be made available on request. 

Refer to the following chart to determine how to proceed to obtain a needed fixpack or special build. 

Release Fixed in fix pack APAR Download URL V9.5 TBD IT07649 [http://www-01.ibm.com/support/docview.wss?uid=swg1IT07649] Please contact technical support. V9.7 FP11 IT07648 [http://www-01.ibm.com/support/docview.wss?uid=swg1IT07648] http://www-01.ibm.com/support/docview.wss?uid=swg24040935 [http://www-01.ibm.com/support/docview.wss?uid=swg24040935] V9.8 TBD IT07647 [http://www-01.ibm.com/support/docview.wss?uid=swg1IT07647] Please contact technical support. V10.1 FP5 IT07646 [http://www-01.ibm.com/support/docview.wss?uid=swg1IT07646] http://www-01.ibm.com/support/docview.wss?uid=swg24040170 [http://www-01.ibm.com/support/docview.wss?uid=swg24040170] V10.5 FP6 IT07635 [http://www-01.ibm.com/support/docview.wss?uid=swg1IT07635] http://www-01.ibm.com/support/docview.wss?uid=swg24040522 [http://www-01.ibm.com/support/docview.wss?uid=swg24040522] 
For customer running IBM data server client and driver types 

GSKit upgrade is required only if you are using LDAP security plugin with SSL connection to LDAP server, otherwise you may ignore this section. 

Upgrading of GSKit is required if either of the following applies to you:  * IBM data server client and driver types V9.5, V9.7, V9.8, V10.1 level and any V10.5 level before fixpack 5. 
 * IBM data server client and driver types V10.5 fixpack 5 and have additionally installed GSKit. 

Where to obtain the GSKit depends on the DB2 release and platform:  * IBM data server client and driver types V10.5 fix pack 5 on Inspur or Linux 64-bit POWER™ little endian on Power System, please contact customer support to obtain the "IBM DB2 Support Files for SSL Functionality". 
 * IBM data server client and driver types V9.5, V9.7, V9.8, V10.1 level and any V10.5 level before fixpack 5:  * Client and the server are on the same physical computer: For the Windows platform, you do not need to upgrade the GSKit as GSKit is automatically installed with the DB2 server image. For all other platforms, you will need to download "IBM DB2 Support Files for SSL Functionality" from IBM Passport Advantage®. 
    * Client and the server are on different computer: For all platforms, download "IBM DB2 Support Files for SSL Functionality" from IBM Passport Advantage® and perform the GSKit upgrade. 
   
   

Refer to the following chart below for the proper version of GSKit 

Release GSkit Version V9.5 V7.0.5.5 V9.7 V8.0.50.41 V9.8 V8.0.50.41 V10.1 V8.0.50.41 V10.5 V8.0.50.41 




In the United States and Canada dial 1-800-IBM-SERV 
View the support contacts for other countries [http://www.ibm.com/planetwide/] outside of the United States. 
Electronically open a Service Request [http://www.ibm.com/software/data/db2/support/db2_9/probsub.html] with DB2 Technical Support. 

Note: IBM’s statements regarding its plans, directions, and intent are subject to change or withdrawal without notice at IBM’s sole discretion. Information regarding potential future products is intended to outline our general product direction and it should not be relied on in making a purchasing decision. The information mentioned regarding potential future products is not a commitment, promise, or legal obligation to deliver any material, code or functionality. Information about potential future products may not be incorporated into any contract. The development, release, and timing of any future features or functionality described for our products remains at our sole discretion.

WORKAROUNDS AND MITIGATIONS
None

GET NOTIFIED ABOUT FUTURE SECURITY BULLETINS
 Subscribe to My Notifications [ http://www-01.ibm.com/software/support/einfo.html] to be notified of important product support alerts like this. 

REFERENCES
Complete CVSS v2 Guide [http://www.first.org/cvss/v2/guide] 
On-line Calculator v2 [http://nvd.nist.gov/CVSS-v2-Calculator] 

RELATED INFORMATION
IBM Secure Engineering Web Portal [http://www.ibm.com/security/secure-engineering/bulletins.html] 
IBM Product Security Incident Response Blog [http://www.ibm.com/blogs/psirt] 

CHANGE HISTORY
 March 23, 2015: Original Version Published
March 24, 2015: Added details for CVE-2014-6221
April 1, 2015: Added instruction for V10.5 FP5 GSKit image on LinuxIA64 & and PPCLE
July 10, 2015: Updated with V10.1 FP5 fix info
Aug 13, 2015: Updated with V10.5 FP6 fix info
Oct 2, 2015: Updated with V9.7 FP11 fix info 

*The CVSS Environment Score is customer environment specific and will ultimately impact the Overall CVSS Score. Customers can evaluate the impact of this vulnerability in their environments by accessing the links in the Reference section of this Security Bulletin. 

DISCLAIMER
According to the Forum of Incident Response and Security Teams (FIRST), the Common Vulnerability Scoring System (CVSS) is an "industry open standard designed to convey vulnerability severity and help to determine urgency and priority of response." IBM PROVIDES THE CVSS SCORES "AS IS" WITHOUT WARRANTY OF ANY KIND, INCLUDING THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. CUSTOMERS ARE RESPONSIBLE FOR ASSESSING THE IMPACT OF ANY ACTUAL OR POTENTIAL SECURITY VULNERABILITY.

 


Cross reference information Segment Product Component Platform Version Edition Information Management DB2 for Linux- UNIX and Windows 9.8, 9.7, 9.5, 10.5