Title: IBM PI25336: DFHAP0001 ABEND (CODE ---/AEXZ) HAS OCCURRED AT OFFSET X'2850' IN MODULE DFHAPEX. - United States

Text:
z/os  A FIX IS AVAILABLE
Obtain the fix for this APAR.


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  Every time we purge a transaction (we often purge or forcepurge
   a transaction that exceed our time-out) we have this ABENDs in
   DFHAPEX (offset X 2850 ).
   This happens since the migration to CICS TS v51.
   
   In the dump we see the purge processing 999 ( X 3E7 abend) as
   expected and percolation of the abend :
   Task  Error Type            Err_Code  Module   Offset
   00396 ABEND                 ---/0999  DFHEMEM  00002EB2
   00396 TRAN ABEND PERCOLATE  ---/AD2R  DFHPCP   000006A6
   00396 TRAN ABEND PERCOLATE  ---/AD2R  DFHD2EX1 00000D8C
   00396 TRAN ABEND PERCOLATE  ---/AD2R  DFHERM   00001746
   00396 TRAN ABEND PERCOLATE  ---/AD2R  QG2CTRM  000070A6
   00396 TRAN ABEND PERCOLATE  ---/AEXZ  DFHPCP   000006A6
   00396 TRAN ABEND PERCOLATE  ---/AEXZ  DFHERM   00002C8E
   00396 TRAN ABEND PERCOLATE  ---/AEXZ  DFHAPEX  00002850
   
   In the trace we see :
   
   AP D51F APEX  *EXC* RECOVERY-ROUTINE-ENTERED
   ME 0301 MEME ENTRY SEND_MESSAGE MESSAGE_NUMBER(1)SYSTEM_DUMPCODE
                (AP0001)
   
   DFHAPEX base 680 + 3EA is calling the message domain to issue
   AP0001 since the R10 the DFHAPEX_PTR does not point to an
   APEX PARAMETER list which contains EXIT names XDUREQ or
   XMEOUT at offset x'24' in the APEX PARM list.
   Instead the APEX parm list seems to be the one from
   the AP D510 APEX ENTRY - FUNCTION(RMI_SWITCH_APPLICATION_ENV)
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED: All                                          *
   ****************************************************************
   * PROBLEM DESCRIPTION: Abend AEXZ followed by msgDFHAP0001     *
   *                      from a DB2 transaction.                 *
   ****************************************************************
   * RECOMMENDATION:                                              *
   ****************************************************************
   After an abend of an OPENAPI DB2 transaction, DFHEPC issues a
   DFHAPEX RMI_SWITCH_APPLICATION_ENV call which goes on to DFHERM
   which issues a DFHDSAT CHANGE_MODE to L8. This fails because the
   TCB has been deleted, so DFHERM issues abendAEXZ. Control
   returns to DFHAPEX which issues a DFHAP0001 message and system
   dump AP0001.
   
   
    
   
   

PROBLEM CONCLUSION
 *  DFHERM has been changed to carry on processing on the QR TCB if
   the application's L8 TCB has been deleted.
   The CICS Transaction Server for z/OS Version 5 Release 1 Trace
   Entries manual, SC34-2873-00, will be updated to add the
   following to Table 85 "CICS DB2 trace points" after trace point
   AP 31A0:-
   "AP 31A2  DFHD2EX1  Exc  Invalid TCB  None"
   The CICS Transaction Server for z/OS Version 5 Release 2 Trace
   Entries manual, SC34-7295-00, will be updated to add the
   following to Table 86 "CICS DB2 trace points" after trace point
   AP 31A0:-
   "AP 31A2  DFHD2EX1  Exc  Invalid TCB  None"
   
   
    
   
   

TEMPORARY FIX
 *  FIX AVAILABLE BY PTF ONLY
   
   
    
   
   

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PI25336
   
   
 * REPORTED COMPONENT NAME
   CICS TS Z/OS V5
   
   
 * REPORTED COMPONENT ID
   5655Y0400
   
   
 * REPORTED RELEASE
   800
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2014-09-09
   
   
 * CLOSED DATE
   2014-11-13
   
   
 * LAST MODIFIED DATE
   2015-03-05
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
    UI22991 UI22992
   
   

MODULES/MACROS
 *  DFHD2CC  DFHD2CM1 DFHD2CO  DFHD2D2  DFHD2EX1 DFHD2EX2 DFHD2EX3
   DFHD2IN1 DFHD2RP  DFHD2STP DFHD2STR DFHD2ST  DFHD2TM  DFHD2TR1
   DFHD2TRI DFHERM
   
   
    
   
   

Publications Referenced SC34287300 SC34729500 FIX INFORMATION
 * FIXED COMPONENT NAME
   CICS TS Z/OS V5
   
   
 * FIXED COMPONENT ID
   5655Y0400
   
   

APPLICABLE COMPONENT LEVELS
 * R800 PSY UI22991 [HTTPS://WWW14.SOFTWARE.IBM.COM/WEBAPP/SET2/ORDERMEDIA/SHOPCART?PTFS=UI22991]
   UP14/11/21 P F411
   
   
 * R900 PSY UI22992 [HTTPS://WWW14.SOFTWARE.IBM.COM/WEBAPP/SET2/ORDERMEDIA/SHOPCART?PTFS=UI22992]
   UP14/11/21 P F411
   
   

FIX IS AVAILABLE
 * SELECT THE PTF APPROPRIATE FOR YOUR COMPONENT LEVEL. YOU WILL BE REQUIRED TO SIGN IN. DISTRIBUTION ON PHYSICAL MEDIA IS NOT AVAILABLE IN ALL COUNTRIES.