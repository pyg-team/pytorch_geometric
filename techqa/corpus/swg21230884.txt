Title: IBM Multiple output folders for EJB projects: unsupported - United States

Text:
JR23288; WSAD; RAD; RSA; 512; v5.1; v6; multiple; output folder; folders; output; deploy; ejb; ejbModule; ejbdeploy; enable using multiple output locations for source folders; 1230884; Archive is not a valid EJB JAR File; IWAE0006E; RedHat Enterprise Linux WS; SuSe Enterprise Server; Windows; 04195 660 706; 06613 999 846; (WAS); WAS TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Multiple output folders are not supported with EJB Deploy for EJB projects in WebSphere® Studio Application Developer (WSAD) version 5.x and Rational® Application Developer for WebSphere Software (RAD) version 6.0. 

CAUSE
In WSAD version 5.1.2 after specifying multiple output folders for an EJB project, when the project is deployed to the WebSphere Test Environment (WTE) 5.1, the following error message occurs: 


com.ibm.etools.archive.exception.OpenFailureException: IWAE0006E Archive is not a valid EJB JAR File because the deployment descriptor cannot be found (case sensitive): META-INF/ejb-jar.xml


This occurs because only the default output folder content is deployed to the server and the server did not have a copy of the folder META-INF from ejbModule containing the deployment descriptor. 

A similar error occurs if you attempt to export the EJB jar.

WSAD version 5.1.2 example - Java Build Path:
[/support/docview.wss?uid=swg21230884&aid=1] [/support/docview.wss?uid=swg21230884&aid=1]


Project: TestEJB (contains one session EJB)

Note: TestEJB/classes and TestEJB/dumpclasses output folders exist under the Navigator View but are not shown in the Project Navigator. The .classpath corresponding to the Java Build Path shows: 


//=== ".classpath" for TestEJB project:

<?xml version="1.0" encoding="UTF-8"?>
<classpath>
<classpathentry kind="src" output="classes" path="ejbModule"/>
<classpathentry kind="src" path="test"/>
<classpathentry kind="con" path="org.eclipse.jdt.launching.JRE_CONTAINER/org.eclipse.jdt.internal.debug.ui.launcher.StandardVMType/WebSphere v5.1 JRE"/>
<classpathentry kind="con" path="com.ibm.etools.server.target.container/com.ibm.etools.websphere.serverTarget.base.v51/j2ee.ejb/1"/>
<classpathentry kind="output" path="dumpclasses"/>
</classpath>
//===

See Related information items: 
Publishing an EJB with multiple source directories fails with an error
and
PK06711: CAUSED INVALID EJB JAR DUE TO MULTIPLE SOURCE FOLDERS FOR EJB PROJECT.


RESOLVING THE PROBLEM
Multiple source folders, single output folder is supported, but WSAD version 5.x and RAD version 6.x do not support multiple output folders for EJB projects. Thus, a project cannot be deployed to WTE 5.1 or WebSphere Application Server version 5.1 when there are existing project errors resulting from the use of multiple output folders on an EJB project. This issue has not been documented in the WSAD version 5.1.2 or RAD version 6.x Help. 


Note that the Java™ preferences in this case: 

 * Window > Preferences > Java > Compiler: Build Path :
 * 
 * ... 
   
 * [x] enable using exclusion patterns in source folders
   [x] enable using multiple output locations for source folders
 * 
 * 
   Filtered Resources: *.launch


are NOT the default preferences. More importantly, EJB projects are specialized Java projects as indicated in the Related information items about EJB development Resources, so they do not always use the preferences for a standard Java project. The ejbModule folder (as the default output folder) "looks" like an actual ejb.jar archive, hence the necessity to have a single output folder. However, you can still have multiple Source folders, where each of them output to the same directory (ejbModule or another output folder). 

It is possible that having multiple output folders will be supported in some future release of RAD. 

Workarounds  * A possible workaround is to create an EJB project for each of your EJBs or sets of EJBs. Then each EJB set would be self-contained in a JAR with its own subsystem, allowing for a different output folder for each EJB project. 
 * Starting with WSAD v5.1.1, support was introduced for specifying an EJB Client Jar project when creating an EJB project. You can specify that EJB client projects are created by default for new EJB projects. Even if this J2EE preference is selected, you can still decide not to create an EJB client project each time that you use the EJB project creation wizard to create an EJB project. This is supported on all WebSphere Application Server v5.1.x and v6 servers. The default for a RAD v6.0 EJB project is to create a separate EJB Client Project.



Note for Rational Application Developer version 7.0.0.1 and later 
Multiple output folders are supported as of RAD v7.0.0.1 and subsequent updates. If multiple output folders are used then all of the EJB projects output folder contents are copied to one directory in the .metadata and the WAS runtime works off it. The result (from the WebSphere Application Server point of view) is one output folder, the copy in the .metadata, yet there still are multiple output folders in the EJB project in the workspace. RELATED INFORMATION
#WSADv512: EJB development resources [http://publib.boulder.ibm.com/infocenter/wsad512/index.jsp?topic=/com.ibm.etools.ejb.doc/topics/ceresrc.html]
RADv6: EJB Development Resources [http://publib.boulder.ibm.com/infocenter/rtnl0600/index.jsp?topic=/com.ibm.etools.ejb.doc/topics/ceresrc.html]
PK06711: CAUSED INVALID EJB JAR DUE TO MULTIPLE SOURCE [http://www.ibm.com/support/docview.wss?rs=2042&uid=swg1PK06711]


 


Cross reference information Segment Product Component Platform Version Edition Software Development WebSphere Studio Application Developer EJB Tools Linux, Windows 5.1.2 Software Development Rational Software Architect EJB Development Linux, Windows 6.0, 6.0.0.1, 6.0.1, 6.0.1.1, 6.0.1.2, 7.0, 7.0.0.1