Title: IBM PI05809: DOUBLE CLICK ON SAV, SPV AND SPS FILE LAUNCH STATISTICS 21.0.0.1 PUBLISHED ON CITRIX XENAPP 6.5 ENVIRONMENT THREE TIMES - United States

Text:
 SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS VENDOR SOLUTION.
    
   
   

ERROR DESCRIPTION
 *  You work with IBM SPSS Statistics 21.0.0.1 installed with
   network license in a Citrix XenApp 6.5 environment on Windows
   2008 R2 server.
   You encounter that if you double click on a sav filr, a syntax
   sps file and on a viewer spv file the statistics 21.0.0.1 is
   launched three times with the files but in separate sessions and
   not in one session.
   When you launch the program first and then use File - Open -
   Data, File - Open - Syntax, and File - Open - Output all files
   are opened in one session and not in three.
   
   Additionally, when you double click you see that on WlmAdmin
   tool of the Sentinel License Manager installtion you see that
   the user is listed tripled but with only one network license in
   use. So as it should only one license is in use but user is
   listed 3 times on subnet server license usage list.
   
   
    
   
   

LOCAL FIX
 *  This is not an SPSS defect.
   Citrix XenApp calls this behavior 'Client to Server Content
   Redirection'. What should happen is described in the blog below
   (We are interested in 'Client to Server'
   and not 'Server to Client'):
   http://www.shaunritchie.co.uk/xenapp-content-redirection [http://www.shaunritchie.co.uk/xenapp-content-redirection]
   
   Citrix XenApp changes the local registry when a user logs-on to
   the Online Plugin so the registry should be checked before and
   after to make sure
   it is changed correctly.
   
   Without XenApp, when a file is double-clicked the Windows OS
   discovers the associated stats.exe application from the
   registry.
   If the application is running, the OS will make a special call
   to it with a string that looks like this:
   
   [open("C:\Program
   Files\IBM\SPSS\Statistics\21\Samples\English\behavior.sav")]
   You can see this format in the registry here:
   HKEY_LOCAL_MACHINE\SOFTWARE\Classes\SPSS.DataDocument\shell\open
   \ddeexec
   This format must not be changed by the logon to the XenApp
   Online Plugin because this is the only format we recognize for
   double-click behavior.
   
   If the application is not running, the OS will launch it with a
   command that looks like this:
   "C:\Program Files\IBM\SPSS\Statistics\21\stats.exe" "C:\Program
   Files\IBM\SPSS\Statistics\21\Samples\English\behavior.sav"
   You can see this format in the registry here:
   HKEY_LOCAL_MACHINE\SOFTWARE\Classes\SPSS.DataDocument\shell\open
   \command
   I would expect the executable path to change when the user
   logs-on to the Online Plugin.
   
   Also, the file association should be checked. It must be
   associated with stats.exe and not stats.com
   because the command-line version, stats.com, cannot handle the
   Windows OS call required to make double-click work.
   
   I quote from the blog some Citrix requirements for double-click
   to work in this environment:
   
       You must have the following components for Client to Server
   Content Redirection to work:
               Citrix Online Plug-in
               Citrix Web Interface
               Client Drive Mapping Enabled
               Content Redirection Policies Enabled
   
       You must have Client Drive Mapping enabled so that XenApp
   can make the call back to the
       client to open the file. If the file is located on a network
   share you must also have these
       mapped into the session as client drives. You do not need to
   make them visible though, as
       long as they are available through the client network in the
   background it will work.
   
   
    
   
   

PROBLEM SUMMARY

PROBLEM CONCLUSION

TEMPORARY FIX

COMMENTS
 *  This is not an IBM SPSS statistics defect, please see explantion
   on APAR text
   
   
    
   
   

APAR INFORMATION
 * APAR NUMBER
   PI05809
   
   
 * REPORTED COMPONENT NAME
   SPSS STATISTICS
   
   
 * REPORTED COMPONENT ID
   5725A54ST
   
   
 * REPORTED RELEASE
   L00
   
   
 * STATUS
   CLOSED ISV
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2013-11-08
   
   
 * CLOSED DATE
   2013-11-13
   
   
 * LAST MODIFIED DATE
   2013-11-13
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION

APPLICABLE COMPONENT LEVELS