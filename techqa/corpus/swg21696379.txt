Title: IBM An upgrade attempt to Portal 8001 CF14 fails with error EJPSD0028E: - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM
An upgrade attempt to Portal 8001 CF14 fails with error EJPSD0028E:

SYMPTOM
The logs show the following in the ConfigTrace.log:
[logmsg] [02/04/15 07:16:16.371 CST]

Target started: change-workdir-permission-iseries

change-workdir-permission-iseries:
Target finished: change-workdir-permission-iseries
[xmlaccess] EJPXB0006I: Connecting to URL
HXXP://localhost:10040/wps/config
[http://localhost:10040/wps/config/]
[xmlaccess] EJPXB0004I: Writing output file
/websphere/websphere8/wp_profile/ConfigEngine/config/xml-work/deployedWe
bAppXmlAccess-PTF/preExistingWebApps.xml
[xmlaccess] EJPXB0002I: Reading input file
/websphere/websphere8/PortalServer/installer/wp.migration.core/migration
/components/wp.migration.core/exportWebApps.xml
[xmlaccess] EJPXB0019E: Server response indicates an error. For status
and details of the XmlAccess error look at file
/websphere/websphere8/wp_profile/ConfigEngine/config/xml-work/deployedWe
bAppXmlAccess-PTF/preExistingWebApps.xml.
[xmlaccess] EJPXB0019E: Server response indicates an error. For status
and details of the XmlAccess error look at file
/websphere/websphere8/wp_profile/ConfigEngine/config/xml-work/deployedWe
bAppXmlAccess-PTF/preExistingWebApps.xml.
--- Exception Thrown ---
/websphere/websphere8/ConfigEngine/config/includes/upgrade_cfg.xml:105:
EJPXB0019E: Server response indicates an error. For status and details
of the XmlAccess error look at file
/websphere/websphere8/wp_profile/ConfigEngine/config/xml-work/deployedWe
bAppXmlAccess-PTF/preExistingWebApps.xml.
at com.ibm.wps.xmlaccess.XmlAccessTask.fail(Unknown Source)

....

Target finished: deploy-portlets-upgrade
--- Exception Thrown ---
/websphere/websphere8/PortalServer/installer/wp.update/config/includes/w
p.update.fix_cfg.xml:194: The following error occurred while executing
this line:
/websphere/websphere8/ConfigEngine/config/includes/upgrade_cfg.xml:105:
EJPXB0019E: Server response indicates an error. For status and details
of the XmlAccess error look at file
/websphere/websphere8/wp_profile/ConfigEngine/config/xml-work/deployedWe
bAppXmlAccess-PTF/preExistingWebApps.xml.
at
org.apache.tools.ant.ProjectHelper.addLocationToBuildException(ProjectHe
lper.java:539)
at org.apache.tools.ant.taskdefs.Ant.execute(Ant.java:384)
at
org.apache.tools.ant.taskdefs.CallTarget.execute(CallTarget.java:107)


This simply means that xmlaccess cannot connect to the Portal Server
because of a Portal startup issue.

Review of the SystemOut.log at the same timestamp shows the
following:

[2/4/15 7:16:18:246 CST] 000000af JNDIDoubleChe E Failed to
initialise interface
com.ibm.portal.wcm.access.service.ManagedPagesServiceHome
javax.naming.NameNotFoundException:
The object or context wcm does not exist.; Remaining name:
'wcm/ManagedPagesServiceHome'
at
com.ibm.wps.jndi.portal.GenericPortalJNDIContext.lookup(GenericPortalJND
IContext.java:333)
at
com.ibm.wps.jndi.portal.GenericPortalJNDIContext.lookup(GenericPortalJND
IContext.java:346)
at
com.ibm.wps.jndi.portal.RootPortalJNDIContext.lookupObject(RootPortalJND
IContext.java:155)
at
com.ibm.wps.jndi.portal.PortalContext.lookup(PortalContext.java:72)


This indicates a problem with WCM startup...so further review of the
SystemOut.log earlier in the startup sequence shows the following:

[2/4/15 7:15:32:307 CST] 00000019 ApplicationMg A WSVR0200I: Starting
application: wcm

However, during the wcm startup the following error is logged:.


[2/4/15 7:15:33:601 CST] 00000019 Connect I IBM Web Content
Manager Framework v8.0.0.1 (bld wp8001CF14_001_24 (8001.CF14.6) -
09/24/2014)
[2/4/15 7:15:33:607 CST] 00000019 Authenticatio E
com.ibm.wps.auth.impl.AuthenticationFilterChainHandlerImpl
initializeChain EJPSD0028E: The filter
<custom_class>.gis.portal.loginFilters.TermsAndConditionsFilter could not be
initialized due to error: java.lang.ClassNotFoundException
[2/4/15 7:15:33:626 CST] 00000019 FfdcProvider W
com.ibm.ws.ffdc.impl.FfdcProvider logIncident FFDC1003I: FFDC Incident
emitted on
/websphere/websphere8/wp_profile/logs/ffdc/WebSphere_Portal_1_4b2d0221_1
5.02.04_07.15.33.61055438217912448564.txt
com.ibm.ws.webcontainer.servlet.ServletInstance.init 181
[2/4/15 7:15:33:626 CST] 00000019 ServletWrappe E
com.ibm.ws.webcontainer.servlet.ServletWrapper init
Uncaught.init.exception.thrown.by.servlet
[2/4/15 7:15:33:628 CST] 00000019 webapp E
com.ibm.ws.webcontainer.webapp.WebApp commonInitializationFinally
SRVE0266E: Error occured while initializing servlets: {0}
javax.servlet.ServletException:
SRVE0207E: Uncaught initialization exception created by servlet
at
com.ibm.ws.webcontainer.servlet.ServletWrapper.init(ServletWrapper.java:
404)
at
com.ibm.ws.webcontainer.servlet.ServletWrapperImpl.init(ServletWrapperIm
pl.java:168)




CAUSE
There are custom classes that are missing and need to be accounted for so the Portal Server can start correctly. 







ENVIRONMENT
Portal 8001 

Linux


DIAGNOSING THE PROBLEM
The problem begins with an xmlaccess issue in the ConfigTrace.log which simply indicates that Portal had a startup problem. Review of the SystemOut.log reveals the nature of the startup problem, which in this case was because the customer was missing custom jars.



RESOLVING THE PROBLEM
Please address the custom code issue and then attempt the upgrade again.