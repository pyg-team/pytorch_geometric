Title: IBM PN90195: IA DATE/TIME STORED DIFFERS BETWEEN LTP AND CP, DB2 HISTORY SQLCODE -530 KEY HI3PRELE INVALID - United States

Text:
 SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  Received the following OPC DB2 History error when extending the
   Current Plan:  EQQD141E EQQD141I DSNT408I SQLCODE = -530.
   HI3PIAdate and time is different from the HI3CIADate and time.
   There was an update via MCP that changed it. The operation
   IA is 960830 19.00 while the occurrence IA from LTP is 960902
   19.00.
   A different IA for the key of occurrence table and for the key
   of operation table.
   EQQD141E.....
   OPC/ESA COULD NOT RETRIEVE REQUIRED DATA FROM THE HISTORY DATABS
   EQQD141I.....
   REASON IS:
   EQQD141I.....
    DSNT408I SQLCODE = -530, ERROR:  THE INSERT OR UPDATE VALUE OF
    FOREIGN KEY HI3PRELE IS INVALID
   DSNT418I SQLSTATE   = 23503 SQLSTATE RETURN CODE
   DSNT415I SQLERRP    = DSNXRUID SQL PROCEDURE DETECTING ERROR
   DSNT416I SQLERRD    = -110  13172774  0  0  0  0 SQL DIAGNOSTIC
                          INFORMATION
   DSNT416I SQLERRD    = X'FFFFFF92' X'00C90026' X'00000000'
            X'00000000' X'00000000' SQL DIAGNOSTIC INFORMATION
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED: All users of History Data Base               *
   *                 functionality.                               *
   *                 FUNCTION=DP                                  *
   ****************************************************************
   * PROBLEM DESCRIPTION: Three problems are addressed by this    *
   *                      apar:                                   *
   *                      1) When DP batch is run and History     *
   *                         functionality is active to store     *
   *                         completed occurrences in DB2, error  *
   *                         -530 KEY HI3PRELE INVALID can occur. *
   *                      2) access authority problems can occur  *
   *                         when trying to add occurrences to    *
   *                         CP from DB2 if authority group id    *
   *                         is specified.                        *
   *                      3) msgEQQD142I can contain garbage      *
   *                         when timestamp of DBRM and PLAS      *
   *                         text is different                    *
   ****************************************************************
   * RECOMMENDATION:                                              *
   ****************************************************************
   Following problems can occur when History functionality
   is used:
   ---------
   Problem 1
   ---------
   DP batch can issue the following error message:
   DSNT408I SQLCODE = -530, ERROR:  THE INSERT OR UPDATE VALUE
            OF FOREIGN KEY HI3PRELE IS INVALID'
   DSNT418I SQLSTATE   = 23503 SQLSTATE RETURN CODE
   DSNT415I SQLERRP    = DSNXRUID SQL PROCEDURE DETECTING ERROR
   DSNT416I SQLERRD    = -110  13172774  0  0  0  0 SQL DIAGNOSTIC
                          INFORMATION
   DSNT416I SQLERRD    = X'FFFFFF92' X'00C90026' X'00000000'
                         X'00000000' X'00000000' SQL DIAGNOSTIC
                         INFORMATION
   ---------
   Problem 2
   ---------
   When trying to add an occurrence from history panels
   the message ICH408I about insufficient access authority
   can occur.
   ---------
   Problem 3
   ---------
   DP batch can issue messages EQQD141E EQQD142I containing garbage
   
   
    
   
   

PROBLEM CONCLUSION
 *  The 3 problems were due to the following reasons:
   ---------
   problem 1
   ---------
   The occurrences were stored in DB2 setting the HI3CIADATE
   and HI3CIATIME different from HI3PIADATE and HI3PIATIME.
   These values must be the same and they indicate the occurrence
   input arrival time, but the code incorrectly used the LTP IA
   instead of the the I after the last MCP modify.
   ---------
   problem 2
   ---------
   The authority problem was caused by the missing consideration
   of the authority group id in the history dialog.
   ---------
   problem 3
   ---------
   The variable area was incorrectly prepared for issuing the
   msgEQQD142I so that garbage was displayed.
   3E0Y
   3G0Y
   DCLZZDP
   EQQDPX2C
   EQQDPX2P
   EQQHIADX
   
   
    
   
   

TEMPORARY FIX
 *  Apar fix WN90195 $JSPC3E0 and VN90195 $HSPC3G0 sent to
   customer for testing.
   
   
    
   
   

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PN90195
   
   
 * REPORTED COMPONENT NAME
   OPC/ESA
   
   
 * REPORTED COMPONENT ID
   569500701
   
   
 * REPORTED RELEASE
   3E0
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt / Xsystem
   
   
 * SUBMITTED DATE
   1996-10-17
   
   
 * CLOSED DATE
   1997-01-29
   
   
 * LAST MODIFIED DATE
   1997-03-02
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
    UQ00573 UQ00587
   
   

MODULES/MACROS
 *  DCLZZDP  EQQDPX2C EQQDPX2P EQQHIADX
   
   
    
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   OPC/ESA
   
   
 * FIXED COMPONENT ID
   569500701
   
   

APPLICABLE COMPONENT LEVELS
 * R3E0 PSY UQ00587
   UP97/02/14 P F702
   
   
 * R3G0 PSY UQ00573
   UP97/02/14 P F702