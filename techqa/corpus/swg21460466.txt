Title: IBM JCR message engine does not start on a cluster - United States

Text:
building a cluster; cluster; V7; 7.0; JCR messaging engine; jcr; message engine; JCRSeedBus; may not start up; WebSphere Portal Server; JCR content resource; content resources; search; may not work; systemout log; log; errors TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 When building a cluster on IBM WebSphere Portal V7, the JCR messaging engine, JCRSeedBus, may not start up when starting the WebSphere Portal Server. Also, the JCR content resource search may not work. 

SYMPTOM
You may find the following errors and exceptions in the Portal Server SystemOut.log file: 

[datetime] 00000020 SibMessage I [JCRSeedBus:PortalCluster.000-JCRSeedBus] CWSIS1538I: The messaging engine, ME_UUID=4A76DD636E4D7F8D, INC_UUID=31828889C3AEC661, is attempting to obtain an exclusive lock on the data store.
[datetime] 00000021 SibMessage I [JCRSeedBus:PortalCluster.000-JCRSeedBus] CWSIS1545I: A single previous owner was found in the messaging engine's data store, ME_UUID=5A4BB5D8F066DB65, INC_UUID=66E9D52EA9D8BA08
[datetime] 00000021 SibMessage E [JCRSeedBus:PortalCluster.000-JCRSeedBus] CWSIS1535E: The messaging engine's unique id does not match that found in the data store. ME_UUID=4A76DD636E4D7F8D, ME_UUID(DB)=5A4BB5D8F066DB65
[datetime] 00000020 SibMessage I [JCRSeedBus:PortalCluster.000-JCRSeedBus] CWSIS1593I: The messaging engine, ME_UUID=4A76DD636E4D7F8D, INC_UUID=31828889C3AEC661, has failed to gain an initial lock on the data store.
[datetime] 00000020 SibMessage E [JCRSeedBus:PortalCluster.000-JCRSeedBus] CWSIS1519E: Messaging engine PortalCluster.000-JCRSeedBus cannot obtain the lock on its data store, which ensures it has exclusive access to the data.
.....
[datetime] 0000001a FfdcProvider W com.ibm.ws.ffdc.impl.FfdcProvider logIncident FFDC1003I: FFDC Incident emitted on /opt/WP7/WebSphere/wp_profile/logs/ffdc/WebSphere_Portal_25b80053_10.12.07_20.53.20.613128892829597717059.txt com.ibm.ws.sib.msgstore.impl.MessageStoreImpl.start 755
[datetime] 0000001a SibMessage E [JCRSeedBus:PortalCluster.000-JCRSeedBus] CWSIS0002E: The messaging engine encountered an exception while starting. Exception: com.ibm.ws.sib.msgstore.PersistenceException: CWSIS1501E: The data source has produced an unexpected exception: com.ibm.ws.sib.msgstore.persistence.DatasourceWrapperStoppedException: New connections cannot be provided because the persistence layer has been stopped
[datetime] 0000001a SibMessage E [JCRSeedBus:PortalCluster.000-JCRSeedBus] CWSID0035E: Messaging engine PortalCluster.000-JCRSeedBus cannot be started; detected error reported during com.ibm.ws.sib.msgstore.impl.MessageStoreImpl start()
[datetime] 0000001a SibMessage E [JCRSeedBus:PortalCluster.000-JCRSeedBus] CWSID0027E: Messaging engine PortalCluster.000-JCRSeedBus cannot be restarted because a serious error has been reported.
[datetime] 0000001a SibMessage I [JCRSeedBus:PortalCluster.000-JCRSeedBus] CWSID0016I: Messaging engine PortalCluster.000-JCRSeedBus is in state Stopped.


RESOLVING THE PROBLEM
Perform the following steps to resolve the problem:

1. Stop the NodeAgent and WebSphere Portal servers.

2. Connect to your database.

3. Drop all 9 tables that are related to the message engine's data store. They all begin with the first three letters, "SIBxxx". Be aware that you will lose any messages currently stored in the data store.

List of tables to drop:
SIB000
SIB001
SIB002
SIBCLASSMAP
SIBKEYS
SIBLISTING
SIBOWNER
SIBOWNERO
SIBXACTS

4. Restart the DMGR, NodeAgent and WebSphere Portal servers. This step recreates the tables automatically with the correct message engine data store's unique ID.