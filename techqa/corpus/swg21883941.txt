Title: IBM DataPower MQ front side handler fails intermittently with no log message - United States

Text:
MQ FSH; urlopen; fail; fails; failure; silent; SOAP fault; concurrent connections TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 When all of the configured MQ FSH concurrent connections are in use, the next request fails. Why does the MQ FSH immediately reject requests when the concurrent connection count is exceeded? 

SYMPTOM
With a simple xslt stylesheet or GatewayScript file, an MQ urlopen does a PUT to the MQ request queue. The MQ FSH of a target DataPower service initiates a GET on the request message from the request queue, but the MQ FSH immediately responds with a SOAP fault. 

If the MQ front side handler of the target DataPower service has concurrent connections set to 1, requests alternately succeed and fail. If you increase the concurrent connections value to 5, then 5 requests succeed, and the 6th request fails. 

The back-end service does not show the failing request in the probe or in the log. A packet capture between the appliance and the MQ server shows the generic SOAP fault:

<env:Envelope xmlns:env="http://schemas.xmlsoap.org/soap/envelope/ [http://schemas.xmlsoap.org/soap/envelope/]">
<env:Body>
<env:Fault>
<faultcode>env:Client</faultcode>
<faultstring>Internal Error (from client)</faultstring>
</env:Fault>
</env:Body>
</env:Envelope>


CAUSE
When all of the configured MQ FSH concurrent connections are in use, the MQ FSH should not retrieve further messages from the request queue until the next MQ FSH connection is available.

However, a defect on the MQ Server causes the described behavior in some releases.


RESOLVING THE PROBLEM
To resolve the problem, upgrade the MQ Server to version 7.1.0.5 or later.