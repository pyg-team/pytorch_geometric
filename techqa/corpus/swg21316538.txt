Title: IBM GSK_BAD_FORMAT_OR_INVALID_FORMAT error in plug-in log when SSL is configured between the WebSphere HTTP Plug-in and WebSphere Application Server - United States

Text:
GSK_BAD_FORMAT_OR_INVALID_FORMAT; (gsk error 106); SSL; WAS; PLUG IN; plugin; plug-in TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 When SSL has been configured between the IBM® WebSphere® plug-in and an IBM WebSphere Application Server, the Web server plug-in log shows the following error during plug-in initialization:

ERROR: lib_security: logSSLError: str_security (gsk error 106): GSK_BAD_FORMAT_OR_INVALID_FORMAT 

SYMPTOM
The following excerpt is an example of what is seen when the plug-in Loglevel is set to "Error": 

ERROR: lib_security: logSSLError: str_security (gsk error 106):GSK_BAD_FORMAT_OR_INVALID_FORMAT
ERROR: lib_security: initializeSecurity: Failed to initialize GSK environment
ERROR: ws_transport: transportInitializeSecurity: Failed to initialize security
ERROR: ws_server: serverAddTransport: Failed to initialize security
ERROR: ws_server: serverAddTransport: HTTPS Transport is skipped


CAUSE
This error can occur when either the "keyring" or "stashfile" properties are incorrectly defined in the plugin-cfg.xml. In the following example, the "keyring" property is incorrectly pointing to the stashfile (*.sth) instead of the main keystore (*.kdb).

<Property Name="keyring" Value="/usr/HTTPServer20/Plugins/etc/blue2/newkey.sth" /> 
<Property Name="stashfile" Value="/usr/HTTPServer20/Plugins/etc/blue2/newkey.sth" />


RESOLVING THE PROBLEM
Review the plugin-cfg.xml to ensure all "keyring" and "stashfile" properties are pointing to their appropriate files. A correct configuration for the above example would be: 

 

<Property Name="keyring" Value="/usr/HTTPServer20/Plugins/etc/blue2/newkey.kdb" /> 
<Property Name="stashfile" Value="/usr/HTTPServer20/Plugins/etc/blue2/newkey.sth" />

RELATED INFORMATION
 IBM GSKit return codes [http://publib.boulder.ibm.com/tividd/td/ITAME/SC32-0845-00/en_US/HTML/am39_error_ref08.htm]