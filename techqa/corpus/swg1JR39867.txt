Title: IBM JR39867: RESOLVES THREAD HANGING ISSUE DUE TO UNSYNCHRONIZED ACCESS TO A HASHMAP IN MONITORCACHE CLASS - United States

Text:
  FIXES ARE AVAILABLE
WebSphere Process Server V7.0.0 Fix Pack 5 (V7.0.0.5) [http://www-01.ibm.com/support/docview.wss?uid=swg24032709]
WebSphere Enterprise Service Bus V7.0.0 Fix Pack 5 (7.0.0.5) [http://www-01.ibm.com/support/docview.wss?uid=swg24032713]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS FIXED IF NEXT.
    
   
   

ERROR DESCRIPTION
 *  Intermittently, a WPS server will appear to hang either
   during startup or shutdown.  This may occur if there is
   incoming JMS traffic during the administrative action.
   .
      This may lead to a WTRN0006W tx timeout that has this java
   stack for the cause of the timeout.
   [5/20/12 22:57:46:505 EDT] 00000007 TimeoutManage I   WTRN0124I:
   When the timeout occurred the thread with which the transaction
   is, or was most recently, associated was
   Thread[WMQJCAResourceAdapter : 9,5,main].
   The stack trace of this thread when the timeout occurred was:
       java.util.HashMap.findNonNullKeyEntry(HashMap.java:525)
       java.util.HashMap.getEntry(HashMap.java:510)
       java.util.HashMap.containsKey(HashMap.java:431)
       com.ibm.ws.monitoring.policy.data.MonitorCache.isAsyncImpl
   (MonitorCache.java:241)
       com.ibm.ws.monitoring.policy.InterfaceGroup2.processSync
   (InterfaceGroup2.java:341)
       com.ibm.ws.monitoring.policy.InterfaceGroup2.process
   (InterfaceGroup2.java:137)
       com.ibm.ws.monitoring.policy.MonPolicy.processMessage
   (MonPolicy.java:104)
       com.ibm.ws.monitoring.policy.InterfaceGroup2.
   processMessage(InterfaceGroup2.java:43)
       com.ibm.ws.sca.internal.message.impl.MessageDispatcherImpl.
   processMessageWithPCI(MessageDispatcherImpl.java:766)
   .
   .-------------------------------------------------------
   A thread dump (javacore) of the server may indicate that there
   are a number of threads hanging in the MonitorCache.isAsyncImpl
   method.
   
   For example:
   at
   java/util/HashMap.findNonNullKeyEntry(HashMap.java:525(Compiled
    Code))
   at java/util/HashMap.getEntry(HashMap.java:510(Compiled Code))
   at java/util/HashMap.containsKey(HashMap.java(Compiled Code))
   at com/ibm/ws/monitoring/policy/data/MonitorCache.isAsyncImpl
   (MonitorCache.java:242(Compiled Code))
   at com/ibm/ws/monitoring/policy/InterfaceGroup2.processSync
   (InterfaceGroup2.java:341(Compiled Code))
   ...
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED:  when system has heavy load and              *
   *                  application has sync invocation that        *
   *                  involves SCA InerfaceGroup2 handler         *
   ****************************************************************
   * PROBLEM DESCRIPTION: Some threads hang when multithreads     *
   *                      concrrently access a cache that is      *
   *                      defined as type HashMap                 *
   ****************************************************************
   * RECOMMENDATION:                                              *
   ****************************************************************
   The HashMap couldn't handle concurrent
   mulithreads. That causes threads hang. So wrapping this HashMap
   with Collections.synchronizedMap method solve the problem
   
   
    
   
   

PROBLEM CONCLUSION

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   JR39867
   
   
 * REPORTED COMPONENT NAME
   WEB PROC SERVER
   
   
 * REPORTED COMPONENT ID
   5724L0100
   
   
 * REPORTED RELEASE
   700
   
   
 * STATUS
   CLOSED FIN
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2011-06-16
   
   
 * CLOSED DATE
   2011-07-13
   
   
 * LAST MODIFIED DATE
   2012-05-22
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION

APPLICABLE COMPONENT LEVELS
 * R700 PSY
   UP