Title: IBM Troubleshooting the IBM FileNet Enterprise Manager Installation - United States

Text:
"Content Engine Enterprise Manager.msc" MMC could not create the snap-in TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 IBM FileNet Content Engine installer displays the message "Install Complete With Errors". Attempts to launch the Content Engine Enterprise Manager.msc result in the error message shown below. 

SYMPTOM
MMC could not create the snap-in.


CAUSE
Microsoft Windows (64-bit) Operating System fails to register the following IBM FileNet Enterprise Manager (EM) DLLs; FNK_ACLEditor.dll, FNK_EnterpriseManager.dll, using the Windows command line tool regsvr32.exe.

ENVIRONMENT
Microsoft Windows 7, Windows Server 2008 R2; 64-bit Operating System

DIAGNOSING THE PROBLEM
IBM FileNet Content Engine (CE) installer runs with both options; .NET Clients and FileNet Enterprise Manager, selected. The installation of IBM FileNet Content Engine finishes, but some errors occur during the install. Review the installation log located by default in:




c:\Program Files (x86)\IBM\FileNet\ContentEngine\ce_install_log_5.0.txt 

and confirm errors like the following are reported: 

Execute Script/Batch file: Remove profiles\dotnetclient 

Status: ERROR 

Additional Notes: ERROR - java.io.FileNotFoundException: C:\Users\p8admin_prod\AppData\Local\Temp\2\032010.tmp\executeScriptTmp.bat (The process cannot access the file because it is being used by another process.) 

Execute Script/Batch file: Configure .Net API 

Status: ERROR 

Additional Notes: ERROR - java.io.FileNotFoundException: C:\Users\p8admin_prod\AppData\Local\Temp\2\032010.tmp\executeScriptTmp.bat (The process cannot access the file because it is being used by another process.) 

Execute Script/Batch file: Configure FEM 

Status: ERROR 

Additional Notes: ERROR - java.io.FileNotFoundException: C:\Users\p8admin_prod\AppData\Local\Temp\2\032010.tmp\executeScriptTmp.bat (The process cannot access the file because it is being used by another process.)


RESOLVING THE PROBLEM
Manually run the commands that were attempted to be executed by the script, after the install has completed. The commands will generate a profile in FileNet Configuration Manager and perform the required .dll registrations. 

1. From a command line, run the following commands (adjust path as necessary for your system): 

cd c:\Program Files (x86)\IBM\FileNet\ContentEngine\tools\configure 

rmdir /S/Q profiles\dotnetclient 

configmgr_cl generateConfig -task configureDotNetAPI -profile dotnetclient 

configmgr_cl execute -task configureDotNetAPI -profile dotnetclient 

 

2. Open a command prompt and browse to the CE Installation folder, where you will find the following DLL's: FNK_ACLEditor.dll, FNK_EnterpriseManager.dll 

Run the commands below: 

regsvr32 FNK_ACLEditor.dll 

regsvr32 FNK_EnterpriseManager.dll 

Note: regsvr32.exe is a command line tool provided by windows to register the dlls. 

This file is commonly found in C:\Windows\System32 folder (On Windows 7 machine) 

If the command prompt says that the command is not found, then either add the path to 'System32' folder to the PATH location (OR) run the commands as - 

"C:\Windows\System32\regsvr32.exe" <dll> 

 

Additional steps to troubleshoot EM installation and configuration issues 

when above suggestion did not resolve the problem: 

1) As per Techdoc 1423925 - FileNet Content Engine version 4.5.1 introduces Microsoft Windows® Communications Foundation (WCF) support for .NET API - 
http://www.ibm.com/support/docview.wss?uid=swg21423925 [https://www-304.ibm.com/support/docview.wss?uid=swg21423925] 

The required Windows components for Installing Enterprise Manager are stated in the product documentation for each P8 version specifically: 

P8 4.5.1 - http://www.ibm.com/support/knowledgecenter/SSNW2F_4.5.1/com.ibm.p8.install.doc/p8pin031.htm [http://www-01.ibm.com/support/knowledgecenter/SSNW2F_4.5.1/com.ibm.p8.install.doc/p8pin031.htm] 

Option: Microsoft® Windows XP, Microsoft Windows Server 2003 

Description: Microsoft .NET Framework 2.0 and Web Services Enhancements (WSE) 3.0 

 

Option: Content Engine version 4.5.1 Fix Pack 002 or higher with Microsoft Windows Vista, Microsoft Windows Server 2008, or Microsoft Windows 7 

Description: Microsoft .NET Framework 3.0 and Windows Communication Foundation (WCF) 

 

P8 5.0 - http://www.ibm.com/support/knowledgecenter/SSNW2F_5.0.0/com.ibm.p8.install.doc/p8pin031.htm [http://www-01.ibm.com/support/knowledgecenter/SSNW2F_5.0.0/com.ibm.p8.install.doc/p8pin031.htm] 

Option: Content Engine version 5.0.0 with Microsoft® Windows Vista, Microsoft Windows Server 2008, or Microsoft Windows 7 

Description: Microsoft .NET Framework 3.0 and Windows Communication Foundation (WCF). 

 To run FileNet Enterprise Manager without SSL configured on the same computer, you must have Microsoft Web Services Enhancements (WSE) 3.0 installed there. 

 See the Microsoft support website for details about the impending end of general support for .NET Framework 2.0 and, by extension, WSE 3.0. If the support for WSE 3.0 ends, you must configure SSL on the Enterprise Manager computers to ensure a fully supported FileNet Content Manager environment 

 To run FileNet Enterprise Manager with SSL configured on the same computer, you must have Microsoft Windows Communication Foundation (WCF), which is the successor to WSE, installed there. 

 

2) Verify if Microsoft Web Services Enhancements (WSE) 3.0 is installed; 

3) Confirm in Control Panel/Programs and Features/ status lists the following: 

Windows Process Activation Service - Process Model - .NET Environment; -Configuration APIs ; 

.NET Framework 3.5.1 Features - .NET Framework 3.5.1 ; WCF Activation - Http/Non-HTTP Activation 

 

4) User Account Control (UAC) Settings: Try the installation with UAC set to Never Notify. 

 

5) System Properties - Advanced - Performance Options: Data Execution Prevention: DEP is turned on for essential Windows programs and services only. 

 

6) When installing remotely, this error occurs when Windows "Remote Registry" service is stopped during installation. By default, "Remote Registry" service is active and started automatically. The problem happens only on the specific environment of the service being disabled or stopped intentionally. "Remote Registry" service should be kept running on Windows 64-bit Operating System. 

Check if the "Remote Registry" service on the client Enterprise Manager workstation is disabled. The "Remote Registry service enables remote users to modify registry settings on this computer. If this service is stopped, the registry can be modified only by users on the computer. 

 

7) Is it possible to install other snap-in .msc's in MMC or use any other available plug-ins without issues? 

 

8) Try installing EM as a local administrator account instead of a domain administrator. 

 

9) Rule out if any software installation attempt of previous P8 versions were made: i.e. confirm this is a first time installation taking place on a new workstation. 

 

10) Prior to any re-install attempt please follow the steps below to verify MMC Snap-in settings. 

a. Click Start, in the Start Search box type "mmc" and press Enter. Are there any snap-ins listed here? 

b. Click "File->Add/Remove Snap-ins". 

c. In the box of "Selected Snap-ins", click on and remove all entries except "Console root". Click OK to quit. 

Report details if any error message is encountered during these steps. 

 

11) Acknowledge that no errors during the installation such as 'Missing prerequisite/ Unable to locate WSE' were encountered - except for those reported in the summary. 

 

12) Prevent using Remote Desktop or alternatively try using VMWare vSphere client console for example in case of a Virtualized Machine. 

 

13) Run the Microsoft Dependency Walker tool 'Depends.exe' to determine if any sub-components (DLLs) are missing. 

 

14) Ascertain that when you run IBM FileNet Content Engine Installer on Windows 7 that 'Content Engine Server' is unchecked during step to Choose Components (since CE Server is not supported on Windows 7).