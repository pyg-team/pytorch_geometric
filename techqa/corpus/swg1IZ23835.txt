Title: IBM IZ23835: WEBSPHERE DISC BROKE ON MIGRATED 5. IF3 TO 7.1 IF4 SYSTEM. - United States

Text:
 SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  Customer upgraded for TADDM 5.1 IF3 to TADDM 7.1 FP4.  After the
   upgrade, their WebSphere discover no longer worked, in fact,
   WebSphere discovery never even started.  Investigation showed
   that the template for WebSphereVersion sensor was missing.
   
   
   Jennifer Lee said:
   
   
   
   
   Hello Andrzej - I am working on a problem, where a customer who
   upgraded from 5.x to 7.1 IF4 has the wrong WAS templates.  I
   believe we somehow broke this recently in IF4, because I have
   the same issue on my test server acura and I know WAS was
   working on it at some point, but I dont know for sure when. But
   I looked at template-upgrade.sh in IF4 and GA and didnt see how
   WAS would be impacted, but I dont really understand it, maybe
   its never worked in 7.1 upgrade scenario?
   
   We need to formally fix this, can I take an APAR on it? Please
   let me know, thanks!
   
   
   In a clean 7.1 database, there are two Websphere templates and
   they have a WebSphereVersionSeed;
   
           <name>WebSphere-Windows</name>
                   <operand1>IBM WebSphere Application
   Server</operand1>
   
   <seedClass>com.collation.discover.seed.app.j2ee.WebSphereVersion
   Seed</seedClass>
           <displayName>WebSphere-Windows</displayName>
           <name>WebSphere-Unix</name>
   
   <displayName>WebSphere-Unix:Argument:contains:com.ibm.ws.runtime
   .WsServer</displayName>
                   <displayName>WebSphere-Unix:Operating
   System:does-not-contain:Windows</displayName>
   
   <seedClass>com.collation.discover.seed.app.j2ee.WebSphereVersion
   Seed</seedClass>
           <displayName>WebSphere-Unix</displayName>
   
   
   In a migrated 7.1 database, the templates are different, for
   one, there are a bunch of extra "cell" templates and the seeds
   are wrong, the WAS sensor does not run at all with this config.
   If I change the two templates so they look like the above, then
   they run;
   
           <name>WebSphere-Cell-Windows-dmgr</name>
                   <operand1>IBM WebSphere Application
   Server</operand1>
                   <displayName>WebSphere-Cell-Windows-dmgr:Windows
   Service Name:contains:IBM WebSphere Application
   Server</displayName>
                   <displayName>WebSphere-Cell-Windows-dmgr:Windows
   Service Name:contains:dmgr</displayName>
   
   <displayName>WebSphere-Cell-Windows-dmgr:Operating
   System:contains:Windows</displayName>
   
   <displayName>WebSphere-Cell-Windows-dmgr</displayName>
   
   <seedClass>com.collation.discover.seed.app.j2ee.WebSphereCellSee
   d</seedClass>
           <displayName>WebSphere-Cell-Windows-dmgr</displayName>
           <name>WebSphere-Cell-Windows-CellManager</name>
                   <operand1>IBM WebSphere Application
   Server</operand1>
   
   <displayName>WebSphere-Cell-Windows-CellManager:Windows Service
   Name:contains:IBM WebSphere Application Server</displayName>
   
   <displayName>WebSphere-Cell-Windows-CellManager:Windows Service
   Name:contains:CellManager</displayName>
   
   <displayName>WebSphere-Cell-Windows-CellManager:Operating
   System:contains:Windows</displayName>
   
   <displayName>WebSphere-Cell-Windows-CellManager</displayName>
   
   <seedClass>com.collation.discover.seed.app.j2ee.WebSphereCellSee
   d</seedClass>
   
   <displayName>WebSphere-Cell-Windows-CellManager</displayName>
           <name>WebSphere-Windows</name>
                   <operand1>IBM WebSphere Application
   Server</operand1>
                   <displayName>WebSphere-Windows:Windows Service
   Name:contains:IBM WebSphere Application Server</displayName>
                   <displayName>WebSphere-Windows:Operating
   System:contains:Windows</displayName>
               <displayName>WebSphere-Windows</displayName>
   
   <seedClass>com.collation.discover.seed.app.j2ee.WebSphereSeed</s
   eedClass>
           <displayName>WebSphere-Windows</displayName>
           <name>WebSphereCell-Unix</name>
   
   <displayName>WebSphereCell-Unix:Argument:contains:com.ibm.ws.run
   time.WsServer</displayName>
   
   <displayName>WebSphereCell-Unix:Argument:contains:dmgr</displayN
   ame>
                   <displayName>WebSphereCell-Unix:Operating
   System:does-not-contain:Windows</displayName>
               <displayName>WebSphereCell-Unix</displayName>
   
   <seedClass>com.collation.discover.seed.app.j2ee.WebSphereCellSee
   d</seedClass>
           <displayName>WebSphereCell-Unix</displayName>
           <name>WebSphere-Unix</name>
   
   <displayName>WebSphere-Unix:Argument:contains:com.ibm.ws.runtime
   .WsServer</displayName>
                   <displayName>WebSphere-Unix:Operating
   System:does-not-contain:Windows</displayName>
               <displayName>WebSphere-Unix</displayName>
   
   <seedClass>com.collation.discover.seed.app.j2ee.WebSphereSeed</s
   eedClass>
           <displayName>WebSphere-Unix</displayName>
   [
   
   
   
   Here is the reply from Szymon:
   
   Jenn,
   
   Here is an answer why does it happen and how to fix that issue
   (means assign me a defect) .
   
   Why:
   In core 7.1 template upgrade for the supported templates was not
   used because of the pluggable sensors implementation (introduced
   by John Cook).
   As a result templates were not laded from xml any more, but from
   java class. It does not solve discovery profiles cleanup issue,
   so we ended up with a technote
   http://d02was006.southbury.ibm.com/support/dcf/preview.wss?host=
   d02dbs88.southbury.ibm.com&db=support/swg/tivtech.nsf&unid=BBC40 [http://d02was006.southbury.ibm.com/support/dcf/preview.wss?host=d02dbs88.southbury.ibm.com&db=support/swg/tivtech.nsf&unid=BBC40]
   846A2A9B1C6852573840048A445&taxOC=SSPLFC&MD=2008/04/15%2005:04:0
   7&sid=
   
   Because of the clients complaints, reading templates from xml
   was brought back. As a result when  the client goes from  5.x to
   7.1 IF4 has the wrong WAS templates.
   
   How to fix:
   In 7.1.1 it is already covered, for 7.1 we need additional
   entries in the tempalte-upgrade script. Only thing I am not sure
   is about profiles cleanup. I dont know if we need that action
   described in a technote anymore then.
   It should be tested.
   
   Regards,
   Szymon
   
   
    
   
   

LOCAL FIX
 *  How to fix:
   In 7.1.1 it is already covered, for 7.1 we need additional
   entries in the tempalte-upgrade script. Only thing I am not sure
   is about profiles cleanup. I dont know if we need that action
   described in a technote anymore then.
   It should be tested.
   
   
    
   
   

PROBLEM SUMMARY
 *  Websphere templates are missing on migrated 7.1 systems.
   
   Run template-upgrade from IF6 to correct this problem.
   
   
    
   
   

PROBLEM CONCLUSION
 *  The fix for this APAR is contained in the following
   maintenance packages:
   | Interim Fix | 7.1.0.0-TIV-ITADDM-IF0006
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IZ23835
   
   
 * REPORTED COMPONENT NAME
   APP DEPENDENCY
   
   
 * REPORTED COMPONENT ID
   5724N5500
   
   
 * REPORTED RELEASE
   710
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2008-06-04
   
   
 * CLOSED DATE
   2008-07-03
   
   
 * LAST MODIFIED DATE
   2008-07-03
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   APP DEPENDENCY
   
   
 * FIXED COMPONENT ID
   5724N5500
   
   

APPLICABLE COMPONENT LEVELS
 * R710 PSY
   UP