Title: IBM ITCAM for SOA Report version 7.2 installation fails on existing TCR 3.1 - United States

Text:
report; TCR; database; table; install; Tivoli Common Reporting; ITCAM for SOA TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 ITCAM for SOA Report version 7.2 installation fails when the installer is run on an existing IBM Tivoli Common Reporting Version 3.1 (TCR 3.1) installation.

This version of ITCAM for SOA Report can be used with ITCAM for SOA version 7.2. 

RESOLVING THE PROBLEM
Ensure that TCR 3.1 is installed, configured and running, as described in the following documentation: http://pic.dhe.ibm.com/infocenter/tivihelp/v3r1/topic/com.ibm.psc.doc_1.1.0/install/tcr_t_install.html [http://pic.dhe.ibm.com/infocenter/tivihelp/v3r1/topic/com.ibm.psc.doc_1.1.0/install/tcr_t_install.html] 

Then complete the following manual steps to get the product report successfully working with TCR 3.1 release:


 * Import report packages into the TCR environment
   
 * Configure database connections on the TCR environment
   
 * Create shared dimension tables and populate the time dimension



Import report packages into the TCR 3.1 environment 
To complete the import of the reports, follow the steps listed here: http://pic.dhe.ibm.com/infocenter/tivihelp/v3r1/topic/com.ibm.psc.doc_1.1.0/tcr_original/ttcr_import.html [http://pic.dhe.ibm.com/infocenter/tivihelp/v3r1/topic/com.ibm.psc.doc_1.1.0/tcr_original/ttcr_import.html]


The report package that is required by the steps is located on your host in the directory: 


$ITCAM_SOA_Report_Installer$/reports/cognos_reports/itcam_soa_cognos_report/package 


and is called ITCAMforSOA_v72.zip. $ITCAM_SOA_Report_Installer$ is the directory where the ITCAM for SOA Application Report installer is unzipped or untarred.


Configure database connections on the TCR 3.1 environment


To configure database connections, follow the steps listed here: http://pic.dhe.ibm.com/infocenter/tivihelp/v3r1/topic/com.ibm.psc.doc_1.1.0/tcr_original/ttcr_config_db.html [http://pic.dhe.ibm.com/infocenter/tivihelp/v3r1/topic/com.ibm.psc.doc_1.1.0/tcr_original/ttcr_config_db.html]. Use the database name TDW to configure the data source in Cognos.


Create shared dimension tables and populate the time dimension


To prepare Tivoli Data Warehouse for Tivoli Common Reporting, you need to create the IBM_TRAM dimensions. These dimensions are required for running Cognos reports and using data models. This procedure creates the following dimension tables: 

1. Schema IBM_TRAM. TRAM stands for Tivoli Reporting and Analytics Model, the common data model used by Tivoli products.
2. Table TIME_DIMENSION with years of time dimensional data and granularity to a specified number of minutes. Each row of this table is a unique minute key with various dimensions related to it, such as hour, weekday, day of month, and quarter.
3. Table MONTH_LOOKUP globalizes the month names for Time Dimension.
4. Table WEEKDAY_LOOKUP globalizes the weekday names for Time Dimension.
5. ComputerSystem, another dimension conforming to the Tivoli Common Data Model. 

For the procedure, you need to use the database scripts. They are included in the extracted reports package under the $ITCAM_SOA_Report_Installer$/reports/cognos_reports/itcam_soa_cognos_report/db_scripts directory.


Procedure for IBM DB2: 

a) Copy the database scripts (.db2 files) from the $ITCAM_SOA_Report_Installer$/reports/cognos_reports/itcam_soa_cognos_report/db_scripts/db2 directory to a location where they can be run against the Tivoli Data Warehouse. 
b) Log in as db2admin. Your user ID must have administrator access to create the IBM_TRAM schema.
c) Connect to the Tivoli Data Warehouse database. 
db2 connect to WAREHOUS;
d) If you have an older version of the database scripts already installed (that is, the tables already exist), clean up the database: 
db2 -tf clean.db2
e) Create the schema and tables: 
db2 -tf create_schema_IBM_TRAM.db2
f) After the command completes successfully, IBM_TRAM includes several tables: TIME_DIMENSION, MONTH_LOOKUP, WEEKDAY_LOOKUP, and ComputerSystem.
g) Create the stored procedure for generating the time dimension: 
db2 -td@ -vf gen_time_dim_granularity_min.db2
h) To populate the TIME_DIMENSION table, call the time dimension stored procedure with dates and granularity to generate the timestamps. You can generate up to five years at a time: 
db2 call IBM_TRAM.CREATE_TIME_DIMENSION('start_date','end_date', granularity_of_data); 
where start_date and end_date are in the YYYY-MM-DD-HH.MM.SS.MILSEC format and granularity_of_data is the frequency in minutes. For example, the following command generates entries from 12/31/2009 to 12/31/2010 with 60-minute granularity. 
db2 call IBM_TRAM.CREATE_TIME_DIMENSION('2009-12-31-00.00.00.000000','2010-12-31-00.00.00.000000', 60); 

Procedure for Microsoft SQL Server: 

a) Copy the database scripts (.sql files) from the $ITCAM_SOA_Report_Installer$/reports/cognos_reports/itcam_soa_cognos_report/db_scripts/mssql directory to a location where they can be run against the Tivoli Data Warehouse. 
b) Customize the provided scripts by changing the default database name in the use statement (USE IBM_TRAM) if it is different from the default. For example, if the name of your Tivoli Data Warehouse is "warehouse" the statement is USE warehouse. Make this change in the following files: 
createSchema.sql
createProcedure.sql
clean.sql
populateTimeDimension.sql 
Also, modify the boundary parameters for the time dimension and granularity in the populateTimeDimension.sql file. For example, 
@startDate = '2010-01-01 00:00:00',
@endDate = '2010-07-08 00:00:00',
@granularity = 60,
c) If you have an older version of the database scripts already installed, clean up the database. 
sqlcmd -i clean.sql [-U username -P password] [-S hostname]
d) Run the scripts at the MS SQL command line in this order: 
sqlcmd -i createSchema.sql [-U username -P password] [-S host]
sqlcmd -i createProcedure.sql [-U username -P password] [-S host]
sqlcmd -i populateTimeDimension.sql [-U username -P password] [-S host] 

Procedure for Oracle: 

a) Copy the database scripts (.sql files) from the $ITCAM_SOA_Report_Installer$/reports/cognos_reports/itcam_soa_cognos_report/db_scripts/oracle directory to a location where they can be run against the Tivoli Data Warehouse. 
b) Start an SQL *Plus session if it is not already running.
c) If you have an older version of the database scripts already installed clean up the database (the procedure must be called by the sys user): 
clean.sql
d) Create user IBM_TRAM (the script must be called by a user with system rights, such as SYS/SYSTEM): 
@MY_PATH\create_IBM_TRAM.sql TCR_PASS USER_TBSPC TEMPORARY_TBSPC
where TCR_PASS is the password for the new user, USER_TBSPC is the default user tablespace name (must exist), and TEMPORARY_TBSPC is the default temporary tablespace name (must exist)
e) Create the IBM_TRAM tables (the script must be called by the IBM_TRAM user created in the previous step): 
@MY_PATH\create_schema.sql USER_TBSPC 
where USER_TBSPC is the default user tablespace name (must exist)
f) Grant privileges to the user account for Reports, for example, ITMUSER (the script must be called by the IBM_TRAM user): 
@MY_PATH\grant_IBM_TRAM.sql USER 
where USER is the name of the user to grant privileges to.
g) Create the procedure (the script must be called by the IBM_TRAM user): 
@MY_PATH\gen_time_dim_granularity_hr.sql
h) Load the lookup data (the script must be called by the IBM_TRAM user): 
@MY_PATH\populateLookup.sql
i) Generate the time dimension (the procedure must be called by the IBM_TRAM user): 
@MY_PATH\populateTimeDimension.sql StartDate EndDate Granularity 
where StartDate is the start date in the format 'yyyy-mm-dd HH:MM', EndDate is the end date in the format 'yyyy-mm-dd HH:MM', and Granularity is the number of minutes. Example:
@reports/myreports/populateTimeDimension.sql '2008-12-31 00:00' '2011-12-31 00:00' '60'Results 

The shared dimensions and time dimensions tables are complete.