Title: IBM BACKUP VM uses NBD over SAN transport - United States

Text:
TLSv1 SSL TLS encryption TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Although "VMVSTORTRANSPORT SAN" is set in the datamovers options file, the backup uses NBD. 

SYMPTOM
Backup uses NBD transport


CAUSE
VMware vCenter 'SSL.VERSION' setting is set to TLSv1. 

This option can be found in the VMware vSphere client -> Administration -> vCenter Server Settings -> Advanced Settings. 

[/support/docview.wss?uid=swg21962719&aid=1] [/support/docview.wss?uid=swg21962719&aid=1]



ENVIRONMENT
Windows/Linux datamover. 

vCenter 5.1 or 5.5.


DIAGNOSING THE PROBLEM
A Tivoli Storage Manager client trace will show the following: 


vmvddksdk.cpp (1275): diskLibPlugin: 2015-07-08T15:32:32.100-07:00 [02832 error 'Default'] 
Cannot use advanced transport modes for VCENTER/moRef=vm-12345/snapshot-6789: Other error encountered: SSL Exception: error:14094410:SSL routines:SSL3_READ_BYTES:sslv3 alert handshake failure. 



RESOLVING THE PROBLEM
The SSL.VERSION parameter needs to either be set to 'ALL', or if TLS is a requirement, then the Tivoli Storage Manager client (datamover) must be upgraded to version 7.1.2.x. This version of client includes VDDK version 6.0 which has added support for TLS. 


https://www.vmware.com/support/developer/vddk/vddk-600-releasenotes.html#whatsnew [https://www.vmware.com/support/developer/vddk/vddk-600-releasenotes.html#whatsnew]

 

PRODUCT ALIAS/SYNONYM
 TSM