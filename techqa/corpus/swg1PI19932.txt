Title: IBM PI19932: DB2 INSERT IS ROLLED BACK FOR UNKNOWN REASON - United States

Text:
z/os  A FIX IS AVAILABLE
Obtain the fix for this APAR.


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  Application running in WebSphere Application Server does an
   INSERT into a DB2 table. The INSERT seems to run fine and the
   application does a COMMIT then (AUTOCOMMIT is set to FALSE).
   COMMIT() returns null which means the COMMIT worked fine.
   Once the application ends a ROLLBACK is done for the previously
   COMMITted INSERT for unknown reasons.
   .
   Servant region joblog (SYSPRINT) shows:
   WLTC0032W: One or more local transaction resources were rolled
              back during the cleanup of a
              LocalTransactionContainment.
   .
   Extensive tracing in WebSphere and JDBC driver reveals that the
   COMMIT was done on a different connection than the original
   INSERT was done.
   By means of a debug module L3 figurred out finally that the
   underlying sqljconnection was not reassociated properly after
   the dissociation due to which there were 2 connection objects.
   .
   Note:
   With unshared connection problem does not occur.
   
   
    
   
   

LOCAL FIX
 *  Use unshareable connections
   
   KC article regarding Connection Handles and shared vs unshared:
   http://www14.software.ibm.com/webapp/wsbroker/redirect?version=p
   hil&product=was-nd-mp&topic=cconpconh [http://www14.software.ibm.com/webapp/wsbroker/redirect?version=phil&product=was-nd-mp&topic=cconpconh]
   
   
    
   
   

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED: All users of IBM WebSphere Application       *
   *                 Server V7.0 when SQLJConnection is used.     *
   ****************************************************************
   * PROBLEM DESCRIPTION: When Shareable Connections is used      *
   *                      and DB2 SQLJConnection is used to do    *
   *                      jdbc operation, if the connection is    *
   *                      not properly closed and a dissociate    *
   *                      When Shareable Connections is used      *
   *                      and DB2 SQLJConnection is used to do    *
   *                      jdbc operation, if the connection is    *
   *                      not properly closed and a dissociate    *
   ****************************************************************
   * RECOMMENDATION:                                              *
   ****************************************************************
   This is because when dissociate happens it would reset the
   jdbc connection however the SQLJConnection was not getting
   reset hence the wrong association.
   
   
    
   
   

PROBLEM CONCLUSION
 *  Code changes have been done to reset the SQLJConnection as
   well during a dissociate.
   
   APAR PI19932 is currently targeted for inclusion in Fix Pack
   7.0.0.35 of WebSphere Application Server.
   
   Please refer to the Recommended Updates page for delivery
   information:
   http://www.ibm.com/support/docview.wss?rs=180&uid=swg27004980 [http://www.ibm.com/support/docview.wss?rs=180&uid=swg27004980]
   
   In addition, please refer to URL:
   http://www.ibm.com/support/docview.wss?rs=404&uid=swg27006970 [http://www.ibm.com/support/docview.wss?rs=404&uid=swg27006970]
   for Fix Pack PTF information.
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PI19932
   
   
 * REPORTED COMPONENT NAME
   WEBSPHERE FOR Z
   
   
 * REPORTED COMPONENT ID
   5655I3500
   
   
 * REPORTED RELEASE
   700
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2014-06-12
   
   
 * CLOSED DATE
   2014-09-24
   
   
 * LAST MODIFIED DATE
   2015-03-13
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
    PI12978 [http://www-01.ibm.com/support/docview.wss?uid=swg1PI12978]
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

MODULES/MACROS
 *     BBGUBINF BBOUBINF
   
   
    
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WEBSPHERE FOR Z
   
   
 * FIXED COMPONENT ID
   5655I3500
   
   

APPLICABLE COMPONENT LEVELS
 * R700 PSY UI21695 [HTTPS://WWW14.SOFTWARE.IBM.COM/WEBAPP/SET2/ORDERMEDIA/SHOPCART?PTFS=UI21695]
   UP14/10/10 P F410
   
   

FIX IS AVAILABLE
 * SELECT THE PTF APPROPRIATE FOR YOUR COMPONENT LEVEL. YOU WILL BE REQUIRED TO SIGN IN. DISTRIBUTION ON PHYSICAL MEDIA IS NOT AVAILABLE IN ALL COUNTRIES.