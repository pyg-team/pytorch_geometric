Title: IBM PM24069: MQOPEN ABEND CEE3204S S0C4 / 0C4 - United States

Text:
z/os  A FIX IS AVAILABLE
Obtain the fix for this APAR.


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  At V701, the MQ code assumes that when the first MQCONN is
   issued in an LE environment (i.e. R12 pointing to a CAA),
   all subsequent MQ API calls issued from the same TCB
   (i.e. using the same connection) will also be issued
   from an LE environment.
   For example:
   - MQCONN from C LE program
   - Call an non-LE assembler program
   - Assembler program does MQCONN (get already connected which
     is expected)
   - Issue MQOPEN ; this failed with CEE3204S S0C4 transaction
     dump
   *
   Additional symptoms/keywords:
   ABEND0C4 in CEEBFTCH
   
   
    
   
   

LOCAL FIX
 *  Clear R12 before the MQCONN so that it will not be pointing
   to a CAA and MQ will not expect subsequent MQ API calls to
   have R12 addressing the CAA.
   .
   Also, a ++APAR is available from the support center. It affects
   the batch adapter so must be picked up by the batch application.
   
   
    
   
   

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED: All users of WebSphere MQ for z/OS Version 7 *
   *                 Release 0 Modification 1.                    *
   ****************************************************************
   * PROBLEM DESCRIPTION: Abend 0C4 and/or CEE3204S occurs when   *
   *                      issuing MQI calls from a non-LE         *
   *                      program, if an LE environment was       *
   *                      detected when MQCONN was run.           *
   ****************************************************************
   * RECOMMENDATION:                                              *
   ****************************************************************
   When a batch application issues MQCONN, CSQBCON detects if there
   is an LE environment present and flags this in the BLOA. On the
   next MQI call, CSQBSRV checks this flag and if it is set, calls
   CSQBLEF, CSQBAPPL and CSQBLER to determine the application's
   CCSID.
   If this subsequent MQI call is run from an non-LE environment,
   R12 and R13 do not point to the CAA and DSA as CSQBLEF expects,
   leading to the abend when these are referenced.
   
   
    
   
   

PROBLEM CONCLUSION
 *  CSQBSRV is changed to locate the CAA and a suitable DSA
   (allocating a suitable DSA if necessary) and pass these to
   CSQBLEF so that it can run without relying on R12 and R13 still
   referring to these LE control areas.
   010Y
   CSQBINTC
   CSQBLEF
   CSQBLER
   CSQBLOA
   CSQBSRV
   CSQQCON2
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PM24069
   
   
 * REPORTED COMPONENT NAME
   WMQ Z/OS V7
   
   
 * REPORTED COMPONENT ID
   5655R3600
   
   
 * REPORTED RELEASE
   010
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   YesSpecatt / Pervasive
   
   
 * SUBMITTED DATE
   2010-10-06
   
   
 * CLOSED DATE
   2011-04-18
   
   
 * LAST MODIFIED DATE
   2011-06-02
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
    UK66848
   
   

MODULES/MACROS
 *  CSQBINTC CSQBLEF  CSQBLER  CSQBLOA  CSQBSRV
   CSQQCON2
   
   
    
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WMQ Z/OS V7
   
   
 * FIXED COMPONENT ID
   5655R3600
   
   

APPLICABLE COMPONENT LEVELS
 * R010 PSY UK66848 [HTTPS://WWW14.SOFTWARE.IBM.COM/WEBAPP/SET2/ORDERMEDIA/SHOPCART?PTFS=UK66848]
   UP11/05/18 P F105
   
   

FIX IS AVAILABLE
 * SELECT THE PTF APPROPRIATE FOR YOUR COMPONENT LEVEL. YOU WILL BE REQUIRED TO SIGN IN. DISTRIBUTION ON PHYSICAL MEDIA IS NOT AVAILABLE IN ALL COUNTRIES.