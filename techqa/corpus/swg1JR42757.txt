Title: IBM JR42757: CMVC 221928 - LIMIT DATA RETRIEVAL QUERIES TO 1000 ROWS. - United States

Text:
  A FIX IS AVAILABLE
WebSphere Commerce Version 7.0.0.7 Fix Pack [http://www-01.ibm.com/support/docview.wss?uid=swg24034686]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  When trying to retrieve a catgroup description, the following
   error is seen:
   
   
    CNTR0019E: EJBthrew an unexpected (non-declared) exception
   during invocation ofmethod "findByCatalogGroupIdsAndLanguageId".
   Exception data:com.ibm.ejs.persistence.EJSPersistenceException:
   find failed:;  nestedexception is:
   java.sql.SQLSyntaxErrorException: ORA-01795: maximum number of
   expressions in a list is 1000...
   at
   com.ibm.commerce.catalog.objsrc.CatalogGroupDescriptionCache.fin
   dByCatalogGroupIdsAndLanguageId(CatalogGroupDescriptionCache.jav
   a:434)
   at
   com.ibm.commerce.catalog.beans.CatalogDataBean.getTopCategories(
   CatalogDataBean.java:538)
   at
   com.ibm.commerce.catalog.facade.server.commands.ComposeCatalogGr
   oupDetailsTaskCmdImpl.isTopCategory(ComposeCatalogGroupDetailsTa
   skCmdImpl.java:400)
   at
   com.ibm.commerce.catalog.facade.server.commands.ComposeCatalogGr
   oupDetailsTaskCmdImpl.execute(ComposeCatalogGroupDetailsTaskCmdI
   mpl.java:170)
   at
   com.ibm.commerce.catalog.facade.server.commands.AbstractFetchCat
   alogGroupSOICmdImpl.execute(AbstractFetchCatalogGroupSOICmdImpl.
   java:234)
   ...
   
   This happens when using an oracle database, when trying to
   retrieve over 1000 catgroup descriptions at once. This is due to
   an Oracle limitation where only 1000 entries can be added to an
   IN clause.
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  USERS AFFECTED:
   All users on WebSphere Commerce V7 who use Oracle
   
   PROBLEM ABSTRACT:
   When using oracle, if there are over 1000 top categories in the
   catalog,  see the error ' ORA-01795: maximum number of
   expressions in a list is 1000' when trying to retrieve a
   catgroup description
   
   BUSINESS IMPACT:
   Catalog Navigation could fail if the catalog has over 1000 top
   catgroups
   
   RECOMMENDATION:
   
   
    
   
   

PROBLEM CONCLUSION
 *  In APAR JR42757, the data cache was changed to use multiple
   executions of the finder method when more than 1000 category ids
   are in the query.
   
   Similar situations were also fixed in the same way for
   CatalogEntry, CatalogEntryDescription, CatalogDescription,
   CatalogEntryShipping, and OfferPrice finder methods.
   
   -------------------------------------------------------------
   The latest available maintenance information can be obtained
   from the Recommended Fixes for WebSphere Commerce technote:
   http://www.ibm.com/support/docview.wss?rs=3046&uid=swg21261296 [http://www.ibm.com/support/docview.wss?rs=3046&uid=swg21261296]
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   JR42757
   
   
 * REPORTED COMPONENT NAME
   WC BUS EDITION
   
   
 * REPORTED COMPONENT ID
   5724I3800
   
   
 * REPORTED RELEASE
   700
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2012-05-09
   
   
 * CLOSED DATE
   2012-09-06
   
   
 * LAST MODIFIED DATE
   2012-09-06
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WC BUS EDITION
   
   
 * FIXED COMPONENT ID
   5724I3800
   
   

APPLICABLE COMPONENT LEVELS
 * R700 PSY
   UP