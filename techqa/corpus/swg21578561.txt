Title: IBM "...COMException (0x800A0005): Invalid procedure call..." "FrTransferBT.ImportDataT.ScratchData ... Dbp_CreateOracleTempTab" when importing FZD file - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 User clicks "Transfer - Import Data". User browses to FZD file. User presses blue triangle "run" button to start the import. User receives error message. 

SYMPTOM
Screen: 

Error
System.Web.Services.Protocols.SoapException: Server was unable to process request. --->
System.Runtime.InteropServices.COMException (0x800A0005):

Invalid procedure call or argument

at FrTransferBT.ImportDataTClass.PushPeriodValues(Recordset rsXDB, Recordset rsXDBtext, Recordset rsXDBBlob, Recordset rsXBJH, Recordset rsVer, Recordset rsComb, Int32 eLog, Int32 eScratch, Boolean bReconciled, String sGuid, String sUser, Boolean bForceLocked, Boolean bAllowImportLocked, Boolean bForceInvalid, Boolean bLogCompanies, Boolean& bErr, Int32& lErr, Recordset& rsErrors)

at
Cognos.Controller.Proxy.CCRWS.ImportDataT_PushPeriodValues(DataSet rsXDB, DataSet rsXDBtext, DataSet rsXDBblob, DataSet rsXBJH, DataSet rsVer, DataSet rsComb, Int32 eLog, Int32 eScratch, Boolean bReconciled, String sGuid, String sUser, Boolean bForceLocked, Boolean bAllowImportLocked, Boolean bForceInvalid, Boolean bLogCompanies, Boolean& bErr, Int32& lErr, DataSet& rsErrors)

--- End of inner exception stack trace ---
[OK] 

 

Event Viewer (Application log) on application server:
Log Name: Application
Source: Cognos Controller
Date: 18/01/2012 08:28:38
Event ID: 0
Task Category: None
Level: Warning
Keywords: Classic
User: N/A
Computer: SERVERNAME
Description:
Error occured at 18/01/2012 08:28:38 in IBM Cognos 8 Controller, Error No=5, Source=FrangoDirect.ImportDataD.PushPeriodValues#ControllerProxyClient, Description=System.Web.Services.Protocols.SoapException: Server was unable to process request. ---> System.Runtime.InteropServices.COMException (0x800A0005): 

Invalid procedure call or argument
at FrTransferBT.ImportDataTClass.PushPeriodValues(Recordset rsXDB, Recordset rsXDBtext, Recordset rsXDBBlob, Recordset rsXBJH, Recordset rsVer, Recordset rsComb, Int32 eLog, Int32 eScratch, Boolean bReconciled, String sGuid, String sUser, Boolean bForceLocked, Boolean bAllowImportLocked, Boolean bForceInvalid, Boolean bLogCompanies, Boolean& bErr, Int32& lErr, Recordset& rsErrors)
at Cognos.Controller.Proxy.CCRWS.ImportDataT_PushPeriodValues(DataSet rsXDB, DataSet rsXDBtext, DataSet rsXDBblob, DataSet rsXBJH, DataSet rsVer, DataSet rsComb, Int32 eLog, Int32 eScratch, Boolean bReconciled, String sGuid, String sUser, Boolean bForceLocked, Boolean bAllowImportLocked, Boolean bForceInvalid, Boolean bLogCompanies, Boolean& bErr, Int32& lErr, DataSet& rsErrors)
--- End of inner exception stack trace ---, HelpFile= HelpContext=0

Log Name: Application
Source: VBRuntime
Date: 18/01/2012 08:28:37
Event ID: 1
Task Category: None
Level: Warning
Keywords: Classic
User: N/A
Computer: SERVERNAME
Description:
The VB Application identified by the event source logged this Application FrTransferBT: Thread ID: 3156 ,Logged: Error occured at 18/01/2012 08:28:37 in FrTransferBT, Error No=5, Source=FrTransferBT.ImportDataT.ValidateAndPushPeriodValues, Description=Invalid procedure call or argument, HelpFile= HelpContext=0 

Log Name: Application
Source: VBRuntime
Date: 18/01/2012 08:28:36
Event ID: 1
Task Category: None
Level: Warning
Keywords: Classic
User: N/A
Computer: SERVERNAME
Description:
The VB Application identified by the event source logged this Application FrTransferBT: Thread ID: 3156 ,Logged: Error occured at 18/01/2012 08:28:36 in FrTransferBT, Error No=5, Source=FrTransferBT.ImportDataT.ScratchData, Description=Invalid procedure call or argument, HelpFile= HelpContext=0 

Log Name: Application
Source: VBRuntime
Date: 18/01/2012 08:28:36
Event ID: 1
Task Category: None
Level: Warning
Keywords: Classic
User: N/A
Computer: SERVERNAME
Description:
The VB Application identified by the event source logged this Application FrSrvFunc: Thread ID: 3156 ,Logged: Error occured at 18/01/2012 08:28:36 in FrSrvFunc, Error No=5, Source=Server Sub:Db_CreateTempTab(..) , Description=Invalid procedure call or argument, HelpFile= HelpContext=0

Log Name: Application
Source: VBRuntime
Date: 18/01/2012 08:28:36
Event ID: 1
Task Category: None
Level: Warning
Keywords: Classic
User: N/A
Computer: SERVERNAME
Description:
The VB Application identified by the event source logged this Application FrSrvFunc: Thread ID: 3156 ,Logged: Error occured at 18/01/2012 08:28:36 in FrSrvFunc, Error No=0, Source=Server Sub:Dbp_CreateOracleTempTab(..) , Description=, HelpFile= HelpContext=0

CAUSE
Code production problem (reference APAR PM57270), which only affects customers using Oracle on non-Windows platforms. 

 
The defect causes the application to create import files containing columns which are declared to be of the wrong size.


ENVIRONMENT
Controller database hosted on Oracle database server which is running a non-Windows operating system (e.g. Linux or Sun Solaris etc.).



RESOLVING THE PROBLEM
Fix: 

Upgrade to Controller 10.1.1 (10.1.1305) or later.

Workaround
Modify the destination database schema so that the size of the relevant columns are changed.

Steps - real-life customer example:
In one real-life customer's example, they needed to modify the table 'UIMDA_SCRTCHDT_FRMS' so that 

 * column "PER" is set to CHAR(16BYTE) 
 * and columns "AKT" is set to CHAR(8BYTE):


In other words, they needed to change the table until it looked like the following (good): 
[/support/docview.wss?uid=swg21578561&aid=1] [/support/docview.wss?uid=swg21578561&aid=1] 

Steps to modify the schema correctly: 
There are many different possible methods to modify that table. One method is:  1. As a precaution, ensure that all the relevant Oracle schemas are backed up 
 2. Launch Oracle scripting tool (e.g. SQL Developer) 
 3. Connect to the database using the Controller application schema (e.g. "ControllerLIVE") 
 4. Run the following script:

 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 

RELATED INFORMATION
#APAR PM57270 [http://www-01.ibm.com/support/docview.wss?uid=swg1PM57270]