Title: IBM Collect WebSphere MQ MustGather data to solve TLS channel problems on HP OpenVMS - United States

Text:
MustGather; MustGathers Must Gather; MustGatherDocument; Collect Troubleshooting Data; Collect; Trouble; Shooting; SSL/TLS; SSL; TLS; Secure Sockets Layer; Transport Layer Security; Certificate; OpenSSL TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 A WebSphere MQ queue manager or client is failing to establish a secure channel using TLS (formerly SSL), and you need to collect MustGather data to find a solution. 

ENVIRONMENT
These instructions apply only to WebSphere MQ V6.0 on HP OpenVMS. Refer to the IBM MQ Read First page for instructions on other operating systems:



 * IBM MQ Read First [http://www.ibm.com/support/docview.wss?uid=swg21618885]



RESOLVING THE PROBLEM
 

Please answer these questions about the problem and then follow the steps below:



 * What TLS channel problem did you observe on the system?
 * What time did the TLS channel problem start and when did it stop?
 * Which specific channels and certificates are involved in the problem?



STEP 1: GENERATE DATA

If the TLS channel problem is reproducible or is happening right now, generate data to provide more information about the problem:



 1.  
 2.  If the problem occurs when starting a sending channel, save the output of a PING CHANNEL command after setting the AMQ_DUMP_SSL system logical. For example:
 3.   
     PING CHANNEL QMA.TO.QMB ON QUEUE MANAGER QMA
     
     $ DEFINE/SYSTEM AMQ_DUMP_SSL 1 
     $ RUNMQSC QMA 
     PING CHANNEL(QMA.TO.QMB) 
     END 
     $ DELETE/SYMBOL AMQ_DUMP_SSL 
     
 4.  
 5.  
 6.  If the problem occurs when starting a sending channel, generate a trace of the queue manager [http://www.ibm.com/support/docview.wss?uid=swg21667361] showing the channel start attempt.
 7.  
 8.  
 9.  Generate MQ trace simultaneously at the other end of the channel:
     
      * Linux and UNIX [http://www.ibm.com/support/docview.wss?uid=swg21665357]
      * Windows [http://www.ibm.com/support/docview.wss?uid=swg21666876]
      * IBM i [http://www.ibm.com/support/docview.wss?uid=swg21664990]
     
      * z/OS CHIN trace [http://www.ibm.com/support/docview.wss?uid=swg21665093]
      * z/VSE [http://www.ibm.com/support/docview.wss?uid=swg21666814]
      * HP NonStop Server [http://www.ibm.com/support/docview.wss?uid=swg21667375]
     
     
 10. 



STEP 2: COLLECT DATA
 1.  
 2.  Record the MQ version and maintenance level [http://www.ibm.com/support/docview.wss?uid=swg21621707].
 3.  
 4.  
 5.  Record the operating system version and maintenance level [http://www.ibm.com/support/docview.wss?uid=swg21634678].
 6.  
 7.  
 8.  Record information about the system activity:
 9.   
     SHOW SYSTEM ACTIVITY
     
     $ SHOW SYSTEM/FULL 
     
 10. 
 11. 
 12. Record the list of processes running on the system:
 13.  
     DISPLAYING PROCESSES
     
     $ SHOW PROCESS/ALL 
     
 14. 
 15. 
 16. Record the list of devices on the system:
 17.  
     DISPLAYING DEVICES
     
     $ SHOW DEVICE/FULL 
     
 18. 
 19. 
 20. Record the logicals which are defined:
 21.  
     DISPLAYING DEVICES
     
     $ SHOW LOGICAL > logicals.txt 
     
 22. 
 23. 
 24. List the contents of the queue manager key store directory. For example:
 25.  
     DISPLAYING THE KEY STORE DIRECTORY FOR QUEUE MANAGER QMA
     
     $ SET DEF MQS_ROOT:[MQM.QMGRS.QMA.SSL] 
     $ DIR/SIZE/OWNER/PROT 
     
 26. 
 27. 
 28. WebSphere MQ on HP OpenVMS uses OpenSSL for its SSL and TLS communications. Display the OpenSSL version installed:
 29.  
     DISPLAYING THE OPENSSL VERSION ON HP ITANIUM SYSTEMS
     
     $ OPENSSL :== $SYS$SYSDEVICE:[VMS$COMMON.SSL.IA64_EXE]OPENSSL.EXE 
     $ OPENSSL VERSION 
     
     DISPLAYING THE OPENSSL VERSION ON HP ALPHA SYSTEMS
     
     $ OPENSSL :== $SYS$SYSDEVICE:[VMS$COMMON.SSL.ALPHA_EXE]OPENSSL.EXE 
     $ OPENSSL VERSION 
     
 30. 
 31. 
 32. Display the OpenSSL CA certificates:
 33.  
     DISPLAYING THE OPENSSL CA CERTIFICATES
     
     $ OPENSSL x509 -in CACERT.PEM -NOOUT -TEXT 
     
 34. 
 35. 
 36. Display the OpenSSL personal certificates:
 37.  
     DISPLAYING THE OPENSSL PERSONAL CERTIFICATES
     
     $ OPENSSL x509 -in SERVER.PEM -NOOUT -TEXT 
     
 38. 
 39. 
 40. Use runmqsc to record your queue manager, queues, channels and channel status information:
 41.  
     DISPLAY QMGR ALL 
     DISPLAY QLOCAL(*) ALL 
     DISPLAY QALIAS(*) ALL 
     DISPLAY QREMOTE(*) ALL 
     DISPLAY CHANNEL(*) ALL 
     DISPLAY CHSTATUS(*) ALL 
     
 42. 
 43. 
 44. Manually package your files for IBM [http://www.ibm.com/support/docview.wss?uid=swg21671892], including files containing the output from the commands listed in Step 1 and 2. Make sure you include the SSLERR.LOG file in the MQS_ROOT:[MQM.ERRORS] directory when packaging the files.
 45. 



STEP 3: SEND DATA TO IBM
 1.  
 2.  Send your data to the IBM ECuRep repository [http://www.ibm.com/de/support/ecurep/send.html] by email to websphere_support@ecurep.ibm.com, or by standard or secure HTTP or FTP.
 3.  
 4.  
 5.  While the data is transferring, send an email or use the IBM Service Request tool [http://www.ibm.com/support/servicerequest/] to update your PMR with your description of the problem and of the data you are sending.
 6.  
 7.  
 8.  A good description of the problem and the data is the most important information you can provide to IBM. Please do not send data without providing a description!
 9.  
 10. Contact your country representative [http://www.ibm.com/planetwide/] if you need to speak to an IBM technical support representative, or in the US call 1-800-IBM-SERV. Refer to the IBM Software Support Handbook [http://www14.software.ibm.com/webapp/set2/sas/f/handbook/home.html] for more information on working with IBM.
 11. 

Back to top

 

PRODUCT ALIAS/SYNONYM
 WebSphere MQ WMQ