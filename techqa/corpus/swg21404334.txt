Title: IBM Knowledge Collection: Full Logical Logs - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Logical logs can fill on an IDS instance and this document will describe what actions to take and what information should be collected. 

SYMPTOM
Messages in online log: Logical Logs are full, backup is needed.


CAUSE
The logical logs which keep the transaction information for the instance have become full and the instance can no longer track any insert/update/delete information.

DIAGNOSING THE PROBLEM
The logical logs can become full for a variety of reasons, we will limit the discussion to the following 2 conditions: 

1) The logical log backup process has stopped.
2) A long transaction has occurred and during the rollback, the logical logs fill.

If 1) occurs, the logical log backup process needs to be restarted. If using ontape -a or ontape -c to backp the logical logs, make sure the LTAPEDEV resource specified in the onconfig file is available and can be written to. If using onbar to backup the logical logs, make sure the device for the log backups is available and can be written to. With onbar, the sysutils database will be updated as a logical log backup is completed, if the logical logs are completely full, this portion of the log backup cannot complete and the instance will hang. To work around this issue with onbar: set LTAPEDEV to /dev/null (Linux or Unix) or /NUL (Windows). Then perform a ontape -a. This will only mark the logical logs as backed up, even though they have not been. It is very important to then set LTAPEDEV back to what it was before and then take a level 0 backup of the instance.

If 2) occurs, there is an onconfig parameter that can help avoid this problem. DYNAMIC_LOGS is the parameter. This parameter must be set to 1 or 2 to enable this feature. If it is set to 0, and a long transaction occurs and the logical logs fills, the safest way out of this situation is to restore the instance and rollforward to a time before the long transaction occurs. If the parameter is set to 1 or 2 before the long transaction occurs, then the instance should try to add logical logs as needed, assuming there is adequate space in the instance.

If the logical logs fill for another reason and the engine does not allow users to insert/update/delete data, then the following information should be collected:

onstat -a
onstat -g all
onstat -g stk all
oncheck -pr
online log

IBM Informix advanced support has some mechanisms to assist getting out of this situation too. The consistency of the instance after the tools have been used cannot be guaranteed.


RESOLVING THE PROBLEM
Once space in a logical log becomes available, the instance should start performing normally again.