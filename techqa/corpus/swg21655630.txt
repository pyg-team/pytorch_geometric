Title: IBM Journals disappear when transferred to an Aggregation ObjectServer - United States

Text:
Journal; Gateway; Missing; Object Server; Aggregation TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 A gateway connecting an ObjectServer (Non-Collection nor Failover) to an aggregation ObjectServer fails to transfer the journal information of the alerts in the source ObjectServer 

SYMPTOM
When the Gateway connects initially and starts resynching both ObjectServer shows many "Failed to lookup matching entry in the destination" 

2013-08-02T11:12:40: Debug: D-GOB-105-219: [ngobjserv]: Mapper: Failed to lookup matching entry in destination 'CLUK_PROD_AGG_P''alerts.status' cache for 'alerts.journal' row. ServerSerial='3036997',ServerName='OBJ_P'

And after those messages it shows it has sent all the journals existing in the source ObjectServer 

2013-08-02T11:12:40: Debug: D-GOB-105-289: [ngobjserv]: Mapper: Post-Mapping insert/update iduc data from 'OBJ_P', table 'alerts.journal' of '29660' item(s). [Inserts=29660][Updates=0]

Despite this final message there are no journals for any events in the destination ObjectServer.


CAUSE
This issue is related to DCF 1655530 that explains how ServerName and ServerSerial are not preserved across ObjectServers when a Gateway other than Correlation or Failover connect to an aggregation ObjectServer. In this scenario agg_new_row assigns and new ServerName and ServerSerial to events coming via an ObjectServer Gateway and this breaks the correlation of alerts. Journal inserts are based on the Serial number of alerts and as they don't match an insert of a journal in the destination ObjectServer using the Serial of the event in the source ObjectServer fails


ENVIRONMENT
Pair of ObjectServers, one of them Aggregation. ObjectServer Gateway (non-correlation nor Aggregation Failover)



DIAGNOSING THE PROBLEM
No journal entries appear in the destination ObjectServer despite the log saying x-number of inserts have been sent



RESOLVING THE PROBLEM
DCF 1655530 explains how to fix agg_new_row trigger so inserts from a gateway other than correlation or failover preserve the ServerName ServerSerials from the source ObjectServer

RELATED INFORMATION
 DCF 1655530 - ServerName/ServerSerial values in Agg Obj [http://www-01.ibm.com/support/docview.wss?uid=swg21655530]