Title: IBM setCellValue POI exception after upgraded from 9.1-FP3 to 10.1-FP6 - United States

Text:
JavaAPI TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 An export job that uses POI jars to generate Microsoft Excel files gives an exception after migration from 9.1 FP3 to 10.1 FP6. 
The following exceptions were found:

2013-10-04 18:55:58,411 [sch_worker_0] FATAL com.ibm.ccd.scheduler.
threads.SchedulerThread JOB_ID:3409- CWPCM0002E:Generic error /
Exception: IExecutable did not complete running, Exception:
org/apache/poi/hssf/usermodel/HSSFCell.setCellValue
(Lorg/apache/poi/hssf/usermodel/HSSFRichTextString;)V
java.lang.NoSuchMethodError: org/apache/poi/hssf/usermodel/HSSFCell.
setCellValue(Lorg/apache/poi/hssf/usermodel/HSSFRichTextString;)V
at com.cust1.pim.outbound.dataexport.impl.
GenerateProdGroupExcelFile.setHeader(GenerateProdGroupExcelFile.java:
327)
at com.cust1.pim.outbound.dataexport.impl.
GenerateProdGroupExcelFile.GenerateExcel(GenerateProdGroupExcelFile.
java:54)


CAUSE
Either older POI jar file is being used, or deleted POI function calls are being used in the scripts.

RESOLVING THE PROBLEM
The POI jar file is a third party jar used to create Microsoft Excel files.


There are two steps, which can be used to troubleshoot this issue. 

1) Check to see if the newer poi jar file exist in $TOP/jars, and if it is being referenced in $TOP/bin/conf/env_settings.ini file. 

Check your classpath in $TOP/bin/conf/env_settings.ini file, and ensure only the latest POI jar file is being referenced. The latest POI jar file is: poi-3.7-20101029.jar. Also ensure that this jar file is located in $TOP/jars directory, and no other POI jars are in this directory. If the older POI jar file is in $TOP/jars directory, then remove it or back it up to another sub-directory. 

a) Once the above is updated, run $TOP/bin/configureEnv.sh. When prompted if you want to overwrite any of the configuration files, enter "n". Do not overwrite any original configuration files here. 

b) Run $TOP/bin/compat.sh, then check $TOP/bin/conf/env_settings.ini file to see if poi-3.2-FINAL-20081019.jar file still exist in the classpath. This file should not exist there, and only poi-3.7-20101029.jar should be referenced. You can also run this command to check the classpath output:
echo $CCD_CLASSPATH
c) Restart the collaborative MDM server.

2) Ensure that you do not use deleted POI related function calls in any customized scripts.
See the following v10.1 migration documentation [http://pic.dhe.ibm.com/infocenter/mdm/v10r1/topic/com.ibm.pim.mig.doc/pim_con_migrating_from_prior_versions.html].

Specifically, here is the instruction relevant to this issue:

If you are migrating from an older fix pack version, ensure that you are not using any deleted APIs in your Excel scripts. The following APIs are not available in the latest POI JAR file: 

 * public String getExcelCellEncoding(); 
 * public void setEncoding(String encoding); 
 * public String getExcelCellEncoding(Object cellObj) throws AustinException;

Note: 
1. The InfoSphere MDM Collaboration Server Excel Parser is supported through a third-party .jar file named poi-3.7-20101029.jar. This library supports Microsoft Excel 2007 format, which allows more than 255 columns per data sheet. You must run the new Rich Search Result Report script by using the Default Rich Search Results Report Script (Excel 2007 - xlsx format) option to export items with more than 255 attributes. 
2. You still can export Rich Search Results to files in the Microsoft Excel 2003 format by using the Default Rich Search Results Report Script option. However, with this format the report fails if items have more than 255 attributes. 
3. Microsoft Excel 2010 files (.xlsx) is not supported by this JAR. RELATED INFORMATION
#Migrating from Prior Versions [http://pic.dhe.ibm.com/infocenter/mdm/v10r1/index.jsp?topic=%2Fcom.ibm.pim.mig.doc%2Fpim_con_migrating_from_prior_versions.html]


 



Cross reference information Segment Product Component Platform Version Edition Information Management InfoSphere Master Data Management Server for Product Information Management AIX, HP-UX, Linux, Solaris 9.1 
PRODUCT ALIAS/SYNONYM
 MDMCE
MDMCS
MDMPIM
MDM Server for PIM
MDM Collaboration Server
InfoSphere MDM Server for PIM
InfoSphere Master Data Management Collaboration Server
InfoSphere Master Data Management Server for Product Information Management