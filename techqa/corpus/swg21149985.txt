Title: IBM MustGather: Data collection for memory reference errors and blue screens on Windows - United States

Text:
bsod; dump; memory reference; dr watson; watson; userdump; process; stop events; 1149985; MUSTGATHERDOCUMENT; blue screen; blue; screen; BSOD; memory reference errors; Blue Screen of death; blue screens TECHNOTE (FAQ)

QUESTION
 How can I collect the necessary output for IBM Rational Client Support to analyze memory reference errors and blue screens that occur on Microsoft® Windows® related to IBM® Rational® processes? 

ANSWER
 



STEP 1: Identify the problem

STEP 2: Collect relevant logs

STEP 3: Collect the User or Memory Dump

Configure Windows for a Memory Dump







STEP 1: IDENTIFY THE PROBLEM 

 * 
 * Note: 
 * 
 *  
 *  For a Memory Reference Error:  * WHICH processes are failing or receiving the error (example: clearexplorer.exe, db_server.exe ....)?
   
   
 *  For either a Memory Reference Error or BSOD:  * WHAT operation is being performed when the memory reference error or blue screen occurs ((example: shutting down GUI, performing X operation ....)? 
    * HOW often do the errors occur (example: every night at X time, every day around X time ....)? 
    * HOW many machines does this happen on (example: ALL, one or X number)?
   
   




STEP 2: COLLECT RELEVANT LOGS 
 * 
 * For either a Memory Reference Error or BSOD:
 * Collect the logs from a good machine and a bad machine and compare the two for differences. 
   
   For example; review technote 1131335 [http://www-1.ibm.com/support/docview.wss?uid=swg21131335] for more information on collecting ClearCase logs from Windows.


 Back to top 


STEP 3: COLLECT THE USER OR MEMORY DUMP


 *  For a Memory Reference Error:
   
   The following tools can be used to help collect data about Memory Reference errors. The instructions for each of the tools are provided below:
    * How to create a full user-mode dump file in Windows Vista
      
      For Windows Vista™ hosts refer to Microsoft KB article 951018 [http://support.microsoft.com/kb/951018]How to generate a full user-mode dump file in Windows Vista
      
      
      For Windows 7 hosts refer to Microsoft KB article 931673 [http://support.microsoft.com/kb/931673] How to create a user-mode process dump file in Windows Vista and in Windows 7
      
      
    * Dr. Watson
      
      Note: Dr. Watson is no longer built into Microsoft Windows Vista. If a Dr. Watson dump is requested for Windows Vista, you can use the following to collect the information: http://www.hotcomm.com/FAQ/FAQ_DrVista.asp [http://www.hotcomm.com/FAQ/FAQ_DrVista.asp]
      
      About Dr. Watson
      
      Dr. Watson Setup
      
      Changing debugger to Dr. Watson
      
      
      
      
   
   For a BSOD:
   
   NOTE: For issues that cause a Blue Screen (BSOD) a complete dump is not needed. Users should collect only a kernel dump for these issues unless a complete dump is specifically requested by Rational Client Support.
   
   Configure Windows for a Memory Dump
   
   Troubleshooting Stop Event Messages
   
   
    Back to top 
   
   






DR. WATSON  

ABOUT DR. WATSON: 

The Dr. Watson for Windows program (DRWTSN32.EXE) is preinstalled in your Windows system32 directory. The default options are set the first time Dr. Watson runs, which can be either when an application error occurs or when you run it from the command prompt. When an application error occurs in Windows, the system searches for an application-software exception (error) handler. If it does not find an exception handler, the system verifies that the application is not currently being debugged and considers the exception to be unhandled. The system then processes unhandled exceptions by looking in the Registry for an application-error debugger. REGISTRY VALUES: 

The system looks in the following registry entry for the values named Debugger and Auto. 

32-bit 

HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion \AeDebug 64-bit 

HKEY_LOCAL_MACHINE\Software\Wow6432Node\Microsoft\Windows NT \CurrentVersion\AeDebug 

 

The Debugger value shows the name of the debugger specified to analyze application errors. If the Debugger value is found, the system checks to see if the Auto value is set to zero or one.

 *  AUTO - ZERO: If Auto is set to zero, the system generates a message box that advises you that an error has occurred in the application. If the Debugger value contains the name of a valid debugger (such as WinDbg or NTSD), the message box will have two buttons: OK and Cancel. 
   
   a. If you choose the OK button, the application is terminated. 
   
   b. If you choose the Cancel button, the debugger specified in the Debugger value is started. 
   
   Note: If the Debugger value is empty, the message box will have only an OK button and no debugger will start.
   
   
   AUTO - ONE: If Auto is set to one and a debugger is specified in the Debugger value, the system does not generate a message box before automatically starting the debugger. When Windows is set up on your system, the Auto value is set by default to one and the Debugger value is set to DRWTSN32. This means that when an application error occurs, Dr. Watson will automatically diagnose the error and log the appropriate diagnostic information. 

 Back to top 

 

 

DR. WATSON SETUP: 

 1.  Click Start > Run and type: DRWTSN32 
    Note the location of the crash dump file (user.dmp) and the log file (drwtsn32.log). 
    
    Uncheck Dump All Thread Contexts. - This restricts the dump to the specific process that caused the error.
    
    Ensure the following options are checked:
    
    Crash Dump Type = Full
    Visual Notification
    Create Crash Dump File
    
    [/support/docview.wss?uid=swg21149985&amp;aid=1]
    Close Dr. Watson
    
    Run the application that creates the Dr. Watson error.
    
    Note: There should be a user.dmp file and a drwtsn32.log with data in the file at the specified location (from step 1).

 Back to top 






CHANGING DEBUGGER APPLICATION TO DR. WATSON: What if Dr. Watson is NOT my default debugger? How do I switch to Dr. Watson as my default debugger instead of VC++ (for example)?


32-bit 

If you have been using a different application as your default debugger, and you want to use Dr. Watson instead click Start > Run and type: drwtsn32 -i 

Note: The -i switch causes the necessary changes to be made to the Registry. 

 

64-bit 

If you are using a 64 bit machine, you need to change the registry manually to ensure dr watson picks up the error: 

Under HKEY_LOCAL_MACHINE\Software\Wow6432Node\Microsoft\Windows 

NT\CurrentVersion\AeDebug 

SetDebugger = drwtsn32 -p %ld -e %ld -g


 Back to top 






CONFIGURE WINDOWS FOR A MEMORY DUMP: Review MS KB article 254649 [http://support.microsoft.com/kb/254649] for an overview of memory dump file options for Windows Server 2003, Windows XP, and Windows 2000.


Instructions:


 1. Click Start > Settings > Control Panel and double-click System
    
 2. On the Advanced tab, click Settings in the Startup and Recovery section. 
    
 3. Ensure the Write Debugging Information drop down box has Kernel memory dump selected and note the Dump File: location window as this is where the dump file(s) will be saved. 
    
 4. Ensure Overwrite any existing file is checked. 
 5. Ensure the Automatically restart box is checked.


Hide details for Example screenshot (from Windows XP): [/support/docview.wss?uid=swg21149985&amp;aid=2]Example screenshot (from Windows XP):  * 
 * 


 Back to top 


TROUBLESHOOTING STOP MESSAGES: Refer to the following Microsoft article for more information on Troubleshooting Specific Stop messages [http://technet.microsoft.com/en-us/library/cc785339.aspx]. 






ADDITIONAL NOTES:

Some disk encryption software may prevent kernel and application dumps from being written to disk in some configurations. 



 Back to top 






RELATED INFORMATION
#About memory reference errors and ClearCase [http://www.ibm.com/support/docview.wss?uid=swg21125212]






Cross reference information Segment Product Component Platform Version Edition Software Development Rational ClearCase Operating System Configurations Windows Software Development Rational ClearCase Operating System Configuration Windows Software Development Rational ClearCase Operating System Configurations Windows