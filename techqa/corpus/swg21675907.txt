Title: IBM Portal Upgrade from 8001 to 8001CF12 is failing - United States

Text:
CF12 upgrade conntype TECHNOTE (TROUBLESHOOTING)

PROBLEM
During the installation of CF, there is a failure indicating that there is no connection to the DMGR.

SYMPTOM
From the ConfigTrace.log, we see:
......
[logmsg] [06/05/14 15:21:08.101 EDT] EJPCA3100I: Configuration task "Modify HTTP Inbound Channel timeout value" in progress
[wsadmin] WASX7023E: Error creating "SOAP" connection to host "<<hostname>>"; exception information: com.ibm.websphere.management.exception.ConnectorNotAvailableException: [SOAPException: faultCode=SOAP-ENV:Client; msg=Unable to find a valid IP for host <<hostname>>]
[wsadmin] WASX7213I: This scripting client is not connected to a server process; please refer to the log file /...../wp_profile/logs/wsadmin.traceout for additional information.
[wsadmin] WASX8011W: AdminTask object is not available.
[wsadmin] =======================================================================
[wsadmin] NodeName: '<<nodeName>>'
[wsadmin] ServerName: 'WebSphere_Portal'
[wsadmin] isIseries: ''
[wsadmin] OperatingSystem: 'Linux'
[wsadmin] OsArch: 'amd64'
[wsadmin] ServerShortName: 'removed'
[wsadmin] 
[wsadmin] [06/05/14 15:21:14.782 EDT] WASX7120E: Diagnostic information from exception with text "com.ibm.ws.scripting.ScriptingException: WASX7070E: The configuration service is not available.
[wsadmin] " follows:

[wsadmin] com.ibm.ws.scripting.ScriptingException: WASX7070E: The configuration service is not available.
.......
[xmlaccess] EJPXB0006I: Connecting to URL http://localhost:10039/wps/config/
[xmlaccess] EJPXB0002I: Reading input file /..../wp_profile/ConfigEngine/config/work/HideAppsOnMobile.xml
[xmlaccess] <?xml version="1.0" encoding="UTF-8"?>
[xmlaccess] <!-- IBM WebSphere Portal/8.0.0.1 build wp8001CF12_001_15 exported on Thu Jun 05 15:26:40 EDT 2014 from tcpodvu2.travp.net/10.40.105.146 -->
[xmlaccess] <request build="wp8001CF12_001_15" type="update" version="8.0.0.1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance [http://www.w3.org/2001/XMLSchema-instance]" xsi:noNamespaceSchemaLocation="PortalConfig_8.0.0.xsd">
[xmlaccess] <status element="[content-node uniquename=ibm.portal.page.Applications]" result="failed">
[xmlaccess] <message id="EJPXA0067E">EJPXA0067E: The following configuration data is needed to create a content-node resource: content-parentref.</message>
[xmlaccess] <stacktrace><![CDATA[
[xmlaccess] com.ibm.wps.command.xml.XmlCommandException: EJPXA0067E: The following configuration data is needed to create a content-node resource: content-parentref. [content-node uniquename=ibm.portal.page.Applications]
[xmlaccess] at com.ibm.wps.command.xml.items.AbstractConfigItem.attributesMissing(AbstractConfigItem.java:250)

......
BUILD FAILED
/was80/PortalServer/installer/wp.update/config/includes/cumulative_fix.xml:60: The following error occurred while executing this line:
/was80/PortalServer/installer/wp.update/config/includes/wp.update.fix_cfg.xml:194: The following error occurred while executing this line:
/was80/PortalServer/base/wp.script/config/includes/wp.script.fp_cfg.xml:35: Java returned: 105
Total time: 20 minutes 15 seconds
.....

and though the DMGR is known to be started, we see the statement for connection type:
......
action-set-conntype-property:
[echo] wsadminConnType set to: NONE
Target finished: action-set-conntype-property
.......


CAUSE
In this case, the task was unable to identify the DMGR profile when attempting to connect.

ENVIRONMENT
WP 8.0.0.1 cluster.

DIAGNOSING THE PROBLEM
From the ConfigTrace.log, we see the following
over and over:
.....
action-set-conntype-property:
[echo] wsadminConnType set to: NONE
Target finished: action-set-conntype-property

......

which indicate that the tasks are not able to connect to a DMGR.

From testing, we know that the DMGR is functional, so, it had to be
some type of configuration error.

Looking at the ant failure logs, we see:
......
iim-start-dmgr:
[exec] WCMD0003E: The specified profile "dmgr" cannot be found. If
a default profile exists and you wish to use it, the -profileName
parameter is not required.
[exec] Result: 1
.....

indicating that the profile 'dmgr' cannot be found.

From the properties, we see this:
......
was.install.root = /was80/nd
user.install.root = /was80/nd/profiles/PortalDmgr01
.....

indicating that the DMGR profile name is 'PortalDmgr01', and
.....
Server dmgr open for e-business; process id is......
.....

indicating that the DMGR Server name is 'dmgr'.

RESOLVING THE PROBLEM
In this install, the Server name is being supplied when the DMGR
profile name is being requested in the CF installation GUI.

From the installation instructions:

http://www-10.lotus.com/ldd/portalwiki.nsf/dx/IBM_WebSphere_Portal_V8.0.0.1_Combined_Cumulative_Fix_Instructions_cluster_cf8001 [http://www-10.lotus.com/ldd/portalwiki.nsf/dx/IBM_WebSphere_Portal_V8.0.0.1_Combined_Cumulative_Fix_Instructions_cluster_cf8001]





make sure that the correct DMGR profile information is provided when needed.