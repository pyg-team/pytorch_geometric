Title: IBM WebSphere Commerce integration with LDAP using referrals to other LDAP servers - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 WebSphere Commerce uses IBM WebSphere Application Server's Federated Repositories to connect to an LDAP server. Federated Repositories supports referrals to other LDAP servers. After setting up WebSphere Commerce with LDAP using referrals, a user attempts to log into WebSphere Commerce to test the LDAP configuration, however an exception is generated. 

SYMPTOM
When an existing user, for example. wcsadmin, first attempts to log into WebSphere Commerce after the system has been configured with LDAP, the user is automatically created in the LDAP server if the user does not already exist there. During this user creation process, the following exception is generated: 

[9/21/10 21:38:40:029 GMT] 00000339 exception E com.ibm.ws.wim.adapter.ldap.LdapConnection createSubcontext CWWIM4520E The 'javax.naming.PartialResultException: [LDAP: error code 10 - Referral]; remaining name 'uid=wcsadmin,ou=ibmgroups,ou=groups,o=ibm.com'; resolved object com.sun.jndi.ldap.LdapCtx@1e9c356' naming exception occurred during processing.

[9/21/10 21:38:40:042 GMT] 00000339 exception E com.ibm.ws.wim.adapter.ldap.LdapConnection createSubcontext com.ibm.websphere.wim.exception.WIMSystemException: CWWIM4520E The 'javax.naming.PartialResultException: [LDAP: error code 10 - Referral]; remaining name 'uid=wcsadmin,ou=ibmgroups,ou=groups,o=ibm.com'; resolved object com.sun.jndi.ldap.LdapCtx@1e9c356' naming exception occurred during processing.
at com.ibm.ws.wim.adapter.ldap.LdapConnection.createSubcontext(LdapConnection.java:816)
at com.ibm.ws.wim.adapter.ldap.LdapAdapter.create(LdapAdapter.java:391)
at com.ibm.ws.wim.ProfileManager.createImpl(ProfileManager.java:591)
at com.ibm.ws.wim.ProfileManager.genericProfileManagerMethod(ProfileManager.java:298)
at com.ibm.ws.wim.ProfileManager.create(ProfileManager.java:344)
at com.ibm.websphere.wim.ServiceProvider.create(ServiceProvider.java:314)
at com.ibm.websphere.wim.client.LocalServiceProvider.create(LocalServiceProvider.java:356)
at com.ibm.commerce.member.syncbeans.VMMProxy$1.run(VMMProxy.java:696)
at com.ibm.ws.security.auth.ContextManagerImpl.runAs(ContextManagerImpl.java:4575)
at com.ibm.ws.security.auth.ContextManagerImpl.runAsSystem(ContextManagerImpl.java:4663)
at com.ibm.commerce.member.syncbeans.VMMProxy.createMember(VMMProxy.java:706)
at com.ibm.commerce.member.syncbeans.SyncBeanBase.createInLDAP(SyncBeanBase.java:824)
at com.ibm.commerce.member.syncbeans.SyncBeanBase.update(SyncBeanBase.java:1668)
at com.ibm.commerce.security.commands.
WMMAuthenticationCmdImpl.performExecute(WMMAuthenticationCmdImpl.java:483)
at com.ibm.commerce.command.ECCommandTarget.executeCommand(ECCommandTarget.java:157)


CAUSE
This error typically occurs due to incorrect set up of LDAP with WebSphere Commerce when referrals are used. Typically, referrals are set to be ignored in wimconfig.xml


RESOLVING THE PROBLEM
Review the following document for instructions on how to set up LDAP with referral settings using the WebSphere Application Server Administration Console: Lightweight Directory Access Protocol repository configuration settings [http://publib.boulder.ibm.com/infocenter/wasinfo/v7r0/index.jsp?topic=/com.ibm.websphere.nd.multiplatform.doc/info/ae/ae/uwim_ldapreposettings.html]. 

 

Following these instructions modifies wimconfig.xml located at:
<profile_root>/config/cells/cellName/wim/config

Change from:
referral="ignore" 

And set to:
referral="follow"