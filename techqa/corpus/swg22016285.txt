Title: IBM Security Guardium Sniffer restarting every five minutes - United States

Text:
sniffer; restart; timestamp; stuck; condition TECHNOTE (TROUBLESHOOTING)

THIS DOCUMENT APPLIES ONLY TO THE FOLLOWING LANGUAGE VERSION(S):
 English 

PROBLEM(ABSTRACT)
 The Sniffer is restarting every five minutes and the nanny is producing the error "stuck condition = timestamp" in the /var/log/messages log file. 

SYMPTOM
The Sniffer is restarting and producing error's in the /var/log/messages log file.


CAUSE
The Guardium appliance unit type has been edited incorrectly.

DIAGNOSING THE PROBLEM
Generate the Sniffer Must Gather output, using either the GUI or using the CLI command. 

Then uncompress the Must Gather zip file, once it has been obtained. In the extracted contents you will be able to find the /var/log/messages log file, you will need to open this file using a text editor, this will enable you to review it's contents.

If you are encountering the same problem with the Sniffer restarting, then you will see the below messages being produced:

May 6 22:09:20 vmguard3 snif: Guardium Sniffer Started
May 6 22:09:22 vmguard3 GuardiumSniffer[31255]: Guardium Sniffer license verified.
May 6 22:09:22 vmguard3 GuardiumSniffer[31255]: Inspection engine, Tap disabled.
May 6 22:14:27 vmguard3 nanny:[4038]: stuck condition = timestamp
May 6 22:14:27 vmguard3 nanny:[4038]: killing 31255 with -9.
May 6 22:14:27 vmguard3 nanny:[4038]: Sun May 6 22:14:27 2018 snif 31255 killed because it stuck
May 6 22:14:27 vmguard3 init: guard-snif main process (31255) killed by KILL signal
May 6 22:14:27 vmguard3 init: guard-snif main process ended, respawning

This problem is caused by the Unit Type being incorrectly set. To confirm that this is the cause simply execute the below CLI command:
SHOW UNIT TYPE

The output generated by this command does not return the "stap" output, as the below example output demonstrates:
Managed Netinsp


RESOLVING THE PROBLEM
To resolve the issue you will need to execute the STORE UNIT TYPE command to add the "stap" to the stored unit type information. 

STORE UNIT TYPE STAP

This will then return the below output from the SHOW UNIT TYPE command:
Managed Netinsp stap

RELATED INFORMATION
 IBM MustGather: Collecting data for Guardium Appliance [https://www-01.ibm.com/support/docview.wss?uid=swg21971158]