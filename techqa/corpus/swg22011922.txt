Title: IBM "Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN" error when run Excel link report - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 User creates an Excel link report containing at least one fGetVal.

User clicks F9 to run the report. An error appears. 

SYMPTOM
Controller 10.1.1: 

Standard Error
Number: 5 
Source: FrangoDirect.ExcelLinkD.FetchValues#ControllerProxyClient 
Description: System.Web.Services.Protocols.SoapException: Server was unable to process request. ---> System.Runtime.InteropServices. 
COMException (0x80040E14): Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN. 
at Cognos.Controller.Proxy.CCRWS.ExcelLinkB_FetchValues(String sGuid, DataSet rsKeys, String sMcurr, Boolean bLocLang, String sUser, String sRep, Boolean bIsLnk, String sSortOrd, String sParams) 
--- End of inner exception stack trace --- 
at Microsoft.VisualBasic.ErrObject.Raise(Int32 Number, Object Source, Object Description, Object HelpFile, Object HelpContext) 
at Cognos.Controller.Common.RaiseErrCli.RaiseError(Int32 lErrNo, String sErrSource, String sErrDesc, String sErrHelpFile, Int32 lErrHelpContext) 
at Cognos.Controller.Direct.ExcelLinkD.FetchValues(DataSet rsKeys, String sMcurr, Boolean bLocLang, String sRep, Boolean bIsLnk, String sSortOrd, String sParams) 
at Cognos.Controller.Reports.ExcelLink.RunReportLnk()

Controller 10.2.1:
[/support/docview.wss?uid=swg22011922&aid=1] [/support/docview.wss?uid=swg22011922&aid=1]


CAUSE
Limitation of Controller, which is only triggered in certain (rare) situations: 

 * Database has the following server preference configured: ENABLE_REPRUN_OPT = TRUE
   [/support/docview.wss?uid=swg22011922&aid=2] [/support/docview.wss?uid=swg22011922&aid=2] 
 * the fGetVal function is running a special part of the program code. 


TIP: ENABLE_REPRUN_OPT is a method of speeding up some types of reports.  * For full details of what it does, see separate IBM Technote #1982182.


Example: 
This error is rarely seen. In one real-life customer case it only occurred when both of the following was true:  * Using a very simple report (workbook), with only one fgetval formula 
 * The closing version was set to a specific value (REPO).  * When the closing version was changed to anything that contains more than only reported values, then the formula worked OK. 
   
   
 * By adding at least one journal type to REP then the report worked OK. 

RESOLVING THE PROBLEM
Fix: 

Modify the report so that it works OK with ENABLE_REPRUN_OPT. 

 * Typically this means increasing the complexity of the report (by adding more formulae connecting to different data) until it works OK (no error).


Workaround: 
Disable the use of ENABLE_REPRUN_OPT 

NOTE: This may cause other (more complex) reports to run more slowly.  * For more details, see separate IBM Technote #1982182.


Steps: 1. Launch the Controller client 

2. Choose the database (where you wish to make the change) 

3. Logon as an administrator 

4. Click "Maintain - Configuration - General" 

5. Click 'Server Preferences' 

6. Modify existing (or create a new) entry: 

 * Variable Name = ENABLE_REPRUN_OPT 
 * Variable Value = FALSE


7. Press 'Save' 
8. Exit Controller 
9. Re-launch the Controller client 
10. Test. RELATED INFORMATION
 1982182 - 'ENABLE_REPRUN_OPT' Server Preference [http://www.ibm.com/support/docview.wss?uid=swg21982182]