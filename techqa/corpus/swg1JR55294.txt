Title: IBM JR55294: THE SINGLE QUOTATION MARK (') IN THE KEY OR VALUE OF DOCUMENT PROPERTY CAUSES INVALID CE AND CMIS QUERIES TO BE PERFORMED - United States

Text:
  A FIX IS AVAILABLE
Version 8.5 Refresh Pack 7 for the IBM Business Process Manager products [http://www-01.ibm.com/support/docview.wss?uid=swg24041575]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS FIXED IF NEXT.
    
   
   

ERROR DESCRIPTION
 *  When you work with documents in IBM Business Process Manager
   (BPM), you can specify properties with a key and value during
   creation. In the Document Attachment control and the Document
   List coach view, you can use those properties to filter the
   result.
   
   However, when the key or the value of such a property contains
   the single quotation mark ('), a query fails and you see an
   exception in the SystemOut.log file that indicates the syntax is
   invalid:
   
   com.lombardisoftware.core.TeamWorksException: CWTDS0000E: An
   unexpected failure occurred. Details: 'FNRCR0083:
   RETRIEVE_SQL_SYNTAX_ERROR: There was a syntax error in an SQL
   query or filter expression at line 1, position 554.  Read
   "'Description,test apo'" but expected "(" | "-" |
   <STRING_LITERAL> "*" | <STRING_LITERAL> "/" | <STRING_LITERAL>
   "+" | <STRING_LITERAL> "-" | <STRING_LITERAL> ")" | "SELECT" |
   <STRING_LITERAL> "," | "OBJECT" | <PARAMETER> | <STRING_LITERAL>
   <COMPARE_OPS> | <STRING_LITERAL> <FOLDER_OPS> | <STRING_LITERAL>
   "LIKE" | "LOWER" | "UPPER" | "ABS" | <ALPHANUM_CHARSEQ> |
   <COMPLEXENTITYDBLQT> | <COMPLEXENTITYBRACKET> | <UINT_LITERAL> |
   <GUID> | "*" | <STRING_LITERAL> "IN" | "EXISTS" | "ISCLASS" |
   "CONTAINS" | "FREETEXT" | "ISOFCLASS" | "ISMODIFIED".  The
   original query was: ObjectStore: "docs", SQL: "SELECT
   DOC.IBM_BPM_Document_DocumentId,
   DOC.IBM_BPM_Document_ParentDocumentId,
   DOC.IBM_BPM_Document_ContentMigrated, DOC.DateCheckedIn,
   DOC.DocumentTitle, DOC.ContentSize,
   DOC.IBM_BPM_Document_FileType,
   DOC.IBM_BPM_Document_HideInPortal,
   DOC.IBM_BPM_Document_ProcessInstanceId,
   DOC.IBM_BPM_Document_ProcessInstanceIdString,
   DOC.IBM_BPM_Document_Properties,
   DOC.IBM_BPM_Document_FileNameURL, DOC.IBM_BPM_Document_UserId,
   DOC.MajorVersionNumber, DOC.ContentElements FROM
   IBM_BPM_Document AS DOC WITH EXCLUDESUBCLASSES WHERE
   DOC.IsCurrentVersion=TRUE AND ('Description,test apo'f') IN
   DOC.IBM_BPM_Document_Properties ORDER BY DOC.DateCheckedIn".'
   Explanation: An exception was thrown.
   Action: Check the server log files.
    at com.lombardisoftware.server.ejb.api.
     BPDInstanceDocumentAPICore.getDocumentsByProperties
     (BPDInstanceDocumentAPICore.java:838)
    at sun.reflect.GeneratedMethodAccessor273.
     invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke
     (DelegatingMethodAccessorImpl.java:37)
    at java.lang.reflect.Method.invoke(Method.java:611)
   
   
    
   
   

LOCAL FIX
 *  When you use the Document Attachment control and specify a
   filter in the display options, escape the single quotation mark
   (') with another single quotation mark so that ' becomes ''.
   
   When you use the Document List coach view and specify a filter
   in the display options, escape the single quotation mark (')
   with a backslash so that ' becomes \'.
   
   Note: After you upgrade to an IBM BPM release that includes this
   fix, remove these workarounds.
   
   
    
   
   

PROBLEM SUMMARY
 *  The single quotation mark (') was not correctly escaped when the
   properties were translated into a query for the IBM BPM document
   store.
   
   A fix that escapes the single quotation mark (') is included in
   IBM BPM V8.5.7.
   
   
    
   
   

PROBLEM CONCLUSION

TEMPORARY FIX
 *  Not applicable
   
   
    
   
   

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   JR55294
   
   
 * REPORTED COMPONENT NAME
   BPM STANDARD
   
   
 * REPORTED COMPONENT ID
   5725C9500
   
   
 * REPORTED RELEASE
   856
   
   
 * STATUS
   CLOSED FIN
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt / Xsystem
   
   
 * SUBMITTED DATE
   2016-02-11
   
   
 * CLOSED DATE
   2016-03-31
   
   
 * LAST MODIFIED DATE
   2016-03-31
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   BPM STANDARD
   
   
 * FIXED COMPONENT ID
   5725C9500
   
   

APPLICABLE COMPONENT LEVELS
 * R856 PSN
   UP