Title: IBM CSPA004E message received repeatedly even though no Secure+ process is running - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Getting "CSPA004E Security Violation - PNODE authentication error" message every minute, even though no associated Secure+ process is running. 

SYMPTOM
The trace showed the following: 

TLS/SSL Socket Init Error, 0x00000192 (No SSL cipher specifications). 
ENDING TLS/SSL HANDSHAKE, RC=402 
CSPA004E Security Violation - PNODE authentication error 

ESTAE had the following:: 

DMGSEC# FUNCTION ERROR: TAPROCNO=00000000 SEC#FUNC=11 SEC#CFUN=00 
SEC#MSG=CSPA999E SEC#RC=00000192 
SEC#SC=00000999 SVRES=00000000 

SEC#FUNC=11 means it was in the SSL/TLS handshake when it failed. SEC#RC=00000192 is RC=402 in hexadecimal; the explanation for RC=402 is: 

The client and server cipher specifications do not contain at least one value in common. This error can also occur if no SSL protocols are enabled or if all of the enabled protocols have empty cipher specifications. 


CAUSE
A non-CDZ application was attempting to establish a session with the DTF while using an incorrect protocol.

DIAGNOSING THE PROBLEM
The trace indicated the IP address of the session attempting to establish connection was coming from IBM Sterling Control Center, which will, by default, attempt to connect to and pull stats and process information from the C:D z/OS node every 60 seconds.

RESOLVING THE PROBLEM
The connection set up in IBM Sterling Control Center for this C:D z/OS node was set up using the wrong protocol.




This connection can be set to TCPIP, SSL, TLS, TLSv1.1 or TLSv1.2. If TCPIP (non-Secure) or TLS (Secure) are coded, a connection can be established without defining .CLIENT in the C:D z/OS Secure+ PARMFILE. However, if SSL, TLSv1.1 or TLSv1.2 are coded, a .CLIENT node must be coded in the C:D z/OS Secure+ PARMFILE with the matching protocol selected. If not, then the CSPA004E message will be received each time (that is, every 60 seconds) this connection is attempted and failed.

To test this, do one of two things: 

1) Go into the IBM Sterling Control Center properties for this node and change the Connection to
TLS or TCPIP, then save the properties. 

2) Go into the C:D z/OS IUI and bring up the PARMFILE in the Secure+ Admin Tool. Add a remote node entry to your PARMFILE called .CLIENT (make sure to include the dot at the beginning - .CLIENT) and set the correct protocol.

IMPORTANT: On the .CLIENT, make sure "Enable Override: is set to Y. 

Do a 'Save Active'. 

Either one of these options should cause the CSPA004E messages to stop.