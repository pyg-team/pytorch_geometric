Title: IBM Content Collector and IBM eDiscovery Manager search errors for email data that was indexed with IBM Content Search Services by the 
IBM FileNet P8 index migration process - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Users of the Content Collector search application and users of eDiscovery Manager might see errors when searching email content archived by Content Collector in an IBM FileNet P8 object store after they accidentally triggered the FileNet P8 migration of IBM Legacy Content Search Engine indexes to IBM Content Search Services for that object store. All searches involving email in that object store fail with an error. Searches involving data in object stores that were not migrated are unaffected. 

SYMPTOM
The error displayed in the Content Collector search UI is a generic repository error message: 

The server is not accessible. The repository session could not be opened, try again later. 

In the eDiscovery Manager search UI, this message is displayed:

DYRS1009E. eDiscovery Manager was unable to connect to one or more content servers. The content servers that were not accessible are: <name of the P8 Domain:object store>. 

The log files both for the Content Collector search application and for eDiscovery Manager contain this error message:

FNRCB0037E: CBR_TS_EXEC_SEARCH_QUERY_FAILED: An IBM Content Search Services server could not run the following full-text search: <query in LCSE syntax>. The syntax for the search expression is not valid. Revise the search expression to use correct syntax. For information about search expression syntax, see "SQL Syntax Reference" in the IBM FileNet P8 information center.



CAUSE
These search errors occur when you mistakenly triggered the FileNet P8 migration of IBM Legacy Content Search Engine indexes to IBM Content Search Services for an object store and subsequently changed the FileNet P8 default search engine setting for that object store to Content Search Services. The following sections describe the background for this and how to recover from this situation. 

While FileNet P8 supports the migration of IBM Legacy Content Search Engine indexes to IBM Content Search Services, you cannot use this migration process for object stores that contain email documents archived with Content Collector into the document classes ICCMail2 and ICCMailSearch2. The reason for this restriction is that Content Collector support for IBM Content Search Services requires an email data model change and not just index migration. Therefore, Content Collector support for IBM Content Search Services is currently limited to new email content archived into new object stores that are configured for using IBM Content Search Services only.

You might have triggered FileNet P8 index migration in IBM FileNet Enterprise Manager by selecting IBM Content Search Services Enabled on the CBR IBM Search tab on the property sheet of an object store. While this migration process runs, the Index Jobs Manager in FileNet Enterprise Manager shows a job labeled "Index migration job". If you triggered this process mistakenly for an object store containing Content Collector email, just let the index migration job run to completion. The job can take considerable time. You can pause and resume the job but you cannot cancel or delete the job if you find problems. If the job stops before its completion, the job is considered TERMINATED_ABNORMALLY and it must be rerun. New documents that are added to the object store while the migration job is still running are indexed with priority over documents being migrated as part of the migration job. There is no data loss and the index migration job by itself does not cause functional problems. However, it uses additional CPU and disk space on your IBM Content Search Services server during migration. You can continue using IBM Legacy Content Search Engine during and after the migration job is processed and ignore IBM Content Search Services on this object store for the time being. This is possible because the migration job can be triggered only if the object store is enabled for both search engines.

As a precaution, make sure that the default search engine for that object store is still set to IBM Legacy Content Search Engine:


 1. In FileNet Enterprise Manager, right-click the object store and select Properties. 
 2. On the General tab of the property sheet, check the value of the CBR Search Type field. Make sure it is set to IBM Legacy Search Engine (Verity). If you changed that earlier to Content Search Services, change it back now to avoid search errors in Content Collector mailbox searches and eDiscovery Manager searches on the email data in this object store. Do not try to disable IBM Content Search Services on this object store; this is not a supported operation. 


Even though there are no functional issues in this situation, you might see additional CPU and disk storage requirements after the migration. These are caused by the dual indexing configuration for that object store. Contact IBM support for additional help. 

If you cannot select IBM Legacy Content Search Engine (Verity) as the default search engine in step 2, you probably disabled IBM Legacy Content Search Engine on that object store. Verify this in FileNet Enterprise Manager: 
 1. Right-click the object store and select Properties. 
 2. On the CBR Verity tab of the property sheet, check the value of the Verity Domain Configuration field. If this is set to <None>, IBM Legacy Content Search Engine is disabled for that object store. 
    

Disabling IBM Legacy Content Search Engine is a non-reversible step. Content Collector search and eDiscovery Manager search on the email data in this object store do not work in this configuration. Other object stores and other functionality is not affected. Contact IBM Support to help you reestablish Content Collector and eDiscovery Manager search functionality. 

Background information from the IBM Content Collector Indexing Guide (see the related links): 
IBM FileNet P8 offers two Content Search Engine components, IBM Legacy Content Search Engine and IBM Content Search Services, which you can run in parallel for indexing and search. 

However, Content Collector does not support concurrent indexing with IBM Content Search Services and IBM Legacy Content Search Engine for a single object store. Object stores that are used for archiving with Content Collector must be configured to use either IBM Legacy Content Search Engine or IBM Content Search Services. So, if your installation of IBM FileNet P8 Content Engine includes both Content Search Engine components and you want to use IBM Content Search Services instead of IBM Legacy Content Search Engine for indexing documents archived with Content Collector, create a new object store and configure it for indexing with IBM Content Search Services only. 

Object stores for indexing with IBM Legacy Content Search Engine must be set up with the document classes ICCMail2 and ICCMailSearch2. Object stores for indexing with IBM Content Search Services must be set up with the document class ICCMail3. 


Related links: 
IBM Content Collector Version 2.2.0.2 Indexing Guide [http://www.ibm.com/e-business/linkweb/publications/servlet/pbi.wss?CTY=US&FNC=SRX&PBL=SH12-6962-00] 
IBM Content Collector Version 3.0 Indexing Guide [http://www.ibm.com/e-business/linkweb/publications/servlet/pbi.wss?CTY=US&FNC=SRX&PBL=SH12-6979-00]