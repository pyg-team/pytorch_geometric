Title: IBM FTP Server Frontside handler with password policy and TLS enabled rejects client connection. - United States

Text:
ftp; ftpes; ssl; tls; 530; authentication; reject; AAA; datapower TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 FTP client connection is rejected when the FTP Server Frontside Handler is configured with password policy and TLS is also enabled on the IBM WebSphere DataPower SOA Appliance. This occurs when mutual authentication is being used with SSL. 

SYMPTOM
The FTP client connection fails and the following messages are logged: 

source-ftp-server(FTP_FsH5031): [request][10.10.10.12]: Reject set: Rejected by policy.
source-ftp-server(FTP_FsH5031): [10.10.10.12]: FTP Server: sending response '530 login incorrect' to client 10.10.10.12

CAUSE
Client's certificate DN is missing in the AAAInfo file



RESOLVING THE PROBLEM
AAA rejects the FTP client connection when the FTP Frontside handler is configured with the combination of password policy and TLS because the AAAInfo file does not include a DN entry for the incoming client (user). When the SSL connection is configured for mutual authentication, the client's certificate DN is included in the input to the AAA Authentication step. The AAAInfo file therefore needs to be updated to include the certificate DN for the incoming client. The updated AAAInfo file may look similar to the one below: 

 

 * 
 * 
 *  
   <Username>fred</Username> <Password>flintstone</Password> 
   
   <DN>CN=Alice, O=DataPower, L=Cambridge, ST=MA, C=US</DN> 
   
   <OutputCredential>admin</OutputCredential>
   
   
 * 
 *