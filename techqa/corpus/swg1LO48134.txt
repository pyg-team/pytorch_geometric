Title: IBM LO48134: CDAT FUNCTION COULD NOT UNDERSTAND THE SOME "MEDIUM DATE" OR "YY/MMM/DD" TYPE DATA ON AIX. - United States

Text:
 SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS FIXED IF NEXT.
    
   
   

ERROR DESCRIPTION
 *  1.Store the sample database (test.nsf) in the attachment
   database to the Domino
   data directory.
   2.Update the signature of the design by using Administrator
   clients.
   3.Start the Domino server.
   > tell amgr sched
   [0CD0:0002-0FB4] S S 17:41 Today        test
   
   test.nsf
   
   4.Then amgr start the agent.
   You can find the some Agents are fail with follow messages.
   [397412:00002-00001] 2010/01/19 18:54:47   AMgr: Agent ('test'
   in 'test.nsf')
   message box: NG
   [397412:00002-00001] 2010/01/19 18:54:47   AMgr: Agent ('test'
   in 'test.nsf')
   error message: N003 No RESUME
   
   
   Sub Initialize
   
    On Error Goto errfnc
   
    Dim session As New NotesSession
    Dim db As NotesDatabase
    Dim collection As NotesDocumentCollection
    Dim doc As NotesDocument
   
    Dim vDate  As Variant
   
    Set db = session.CurrentDatabase
    Set collection = db.UnprocessedDocuments
    Set doc = collection.GetFirstDocument()
   
    While Not(doc Is Nothing)
   
     vDate = doc.test
   
     If Cdat(Format(Cstr(vDate(0)),"Medium Date")) = Today() Then
      Msgbox "OK1 : "+Format(Cstr(vDate(0)),"Medium Date") +" : "+
   
   Format(Cstr(vDate(0)),"yy/mmm/dd")
      End
     Else
      Msgbox "OK2 : "+Format(Cstr(vDate(0)),"Medium Date")  +" : "+
   
   Format(Cstr(vDate(0)),"yy/mmm/dd")
      End
     End If
   
     Set doc = collection.GetNextDocument(doc)
    Wend
   
    Exit Sub
   
   errfnc:
   
    Msgbox "NG"
   
   End Sub
   
   The problem occurred in the line as follow...
   
   If Cdat(Format(Cstr(vDate(0)),"Medium Date")) = Today() Then
   
   In the interest of brevity, set the result of the Format
   function as follows...
   
   If Cdat("10/Jan/07") = Today() Then
   
   The agent fail with same error messages.
   
   Made further inquiries,it seems that Cdat function could not
   understand "Jan".
   Success
   09/Dec/07
   10/Dec/07
   
   Fail
   09/Jan/07
   10/Jan/07
   
   This problem could not occurred on Windows.
   #But, on windows, Format function could not output the type of
   "Medium Date"
   correctly.  :-p
   
   
    
   
   

LOCAL FIX
 *  Use another data type like "yy/mm/dd".
   
   
    
   
   

PROBLEM SUMMARY
 *  The problem will be fixed in the next release of the product.
   
   
    
   
   

PROBLEM CONCLUSION

TEMPORARY FIX

COMMENTS
 *  This APAR is associated with SPR# MKIA7ZXCMZ.
   The problem will be fixed in the next release of the product.
   
   
    
   
   

APAR INFORMATION
 * APAR NUMBER
   LO48134
   
   
 * REPORTED COMPONENT NAME
   NOTES CLIENT
   
   
 * REPORTED COMPONENT ID
   5724E6255
   
   
 * REPORTED RELEASE
   703
   
   
 * STATUS
   CLOSED FIN
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2010-01-22
   
   
 * CLOSED DATE
   2010-02-11
   
   
 * LAST MODIFIED DATE
   2010-02-11
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

MODULES/MACROS
 *  NA
   
   
    
   
   

FIX INFORMATION

APPLICABLE COMPONENT LEVELS
 * R703 PSN
   UP