Title: IBM MustGather: Performance, hang, or high CPU issues with WebSphere Application Server on Linux - United States

Text:
mustgather; mustgather; mustgather; performance; isa; collector; autopd; auto pd; MustGatherDocument; WASSDK TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 If you are experiencing performance, hang, or high CPU issues with WebSphere Application Server on Linux, this MustGather will assist you in collecting the data necessary to diagnose and resolve the issue. 

RESOLVING THE PROBLEM
 

If you are experiencing performance, hang, or high CPU issues with WebSphere Application Server on Linux, this MustGather will assist you in collecting the data necessary to diagnose and resolve the issue. There are two scripts that can be used to collect the performance diagnostic information Please expand the following section and download one of the scripts and use it to collect information during the problem

COLLECTING DATA

Complete the following three steps: 

(1) Collecting the required data: 

If you have not already done so, enable verboseGC [http://www.ibm.com/support/docview.wss?uid=swg21114927] and restart the problematic server(s). 

At the time of the problem, run the attached script with the following command: 

./linperf.sh [PID] 
linperf.sh [/support/docview.wss?uid=swg21115785&aid=2]linperf.sh [/support/docview.wss?uid=swg21115785&aid=1] 


This script will create a file named linperf_RESULTS.tar.gz and three javacores. This script should be executed as the root user. As with any script, you may need to add execute permissions before executing the script (chmod). 

In the above command, [PID] is the Process ID of the problematic JVM(s). If specifying multiple Process IDs they should each be separated by a space. 

(2) Collecting log files: 

Collect the server logs (SystemOut.log, native_stderr.log,...) from the problematic server(s): 

profile_root /logs/ server_name /* 

(3) Submitting required data: 

Zip/Tar all the files gathered: 
 * linperf_RESULTS.tar.gz 
 * javacores 
 * server logs (SystemOut.log, native_stderr.log,...)


Send the results to IBM Support: "Exchanging information with IBM Support" [http://www.ibm.com/support/docview.wss?uid=swg21153852] 



Frequently Asked Questions:


 * What is the impact of enabling verboseGC?
 * 
 * 
 * 
 * 
 * What is the linperf_RESULTS.tar.gz file and where can I find it?
 * 
 * 
 * 
 * 
 * What are 'javacores' and where do I find them?
 * 
 * 
 * 
 * 
 * find / -name "*javacore*"



If asked to do so: 
The preceding data is used to troubleshoot most of these type of issues; however, in certain situations Support may require additional data. Only collect the following data if asked to do so by IBM Support. 
 * A series of system cores
 * Collect a series of system cores by running the following commands: 
   Note: These commands require the gdb debugger to be installed. 
   
   gdb install_root /java/jre/bin/java [PID] 
   (gdb) generate core1.[PID] 
   (gdb) detach 
   (gdb) quit 
   
   <wait two minutes> 
   
   gdb install_root /java/jre/bin/java [PID] 
   (gdb) generate core2.[PID] 
   (gdb) detach 
   (gdb) quit 
   
   <wait two minutes> 
   
   gdb install_root /java/jre/bin/java [PID] 
   (gdb) generate core3.[PID] 
   (gdb) detach 
   (gdb) quit 
   
   Creating core files with gdb as described above should not kill the process. If the above 'generate' command does not work then try using the 'gcore' command. 
   
   Process the resulting system core files (core1.[PID], core2.[PID],...) using the instructions in How to process a core dump using jextract on the IBM SDK on Windows, Linux, and AIX [http://www.ibm.com/support/docview.wss?uid=swg21577379] 
 * 
 * System core
 * In cases where we cannot collect a series of system cores we can collect a single core file using the following method. However, it must be noted that this will kill the process when collected and the diagnostic value of a series of system cores is much greater than a single core when working with these type of issues. This single core file will need to be processed with jextract as noted in the above section. 
   
   kill -6 [PID] 
 * 
 * Monitor process sizes and paging usage
 * The linmon.sh script will collect data every 5 minutes until it is stopped manually. Run the following command before the issue occurs to start the script: 
   
   ./linmon.sh 
   
   This will create two files: ps_mon.out and vmstat_mon.out. 
   [/support/docview.wss?uid=swg21115785&aid=4] linmon.sh [/support/docview.wss?uid=swg21115785&aid=3] 


EXCHANGING DATA WITH IBM SUPPORT
To diagnose or identify a problem, it is sometimes necessary to provide Technical Support with data and information from your system. In addition, Technical Support might also need to provide you with tools or utilities to be used in problem determination. You can submit files using one of following methods to help speed problem diagnosis: 

 * IBM Support Assistant (ISA) 
 * Service Request (SR)
 * E-mail 
 * FTP to the Enhanced Customer Data Repository (ECuRep)




Instructions for exchanging information with IBM Support [http://www.ibm.com/support/docview.wss?uid=swg21153852]

READ FIRST AND RELATED MUSTGATHERS
MustGather: Read first for WebSphere Application Server [http://www.ibm.com/support/docview.wss?uid=swg21145599]




 Crash problem [http://www.ibm.com/support/search.wss?tc=SSCYP8L&q=MustGatherDocument] Out of Memory Problem [http://www.ibm.com/support/search.wss?tc=SSCMPCY&q=MustGatherDocument] 

RELATED INFORMATION
 Recording your screen to share with IBM Support [https://www.ibm.com/developerworks/community/blogs/IBMElectronicSupport/entry/recording_your_screen_to_share_with_support?lang=en]


 



Cross reference information Segment Product Component Platform Version Edition Application Servers WebSphere Application Server - Express Linux 8.5, 8.0, 7.0, 6.1, 6.0, 5.1 Application Servers Runtimes for Java Technology Java SDK