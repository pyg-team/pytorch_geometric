Title: IBM JR54039: UNABLE TO CREATE SDK 7 DEPLOYMENT ENVIRONMENT IF THE DEFAULTPROFILE IS SDK 7 - United States

Text:
  DIRECT LINKS TO FIXES
bpm.8560.cf1.delta.repository.2 [http://www.ibm.com/support/fixcentral/quickorder?product=ibm%2FWebSphere%2FIBM+Business+Process+Manager+Standard&fixids=bpm.8560.cf1.delta.repository.2&source=SAR]
bpm.8560.cf1.delta.repository.1 [http://www.ibm.com/support/fixcentral/quickorder?product=ibm%2FWebSphere%2FIBM+Business+Process+Manager+Standard&fixids=bpm.8560.cf1.delta.repository.1&source=SAR]
Version 8.5 Refresh Pack 7 for the IBM Business Process Manager products [http://www-01.ibm.com/support/docview.wss?uid=swg24041575]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  If we have an existing defultprofile configured for SDK6 and
   trying to create a new Deployment Environment for SDK7 by
   
   ./managesdk.sh -setNewProfileDefault -sdkName 1.7_64
   ./managesdk.sh -setCommandDefault -sdkname 1.7_64
   
   If the Deployment Environment backend database is Oracle (
   ojdbc7.jar ) you see the following exception and DE creation
   fails with the following exception.
   
   
   java.lang.UnsupportedClassVersionError:
   oracle/jdbc/driver/OracleDriver : Unsupported major.minor
   version 51.0
       at java.lang.ClassLoader.defineClass1(Native Method)
       at
   java.lang.ClassLoader.defineClassCond(ClassLoader.java:637)
       at java.lang.ClassLoader.defineClass(ClassLoader.java:621)
       at
   java.security.SecureClassLoader.defineClass(SecureClassLoader.ja
   va:141)
       at
   java.net.URLClassLoader.defineClass(URLClassLoader.java:283)
       at
   java.net.URLClassLoader.access$000(URLClassLoader.java:58)
       at java.net.URLClassLoader$1.run(URLClassLoader.java:197)
       at java.security.AccessController.doPrivileged(Native
   Method)
       at
   java.net.URLClassLoader.findClass(URLClassLoader.java:190)
       at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
       at java.lang.ClassLoader.loadClass(ClassLoader.java:247)
       at
   com.ibm.bpm.config.util.db.JdbcHelper.getDriver(JdbcHelper.java:
   1060)
       at
   com.ibm.bpm.config.util.db.JdbcHelper.getConnection(JdbcHelper.j
   ava:756)
       at
   com.ibm.bpm.config.util.db.JdbcHelper.getConnection(JdbcHelper.j
   ava:706)
       at
   com.ibm.bpm.config.soe.impl.Db.checkConnection(Db.java:107)
       at
   com.ibm.bpm.config.model.Validator.validateDBConnections(Validat
   or.java:1560)
       at
   com.ibm.bpm.config.model.Validator.validateDBConnections(Validat
   or.java:1510)
       at
   com.ibm.bpm.config.model.ConfigModelFactory.validateConfigModel(
   ConfigModelFactory.java:140)
       at
   com.ibm.bpm.config.model.ConfigModelFactory.loadFromPropertiesDe
   legate(ConfigModelFactory.java:117)
       at
   com.ibm.bpm.config.model.ConfigModelFactory.loadFromConfigFile(C
   onfigModelFactory.java:95)
       at
   com.ibm.bpm.config.BPMConfig.configureDeploymentEnvironment(BPMC
   onfig.java:610)
       at
   com.ibm.bpm.config.BPMConfig$Actions.createDe(BPMConfig.java:424
   0)
       at
   com.ibm.bpm.config.cli.CreateAction.runInner(CreateAction.java:1
   38)
       at
   com.ibm.bpm.config.cli.AbstractConfigAction.run(AbstractConfigAc
   tion.java:128)
       at
   com.ibm.bpm.config.cli.CreateAction.run(CreateAction.java:34)
       at com.ibm.bpm.config.BPMConfig.main(BPMConfig.java:282)
   
   
    
   
   

LOCAL FIX
 *  * Possible work around :
   - Create new Dmgr  ( java7)
   ./managesdk.sh -setNewProfileDefault -sdkName 1.7_64
   ./managesdk.sh -setCommandDefault -sdkname 1.7_64
   
   - use manaprofiles command to create new DMgrNew
   
   - set the new DMgr as default profile
   ./manageprofiles.sh -setDefaultName -profileName DmgrPS
   
   INSTCONFSUCCESS: Success: The default profile has been set.
   
   
   - use the new Dmgr in the DE.properties file to create new DE
   environment  , resulting DE environment will be  SDK 1.7
   
   
    
   
   

PROBLEM SUMMARY
 *  The UnsupportedClassVersionError occurs because in this setup
   the BPMConfig command runs with SDK version 6 from the default
   profile but tries to load the Oracle JDBC driver ojdbc7.jar
   based on the managesdk command default SDK, which is version 7.
   However, ojdbc7.jar is compiled with Java 7 and, therefore,
   cannot run in a SDK version 6 runtime environment.
   
   
    
   
   

PROBLEM CONCLUSION
 *  A fix is available for IBM BPM V8.5.6.0 that allows the
   ?BPMConfig -create? command to load the Oracle JDBC driver
   according to the version of the SDK it is running with; database
    connections from BPMConfig (or the Deployment Environment
   wizard in the administrative console) always use the SDK version
    of the running JVM.
   
   JDBC providers are always created with the class path for the
   SDK version of the profile where the deployment environment is
   configured. Profiles are created with the SDK that is configured
   as the new profile default SDK in WebSphere.
   
   Note: IBM BPM does not support mixing SDK versions within the
   deployment environment. The  nodes (profiles) of the deployment
   environment must all have the same SDK version.
   
   On Fix Central (http://www.ibm.com/support/fixcentral), search
   for JR54039:
   
   1.Select IBM Business Process Manager with your edition from the
   product selector, the installed version to the fix pack level,
   and your platform, and then click Continue.
   2.Select APAR or SPR, enter JR54039, and click Continue.
   When you download fix packages, ensure that you also download
   the readme file for each fix. Review each readme file for
   additional installation instructions and information about the
   fix.
   
   
    
   
   

TEMPORARY FIX
 *  Before you run the BPMConfig -create command, run the managesdk
   command to set the command default SDK to version 6, matching
   the default profile's SDK version, for example
   managesdk -setCommandDefault -sdkName 1.6_64.
   
   
    
   
   

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   JR54039
   
   
 * REPORTED COMPONENT NAME
   BPM ADVANCED
   
   
 * REPORTED COMPONENT ID
   5725C9400
   
   
 * REPORTED RELEASE
   856
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2015-08-07
   
   
 * CLOSED DATE
   2015-11-02
   
   
 * LAST MODIFIED DATE
   2015-11-02
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   BPM ADVANCED
   
   
 * FIXED COMPONENT ID
   5725C9400
   
   

APPLICABLE COMPONENT LEVELS
 * R856 PSY
   UP