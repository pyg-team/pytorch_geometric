Title: IBM IV59643: DB CONNECTION ISSUES WHEN SETTING UP DSA BACKUP SERVER ON NON DEFAULT PORT FOR DSA CONNECTION - United States

Text:
 SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  When setting up the backup server for a Distributed Server
   Architecture
   (DSA) setup, I am unable to establish the connection to the
   master DB.
   I can browse and find the database, but it give a c
   
   When researching with our DBA team, they're required to use
   port 15001
   for the server port rather than the default MS-SQL port (1433).
   
   Dev, is this something we can support? If so, do we have any
   directions on how
   to do it please?
   
   I tried simply setting up a System DSN through the ODBC
   interface
   within Control Panel.  When I kept all the defaults, it gave a
   similar
   error; however, when I altered the port from the default to
   explicitly
   use 15001, the ODBC driver connected successfully.
   
   We need to some way to set the port that the Endpoint Manager
   installation uses to connect to the master DB.  I've included
   screenshots of the error.
   
   I tried the scenario, since it is not possible to choose the
   SQL Server port at
   installation time, I installed the DSA environment with default
   MSSQL ports
   (1433). Then I changed them all to 15001, added the
   ReplicationPort attribute
   and reproduced the customer issue with 9.1.1082 (Grinnell Patch
   1).
   
   With FillDB logs enabled I was able to see this error message
   (it appears on
   both primary and secondary):
   http://platdev.sfolab.ibm.com/gist/LcIPjHQSK [http://platdev.sfolab.ibm.com/gist/LcIPjHQSK]
   
   From what I saw, the database connection string is not built as
   it should:
   http://technet.microsoft.com/en-us/library/ms130822.aspx [http://technet.microsoft.com/en-us/library/ms130822.aspx]
   
   Indeed, giving a value to "ReplicationPort", means adding a
   "Port=<value>" to
   the connection string. From the link to the MS docs, "Port" is
   not a valid
   attribute for SQL Server, and a custom port must be specified
   using this kind
   of notation:
   <server_address_or_dsn>,<port>
   for the "Server" attribute of the connection string.
   
   If we could get the customer's filldb logfile (with
   "critical;database;debug;performance" as EnabledLogs) we can
   confirm this and open an APAR to fix this issue.
   
   
    
   
   

LOCAL FIX
 *  In any case, I have a workaround that seems to work (in my own
   environment at least), it requires to modify a couple of rows
   in the database, so I do not know if we can provide it to the
   customer. In case you want to give it a try, follow these steps:
   
   1. stop all IEM services on both servers
   2. remove the "ReplicationPort" entries on both servers
   3. modify the DSN column values of REPLICATION_SERVERS on both
   servers, they should look like this:
   http://platdev.sfolab.ibm.com/share/jqdmO/Capture.JPG [http://platdev.sfolab.ibm.com/share/jqdmO/Capture.JPG]
   
   as you may see I just appended ",15001" to the name that FillDB
   use to build the "Server" attribute of the connection string,
   in this we are complying to what is written in the Microsoft
   doc link above
   4. restart IEM services on both servers.
   
   In my environment works smoothly, but as I mentioned before, I
   do not know if it would be wise to let the customer modify
   manually our database.
   
   
    
   
   

PROBLEM SUMMARY
 *  DB CONNECTION ISSUES WHEN SETTING UP DSA BACKUP SERVER ON NON
     DEFAULT PORT FOR DSA CONNECTION
   
   
    
   
   

PROBLEM CONCLUSION
 *  Fixed in IBM Endpoint Manager 9.1 (fixpack 3).
   
   General availability Q3 2014 (release schedule subject to
   change).
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IV59643
   
   
 * REPORTED COMPONENT NAME
   TIV EP MGR SERV
   
   
 * REPORTED COMPONENT ID
   5725C43SV
   
   
 * REPORTED RELEASE
   90W
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2014-04-23
   
   
 * CLOSED DATE
   2014-06-04
   
   
 * LAST MODIFIED DATE
   2014-06-04
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   TIV EP MGR SERV
   
   
 * FIXED COMPONENT ID
   5725C43SV
   
   

APPLICABLE COMPONENT LEVELS
 * R91W PSY
   UP