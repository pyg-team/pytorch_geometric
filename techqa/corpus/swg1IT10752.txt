Title: IBM IT10752: A NON-ATOMIC INSERT STATEMENT SUCCESSFULLY COMPLETED FOR SOME OF THE REQUESTED ROWS - United States

Text:
 SUBSCRIBE TO THIS APAR
By subscribing, you receive periodic emails alerting you to the status of the APAR, along with a link to the fix after it becomes available. You can track this item individually or track all items by product.

Notify me when this APAR changes.

Notify me when an APAR for this component changes.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  SCC crashed after - A NON-ATOMIC INSERT STATEMENT SUCCESSFULLY
   COMPLETED FOR SOME OF THE REQUESTED ROWS .
   
   SQLExceptionShutdownHandler - ** About to broadcast CJDB026E,
   which will cause engine to shut down ...
   
   os.name: Linux
   os.arch: s390x
   Database Type = DB2zOS
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  Description of issue:  The following error occurred when Control
    Center was trying to insert a record into the EVENTS table
   (DB2zOS database), as part of a batch insert (100 INSERT
   requests):  Nested SQL exception[100]: Message: A NON-ATOMIC
   INSERT STATEMENT SUCCESSFULLY COMPLETED FOR SOME OF THE
   REQUESTED ROWS, POSSIBLY WITH WARNINGS, AND ONE OR MORE ERRORS
   SQLSTATE: 22529 Error code: -253
   05 Mar 2015 13:08:56,896 284279010 [WRZN031F(1)] WARN
   RecoverableDAO - Exception while setting the Auto commit level
   back to original setting.
   Message:[jcc][t4][10335][10366][3.63.75] Invalid operation:
   Connection is closed. ERRORCODE=-4470, SQLSTATE=08003
   05 Mar 2015 13:09:02,720 284284834 [WRZN031F(1)] INFO  SCCEngine
   - com.ibm.db2.jcc.am.BatchUpdateException:
   [jcc][t4][102][10040][3.63.75] Batch failure.  The batch was
   submitted, but at least one exception occurred on an individual
   member of the batch.
   Use getNextException() to retrieve the exceptions for specific
   batched elements. ERRORCODE=-4229, SQLSTATE=null
   
   
    
   
   

PROBLEM CONCLUSION
 *  Description of fix:  Added a new property in engine.properties
   to allow the failed batch request to be re-tried as individual
   SQL INSERT requests.  By re-trying each INSERT individually, the
    true SQL error will be exposed for each error.  So this fix may
    resolve the retry failure in and of itself, by retrying as
   individual request, but more importantly, this will allow the
   ability to find root cause for each specific SQL error occurring
    in the original batch INSERT.
   
   RETRY_NON_DUP_EXCEPTION_IN_BATCH
        Specifices how to retry a database batch update request for
   non-duplicate errors
            true = retry a batch update request in batch mode
   (default value)
            false = retry a batch update request as individual SQL
   requests
                         false can be used to expose the actual
   error of each failing request during retry
   
   
    
   
   

TEMPORARY FIX
 *  Description of issue:  The following error occurred when Control
    Center was trying to insert a record into the EVENTS table
   (DB2zOS database), as part of a batch insert (100 INSERT
   requests):  Nested SQL exception[100]: Message: A NON-ATOMIC
   INSERT STATEMENT SUCCESSFULLY COMPLETED FOR SOME OF THE
   REQUESTED ROWS, POSSIBLY WITH WARNINGS, AND ONE OR MORE ERRORS
   SQLSTATE: 22529 Error code: -253
   05 Mar 2015 13:08:56,896 284279010 [WRZN031F(1)] WARN
   RecoverableDAO - Exception while setting the Auto commit level
   back to original setting.
   Message:[jcc][t4][10335][10366][3.63.75] Invalid operation:
   Connection is closed. ERRORCODE=-4470, SQLSTATE=08003
   05 Mar 2015 13:09:02,720 284284834 [WRZN031F(1)] INFO  SCCEngine
   - com.ibm.db2.jcc.am.BatchUpdateException:
   [jcc][t4][102][10040][3.63.75] Batch failure.  The batch was
   submitted, but at least one exception occurred on an individual
   member of the batch.
   Use getNextException() to retrieve the exceptions for specific
   batched elements. ERRORCODE=-4229, SQLSTATE=null
   
   Description of fix:  Added a new property in engine.properties
   to allow the failed batch request to be re-tried as individual
   SQL INSERT requests.  By re-trying each INSERT individually, the
   true SQL error will be exposed for each error.  So this fix may
   resolve the retry failure in and of itself, by retrying as
   individual request, but more importantly, this will allow the
   ability to find root cause for each specific SQL error occurring
   in the original batch INSERT.
   
   RETRY_NON_DUP_EXCEPTION_IN_BATCH
       Specifices how to retry a database batch update request for
   non-duplicate errors
              true = retry a batch update request in batch mode
   (default value)
             false = retry a batch update request as individual SQL
   requests
                          false can be used to expose the actual
   error of each failing request during retry
   
   
    
   
   

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IT10752
   
   
 * REPORTED COMPONENT NAME
   STR CONTROL CEN
   
   
 * REPORTED COMPONENT ID
   5725D0200
   
   
 * REPORTED RELEASE
   542
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2015-08-18
   
   
 * CLOSED DATE
   2015-12-16
   
   
 * LAST MODIFIED DATE
   2015-12-16
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   STR CONTROL CEN
   
   
 * FIXED COMPONENT ID
   5725D0200
   
   

APPLICABLE COMPONENT LEVELS
 * R542 PSY
   UP
   
   
 * R600 PSY
   UP