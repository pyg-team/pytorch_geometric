Title: IBM SQL Server databases cannot be set to Single User nor have any server roles - United States

Text:
single; CQ; Cannot open; database required; DBOwner; sql_server; 1266536 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 This technote explains how to resolve the errors that can occur when using IBM速 Rational速 ClearQuest速 with Microsoft速 SQL Server databases that are not set for DBOwner. 

CAUSE
While attempting to access or upgrade a user database, you might encounter an error such as: 

SQLDriverConnect: RETCODE=-1, State=37000, Native 
Error=4060 [Microsoft][ODBC SQL Server Driver][SQL Server]Cannot open
database required.

or 


Your database is in an inconsistent state


RESOLVING THE PROBLEM
These errors can occur if the SQL Server database is set to "Single User" or if Server Roles have been set. To resolve these errors: 

 1. If "Single User" access is set for the database, set it back to DBOwner. 
 2. Open the SQL server login properties for the login user. Select Server Roles and verify that all Server roles are not selected. 


Note: If this error occurred during a database upgrade, and the upgrade failed, you will have to unlock your user database. See technote 1133810 [http://www-1.ibm.com/support/docview.wss?rs-988&uid=swg21133810] for details on "How to unlock a ClearQuest database that has been locked".