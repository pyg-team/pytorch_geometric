Title: IBM Multiple Web Service Proxy services using the same Front Side Handler - United States

Text:
wsp; ws-proxy; ws proxy; web service proxy; wsdl; slow; long; datapower; 9235; 9004; 9003 TECHNOTE (FAQ)

THIS DOCUMENT APPLIES ONLY TO THE FOLLOWING LANGUAGE VERSION(S):
 English 

QUESTION
 How does the DataPower device react or work when one or more front side handlers are shared by multiple Web Service Proxy objects? 

CAUSE
When you change a shared front side handler or Web Service Proxy, you notice a significant jump in memory, load, or cpu use by the device.

ANSWER
When multiple Web Service Proxy services share the same front side handlers, they become linked. When a Web Service Proxy or front side handler within a linked configuration is reloaded, this will trigger a recompilation of all WSDLs used by the linked configuration. 

Any time that you click Apply within the WebGUI, or make a change via the CLI, on either the Web Service Proxy or the front side handler used by the Web Service Proxy services, the appliance can trigger a recompile of all referenced WSDL's.

Notes: 


 * When a front side handler is shared by multiple Web Service Proxy services, all services are then linked. 
 * When a front side handler changes operational state up or down, all Web Service Proxy services sharing that handler will trigger a recompile of all WSDLs used by those services. 
 * The WSDLs may not show up immediately in the style sheet cache on that initial compile. Rather, they will show up or change on the first client request.
   
 * If you have a log target subscribed to the proper events you will be able to see the following:
   
   [mgmt][info] source-http(http9100): tid(95): admin-state disabled.

[mpgw][info] source-http(http9100): tid(95): Protocol Handler Disabled on 0.0.0.0:9100 
[mgmt][warn] source-http(http9100): tid(95): Service removed from port 
[mgmt][notice] source-http(http9100): tid(95): Operational state down 
[mgmt][notice] wsgw( gamma): tid(1776330191): Operational state down 
[mgmt][notice] wsgw( beta): tid(1776207231): Operational state down 
[mgmt][notice] wsgw( Alpha): tid(1775598111): Operational state down 
[ws-proxy][debug] xmlmgr(default): tid(1776330191): wsdl Compilation Request: Checking cache for URL 'local:///SimpleSOAP3.wsdl'. 
[ws-proxy][debug] xmlmgr(default): tid(1776207231): wsdl Compilation Request: Checking cache for URL 'local:///SimpleSOAP2.wsdl'. 
[ws-proxy][debug] xmlmgr(default): tid(1775598111): wsdl Compilation Request: Checking cache for URL 'local:///SimpleSOAP1.wsdl'. 
[ws-proxy][debug] xmlmgr(default): tid(1776330191): wsdl Compilation Request: Forcing compilation of URL 'local:///SimpleSOAP3.wsdl'. 
[ws-proxy][debug] xmlmgr(default): tid(1776207231): wsdl Compilation Request: Forcing compilation of URL 'local:///SimpleSOAP2.wsdl'. 
[ws-proxy][debug] xmlmgr(default): tid(1775598111): wsdl Compilation Request: Forcing compilation of URL 'local:///SimpleSOAP1.wsdl'. 
[mgmt][notice] wsgw(beta): tid(1776207231): Operational state up 
[mgmt][notice] wsgw(gamma): tid(1776330191): Operational state up 
[mgmt][notice] wsgw(Alpha): tid(1775598111): Operational state up 



Best practices to consider in this configuration: 
 * Because a front side handler can be shared by multiple services (Web Service Proxy, MPGW, etc), there is a chance that some services may not be completely up by the time the front side handler port is listening. This can be due to slow or large WSDLs fetched over a network, complex service configurations, etc. Many services such as MPGW can come up immediately and may never see this timing behavior, contrasted to a Web Service Proxy that has to fetch a remote multi-megabyte WSDL from a remote web server. 
   
 * This front side handler behavior is why many clients will use more complete health checks, such as HTTP HEAD requests to query the WSDL, rather than just checking to see if the TCP port is up. Rather than simply querying the port with a simple TCP layer port check, a content specific request/response can be used. An HTTP Head /path/to?wsdl request to query the wsdl would confirm the WSProxy is up.
   
 * Using a gateway service or reducing the number of WSProxy services sharing the same front side handler will also help reduce complexity and the tremendous memory footprint required when making changes to this type of configuration.



Cross reference information Segment Product Component Platform Version Edition Business Integration WebSphere DataPower Integration Appliance XI50 Not Applicable Firmware 3.8.1, 3.8, 3.7.3 All Editions