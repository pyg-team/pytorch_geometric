Title: IBM Notes Internet domain added unexpectedly when replying to e-mail - United States

Text:
Reply; Reply To All; respond; responding; e-mail; email; Domino domain; domain name; SendTo field; Send To; InheritedFrom; InheritedAltFrom; field; FromDomain; route; routing; Domino Directory Assistance; NoOptimizeLocalRouting=1; notes.ini file; notes.ini; ini; .ini; APAR LO21828; Vantive #1342257 TECHNOTE (FAQ)

QUESTION
When replying to an e-mail in Notes, you notice that the Notes Internet domain is added unexpectedly to the Send To address. 

For example, when replying to an e-mail message from johndoe@us.widgets.com, the SendTo is addressed to johndoe@us.widgets.com@uswidgets.

This occurs in cases where multiple Notes domains are in use and inbound mail comes in via SMTP, with NRPC being used to route to the domains.

Example:
You use multiple Notes domains with incoming and outgoing SMTP servers in different domains:


 * 
 * 
 * 


1. You send an Internet e-mail to a user in domain B from test@test.com: 
 * 
 * 
 * 
 * 

2. You open the received message and click Reply or Reply To All: 
 * 
 * 
 * 
 * 

The address in the Send To field still contains the Notes domain. This should be stripped off since it is an e-mail address. The address in the cc: field is processed correctly. 

If inbound and outbound SMTP traffic is separate and the servers are in two different domains, this is very problematic. 
ANSWER
Notes/Domino is working as designed. It can be critical that the domain information be appended since without it, sometimes mail may not route as expected. 

Enhancement requests to enhance the logic in this area have been made to Quality Engineering as SPR# NGRT4M7H67 and SPR# MCHT4LYK85.

If you want multiple domain information to remain in e-mail:
Add the following variable to the notes.ini file in the Notes client, "NoOptimizeLocalRouting=1", and restart Notes. 

Unsupported workaround
The following workaround will prevent the Notes Internet domain from being added to Internet addresses but may result in delivery failures under some scenarios. 

NOTE: The code below is a sample script, provided to illustrate one way to approach this issue and is used at your own risk. In order for this example to perform as intended, the script must be laid out exactly as indicated below. Product Support cannot customize this script for specific environments or applications. 
Modify the formulas in the InheritedFrom and InheritedAltFrom fields in the Reply and Reply With History forms as follows: 

Who := @If 

 * (@IsAvailable(Principal) & Principal != "";  * 
   
   @IsAvailable(From);  * 
   
   @Author  * 
   
   

@If  * (@IsAvailable(FromDomain) & (@Middle(who; "@";".")="");  * 
    * Who 
    * 
   
   

RELATED INFORMATION
#A simplified Chinese translation is available [http://www.ibm.com/support/docview.wss?uid=swg21602218]