Title: IBM How do I move Verity index collections from one location to another? - United States

Text:
moving verity collections; moving k2 collections; move collections TECHNOTE (TROUBLESHOOTING)

THIS DOCUMENT APPLIES ONLY TO THE FOLLOWING LANGUAGE VERSION(S):
 English 

PROBLEM(ABSTRACT)
 The storage device on the FileNet Content Search Engine where the current index collections are located, is running out of space. How can the index collections be moved to a new storage device?


SYMPTOM
Storage device where current index collections are located is running out of disk space.


DIAGNOSING THE PROBLEM
There are 2 scenarios in which this should be done: 

 * The storage device where the Verity index collections are located is about to run out of space and no additional space can be added. 
 * The Verity index collections are located on a remote storage device (remote to the Content Search Engine server) which is not a supported configuration.

RESOLVING THE PROBLEM
 

 1.  Disable the CBR Dispatcher in FEM. 
 2.  Open FileNet Enterprise Manager. 
 3.  Go to the P8 Domain properties. 
 4.  Select the tab ‘Verity Server’. 
 5.  Uncheck the box ‘Enable Dispatcher’. Apply the changes and exit the P8 Domain properties. 
 6.  Shut down K2 by stopping the 2 Verity K2 services. 
 7.  Locate k2\common\verity.cfg, and make a backup 
 8.  Open up verity.cfg in a text editor, and locate the next unmapped directory alias to declare the new storage location. Save the file and restart the K2 services. 
 9.  Change the Verity Temp location then create a directory that will be shared and used by Verity and P8. Take note of the path as it will be needed later for the P8 Index Area update. In the event of an error message similar to "The VerityIndeaArea RootDirectoryPath property cannot be changed when a VerityCollection exists in that indexArea" you have to use direct SQL to update this; 
     eg: UPDATE indexarea SET root_directory_path ='\\server_name_or_ip\shareName' 
 10. In K2 Dashboard, de-register the collections. Click on the "Collections" icon in Dashboard. Click "Remove a Collection" 
 11. Select the appropriate collection from the list and click "Continue >" 
 12. Do not check the "Enable removal of all files" box". Click "Remove" 
 13. Exit out of K2 Dashboard and stop both K2 services 
 14. Copy the collections over to the new directory. There must not be any processes running against the collections when you do this. Note that a storage location has to be recognized by the Content Search Engine server as a locally mounted storage device. 
 15. Use your database tool and manually update the RootDirectoryPath column in the table "IndexArea" using the same value as used above in step 9. This is necessary so when new search servers are added to that index area the CE server will be able to attach those servers to the collections. 
 16. Start both K2 services. Login to K2 Dashboard. Re-register the collections 
 17. Click on the "Collections" icon in Dashboard. Click on "Add a Collection". Enter the collection name The collection name is the folder name for the collection which goes into the ‘Index Alias’ field 
 18. Check the "Override Default Path" check-box. Provide the complete path to the collection, including the collections directory itself. Click "Next > Change the “Style Set” value to your relevant style set. FileNet_FileSystem_PushAPI or ICC_FileSystem_PushAPI or whatever name you may have for the directory holding your style set. 
 19. Verify the collection settings and click "Next > Select a k2server to attach to, and click "Next >Click "Finish". Repeat for additional collections. Do a "quick restart" on the attached k2server 
 20. Re-enable the CBR Dispatcher in FileNet Enterprise Manager