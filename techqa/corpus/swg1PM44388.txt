Title: IBM PM44388: ORACLE UNIVERSAL CONNECTION POOL (UCP) SUPPORT IN WEBSPHERE APPLICATION SERVER VERSION 7 - United States

Text:
  FIXES ARE AVAILABLE
7.0.0.23: WebSphere Application Server V7.0 Fix Pack 23 [http://www-01.ibm.com/support/docview.wss?uid=swg24032493]
7.0.0.25: WebSphere Application Server V7.0 Fix Pack 25 [http://www-01.ibm.com/support/docview.wss?uid=swg24033267]
7.0.0.27: WebSphere Application Server V7.0 Fix Pack 27 [http://www-01.ibm.com/support/docview.wss?uid=swg24033882]
7.0.0.29: WebSphere Application Server V7.0 Fix Pack 29 [http://www-01.ibm.com/support/docview.wss?uid=swg24034966]
7.0.0.31: WebSphere Application Server V7.0 Fix Pack 31 [http://www-01.ibm.com/support/docview.wss?uid=swg24036768]
7.0.0.27: Java SDK 1.6 SR13 FP2 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24035324]
7.0.0.33: WebSphere Application Server V7.0 Fix Pack 33 [http://www-01.ibm.com/support/docview.wss?uid=swg24037573]
7.0.0.35: WebSphere Application Server V7.0 Fix Pack 35 [http://www-01.ibm.com/support/docview.wss?uid=swg24038310]
7.0.0.37: WebSphere Application Server V7.0 Fix Pack 37 [http://www-01.ibm.com/support/docview.wss?uid=swg24039338]
7.0.0.39: WebSphere Application Server V7.0 Fix Pack 39 [http://www-01.ibm.com/support/docview.wss?uid=swg24041013]
7.0.0.41: WebSphere Application Server V7.0 Fix Pack 41 [http://www-01.ibm.com/support/docview.wss?uid=swg24041931]
7.0.0.43: WebSphere Application Server V7.0 Fix Pack 43 [http://www-01.ibm.com/support/docview.wss?uid=swg24043400]
7.0.0.45: WebSphere Application Server V7.0 Fix Pack 45 [http://www-01.ibm.com/support/docview.wss?uid=swg24044551]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS NEW FUNCTION.
    
   
   

ERROR DESCRIPTION
 *  Client would like to use Oracle Universal Connection Pool built
   in Oracle JDBC driver for data source created within WebSphere
   Application Server version 7
   
   
    
   
   

LOCAL FIX
 *  n/a
   
   
    
   
   

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED:  All users of IBM WebSphere Application      *
   *                  Server V7.0                                 *
   ****************************************************************
   * PROBLEM DESCRIPTION: Enable Oracle Universal Connection      *
   *                      Pool (UCP) Support in WebSphere         *
   *                      Application Server V7.0                 *
   ****************************************************************
   * RECOMMENDATION:                                              *
   ****************************************************************
   This apar enables support for using Oracle Connection Pool
   (UCP) in WebSphere Application Server V7.0.
   Below are the steps to configure Oracle UCP using the
   administrative console in WebSphere Application Server Version
   7.0:
   1) Create a User-defined JDBC provider.
   Start the administrative console, expand Resources > JDBC.
   Select JDBC providers.
   Select the Scope that you wish to create at,
   Select New....
   For Database type, select User-Defined
   For Implementation type, define either
   oracle.ucp.jdbc.PoolDataSourceImpl or
   oracle.ucp.jdbc.PoolXADataSourceImpl
   Click Next.
   Provide the classpath information:
   ${User-defined_JDBC_DRIVER_PATH}/ojdbc.jar
   ${User-defined_JDBC_DRIVER_PATH}/ucp.jar
   -Be Sure to update the WebSphere Variable
   User-defined_JDBC_DRIVER_PATH with the directory
   location where these JARs are located.
   -Be sure to use a matching pair of jars. For example, if
   using Oracle 11.2.0.1 driver, be sure to use the
   odjbc6.jar and ucp.jar from that version.
   Click Next.
   Verify the Summary information looks correct.
   You should see the ojdbc6.jar and the ucp.jar
   configured on the "Class path".
   You will see "oracle.ucp.jdbc.PoolDataSourceImpl" or
   "oracle.ucp.jdbc.PoolXADataSourceImpl"  for the
   Implementation class name
   Click Finish, then select Save.
   2) Create a data source :
   The JDBC providers list will be shown. To create a data source:
   Select the provider you just created.
   Select Data sources.
   Select New...
   Fill in the JNDI name.
   Click Next.
   Set the Data store helper class name to Oracle11g data
   store helper.
   ie com.ibm.websphere.rsadapter.Oracle10gDataStoreHelper
   Click Next.
   Set the "security aliases" as appropriate for this
   data source.
   Click Next.
   Review Summary and click Finish.
   Click Save.
   3) Configure the data source that you just created.
   a) Navigate to JDBC providers > (JDBC Provider Name) > Data
   sources > (datasource name)  > Connection pools
   Set the Maximum connections to 0.
   b) Navigate to JDBC providers > (JDBC Provider Name) > Data
   sources > (datasource name) > WebSphere Application
   Server data source properties
   Set Statement cache size to 0.
   4) Create the following custom properties for the data source
   that you just created.
   Navigate to JDBC providers > (JDBC Provider Name) > Data
   sources > (datasource name) > Custom properties
   disableWASConnectionPooling = true
   URL = jdbc:oracle:thin:@//localhost:1521/orcl
   connectionFactoryClassName = oracle.jdbc.pool.OracleDataSource
   You may want to add additional custom properties to configure
   UCP. For example, to set the maximum pool size for UCP:
   Select "Custom properties" on the data source.
   Select "New..."
   Type in the name, value and type for the property
   Name: maxPoolSize
   Value: 5
   Type: java.lang.String Select "OK", then select "Save"
   UCP properties can be set in the application. For example:
   if (ds.isWrapperFor(oracle.ucp.jdbc.PoolDataSource.class)) {
   PoolDataSource pds =
   ds.unwrap(oracle.ucp.jdbc.PoolDataSource.class);
   pds.setMaxPoolSize(5); }
   else if
   (ds.isWrapperFor(oracle.ucp.jdbc.PoolXADataSource.class)) {
   PoolXADataSource pdsxa =
   ds.unwrap(oracle.ucp.jdbc.PoolXADataSource.class);
   pdsxa.setMaxPoolSize(5); }
   5) Select the data source you just created and press "Test
   connection" if you want to check if the data source can
   connect to the database.
   
   
    
   
   

PROBLEM CONCLUSION
 *  Code has been update to enable the Oracle Universal Connection
   Pool support in WebSphere Application Server V7.0.
   
   The fix for this APAR is currently targeted for inclusion in
   fix pack 7.0.0.23.  Please refer to the Recommended Updates
   page for delivery information:
   http://www.ibm.com/support/docview.wss?rs=180&uid=swg27004980 [http://www.ibm.com/support/docview.wss?rs=180&uid=swg27004980]
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PM44388
   
   
 * REPORTED COMPONENT NAME
   WEBS APP SERV N
   
   
 * REPORTED COMPONENT ID
   5724H8800
   
   
 * REPORTED RELEASE
   700
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2011-07-25
   
   
 * CLOSED DATE
   2011-10-31
   
   
 * LAST MODIFIED DATE
   2011-10-31
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WEBS APP SERV N
   
   
 * FIXED COMPONENT ID
   5724H8800
   
   

APPLICABLE COMPONENT LEVELS
 * R700 PSY
   UP