Title: IBM Collecting DB2 Troubleshooting information - United States

Text:
db2; dbm; instance; configuration; get db cfg for; get dbm cfg; bwm8 TECHNOTE (FAQ)

QUESTION
 This technote shows how to collect DB2 information for troubleshooting purposes in Directory Server environments. 

ANSWER
On UNIX/Linux:
1. Find and provide the list of db2 installations/details and the db2 installations used by Directory Server:


 * /usr/local/bin/db2ls
 * 
 * 
 * 
 * 
 * /usr/local/bin/db2ls -b <db2_Install_Path> -q -p
 * 
 * /usr/local/bin/db2ls -b <db2_Install_Path> -q -a
 * 
 * 
 * find /opt -name ldapdb.properties -ls -exec cat {} \;


2. Find and provide DB2 configuration info as used by ibmslapd.conf of Directory Server instance: 
 * 
 * idsilist -a
 * 
 * 
 * 
 * cd <Location>/idsslapd-<Name>/etc
 * 
 * egrep -i "dbinstance|dbname|dbuserid|dblocation|dbalias|dbconnections" ibmslapd.conf
 * 
 * cat ldapdb.properties


3. Gather and provide DB Manager (Instance) and Database configuration details: 
 * su - <db2_instance>
 * 
 * db2 list db directory
 * 
 * db2 get dbm cfg > dbm.cfg.txt
 * 
 * db2 get db cfg for <ldap_db> > db.cfg.txt
 * 
 * 
 * 


4. Provide db2support output: 
 * 
 * 
 * db2support . -s -d <ldap_db> -c
 * 
 * 
 * 


5. Gather db2look output to understand table/index definitions: 
 * db2look -d <ldap_db> -e -a -o db2look.out
 * 
 * 
 * 


6. Gather statistics information: 
 * db2 connect to <ldap_db>
 * 
 * db2 "select tabschema,tabname,card from sysstat.tables order by card" > cardinalities.out
 * 
 * db2 "select tabschema,tabname,stats_time from syscat.tables order by stats_time" > rnst_times.out
 * 
 * db2 connect reset
 * 
 * 
 * 
 * 


On Windows: 

1. Find and provide the list of db2 installations/details and the db2 installations used by Directory Server:  * 
 * 
 * reg query HKEY_LOCAL_MACHINE\SOFTWARE\IBM\DB2 /s > db2_install_info.txt
 * 
 * 
 * 
 * 
 * reg query HKEY_LOCAL_MACHINE\SOFTWARE\IBM\IDSLDAP /s | findstr /i LDAPHome
 * 
 * 
 * 
 * 
 * type <LDAPHome>\etc\ldapdb.properties


2. Find and provide DB2 configuration info as used by ibmslapd.conf of Directory Server instance: 
 * 
 * idsilist -a
 * 
 * 
 * 
 * cd <Location>\idsslapd-<Name>\etc\
 * 
 * findstr /i "dbinstance" ibmslapd.conf
 * 
 * findstr /i "dbname" ibmslapd.conf
 * 
 * findstr /i "dbuserid" ibmslapd.conf
 * 
 * findstr /i "dblocation" ibmslapd.conf
 * 
 * findstr /i "dbconnections" ibmslapd.conf
 * 
 * type ldapdb.properties


3. Make sure you're attached to the right DB2 instance: 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * db2ilist
 * 
 * 
 * 
 * 
 * echo %DB2INSTANCE%
 * 
 * 
 * 
 * 
 * set DB2INSTANCE=<DB2_instance>
 * 
 * 
 * 
 * 
 * db2 list db directory
 * 
 * 
 * 


4. Gather and provide DB Manager (Instance) and Database configuration details: 
 * db2 get dbm cfg > dbm.cfg.txt
 * 
 * db2 get db cfg for <ldap_db> > db.cfg.txt
 * 
 * 
 * 


5. Provide db2support output: 
 * 
 * 
 * db2support . -s -d <ldap_db> -c
 * 
 * 
 * 


6. Gather db2look output to understand table/index definitions: 
 * db2look -d <ldap_db> -e -a -o db2look.out
 * 
 * 
 * 


7. Gather statistics information: 
 * db2 connect to <ldap_db>
 * 
 * db2 "select tabschema,tabname,card from sysstat.tables order by card" > cardinalities.out
 * 
 * db2 "select tabschema,tabname,stats_time from syscat.tables order by stats_time" > rnst_times.out
 * 
 * db2 connect reset
 * 
 * 
 * 



PRODUCT ALIAS/SYNONYM
 itds
tds
ids
secureway
ldap