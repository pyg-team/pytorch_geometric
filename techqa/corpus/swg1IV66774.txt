Title: IBM IV66774: CPU UTILIZATION METRICS ARE INCORRECT DUE TO MISSING WMI IDLE TIME - United States

Text:
  A FIX IS AVAILABLE
IBM Tivoli Monitoring 6.3.0 Fix Pack 5 (6.3.0-TIV-ITM-FP0005) [http://www-01.ibm.com/support/docview.wss?uid=swg24039236]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  Problem:
   It has been reported that percentages of CPU time used by
   processors on Windows servers do not match the actual CPU
   utilization as reported by operating system tools. This depends
   on the possible lack of the processors' idle time information
   from WMI. With this APAR it will be possible to workaround this
   issue by restoring the same perfmon interface for these kind of
   metrics as used by pre 6.30 KNT agents.
   
   The perfmon style of data will be accessible only through an
   environment variable to be set. Current WMI interface remains
   the default.
   
   Affected Platforms / Versions:
   It looks like only 32 bit WMI DLL on Windows 2003 servers may
   be affected, so this issue is only with the 32 bit agent
   running on 32 or 64 bit servers.
   
   Diagnostics:
    KBB_RAS1: ERROR (UNIT:knt05agt ALL) (UNIT:cpu ALL). Look for:
   
    "getWMIrefreshed_data") Read Raw IdleTime: 0
   
   Example: TBD
   
   Initial Impact:
    High, the wrong CPU metrics may trigger false alerts on
    high cpu consumption.
   
   Additional Keywords:
    PRIVTME
    PROCTIME
    USERTME
    NTPROCSSR
   
   
    
   
   

LOCAL FIX
 *  Run the 64 bit version of the KNT agent on 64 bit servers.
   
   
    
   
   

PROBLEM SUMMARY
 *  Overestimated percentages of CPU utilization from the Monitoring
    Agent for Windows OS.
   
   
   The Monitoring Agent for Windows OS can return incorrect values
   for attributes related to CPU percent utilization at system and
   processor level.  This is due to possible missing information
   about Idle Time of processors from the underlying WMI provider,
   when the agent runs in 32-bit mode on Windows 2003 servers.
   
   
   In order for this APAR to be properly implemented in your
   environment, a new environment variable has been added.  See the
   "Install Actions" section of the APAR conclusion for more
   details.
   
   
    
   
   

PROBLEM CONCLUSION
 *  Introduced new environment variable that allows to switch from
   the WMI interface to the perfmon interface when collecting CPU
   related metrics.  Default behavior is unchanged.
   
   Impacted attributes are NT_System\%_Total_Privileged_Time,
   NT_System\%_Total_Processor_Time,NT_System\%_Total_User_Time,
   NT_Processor\%_Privileged_Time, NT_Processor\%_Processor_Time,
   NT_Processor\%_User_Time,
   NT_Processor_Summary\High_%_Privileged_Time,
   NT_Processor_Summary\High_%_Processor_Time,
   NT_Processor_Summary\High_%_User_Time,
   NT_Processor_Summary\Low_%_Privileged_Time,
   NT_Processor_Summary\Low_%_Processor_Time,
   NT_Processor_Summary\Low_%_User_Time.
   
   Install Actions:
   Set environment variable: NT_SKIP_WMICPU=1
   
   allowed values:
   0=default, continue to collect the data using WMI
   1=collect the data using perfmon
   
   
   The fix for this APAR will be contained in the following
   maintenance packages:
   
   | FixPack    | 6.3.0-TIV-ITM-FP0005
   | InterimFix | 6.3.0.2-TIV-ITM_WIN-IF0003
   
   
    
   
   

TEMPORARY FIX
 *  Run 64-bit native Monitoring Agent for Windows OS on 64-bit
   servers.
   
   
    
   
   

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IV66774
   
   
 * REPORTED COMPONENT NAME
   ITM AGENT WINDO
   
   
 * REPORTED COMPONENT ID
   5724C040W
   
   
 * REPORTED RELEASE
   630
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt / Xsystem
   
   
 * SUBMITTED DATE
   2014-11-12
   
   
 * CLOSED DATE
   2014-11-25
   
   
 * LAST MODIFIED DATE
   2016-04-04
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   ITM AGENT WINDO
   
   
 * FIXED COMPONENT ID
   5724C040W
   
   

APPLICABLE COMPONENT LEVELS
 * R630 PSY
   UP
   
   
 * R610 PSN
   UP
   
   
 * R620 PSN
   UP
   
   
 * R621 PSN
   UP
   
   
 * R622 PSN
   UP
   
   
 * R623 PSN
   UP