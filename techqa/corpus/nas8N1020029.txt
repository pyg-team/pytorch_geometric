Title: IBM OpenSSH version 5.8p1 changes the default umask of the Secure Shell Daemon (SSHD). - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 The 5.8p1 version of OpenSSH changes the default umask of the SSHD. 

RESOLVING THE PROBLEM
 

With the 5.8p1 version of OpenSSH installed, the output of the umask command is different depending
on where you execute it. If the umask command is run directly in PASE, 00 is returned.

The default umask setting for the SSHD daemon server was changed to 022 starting in OpenSSH 5.1. 

Here's a excerpt from the change log that mentions the change of the SSHD's default umask 
starting at OpenSSH 5.1. [http://www.openssh.com/txt/release-5.1]

Search on:
• “Ensure that sshd(8)'s umask disallows at least group and world
write, even if a more permissive one has been inherited. (bz#1433)”

This change was a result of some permission problems related to the sshd.pid file created at the time 
the sshd daemon server is started.

This is working as designed on IBM i machines running openssh versions 5.1 & above.

Depending on what ssh application you are using there is a variety ways make sure the the authorities are the same on the source and target. 

SSH -Remote Shells. 
For SSH remote shells, calls can be resolved by adding

umask 000

to any of these files on the server system (i.e. where sshd runs):

/QOpenSys/etc/profile (for all PASE processes - including all ssh users)

<user's home directory>/.profile (for a specific user)

SFTP 
For a SFTP connection you will need to edit the sshd config file in /QOpenSys/QIBM/UserData/SC1/OpenSSH/"YOU RELEASE OF SSH"/etc/

Find this line in the config:

Subsystem sftp /QOpenSys/QIBM/UserData/SC1/OpenSSH/"YOUR RELEASE OFSSH"/libexec/sftp-server 
Make sure it does not have # in front of it and add the -u 000 to the end of the line. 
Subsystem sftp /QOpenSys/QIBM/UserData/SC1/OpenSSH/openssh-3.8.1p1/libexec/sftp-server -u 000 
SCP
For SCP the only way to resolve this is by using the -p in the command 

-p' The -p option causes scp to attempt to preserve (duplicate) in its copies the modification times and modes of the source files, ignoring the umask. By default, the mode and owner of file2 are preserved if it already existed; otherwise the mode of the source file modified by the umask [http://linux.die.net/man/2/umask](2) on the destination host is used. 


 


Cross reference information Segment Product Component Platform Version Edition Operating System IBM i 7.2 Operating System IBM i 7.1 Operating System IBM i 6.1