Title: IBM Procedure to get AT-TLS to pick up new ICSF configuration - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Changes to ICSF are not automatically picked up by AT-TLS if TCPIP has been started prior to ICSF, or ICSF changes are made while the TCPIP stack is running. 

SYMPTOM
AT-TLS connections fail with message EZD1286I or EZD1287I with return code of 428 if the private key of the certificate is stored in ICSF. 

Message GSK01051E [http://publibz.boulder.ibm.com/cgi-bin/bookmgr/BOOKS/GSKA1A90/13.5.51?SHELF=ez2zo111&DT=20110613110223&CASE=] will be issued if System SSL detects that ICSF is no longer available for hardware encryption. 


ENVIRONMENT
For AT-TLS to use ICSF services, ICSF must complete initialization prior to the AT-TLS TTLSGroup being started. TTLSGroups are started when the Policy Agent installs the AT-TLS policy. Policy agent installs AT-TLS policies when TCPIP is started and Policy Agent is already active, when Policy Agent is started and TCPIP is already active, when a F PAGENT_PROC,REFRESH command is issued or a F PAGENT_PROC,UPDATE command is issued and a change to the TTLSGroupAction statement is detected. 

The Policy Agent must be configured with FLUSH on either the TcpImage [http://publibz.boulder.ibm.com/cgi-bin/bookmgr/BOOKS/F1A1B4B0/22.24?SHELF=ez2zo111&DT=20110609204120] statement or TTLSConfig [http://publibz.boulder.ibm.com/cgi-bin/bookmgr/BOOKS/F1A1B4B0/22.25?SHELF=ez2zo111&DT=20110609204120] statement to force the TTLSGroupActions to be deleted. See FLUSH and PURGE considerations [http://publibz.boulder.ibm.com/cgi-bin/bookmgr/BOOKS/F1A1B3B0/2.7.12?SHELF=ez2zo111&DT=20110608115203] for more details. 


RESOLVING THE PROBLEM
To get AT-TLS to pick up ICSF changes, perform the following actions:

 

 1. Update the GroupUserInstance [http://publibz.boulder.ibm.com/cgi-bin/bookmgr/BOOKS/F1A1B4B0/22.32?SHELF=ez2zo111&DT=20110609204120] n value in the TTLSGroupAction [http://publibz.boulder.ibm.com/cgi-bin/bookmgr/BOOKS/F1A1B4B0/22.32?SHELF=ez2zo111&DT=20110609204120] block of your AT-TLS policy for each group that needs to use the new ICSF configuration. 
    
    
 2. Issue the F PAGENT_PROC,UPDATE console command to get AT-TLS to pick up these new changes from ICSF. Issuing this command is not necessary if you start Policy Agent with the -i parameter, which automatically picks up changes to the configuration. 
    
    
 3. Check your TCPIP joblog for new instances of the following messages (these messages might vary depending on the ICSF configuration):

 * System SSL: SHA-1 crypto assist is available
 * 
 * System SSL: SHA-224 crypto assist is available
 * 
 * System SSL: SHA-256 crypto assist is available
 * 
 * System SSL: SHA-384 crypto assist is available
 * 
 * System SSL: SHA-512 crypto assist is available
 * 
 * System SSL: DES crypto assist is available
 * 
 * System SSL: DES3 crypto assist is available
 * 
 * System SSL: AES 128-bit crypto assist is available
 * 
 * System SSL: AES 256-bit crypto assist is available
 * 
 * System SSL: ICSF FMID is HCRXXXX
 * 
 * System SSL: PCI cryptographic accelerator is not available
 * 
 * System SSL: PCIX cryptographic coprocessor is available
 * 
 * System SSL: Public key hardware support is available


After you see these messages in the TCPIP joblog, AT-TLS is using the new configuration from ICSF. 


Cross reference information Segment Product Component Platform Version Edition Operating System (z/OS- OS/390- MVS) z/OS 568505101 - INTEGRATED CRYPTOGRAPHIC SERVICE FACILITY (ICSF) z/OS