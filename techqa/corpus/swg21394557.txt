Title: IBM WebSphere DataPower SOA appliance configuration option Buffering Mode = Buffer for ITCAM SOA data collection - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 There are scenarios where ITCAM SOA data collection from an IBM WebSphere DataPower SOA appliance benefits from changing the DataPower setting Buffering Mode to value Buffer. 

Set the Buffering Mode option to Buffer for each domain involved in data collection by selecting Objects > Device Management > Web Services Management Agent in the DataPower WebGUI.

The default value of Discard is suited to a single ITCAM SOA subscriber where a low transaction volume is being handled by the appliance and collected by ITCAM SOA. Buffering mode Buffer is a better choice when initially configuring data collection, or when processing high volumes, particularly when using multiple ITCAM SOA subscribers. 

SYMPTOM
If ITCAM SOA data collection is not running, DataPower will discard metrics for transactions if Buffering Mode is set to Discard. For example, a dp:wsm-agent-append() function call may receive result "no record" in a stylesheet enabling metrics for a Multi-Protocol gateway. Result "no record" is returned because there were no subscribers to collect the data written by the stylesheet function. If Buffering Mode = Buffer is used, the metrics will be recorded in anticipation that the next time ITCAM SOA collection is started, the metrics can be collected. 

In high volume scenarios, particularly when multiple ITCAM SOA subscribers are configured, setting Buffering Mode = Buffer simplifies how subscriptions are handled. When a subscriber collects data, all the DataPower records that have been written to the Web Services Management buffer are collected. 
With the default setting of Discard, complications can occur if a new subscriber replaces a former subscriber, or if high volumes cause the Complete Records Count to reach the configured Maximum Record Size limit. Set Buffering Mode = Buffer and collection can proceed.


DIAGNOSING THE PROBLEM
 

 1. Select Status > Web Service > WSM Agent Status in the DataPower WebGUI. The WSM Agent Status shows the number of active subscribers and a count of metrics records that were lost or are complete. 
 2. Make a note of the complete record count; it should have a value less than 3000, the default maximum record setting. This setting is configurable by selecting Objects > Device Management > Web Services Management Agent. 
 3. Select Refresh multiple times on the WSM Agent Status page and monitor the complete record count. When an ITCAM SOA collection completes, the complete record count should reset to a low number, and increase again with each Refresh of this page until the next ITCAM SOA collection completes.

RESOLVING THE PROBLEM
Select Objects > Device Management > Web Services Management Agent and change Buffering Mode to Buffer to resolve either of two issues: 

 *  If active subscribers and complete records have a zero value, the lost record count may increase with each refresh of this page. Records that are candidates for data collection are being discarded because there are no subscribers to collect them. A non-zero complete record count that remains static indicates that records are not being collected. A complete record count of 3000 may indicate there was an issue associated with high volume. An Active Subscribers count greater than one may indicate that managing multiple subscribers may be be a contributor to the problem. You can review page Status > Management > WSM Subscriber Status to see details on the subscribers. 

RELATED INFORMATION
#Configuring data collection: DataPower SOA Appliance [http://publib.boulder.ibm.com/infocenter/tivihelp/v3r1/index.jsp?topic=/com.ibm.itcamsoa.doc/kd4inmst138.htm#configdatapower]
Configuring a DataPower user for ITCAM SOA data collect [http://www.ibm.com/support/docview.wss?uid=swg21394718]


 

Cross reference information Segment Product Component Platform Version Edition Business Integration WebSphere DataPower SOA Appliances General Firmware 3.7.3, 3.7.2, 3.7.1, 3.7.0, 3.6.1 Edition Independent