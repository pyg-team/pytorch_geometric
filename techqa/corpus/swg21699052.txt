Title: IBM Security Bulletin: Vulnerabilities in OpenSSL affect IBM WebSphere MQ (HP-NSS and OVMS platforms) and Eclipse Paho MQTT C Client libraries (Windows and Linux platforms) (CVE-2014-3570, CVE-2014-3572, CVE-2015-0204, CVE-2015-0205) - United States

Text:
 SECURITY BULLETIN

SUMMARY
 OpenSSL vulnerabilities were disclosed on January 8, 2015 by the OpenSSL Project. This includes â€œFREAK: Factoring Attack on RSA-EXPORT keys" TLS/SSL client and server vulnerability. OpenSSL is used by IBM WebSphere MQ on HP-NSS and HP OpenVMS platforms. 

VULNERABILITY DETAILS
CVEID: CVE-2014-3570 [http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3570]
DESCRIPTION: An unspecified error in OpenSSL related to the production of incorrect results on some platforms by Bignum squaring (BN_sqr) has an unknown attack vector and impact.
CVSS Base Score: 2.6
CVSS Temporal Score: See http://exchange.xforce.ibmcloud.com/#/vulnerabilities/99710 [http://exchange.xforce.ibmcloud.com/#/vulnerabilities/99710] or the current score
CVSS Environmental Score*: Undefined
CVSS Vector: (AV:N/AC:H/Au:N/C:N/I:P/A:N) 

CVEID: CVE-2014-3572 [http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3572]
DESCRIPTION: OpenSSL could provide weaker than expected security. The client accepts a handshake using an ephemeral ECDH ciphersuite with the server key exchange message omitted. An attacker could exploit this vulnerability to launch further attacks on the system.
CVSS Base Score: 1.2
CVSS Temporal Score: See http://exchange.xforce.ibmcloud.com/#/vulnerabilities/99705 [http://exchange.xforce.ibmcloud.com/#/vulnerabilities/99705] for the current score
CVSS Environmental Score*: Undefined
CVSS Vector: (AV:L/AC:H/Au:N/C:N/I:P/A:N) 

 

CVEID: CVE-2015-0204 [http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-0204]
DESCRIPTION: A vulnerability in the OpenSSL ssl3_get_key_exchange function could allow a remote attacker to downgrade the security of certain TLS connections. An OpenSSL client accepts the use of an RSA temporary key in a non-export RSA key exchange ciphersuite. This could allow a remote attacker using man-in-the-middle techniques to facilitate brute-force decryption of TLS/SSL traffic between vulnerable clients and servers. 

This vulnerability is also known as the FREAK attack. 

CVSS Base Score: 4.3
CVSS Temporal Score: See http://exchange.xforce.ibmcloud.com/#/vulnerabilities/99707 [http://exchange.xforce.ibmcloud.com/#/vulnerabilities/99707] for the current score
CVSS Environmental Score*: Undefined
CVSS Vector: (AV:N/AC:M/Au:N/C:N/I:P/A:N) 

 

CVEID: CVE-2015-0205 [http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-0205]
DESCRIPTION: OpenSSL could allow a remote authenticated attacker to bypass security restrictions, caused by the acceptance of a DH certificate for client authentication without verification. An attacker could exploit this vulnerability to authenticate without the use of a private key.
CVSS Base Score: 2.1
CVSS Temporal Score: See http://exchange.xforce.ibmcloud.com/#/vulnerabilities/99708 [http://exchange.xforce.ibmcloud.com/#/vulnerabilities/99708] for the current score
CVSS Environmental Score*: Undefined
CVSS Vector: (AV:N/AC:H/Au:S/C:N/I:P/A:N)

AFFECTED PRODUCTS AND VERSIONS
IBM MQ Appliance M2000 

IBM WebSphere MQ for OpenVMS V6 

IBM WebSphere MQ V5.3 for HP NonStop 

IBM WebSphere MQ Client for HP Integrity NonStop Server - SupportPac MAT1 

IBM MQ Client for HP Integrity NonStop Server - SupportPac MQC8 

IBM Mobile Messaging and M2M Client Pack (Eclipse Paho MQTT C Client libraries only) - Support Pac MA9B

REMEDIATION/FIXES
IBM strongly recommends immediately changing any channel definitions that use any of the following MQ CipherSpecs to use a stronger encryption algorithm; 

 * RC4_MD5_EXPORT 
 * TLS_RSA_EXPORT_WITH_RC4_40_MD5 
 * RC2_MD5_EXPORT 
 * TLS_RSA_EXPORT_WITH_RC2_40_MD5


Further details on MQ CipherSpecs can be found here [http://www-01.ibm.com/support/knowledgecenter/SSFKSJ_8.0.0/com.ibm.mq.sec.doc/q014260_.htm].  

IBM MQ Appliance M2000 

A firmware update containing this fix is available, please contact your IBM Support Representative for further details. 

 

IBM WebSphere MQ for OpenVMS V6 

The version of OpenSSL used by MQ is provided by Hewlett-Packard. Please contact HP support [http://h71000.www7.hp.com/openvms/products/ssl/ssl.html] for further information. 

 

IBM WebSphere MQ V5.3 for HP NonStop 

A patched version of OpenSSL will be made available in WebSphere MQ v531.11, in the interim please contact your IBM Support representative. 

 

IBM WebSphere MQ Client for HP Integrity NonStop Server - Support Pac MAT1 

This SupportPac has been withdrawn and replaced by IBM MQ Client for HP Integrity NonStop server, apply the ifix as indicated below. 

 

IBM MQ Client for HP Integrity NonStop Server - Support Pac MQC8 

An ifix is available to download from Fix Central - 8.0.0.2b-WS-MQC-HPNS-IA64 [http://www.ibm.com/support/fixcentral/swg/quickorder?parent=ibm%7EWebSphere&product=ibm/WebSphere/WebSphere+MQ&release=8.0&platform=HP+NonStop&function=fixId&fixids=8.0.0.2b-WS-MQC-HPNS-IA64&includeSupersedes=0&source=fc]. 

 

IBM Mobile Messaging and M2M Client Pack (Eclipse Paho MQTT C Client libraries only) - Support Pac MA9B 

Review the instructions below for rebuilding the C client libraries against a new version of OpenSSL.

WORKAROUNDS AND MITIGATIONS
IBM WebSphere MQ and IBM MQ Appliance 

The MQ channel protocol protects against a man-in-the-middle downgrade of secure socket protocol and/or ciphersuites through channel SSLCIPH validation. After a successful handshake, the MQ protocol exchanges communications flows to negotiate channel startup, this processing detects an export ciphersuite being used where a stronger level of ciphersuite is required. In this scenario, the channel does not exchange any messages and logs an AMQ9631 error in the queue manager error logs before ending the connection. 

 

IBM Mobile Messaging and M2M Client Pack
The C client libraries provided by the MA9B Support Pac can also be rebuilt from source and linked against a newer maintenance level of OpenSSL 1.0.1 using the following instructions [http://pic.dhe.ibm.com/infocenter/wmqv7/v7r5/topic/com.ibm.mm.tc.doc/tc10155_.htm]. To address the vulnerabilities outlined in this security bulletin, version OpenSSL 1.0.1l or later should be used.

GET NOTIFIED ABOUT FUTURE SECURITY BULLETINS
 Subscribe to My Notifications [ http://www-01.ibm.com/software/support/einfo.html] to be notified of important product support alerts like this. 

REFERENCES
Complete CVSS v2 Guide [http://www.first.org/cvss/v2/guide] 
On-line Calculator v2 [http://nvd.nist.gov/CVSS-v2-Calculator] 
RELATED INFORMATION
IBM Secure Engineering Web Portal [http://www.ibm.com/security/secure-engineering/bulletins.html] 
IBM Product Security Incident Response Blog [http://www.ibm.com/blogs/PSIRT] CHANGE HISTORY
 23rd March 2015 - Initial version Published 

*The CVSS Environment Score is customer environment specific and will ultimately impact the Overall CVSS Score. Customers can evaluate the impact of this vulnerability in their environments by accessing the links in the Reference section of this Security Bulletin. 

DISCLAIMER
According to the Forum of Incident Response and Security Teams (FIRST), the Common Vulnerability Scoring System (CVSS) is an "industry open standard designed to convey vulnerability severity and help to determine urgency and priority of response." IBM PROVIDES THE CVSS SCORES "AS IS" WITHOUT WARRANTY OF ANY KIND, INCLUDING THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. CUSTOMERS ARE RESPONSIBLE FOR ASSESSING THE IMPACT OF ANY ACTUAL OR POTENTIAL SECURITY VULNERABILITY.

RELATED INFORMATION
 A Japanese translation is available [http://www.ibm.com/support/docview.wss?uid=swg21700425]