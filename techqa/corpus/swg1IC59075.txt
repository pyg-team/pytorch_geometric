Title: IBM IC59075: Applications which contain mediation flow components can be     slow to initialise on receipt of the first message - United States

Text:
  FIXES ARE AVAILABLE
WebSphere Process Server V6.2.0 Fix Pack 1 (V6.2.0.1) [http://www-01.ibm.com/support/docview.wss?uid=swg24022185]
WebSphere Enterprise Service Bus V6.2.0 Fix Pack 1 (6.2.0.1) [http://www-01.ibm.com/support/docview.wss?uid=swg24022868]
WebSphere Enterprise Service Bus V6.2.0 Fix Pack 2 (6.2.0.2) [http://www-01.ibm.com/support/docview.wss?uid=swg24024407]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  After an application which contains a mediation flow component
   is installed or started on the runtime server (including a
   server restart), it might be observed that the initial message
   processing time is significantly longer than subsequent message
   flows.  Furthermore, as the number of installed applications
   increases, the performance of this initialisation degrades
   further as the filesystem IO of the system is heavily utilised.
   
   Initialisation of the mediation flow component occurs when the
   running application receives its first message.  During this
   initialisation, the message flows for the mediation flow
   component are built and configured, which manifests itself
   externally as taking longer to process the first message than
   it takes to process subsequent messages.
   
   For example, this first message may be processed by a mediation
   flow component module in 5 seconds, and the second message might
   take 200ms. If the system is heavily loaded with 50+
   applications, then it might be observed that this initial
   processing time is 30 seconds or more.  This degradation of
   initial flow performance of 5 seconds down to 30
   seconds is what this APAR is primarily concerned with
   addressing, although optimisations in the initialisation code
   to decrease this 5 second value are also utilised.
   
   
    
   
   

LOCAL FIX
 *  N/A
   
   
    
   
   

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED: Users of WebSphere Enterprise Service Bus    *
   *                 and WebSphere Process Server who are making  *
   *                 use of applications which contain mediation  *
   *                 flow components, and are concerned with the  *
   *                 initial flow message response time after     *
   *                 the application has been started.            *
   *                                                              *
   *                 Users who have many (for example over 50)    *
   *                 applications installed on their runtime      *
   *                 server are particularly affected by this     *
   *                 issue, dependent on the I.O. performance of  *
   *                 their filesystem.                            *
   ****************************************************************
   * PROBLEM DESCRIPTION: When an initial message is received     *
   *                      by an application which contains a      *
   *                      mediation flow component,               *
   *                      initialisation of the mediation flows   *
   *                      is performed.  This involves the        *
   *                      compiling of message flows and any      *
   *                      subsequent primitive processing which   *
   *                      may be required, for example XSLT       *
   *                      stylesheet compiling.                   *
   *                                                              *
   *                      One activity which occurs during this   *
   *                      initialisation is the management of     *
   *                      promoted properties for mediation       *
   *                      primitives.  This activity is very      *
   *                      resource intensive, particularly if     *
   *                      there are many applications installed   *
   *                      to the runtime server, and takes some   *
   *                      time to complete.                       *
   ****************************************************************
   * RECOMMENDATION: If the initial flow message processing       *
   *                 performance is causing you concern, then     *
   *                 you can take a number of actions to improve  *
   *                 matters.  These are:                         *
   *                                                              *
   *                 (1) "Warm-up" the application before it is   *
   *                     needed in the production environment.    *
   *                                                              *
   *                 (2) Install the code change associated with  *
   *                     this APAR.                               *
   *                                                              *
   *                 (3) Disable promoted properties.             *
   *                                                              *
   *                 These are discussed in more detail in the    *
   *                 section below.                               *
   ****************************************************************
   If the initial flow message processing performance is causing
   you concern, then you can take a number of actions to improve
   matters.  In recommended order of precedence (from high to
   low), these are:
   
   (1) Initialise the system prior to the point where high response
       performance is required.
   
       If you require that each flow invocation occurs in the
       minimum amount of time, you are strongly recommended to
       pre-initialise your mediation flow component applications
       in advance of requiring the fast invoked message.  This
       process, sometimes referred to as "warming-up" the
       application, involves sending a dummy message into the
       application which triggers the compilation and
       initialisation of the application code.
   
       Note that if you cannot invoke your actual production flow
       in a dummy way due to its business logic operation, you will
       still see some benefit from invoking another application
       which contains a mediation flow component on the same
       server. This is due to the fact that the loading of runtime
       code will be cached after the initial application load, and
       hence subsequent invocations of other applications will
       perform better.
   
   
   (2) Apply the code change which is associated with this APAR.
   
       Upon investigation of the server initialisation procedure,
       several optimisations were made to enhance the flow
       building time.  The most significant enhancement will occur
       in systems which have many applications installed, where
       filesystem I.O. has been greatly reduced.
   
   
   (3) Disable promoted properties for the system.
   
       Using this option will reduce the initialisation time at the
       cost of disabling the promoted properties system.  Promoted
       properties are properties associated with mediation flow
       component primitives which can be configured within the
       Administration Console.  Given that the promoted property
       subsystem will not function after this option is utilised,
       this option should not be used if you are making use of
       promoted properties anywhere on your server.
   
       To disable promoted properties, use the Administration
       Console to define the following environment variable:
   
       Servers -> Application Servers -> [Select Server]
   
       Scroll down to the "Server Infrastructure" section and
       expand the "Java and Process Management" section to reveal
       "Process Definition"
   
       Process Definition->Java Virtual Machine->Custom Properties
   
       Here, define a new property, with the following name:
   
       com.ibm.websphere.sibx.mediation.enableDynamicPropertyChange
   
       The value of this property should be "false", in lower case
       as written here.
   
   
    
   
   

PROBLEM CONCLUSION
 *  The code change associated with this APAR optimises the
   mediation flow component initialisation procedure, such that
   the initial message processing time is reduced.
   
   The size of the reduction will be dependent on the application
   and server configuration, and will be most significant for
   systems which have many applications installed on the server
   (eg. over 50).
   
   There are no known side effects associated with this code
   change.
   
   This code change was targeted to be included in the following
   fix packs:
   
       6.1.2 Fix Pack 3 (v6.1.2.3)
       6.2.0 Fix Pack 1 (v6.2.0.1)
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IC59075
   
   
 * REPORTED COMPONENT NAME
   WEB ESB FOR WIN
   
   
 * REPORTED COMPONENT ID
   5724I8200
   
   
 * REPORTED RELEASE
   612
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2008-11-30
   
   
 * CLOSED DATE
   2009-01-29
   
   
 * LAST MODIFIED DATE
   2009-01-30
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WEB ESB FOR WIN
   
   
 * FIXED COMPONENT ID
   5724I8200
   
   

APPLICABLE COMPONENT LEVELS
 * R100 PSN
   UP
   
   
 * R200 PSN
   UP
   
   
 * R300 PSN
   UP
   
   
 * R612 PSY
   UP
   
   
 * R620 PSY
   UP