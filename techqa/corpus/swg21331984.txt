Title: IBM Creating a Build with an Excel Spreadsheet Source - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 How can an Excel spreadsheet that has an ODBC connection be used as a data source? 

RESOLVING THE PROBLEM
MS Excel Spreadsheet information can be set up as data sources through the use of SQLTXT Designer. The steps are as follows:

1. In Excel, save the spreadsheet as a comma delimited (.csv) file. 

2. Invoke SQLTXT Designer. Set up a new definition file by selecting 'File' and then 'New'. A database icon labelled 'Untitled' appears in the leftmost pane.

3. Right-click the database icon, and then select 'Import Table Data'. The 'Import SQLTXT Table Data File' window appears. Navigate to the location of the CSV file created in Excel and select that file. Click 'Open'. The 'Import Wizard' window appears.

4. Indicate the number of header rows in the CSV file (if any), and then click 'Next'.

5. Select the delimiter type, and then click the 'Next'.

6. Click 'Process All Records'. This parses the CSV file and then informs you of the number of records processed. Click 'Close' when the parsing is completed, and then click 'Finish'.

7. The main SQLTXT Designer window appears. A new branch appears under the database icon 'Untitled'. Click '+' to expand the tree and view the column definitions of the imported file.

8. Repeat steps 1 through 7 for each spreadsheet that needs to be defined.

9. From the 'File' drop-down list, select 'Save As'. This saves the definitions as a SQLTXT .def file. 


If this is a new catalog, ensure that a database exists to store the DecisionStream catalog definitions. For this example, assume that an MS Access database will be used. 

1. Invoke the ODBC Administrator. Click 'Add', and then in the 'Create New Data Source' window, select 'Microsoft Access Driver'. Click the 'Finish'. The 'ODBC Microsoft Access Setup' window appears.

2. Enter a 'Data Source Name' value.

3. In the 'Database' section, click 'Create'. In the 'New Database' window, enter a 'Database Name' value. In the 'Format section of the window, select 'Version 3.x'. Ensure that the path is set for where the MS Access database is stored. Click 'OK'. A verification message window appears stating that the database was created. Click 'OK'.

4. Close the ODBC Administrator.


Now that the database to store the DecisionStream catalog definitions is ready, set up the new catalog.

1. Invoke DecisionStream Designer. From the 'File' menu, click 'New Catalog'.

2. Enter a value for 'Name', and then click 'Next'.

3. Select the 'ODBC' icon, and then use the 'Data Source Name' drop-down list to select the MS Access database created through the ODBC Administrator.

4. Click 'Test Connection'. This should return a message window stating that the connection is OK. Click 'OK', and then click 'Finish'. The DecisionStream Designer 'Build' window appears.

You can save the catalog at this point by clicking File/Save Catalog.


Next, you can set up the build that uses the MS Excel spreadsheet as a source. First, you need to tell DecisionStream how to connect to the DEF file created earlier. 

1. Click 'Edit', and then click 'Connections'. The 'Connection' window appears.

2. Click 'New'. The 'Connection Properties' window appears. Enter a name for this connection (ie. ExcelConnect), and then click the 'Connection Details' tab.

3. Click the 'SQLTXT' option in the left pane, and then specify the path and name of the DEF file created earlier. Click 'Test Connection'. Click 'OK' in the confirmation window, and then click 'OK' in the 'Connection Properties' window.

4. Click 'Close' in the 'Connections window.


You now have a connection to the spreadsheet data. Now set up the build.

1. In the 'Build' window, right-click the 'Build' icon, and then select 'Insert Build'. The 'Build Properties' window appears. Enter a name for the build, and then click 'OK'. A new icon appears in the Build window. Expand the tree. You should see an item called 'DataStream'.

2. Right-click 'DataStream', and then select 'Insert Data Source'. The 'Data Source Properties' window appears. Enter a name, and then click 'OK'. Again, a new icon appears in the Build window. Expand the new data source tree. You should see an item called 'SQL'.

3. Double-click SQL to invoke the 'Data Source SQL' window. Click 'SQL Helper'. This invokes the 'SQL Helper' window.

4. In the drop-down list below the title bar, select the connection to the DEF file create above. Double-click the database objects icon in the rightmost pane. Your SQLTXT definition table name is shown.

5. CTRL + click the table, drag to the leftmost pane and then release. A SQL SELECT statement is created. Use the arrow icon to run a SQL report on your data. 

Once the data appears, you know that the connection works fine. Click 'OK' until you return back to the 'Build' window. You are now ready to carry out the rest of your design.

 

HISTORICAL NUMBER
 96925