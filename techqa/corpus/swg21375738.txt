Title: IBM Error 'The underlying connection was closed: An unexpected error occurred on a receive' when refreshing Excel report - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 User opens Excel link spreadsheet (.XLS file). User clicks 'F9' on the keyboard, to run the report. After about 10 seconds, an error appears. 

SYMPTOM
Screen message: 

 
Information
Standard Error
Number: 5
Source: FrangoDirect.ExcelLinkD.FetchComp#ControllerProxyClient
Description: The underlying connection was closed: An unexpected error occurred on a receive.
[OK]


CAUSE
There are several possible causes for the 'The underlying connection was closed' error when running an Excel link report (F9). 

 * TIP: For more examples, see separate IBM Technote #1472412.


This Technote specifically relates to the scenario where the cause is that the Controller client was not able to save its configuration and cache data inside the relevant folder. 

More Information: 
By default, the Controller client will attempt to read/write its cache files to this folder: %APPDATA%\Cognos\CCR.  * For example, on Windows 7 this translates to: C:\Users\<username>\AppData\Roaming\cognos\ccr




Example #1 
In one real-life customer example, the Windows system variable %APPDATA% had been modified from its default (for example C:\Documents and Settings\<username>\Application Data) to a value (for example H:\Application Data) that did not exist.  * In other words, the folder was not available to the client device, so therefore the Controller client could not read/write its cache files to there,


Example #2 
In one real-life customer example, the customer had changed ' CachDir' to be D:\ControllerCache, but unfortunately the NTFS permissions were such that the end users could not write to that folder: 
[/support/docview.wss?uid=swg21375738&amp;aid=1] 
ENVIRONMENT
Controller being run inside a modified/custom environment (for example, inside a Citrix server) where the Windows system variable %APPDATA% was changed to an invalid value.



RESOLVING THE PROBLEM
Ensure that the end user's client device has read and write access to the location where Controller has been told to use for its client cache. 

 

Steps: 

1. Logon to the client device, using the same Windows user account as the person who has the issue 

2. Launch a command prompt 

 * TIP: Click 'START - RUN' and type: CMD


3. Type the following: SET 

4. Make a note of the value of %APPDATA% 

 * For example: C:\Users\bad_user\AppData\Roaming\cognos\ccr


5. Launch Windows explorer, and browse to that folder 

6. Open the file "ccr.config" inside Notepad 

7. Search for: CacheDir 

 * For example: <add key="CacheDir" value=""/>


8. If the value is "", this means that Controller is using the 'default' location (which is the same folder that you are now in). 

 * However, if the value is different (for example D:\ControllerCache) then please now browse to that (different) folder.


9. Check that the end user can read/write to this folder. 

 * For example, create a new TXT file in this folder, and then delete it afterwards. 
 * If necessary, modify the NTFS permissions until the end user can successfully read/write to the folder.

RELATED INFORMATION
#1472412 - ** Troubleshooting ** error "The underlying c [http://www.ibm.com/support/docview.wss?uid=swg21472412]