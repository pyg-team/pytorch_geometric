Title: IBM Support for TLS Extended Master Secret on Security Network Protection sensors - United States

Text:
XGS; SSL TECHNOTE (FAQ)

QUESTION
 Is the Inbound SSL policy able to decrypt TLS Extended Master Secret cyphers on Security Network Protection (XGS) sensors? 

CAUSE
You may see messages like the following in the XGS System Events if the client/server is using TLS Extended Master Secret Extension:

SSL decryption failed for rule: 1,src_addr:<srcIP>, dest_addr:<dstIP>,src_port:<srcPort>, dest_port:<dstPort>,throttled:0, error:Bad handshake sequence: error:1408F119:SSL routines:SSL3_GET_RECORD:decryption failed or bad record mac

TLS Extended Master Secret Extension is defined in RFC 7627 [https://tools.ietf.org/html/rfc7627]


ANSWER
As of firmware 5.3.2.2 on the XGS, the Inbound SSL Inspection policy does not yet support TLS Extended Master Secret. Development currently plans to add support for this feature in a future release.


Users can apply the following workaround at firmware 5.3.2.2:

Note: Prepare for this activity by updating the XGS to firmware 5.3.2.2 and ensuring that the system has an SSL inspection license. Also, contact IBM Support [http://www.ibm.com/support/customercare/sas/f/handbook/contacts.html] and request fixpack 5.3.2.2-ISS-XGS-All-Models-Hotfix-IF0004.


 1. In the XGS Local Management Interface (LMI), go to Manage System Settings > Updates and Licensing > Fix Packs and install fixpack 5.3.2.2-ISS-XGS-All-Models-Hotfix-IF0004.
    
 2. Restart the XGS sensor by going to Manage System Settings > System Settings > Restart or Shutdown and clicking Restart.
    
 3. Open the Advanced Tuning Parameters policy for the XGS sensor:  * In the LMI: Go to Manage System Settings > System Settings > Advanced Tuning Parameters. 
     * In SiteProtector: Right-click the XGS and select Manage Policy. Open the Advanced Tuning Parameters policy in the resulting Policy tab.
       
    
    
 4. Add the following two parameters to the policy and then save and deploy your changes:
    
    Name: alpsd.ssl.intercept.domains
    Value: <The server domain to which you wish to connect. For example, example.com>
    
    Name: alpsd.ssl.inverse
    Value: 1
    
 5. In the LMI, go to Manage System Settings > Network Settings > Inbound SSL Certificates and upload the certificate for the SSL server.
    
 6. Open the Inbound SSL Inspection policy:  * In the Local Management Interface (LMI): Go to Secure Policy Configuration > Security Policies > Inbound SSL Inspection Policy. 
     * In SiteProtector: Right-click the XGS and select Manage Policy. Open the Inbound SSL Inspection policy in the resulting Policy tab.
       
    
    
 7. Delete any existing rules for inspecting the internal servers.
    
 8. Open the Outbound SSL Inspection policy:  * In the Local Management Interface (LMI): Go to Secure Policy Configuration > Security Policies > Outbound SSL Inspection Policy. 
     * In SiteProtector: Right-click the XGS and select Manage Policy. Open the Outbound SSL Inspection policy in the resulting Policy tab.
       
    
    
 9. Create an outbound SSL inspection rule with source and destination settings as you would for an inbound SSL inspection rule.





[/support/docview.wss?uid=swg21986092&aid=1] [https://ibm.biz/BdHdZx] [/support/docview.wss?uid=swg21986092&aid=2] [http://ibm.biz/InfraSecForumTechnote] [/support/docview.wss?uid=swg21986092&aid=3] [http://ibm.biz/SecSuptUTube] [/support/docview.wss?uid=swg21986092&aid=4] [http://ibm.biz/InfraSecFixes] [/support/docview.wss?uid=swg21986092&aid=5] [http://ibm.biz/FlexLicLogin] [/support/docview.wss?uid=swg21986092&aid=6] [http://ibm.biz/MyNotification] [/support/docview.wss?uid=swg21986092&aid=7] [http://ibm.biz/ContactSecSupport]