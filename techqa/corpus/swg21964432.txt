Title: IBM Unable to process events in Case Foundation Case Analyzer due to error: pa_X_QuarantinedEvents_Insert() - DB2 SQL Error: SQLCODE=-302, SQLSTATE=22001, SQLERRMC=null - United States

Text:
Blob datatype; Alter table TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Unable to process events or create data fields in Case Analyzer due to error: pa_X_QuarantinedEvents_Insert() - DB2 SQL Error: SQLCODE=-302, SQLSTATE=22001, SQLERRMC=null 

SYMPTOM
When attempting to process events or create data fields in Case Analyzer when using DB2 the following error is reported:

2015/05/14 09:38:23.958-0400 CAPublisher 07640764 [Trace] CA_DATA, [CASTORE] filenet.eventexporter.ca.sql.IPADataEnvironmentAdaptor::getCachedPreparedStatement-pa_X_QuarantinedEvents_Insert_2

2015/05/14 09:38:23.959-0400 CAPublisher 07640764 [Trace] CA_DATA, [CASTORE] filenet.eventexporter.ca.sql.IPADataEnvironmentAdaptor::getCachedPreparedStatement-pa_X_QuarantinedEvents_Insert_3

2015/05/14 09:38:23.960-0400 CAPublisher 07640764 [Error] [CASTORE] filenet.eventexporter.ca.sql.PADataEnvironmentDB2::pa_X_QuarantinedEvents_Insert() - DB2 SQL Error: SQLCODE=-302, SQLSTATE=22001, SQLERRMC=null, DRIVER=4.18.60 ; Exception: com.ibm.db2.jcc.am.SqlDataException: DB2 SQL Error: SQLCODE=-302, SQLSTATE=22001, SQLERRMC=null, DRIVER=4.18.60
at com.ibm.db2.jcc.am.kd.a(kd.java:739)
at com.ibm.db2.jcc.am.kd.a(kd.java:66)
at com.ibm.db2.jcc.am.kd.a(kd.java:135)
at com.ibm.db2.jcc.am.bp.c(bp.java:2788)
at com.ibm.db2.jcc.am.bp.a(bp.java:2236) 
...

2015/05/14 09:38:23.960-0400 CAPublisher 07640764 [Error] Unexpected exception occurred while processing task CAPublisher for store CASTORE.; Exception: java.sql.SQLException: com.ibm.db2.jcc.am.SqlDataException: DB2 SQL Error: SQLCODE=-302, SQLSTATE=22001, SQLERRMC=null, DRIVER=4.18.60
at java.sql.SQLException.<init>(SQLException.java:123)
at filenet.eventexporter.ca.sql.IPADataEnvironmentAdaptor.logException(IPADataEnvironmentAdaptor.java:2720)
at filenet.eventexporter.ca.sql.PADataEnvironmentDB2Base.pa_X_QuarantinedEvents_Insert(PADataEnvironmentDB2Base.java:398) 
....
Caused by: com.ibm.db2.jcc.am.SqlDataException: DB2 SQL Error: SQLCODE=-302, SQLSTATE=22001, SQLERRMC=null, DRIVER=4.18.60 



CAUSE
This has been identified as a product defect under APAR PJ43359. DB2 is not accepting the BLOB datatype that is being obtained from the PE for the F_WobNum and F_WorkflowNumber columns in the Eventlog tables. To address the issue a conversion of the DataType needs to be made.

RESOLVING THE PROBLEM
This issue will be addressed in release CPE-5.2.3.

As a workaround you can carry out the following steps:

1) Stop the AppServer
2) Connect to DB2 (using GUI or command line client)
3) Execute the following commands:

ALTER TABLE <schema_name/owner_name>.X_QuarantinedEvents ALTER COLUMN PALogElement SET DATA TYPE BLOB(1M)

ALTER TABLE <schema_name/owner_name>.X_CEQuarantinedEvents ALTER COLUMN CELogElement SET DATA TYPE BLOB(1M)

ALTER TABLE <schema_name/owner_name>.F_DMCaseWIP ALTER COLUMN Attributes SET DATA TYPE BLOB(1M)

ALTER TABLE <schema_name/owner_name>.F_DMTaskWIP ALTER COLUMN Attributes SET DATA TYPE BLOB(1M)

ALTER TABLE <schema_name/owner_name>.F_DMWIP ALTER COLUMN Attributes SET DATA TYPE BLOB(1M)

ALTER TABLE <schema_name/owner_name>.F_DMWorkflowWIP ALTER COLUMN Attributes SET DATA TYPE BLOB(1M)