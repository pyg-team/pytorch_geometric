Title: IBM Inbound SMTP mail not accepted for remote LDAP user configured through Directory Assistance - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM
You enable Directory Assistance (DA) on a DominoÂ® server to make a remote LDAP directory available to the server for mail routing and authentication. The server, an inbound SMTP gateway, also has the SMTP inbound control "Verify that local domain recipients exist in the Domino Directory" enabled.

Messages were routing inbound for the remote LDAP users correctly when the server was first started. However, after a short period of time, messages addressed to any users outside of the primary directory are rejected by the inbound Domino SMTP server with the error: 



 * "No such user" 


Other inbound SMTP messages are failing with the error: 

 * "Rejected for policy reasons. Recipient could not be found in the Domino Directory". 


The recipient inbound address is a valid user from the Remote LDAP directory source. 

Directory Assistance is configured using LDAP over SSL Port 636. All ports are enabled and you are able to telnet to the remote LDAP server from the Domino Server. 

When you run the Domino Console command "Show xdir ", the remote LDAP directory is confirmed as available: 
 * DomainName DirectoryType ClientProtocol Replica/LDAP Server 
   
   1 LOTUS Primary-Notes Notes & LDAP names.nsf 
   2 EXTDOM Secondary-LDAP Notes & LDAP <IP address>:636 
   
   Directory Assistance Database 'da.nsf' in use. 


Recreating the Directory Assistance database and documents to rule out database or document corruption does not resolve the issue. 

CAUSE
The LDAP directory users were imported into a Domino Directory and a Domino Directory Assistance document so that the server could continue to route mail to these users. This also did not work, which indicated that the problem was not with the remote LDAP server and the DA connection. The issue is with the name lookup.



Domino, a while after the server is restarted, is not looking up any of the secondary directories to resolve the inbound names.


RESOLVING THE PROBLEM
The Configuration document option "Restrict name lookups to primary directory only" is enabled. This is why the lookup only occurs in the primary Domino Directory, and why debug is reporting no errors.


To resolve this issue, perform the following steps:

1. Open the Configuration document(s) that apply to this server. 
2. Go to Router/SMTP > Advanced > Controls tab.
3 - Go to the Advanced controls section of this tab in the top right hand corner.
4 - Set "Restrict name look-ups to primary directory only" to disabled and save and close the document.
5 - Restart the Domino server.




 * 
 *