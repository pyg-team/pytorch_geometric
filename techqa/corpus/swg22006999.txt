Title: IBM Webinar Q&A: IBM Spectrum Protect server database backup and restore - 3 August 2017 - United States

Text:
ISP web cast db backup restore NEWS

ABSTRACT
 IBM recently hosted a Webinar with IBM Spectrum Protect Support Engineers to discuss "Spectrum Protect server database backup and restore". This document contains Q&A from that call and presentation audio and video download links. 

CONTENT
The following Questions/Answers are from the August 3rd, 2017 Webinar with IBM Spectrum Protect Support Engineers to discuss "Spectrum Protect server database backup and restore". 
Q1: What is the maximum size of Active log supported in version 8?
>> 512 GB

Q2. If the Archive log directory is full can we manually move some of the logs to different location to free up the space?
>> It is not recommended to manually move the Archive logs. 
Case 1: If your archive log directory is full and if you are unable to start the Tivoli Storage Manager server then reference the following solution: 

 * Archive log directories are full and server will not start


Case 2: If your archive log directory is small in size, and you want to move it into a new, larger directory then follow the steps below:  * Moving only the active log, archive log, or archive failover log


Q3. If the IBM Spectrum Protect server is upgraded to a newer version, will clients be able to restore their data that was backed up using the old version? 
>> Yes. There is no impact on client backup and restore operation. 

Q4. What is the single log file size created under active or archive log directory? 
>> 512 MB 

Q5. What is the basic difference in the functionality of the DB2 database in IBM Spectrum Protect server v8.1 and other Tivoli Storage Manager versions like 6.x, 7.x? 
>> The basic change is the DB2 version, which includes fixes for APAR defects found in the old version.  * Tivoli Storage Manager v6.x uses DB2 v9.x 
 * IBM Spectrum Protect server v7.x uses DB2 v10.x 
 * IBM Spectrum Protect server v8.x uses DB2 v11.1

Reference the following link for more detail:  * TSM Schedule for Fix-Packs


Q6. In Tivoli Storage Manager 5.x, we could add an entry in volhist files and be able to restore Tivoli Storage Manager db. Is there any way to generate volhistory file in 7.x if a current volhistory file is unavailable? 
>> It is not recommended to add/remove any entries from the existing volhist file. If you lose the volhist file you can rebuild the file according to the following technote steps:  * Rebuild a missing volume history file for a file database restore

However, the best option is to always have a copy of the volhist file stored in a different location, to avoid the necessity of recreating the volume history manually. 

Q7. How to know the database sizes currently in use for planning in the future? 
>> Run "query db f=d" to check the current usages. 
For future planning refer to the following link:  * Estimating database space requirements


Q8. How to restore IBM Spectrum Protect database from the Primary Data Center to a Disaster Recovery site? 
>> Recovering from a disaster [https://www.ibm.com/support/knowledgecenter/en/SSGSG7_7.1.0/com.ibm.itsm.srv.doc/t_recover_disaster.html] 
Reference step 7. 

Q9. What are the steps for upgrading the IBM Spectrum Protect server from version 7 to 8? 
>> Reference the following guide link:  * Upgrading to V8.1


Q10. Is there a method to restore the database if the volhistory file is missing? 
>> If you have lost the volhist file then you can rebuild the volhist file as per the article below:  * Rebuild a missing volume history file for a file database restore

If you have a DR plan file, you can manually create the volhist file by copying volume history details from the DR plan file. 

Q11. What is the recommendation from IBM for DB volumes (I/O, cache) which are placed on private cloud? 
>> Reference the following link for configurations for the database directories:  * Configuring the server database directories for optimal performance
 * 

Q12. What are the scenarios which may corrupt IBM Spectrum Protect DB or active logs? 
>> Corrupt file system is one the most common reasons for corruption of the database. Abrupt system shutdowns, power surges, file system double-mount, migrating disks, file system-level activities like checking and repairing file system (using utilities like fsck on LinuxÂ®) when the database is up and running. On a Windows system, using Ctrl+Alt+Delete while a file is open, and/or viruses can all introduce unintentional changes in the database. The below devWorks article provides an in-depth knowledge of DB2 database corruptions:  * Diagnosing corruption when using IBM DB2


Q13. What if the IBM Spectrum Protect database gets full? 
>> If the IBM Spectrum Protect server db directories get full, then the server will crash. To resolve this issue, try the following solution:  * Add space on existing db directories from the OS and then restart the server. After the IBM Spectrum Protect server has started successfully, add more db space using the 'extend db' command. 
 * If adding space on the existing db filesystem is not possible then create a new db volume and run a Point-In-Time database restore using the "ON" parameter with a file that lists the directories and specify the existing plus new db volume path.


Q14. Does increasing number of streams improve db backup performance? 
>> Using more stream/volumes might improve the speed of the database backups, but at the cost of more volumes that are not fully used. 

Q15. Can we use a different instance id for the database restore? 
>> Yes, It is possible to restore using a different instance id. 

Q16. Can we balance the database volumes online, other than by restoring? 
>> For version 8.1 db balancing is done automatically. For v7 if it does not happen automatically then reference the following steps:  * Steps to rebalance Database tablespaces


Q17. How to find the reason for sudden growth of active log? 
>> Active log contains in-flight transactions, that means transactions which are not committed to database. The sudden growth of active logs might be due to:  *  Long running backup / restore session 
 *  Server process such as import/export, storage pool migration etc.


Q18 . Frequently we have issues of DB backup completing too soon or sometimes it takes too long. How to analyze the reason? 
>> You need to monitor the pattern, time and identify the difference in what other operations are running on Tivoli Storage Manager server during both cases. 

Q19. When relocating the log volumes from the primary site (DC) to site (DR), if a single file fails to relocate (breaking the log chain), can the missing file be skipped to bring up the database on the DR site? 
>> A Missing log volume would not allow the database to come up to the most current state at the DR site. However, the database can be restored with a Point-In-Time (before the corruption/missing log). 

Q20 . Can we restore IBM Spectrum Protect data (complete) via clone volumes on AIX to LINUX? 
>> No 

______________________ 

Download links of presentation, audio and video recording : 

Presentation: 
https://ibm.biz/BdjFLF [https://ibm.biz/BdjFLF] 
Audio reply: 
https://ibm.biz/BdjFLE [https://ibm.biz/BdjFLE] 
Video recording: 
https://ibm.biz/BdjFLX [https://ibm.biz/BdjFLX] RELATED INFORMATION
 Managing the database and recovery log [https://www.ibm.com/support/knowledgecenter/SSGSG7_7.1.0/com.ibm.itsm.srv.doc/t_manage_db_reclog.html]
Monitoring spectrum protect RESTORE DB operations [http://www-01.ibm.com/support/docview.wss?uid=swg21657102]
Recommended DSMSERV RESTORE DB point-in-time procedure [http://www-01.ibm.com/support/docview.wss?uid=swg21294024]




PRODUCT ALIAS/SYNONYM
 TSM