Title: IBM Embedded browser in Notes client unable to open ADFS 3.0 login form - United States

Text:
 TECHNOTE (FAQ)

QUESTION
Why does the Notes client hang when logging in to ADFS 3.0 using Notes Federated Login

CAUSE
If Notes Federated Login is enabled in a Notes client, and the Identity Provide (IdP) is ADFS 3.0, the login form sent to the embedded browser in the client does not open. After the client displays the dialog box, "downloading ID file from vault to enable Notes Federated
Login", the client appears to be hung.

ANSWER
ADFS 3.0 servers send a login form that contains active content that the Notes client embedded browser is unable to open. This results in the client appearing to be hung. 

Notes client logs may repeatedly log "NNOTESWC::NotesListener> waiting for NFL login to complete" when this occurs. 

You can verify this issue is due to the ADFS login form by enabling Workspace debug for Notes Federated Login, and then reviewing the workspace logs. Search for the term "DocumentCompleteListener:changed". The log data will contain the contents of the form sent from the ADFS server. The ADFS 3.0 form begins with the tag <!DOCTYPE html> and will include a JavaScript section beginning "CDATA", as seen in the log snippet below.



com.ibm.rcp.internal.security.auth.samlsso.SAMLBrowser
DocumentCompleteListener:changed DocumentCompleteListener:changed AuthState when entering document complete:ContactingServer<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml [http://www.w3.org/1999/xhtml]" lang="en-US"><head>
<meta content="IE=10.000" http-equiv="X-UA-Compatible" />
<meta content="width=669px; initial-scale=1.0; maximum-scale=1.0" name="viewport" />
<meta content="text/html;charset=UTF-8" http-equiv="content-type" />
<meta content="no-cache,no-store" http-equiv="cache-control" />
<meta content="no-cache" http-equiv="pragma" />
<meta content="-1" http-equiv="expires" />
<meta content="Connecting to XXX ADFS" name="mswebdialog-title" />

<title>Sign In</title>
<script type="text/javascript">
//&lt;![CDATA[
function LoginErrors(){this.userNameFormatError = 'Enter your user ID in the format \u0026quot;domain\\user\u0026quot; or \u0026quot;user@domain\u0026quot;.'; this.passwordEmpty = 'Enter your password.';}
//]]&gt;
</script>..... [Additional content removed] 
This issue will occur when the IdP must send a login form to the client. This login form is not displayed in cases where Notes Shared Login is also enabled, or when Integrated Windows Authentication is working. 

To enable workspace debug and Notes client debug, see Technote 1988862 [http://www-01.ibm.com/support/docview.wss?uid=swg21988862] - Debug Settings for Notes Federated Login. To enable Integrated Windows Authentication with ADFS 3.0, see Technote 1988917 [http://www-01.ibm.com/support/docview.wss?uid=swg21988917] - Enabling Integrated Windows Authentication in ADFS for Notes Federated Login 


This issue has been reported to development as SPR PJONA9MR3J and will be fixed in Notes 9.0.1 Fix Pack 7. To work around the issue in earlier releases, use Notes Shared Logon or enable Integrated Windows Authentication.

RELATED INFORMATION
 Enabling Integrated Windows Authentication in ADFS for [http://www.ibm.com/support/docview.wss?uid=swg21988917]
Debug Settings for Notes Federated Login [http://www.ibm.com/support/docview.wss?uid=swg21988862]