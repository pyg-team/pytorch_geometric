Title: IBM Locked files encountered during Windows agent silent installation - United States

Text:
locked files; silent; remote; installation; Windows TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 A silent installation of the Windows NT agent aborts due to locked files. 

SYMPTOM
The Customer's AbortIBMTivoliMonitoring yyyymmdd hhmm.log (for example AbortIBMTivoliMonitoring20150409 1014.log) shows the following messages & errors. 

4-9-2015 10:15:22 CheckLockedFiles - Search directory C:\IBM\ITM for locked files.
4-9-2015 10:15:22 CheckLockedFiles - File C:\IBM\ITM\InstSpbs\WINDOWS\ISSetup.dll is locked.
4-9-2015 10:15:22 File C:\IBM\ITM\InstSpbs\WINDOWS\ISSetup.dll could not be renamed, errors may occur.
4-9-2015 10:15:22 CheckLockedFiles - File C:\IBM\ITM\InstSpbs\WINDOWS\setup.exe is locked.
4-9-2015 10:15:22 File C:\IBM\ITM\InstSpbs\WINDOWS\setup.exe could not be renamed, errors may occur.
4-9-2015 10:15:22 CheckLockedFiles - Directory C:\IBM\ITM has locked files.
4-9-2015 10:15:22 CheckedLockedFiles - silent install processing
4-9-2015 10:15:22 CheckedLockedFiles - Check[C:\IBM\ITM\InstSpbs\silent_winos622_64bit_prod.txt] for Locked Files=continue
4-9-2015 10:15:22 CheckLockedFiles - Locked files not present.
4-9-2015 10:15:22 CheckLockedFiles - Directory C:\IBM\ITM - return TRUE
4-9-2015 10:15:22 Directory C:\IBM\ITM has locked files.
4-9-2015 10:15:22 Correct and launch setup again.
4-9-2015 10:15:22 Directory C:\IBM\ITM has locked files, unable to continue.
4-9-2015 10:15:22 SEVERE: ERROR - Install aborted.


CAUSE
A limitation for remote deployment and silent installations indicates:
A silent installation terminates if product files are locked. This behavior ensures that the installer does not overwrite product files that are currently running. The best practice is to shut down all components, including monitoring servers, portal server, and portal clients before you perform any product upgrade. This limitation only affects silent installations. Installations through the installation wizard is not affected.


ENVIRONMENT
Any Windows version 

Any ITM component installed silently


DIAGNOSING THE PROBLEM
Look in <ITMHOME>\InstallITM for a file name with syntax similar to: 
AbortIBMTivoliMonitoring<DATE TIME>.log

For example:
AbortIBMTivoliMonitoring20150409 1014.log



RESOLVING THE PROBLEM
Workaround: Use the following method to resolve the problem:
1. Search the installation log for instances of the CheckLockedFiles string. Locked files are listed at these places. Locked files are files that might need to be upgraded during an installation, and because they are in use (locked) the silent install terminates.


2. Identify the process that is locking the files.


3. Stop the process.


4. Prevent file locking by modifying the response file for installation file. This step is required when a silent installation has terminated. 

a. Open the response file in a text editor. In many cases, the file in which you make this modification is named silent.txt. On Windows, the file to modify is the NT_Silent_Install.txt file that is located on the monitoring server.
b. Add the following line to the [INSTALLATION SECTION] area of your silent install response file:
Locked Files=continue
If you apply any other value or assign no value for this parameter, silent installations fail when locked files exist.
c. If Locked Files=continue is used in a silent install or remote deploy, the computer MUST be rebooted before ITM is brought up or another install is run. This is mandatory or the <ITMHOME> directory could become corrupt. If the <ITMHOME> directory becomes corrupt, all of ITM will have to be uninstalled and reinstalled.


5. Run the silent installation again.