Title: IBM PM59369: THE UPGRADE-JCR-DATABASE-610X-TO-610X TASK FAILS WHERE THE ORACLE URL PORT IS UNABLE TO BE PARSED FROM THE ICM.PROPERI - United States

Text:
 SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  Attempting to upgrade from Portal 6104 -> 6106 but fails
   
   during the CONFIG-WP-PTF-6106 task. Specifically:
   
   action-update-transferred-jcrls-data:
   [echo] Updating transferred data
   [echo] In case of error, refer to
   <WebShere Root>/AppServer/profiles/<wp_profile>/ConfigEngine
   /log/kisod003.log
   [java] Executing java with empty input string
   Target finished: action-update-transferred-jcrls-data
   [echo] Setting jcr.zos.database.prefix with prefix value :
   ICM
   [echo] Migrating JCR schema from JCR6.1.0.3 to JCR6.1.0.3
   ...
   [java] Executing java with empty input string
   [java] Please refer to log
   File::<WebSphere root>/AppServer/profiles/<wp_profile>/Confi
   gEngine/log/Migration.log
   [java] For input string: "//oid:389"
   [java] Java Result: 1
   Target finished: upgrade-jcr-database-610x-to-610x
   
   The migration log shows the following:
   
   2012-02-01 12:02:31 Migration: TRACE -> Loading Database
   properties
   .................
   2012-02-01 12:02:31 Migration: DEBUG -> Properties loaded from
   =
   <WebSphere
   root>/AppServer/profiles/<wp_profile>/PortalServer/jcr/lib/com/i
   
   bm/icm/icm.properties
   2012-02-01 12:02:31 Migration: TRACE -> Database properties
   loaded
   successfully.............
   2012-02-01 12:02:31 Migration: ERROR ->Initialization not
   successful ::
   For input string: "//oid:389"
   
   The client is using a unique Oracle URL that has provided
   issues in the past. A fix was provided (PK90090 [http://www-01.ibm.com/support/docview.wss?uid=swg1PK90090]).
   
   The PK90090 [http://www-01.ibm.com/support/docview.wss?uid=swg1PK90090] fix allowed the database-transfer script to proceed
   successfully with the Oracle URL, but it did it in such a way
   that it appears to set incorrectly the port in icm.properties.
   This wasn't exposed until the 6106 upgrade when JCR tries to
   use the port value.
   
   
    
   
   

LOCAL FIX
 *  updating the jcr.database.port value from '//oid:389' to '389'
   in the icm.properties allowed the configEngine task to complete
   successfully.
   
   
    
   
   

PROBLEM SUMMARY
 *  Attempting to upgrade from Portal 6104 -> 6106 but fails
   
   during the CONFIG-WP-PTF-6106 task. Specifically:
   
   action-update-transferred-jcrls-data:
   [echo] Updating transferred data
   [echo] In case of error, refer to
   &lt;WebShere Root&gt;/AppServer/profiles/&lt;wp_profile&gt;/Conf
   igEngine
   /log/kisod003.log
   [java] Executing java with empty input string
   Target finished: action-update-transferred-jcrls-data
   [echo] Setting jcr.zos.database.prefix with prefix value :
   ICM
   [echo] Migrating JCR schema from JCR6.1.0.3 to JCR6.1.0.3
   ...
   [java] Executing java with empty input string
   [java] Please refer to log
   File::&lt;WebSphere root&gt;/AppServer/profiles/&lt;wp_profile&g
   t;/Confi
   gEngine/log/Migration.log
   [java] For input string: "//oid:389"
   [java] Java Result: 1
   Target finished: upgrade-jcr-database-610x-to-610x
   
   The migration log shows the following:
   
   2012-02-01 12:02:31 Migration: TRACE -&gt; Loading Database
   properties
   .................
   2012-02-01 12:02:31 Migration: DEBUG -&gt; Properties loaded
   from =
   &lt;WebSphere
   root&gt;/AppServer/profiles/&lt;wp_profile&gt;/PortalServer/jcr/
   lib/com/i
   bm/icm/icm.properties
   2012-02-01 12:02:31 Migration: TRACE -&gt; Database properties
   loaded
   successfully.............
   2012-02-01 12:02:31 Migration: ERROR -&gt;Initialization not
   successful ::
   For input string: "//oid:389"
   
   The client is using a unique Oracle URL that has provided
   issues in the past. A fix was provided (PK90090 [http://www-01.ibm.com/support/docview.wss?uid=swg1PK90090]).
   
   The PK90090 [http://www-01.ibm.com/support/docview.wss?uid=swg1PK90090] fix allowed the database-transfer script to proceed
   successfully with the Oracle URL, but it did it in such a way
   that it appears to set incorrectly the port in icm.properties.
   This wasn't exposed until the 6106 upgrade when JCR tries to
   use the port value.
   
   
    
   
   

PROBLEM CONCLUSION
 *  PM59369
   =======
   
   Problem Description:
      THE UPGRADE-JCR-DATABASE-610X-TO-610X TASK FAILS WHERE THE
   ORACLE URL PORT IS UNABLE TO BE PARSED FROM THE ICM.PROPERTIES
   
   Problem Solution:
     PM59369 contains code changes.
   
   Affected Users:
      All portal users.
   
   Pre-Requisite(s):
      Portal Version: 6.1.0.x
   
   Installation Steps:
      NOTE:  YOU MUST FIRST DOWNLOAD THE UPDATE INSTALLER TOOL IN
   ORDER TO INSTALL A FIX.
             The WebSphere Portal Update Installer (PUI) can be
   downloaded from the following link:
             http://www.ibm.com/support/docview
   .wss?rs=688&uid=swg24006942 [http://www.ibm.com/support/docview.wss?rs=688&uid=swg24006942]
   
   *Reminder: the version of PUI used varies based on the version
   of WebSphere Portal.
   Ensure the correct version is in use.*
   
   Refer to the "Maintaining the cluster" topic in the 6.0
   InfoCenter
   (http://publib.boulder.ibm.com/infocenter/wpdoc/v6r0/index
   .jsp?topic=/com.ibm.wp.ent.doc/wpf/clus_maint.html)
   for additional information on installing or uninstalling interim
   fixes in clustered environments
   while maintaining continuous availability of your portal.
   
   1. Stop the WebSphere Portal server
   2. Apply the PM59369.jar using the PUI (Portal update
   installer).
      Refer to the PUI readme for further information on using the
   PUI.
   3. Restart the WebSphere Portal server.
   
   
   Uninstall:
   NOTE:  FIXES MUST BE REMOVED IN THE ORDER THEY WERE APPLIED.
          DO NOT REMOVE A FIX UNLESS ALL FIXES APPLIED AFTER IT
   HAVE FIRST BEEN REMOVED.
          YOU MAY REAPPLY ANY REMOVED FIX.
   
   Use the Portal Update Installer to uninstall the fix:
   
      1. Shutdown WebSphere Portal.
      2. Follow the instructions that are packaged with the Portal
   Update Installer on how to uninstall a fix.
      3. Restart WebSphere Portal.
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PM59369
   
   
 * REPORTED COMPONENT NAME
   WEBSPHERE PORTA
   
   
 * REPORTED COMPONENT ID
   5724E7600
   
   
 * REPORTED RELEASE
   610
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2012-02-29
   
   
 * CLOSED DATE
   2012-04-02
   
   
 * LAST MODIFIED DATE
   2012-04-02
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WEBSPHERE PORTA
   
   
 * FIXED COMPONENT ID
   5724E7600
   
   

APPLICABLE COMPONENT LEVELS
 * R61A PSY
   UP
   
   
 * R61B PSY
   UP
   
   
 * R61C PSY
   UP
   
   
 * R610 PSY
   UP