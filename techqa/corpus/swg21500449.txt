Title: IBM Errors when reconnecting to UCM views after moving pvob to another registry - United States

Text:
CC; mkact; stream from view; stream for view; replica TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Attempts to use IBM Rational ClearCase UCM views result in "Unable to get stream" or "Could not determine stream".



SYMPTOM
An administrator is migrating UCM vobs with multisite to a new server. The administrator also wants to preserve the UCM views attached to the streams. Client hosts store the views in question. 

But when you attempt to access these views, it fails.

For example, the following cleartool command yields the following errors:


cleartool mkact NEW_ACT1 
cleartool: Error: Unable to get stream from view "<view-tag>".


or


cleartool: Error: Could not determine stream for view.


CAUSE
When you replace the pvob replica or when you move it to a new site, the existing UCM views are not attached anymore to the UCM streams.



RESOLVING THE PROBLEM
Migrate the UCM views in the following way. 



1. Save the private files.

cleartool lsp -tag <view-tag>


2. Rmtag/unregister view from the old registry server.


3. Switch the view server (client host) to the new registry.


4. Register/mktag view to new registry server.
This action will preserve the view UUID. 


5. Try to synchronize view with stream:

cleartool setcs -stream -tag <view-tag>


This command will yield the following messages:

cleartool: Error: Unable to get VOB object registry information for replica uuid "87e64e1d.218511d7.9041.00:01:80:ac:3c:1e": ClearCase object not found

cleartool: Error: Unable to access VOB, replica uuid "87e64e1d.218511d7.9041.00:01:80:ac:3c:1e": ClearCase object not found

cleartool: Error: Could not determine stream for view


At this point the pvob knows the view via its uuid but not the reverse because the view is still storing the old replica uuid of the pvob.


6. Reconnect the view to the pvob:

[clearcase_installation]/.../clearcase/etc/utils/view_sr <view-tag> <pvob-tag>
Switch replica:<old_pvob_replica>
to replica:<new_pvob_replica>@<pvob-tag>



7. Verify that the view is now attached to its stream.

cleartool setcs -stream -tag <view-tag>



8. If step 1 was unsuccessful, recover stranded private files.

cleartool lsp -tag <view-tag>


This command yields the following output:

cleartool: Warning: VOB is unavailable -- using name: "<Unavailable-VOB-1>".

If it has been deleted use 'recoverview -force -vob vob-identifier -tag view-tag'

VOB identifier is 87e64e1d.218511d7.9041.00:01:80:ac:3c:1e

Last known location of storage is clearsv1:/home0/ccase_pamcsm/vobs/project_pamcsm.vbs



After that, run the following command:


cleartool recoverview -force -vob <vob-identifier> -tag <view-tag>

ls <view-storage-pathname>/.s/lost+found