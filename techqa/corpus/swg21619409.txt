Title: IBM "System call Failed ... HRESULT: 0x80010100" error, plus Excel Link refresh fails - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 User clicks "Reports > Run", and selects any Report. User chooses "Report Conversion" to Excel Link, and clicks “Send to Application”.

User clicks the Excel “tick”. An error appears.

If the user clicks OK, then the report appears to have successfully run OK. However, hitting F9 (to retrieve the numbers again) results in a quick (e.g. 5 second) refresh, where the user finds that all the numbers disappear.

NOTE: The problem may appear to be intermittent. In one real-life scenario, the user had to switch between two open Excel sheets(and/or refresh several times) to see the error. 

SYMPTOM
Standard Error 

Number: -2147417856
Source: mscorlib
Description: System call Failed. (Exception From HRESULT:
0x80010100 (RPC_E_SYS_CALL_FAILED))
at System. RuntimeType . InvokeDispMethod(String name, BindingFlags
invokeAttr, Object target, Object[] args, Boolean[] byrelModiliers,
1nt32 culture, String[] namedParameters)
at System. RuntimeType . InvokeMember(String name,
BindingFlags bindingFlags, Binder binder, Object target, Object[]
providedArgs, ParameterModifier[] modifiers, Culturelnfo culture,
String[] namedParams)
at
Microsoft. VisualBasic . CompilerServices . VBBinder InvokeMember(St
ring name, BindingFlags invokeAttr, Type objType, IReflect objlReflect,
Object target, Object[] args, String[]
namedParameters)
at
Microsoft. VisualBasic CompilerServices . LateBinding . Latecet(Object
o, Type objType, String name, Object[] args, String[]
paramnames, Boolean[J CopyBack)
at
Microsoft. Visualsasic . Compilerservices, NewLatebinding .
LateGet(Object Instance, Type Type, String MemberName, Object[]
Arguments, String[] ArgumentNames, Type[] TypeArguments, Boolean[)
Copyoack)
at
Cognos .Controller. Forms. Form. FrmReportRun . XlSetMeForeGround
0
at
Cognos . Controller. Forms. Form. frmReportRun . RunReport(1nt32lWhere)
OK


CAUSE
Known limitation in Controller, triggered by the complexity of the report design. 

 * Specifically, in one real-life case, the report crash may have been caused by excel multiple sheets as well as the use of complex formulas. 

ENVIRONMENT
The problem has been seem in the following environment: 

 * Controller Version: 10.1.1 IF2 10.1.1308 
 * Application Server: Windows 2008 R2 SP1 
 * Excel Version: MS office 2010 1.4.0.6023.1000 32 bit 
 * Database Server: : Windows 2008 R2 SP1 / SQL Version: SQL Server 2008

RESOLVING THE PROBLEM
Reduce the complexity of your reports. 

 
Steps:
The users should refer to the following document that describes recommended practices when building reports using IBM Cognos Controller: http://www.ibm.com/developerworks/data/library/cognos/financial_management/financial_reporting/page543.html [http://www.ibm.com/developerworks/data/library/cognos/financial_management/financial_reporting/page543.html]