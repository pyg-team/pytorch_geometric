Title: IBM Patch install failure: dbverify.DbVerifyCommandLine.getSqlServerProcedureOwner - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 IBM Sterling B2B Integrator (B2Bi) Patch install failure: at com.yantra.tools.dbverify.DbVerifyCommandLine.getSqlServerProcedureOwner 

SYMPTOM
Running InstallService.sh/cmd on B2Bi and InstallService log has the following error stack:

schema-synchronizer:
[java] Wed Jul 22 14:05:40 CDT 2015 :: ...Reading entity repository into memory from D:\sterling\node\install\repository\entity ......took 1544 milliseconds
[java] Wed Jul 22 14:05:42 CDT 2015 :: ...Initializing connection to database.
[java] User: xxxxx
[java] Driver: com.microsoft.sqlserver.jdbc.SQLServerDriver
[java] URL: jdbc:sqlserver://xxxxxx:1433;databaseName=xxxx;SelectMethod=cursor
[java] Found internal config file /com/sterlingcommerce/security/jcae/provider.txt, loading it now!
[java] Done loading it.
[java] Wed Jul 22 14:05:44 CDT 2015 :: Database Product Name: Microsoft SQL Server
[java] Wed Jul 22 14:05:44 CDT 2015 :: Database Product Version: 10.00.5775
[java] Wed Jul 22 14:05:44 CDT 2015 :: Driver Name: Microsoft SQL Server JDBC Driver 3.0
[java] Wed Jul 22 14:05:44 CDT 2015 :: Driver Version: 3.0.1301.203
[java] Wed Jul 22 14:05:44 CDT 2015 :: ...Getting metadata from database. This is time consuming. Please wait...
[java] Exception in thread "main" java.lang.Exception: java.lang.reflect.InvocationTargetException
[java] at com.sterlingcommerce.woodstock.noapp.NoAppLoader.main(NoAppLoader.java:85)
[java] Caused by: java.lang.reflect.InvocationTargetException
[java] at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
[java] at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:60)
[java] at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)
[java] at java.lang.reflect.Method.invoke(Method.java:611)
[java] at com.sterlingcommerce.woodstock.noapp.NoAppLoader.main(NoAppLoader.java:82)
[java] Caused by: java.lang.reflect.InvocationTargetException
[java] at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
[java] at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:60)
[java] at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)
[java] at java.lang.reflect.Method.invoke(Method.java:611)
[java] at com.yantra.tools.dbverify.SchemaSynchronizer.run(SchemaSynchronizer.java:1535)
[java] at com.yantra.tools.dbverify.SchemaSynchronizer.main(SchemaSynchronizer.java:1500)
[java] ... 5 more
[java] Caused by: <?xml version="1.0" encoding="UTF-8"?>
[java] <Errors>
[java] <Error ErrorCode="java.lang.NullPointerException"
[java] ErrorDescription="java.lang.NullPointerException" ErrorRelatedMoreInfo="">
[java] <Attribute Name="ErrorCode" Value="java.lang.NullPointerException"/>
[java] <Attribute Name="ErrorDescription" Value="java.lang.NullPointerException"/>
[java] <Error ErrorCode="java.lang.NullPointerException"
[java] ErrorDescription="" ErrorRelatedMoreInfo="">
[java] <Stack>java.lang.NullPointerException&#xd;
[java] at com.yantra.tools.dbverify.DbVerifyCommandLine.getSqlServerProcedureOwner(DbVerifyCommandLine.java:50)&#xd;
[java] at com.yantra.tools.dbverify.SchemaSynchronizer.handleSequencesSqlServer(SchemaSynchronizer.java:378)&#xd;
[java] at com.yantra.tools.dbverify.SchemaSynchronizer.getMetaDataDocumentFromDatabase(SchemaSynchronizer.java:1146)&#xd;
[java] at com.yantra.tools.dbverify.SchemaSynchronizer.getMetaDataDocumentFromDatabase(SchemaSynchronizer.java:1114)&#xd;
[java] at com.yantra.tools.dbverify.SchemaSynchronizer.getMetaDataDocumentFromDatabase(SchemaSynchronizer.java:1109)&#xd;
[java] at com.yantra.tools.dbverify.DbVerifyCommandLine.generateScripts(DbVerifyCommandLine.java:123)&#xd;
[java] at com.yantra.tools.dbverify.DbVerifyCommandLine.processEntityRepository(DbVerifyCommandLine.java:102)&#xd;
[java] at com.yantra.tools.dbverify.DbVerifyCommandLine.nonStaticEntryPoint(DbVerifyCommandLine.java:76)&#xd;
[java] at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&#xd;
[java] at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:60)&#xd;
[java] at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)&#xd;
[java] at java.lang.reflect.Method.invoke(Method.java:611)&#xd;
[java] at com.yantra.tools.dbverify.SchemaSynchronizer.run(SchemaSynchronizer.java:1535)&#xd;
[java] at com.yantra.tools.dbverify.SchemaSynchronizer.main(SchemaSynchronizer.java:1500)&#xd;
[java] at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&#xd;
[java] at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:60)&#xd;
[java] at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)&#xd;
[java] at java.lang.reflect.Method.invoke(Method.java:611)&#xd;
[java] at com.sterlingcommerce.woodstock.noapp.NoAppLoader.main(NoAppLoader.java:82)&#xd;
[java] </Stack>


CAUSE
The value of DB_SCHEMA_OWNER parameter in the sandbox.cfg does not match the value of the Default Schema in the User Mapping for the MSSQL Login. You can verify this using Microsoft SQL Server Management Studio under Security > Logins for the B2BI DB_USER. 

It is also possible that DB_SCHEMA_OWNER parameter is completely missing from the sandbox.cfg, If it is, add the parameter into the sandbox.cfg pointing to the value established above. 


ENVIRONMENT
MSSQL Database



DIAGNOSING THE PROBLEM
Verify the DB_SCHEMA_OWNER parameter exists in the sandbox.cfg and that its value matches the Default Schema in the User Mapping for the MSSQL User under Security > Logins in Microsoft SQL Server Management Studio.



RESOLVING THE PROBLEM
Add or correct the DB_SCHEMA_OWNER parameter in the sandbox.cfg, run setupfiles.sh/cmd and deployer.sh/cmd. Then try installing the patch again