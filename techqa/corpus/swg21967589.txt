Title: IBM Product upgrade installed a second instance of the DE, causing upgrade failure. - United States

Text:
DEL2INST; Tivoli; Deployment; Engine; FQDN; Duplicate; acsi TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 The Deployment Engine should only have one instance installed on a server with IBM products installed. In this case, a second DE was installed, which caused the failure of the Product upgrade.
Error: Wrong Deployment Engine. 

SYMPTOM
Product install failed. You will get a message similar to this:
You are updating an instance of <Product name> that was installed using 
the Tivoli Deployment Engine (DE) located at "/home/nc_admin/.acsi_<Fully Qualified hostname>". 
However you are now using the DE located at "/home/nc_admin/.acsi_<hostname>". 


When the DE is installed as non-root ( in this case nc_admin ), it will install the DE in the user home directory, in this case /home/nc_admin, and use the FQDN in the name: /home/nc_admin/.acsi_<Fully Qualified hostname> 


CAUSE
Because the two Product installs used different versions of JVM, the underlying Java is using "hostname" for one version of JVM, and "Fully Qualified hostname" for the other. The DE normally uses the FQDN appended to the "acsi_" string to create the DE directory:

For example, if the Product is being installed as user "nc_admin" and the entry in /etc/hosts is this:

x.xx.xxx.xx server_name.corporation.net server_name

The hostname is "server_name"
Fully Qualified hostname (FQDN) is "server_name.corporation.net"


ENVIRONMENT
Upgrading existing product that uses the Deployment Engine on a UNIX server



DIAGNOSING THE PROBLEM
Output similar to this when the Product install fails: 

the Tivoli Deployment Engine (DE) located at "/home/nc_admin/.acsi_<Fully qualified hostname>". 
However you are now using the DE located at "<User_home>/nc_admin/.acsi_<hostname>"


RESOLVING THE PROBLEM
There are two options to fix this problem. 

1) Make sure the current upgrade is using the same version of JVM as the original install. 

2) Removing the newly created DE, which shouldn't have been created, then creating a link to the existing DE is the best work around in this case. The Product upgrade will see the link and add the information to the valid DE install. 

*IMPORTANT NOTE: The Product install failure message will tell you what instance of the DE is valid, please refer to the error message in the "Symptom" section above. 

 At this point there will be the following in the DE_HOME directory: 

 .acsi_<FQDN> ( Valid DE installation ) 

 .acsi_<userid> ( link to .acsi_<FQDN> ) 

 .acsi_<hostname> ( Invalid DE directory created by the failed Product upgrade ) 

 This can be confirmed by referring to the Product install error. 

 Removing the invalid DE and creating softlink: 

 - Backup the original DE installation directory: <DE_HOME>/.acsi_<FQDN> 

 - Move the new invalid DE directory to a backup directory: <DE_HOME>/.acsi_<hostname> 

 - Create a soft link to the "good" DE install 

 cd <DE_HOME> 

 ln -s <DE_HOME>/.acsi_<FQDN> .acsi_<hostname> 

 - Confirm the link was created successfully, it should look like this: 
> ls -lart 
lrwxrwxrwx 1 nc_admin ncoadmin <date> .acsi_<hostname> -> <DE_HOME>/.acsi_<FQDN> 

 
3) Retry the product install. You will need to confirm there is no required cleanup before retrying the Product upgrade.