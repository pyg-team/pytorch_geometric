Title: IBM The preproduction plan is getting bigger. - United States

Text:
LTP; preproduction plan; transaction; AWSJDB801E; AWSJPL720E TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 During UpdateStats job, the error AWSJPL720E sometimes can be written into SystemOut.log. 

SYMPTOM
In UpdateStats job, logman tries to remove completed and obsolete instances from the preproduction plan. If logman tries to remove too many records at one time, the transaction log for the database can be full and it can fail to remove them with the following error messages in SystemOut.log. 

00007849 ExceptionMapp E AWSJDB801E An internal error has been found while accessing the database. Internal error message is: "The transaction log for the database is full."

00007849 LTPPlanManage E AWSJPL720E An error occurred when the planner tried to remove completed and obsolete instances from the preproduction plan. 


RESOLVING THE PROBLEM
This situation can occur if you cancel old not complete job stream instances by conman cancel command. As Reference Guide explains, if first not complete job stream instance (FNCJSI) is older than 7 days from the start time of the new production plan, all job stream instances younger than FNCJSI are kept in the preproduction plan. 

 

In other words, for example, if FNCJSI was scheduled 3 months ago, all the job stream instances for 3 months are kept in it. Under this kind of situation, if you cancel FNCJSI by conman cancel command, logman in UpdateStats will try to remove so many complete and obsolete instances from the preproduction plan. 

 

This will sometimes cause the transaction log full for the database and logman will fail to remove them. If the logman in UpdateStats fails to remove them everyday due to the transaction log full, the preproduction plan size can keep increasing. 

 

If the preproduction plan size becomes too large, makeplan will also fail to extend the preproduction plan due to the transaction log full or temporary table space full. 

 

In these reasons, you should try not to keep too old not completed job stream instances in Symphony file. 


You can also check the First Not Completed Job stream instance using "planman showinfo" command, the field is: "Start time of first not complete preproduction plan job stream instance".

If you encounter the error AWSJPL720E, you need to increase the transaction log file size or you need to delete unnecessary records from the preproduction plan manually. 
For example, if you want to delete all the job stream instances scheduled on Sep 1 in 2009 from the preproduction plan, you can run the following SQL.

delete from MDL.JSI_JOB_STREAM_INSTANCES where JSI_START_TIME between '2009-09-01-00.00.00.000000' and '2009-09-01-23.59.00.000000'

In order to carefully decide which record should be manually deleted, you should consult with IBM Tivoli Support in case you encounter the error.