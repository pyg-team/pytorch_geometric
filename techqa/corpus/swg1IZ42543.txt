Title: IBM IZ42543: ABSTRACT: AGGREGATE CPU STATISTICS ON A SHARED AIX LPAR DO NOT MATCH WITH MPSTAT, VMSTAT AND LPARSTAT. - United States

Text:
  FIXES ARE AVAILABLE
IBM Tivoli Monitoring: Unix(R) OS Agent 6.1.0.7-TIV-ITM_UNIX-IF0006 [http://www-01.ibm.com/support/docview.wss?uid=swg24022696]
IBM Tivoli Monitoring: Unix(R) OS Agent 6.2.1.0-TIV-ITM_UNIX-IF0002 [http://www-01.ibm.com/support/docview.wss?uid=swg24022794]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  Approver: dpr
   
   Environment: Unix OS Agent 6.1 FP7 running on a shared AIX LPAR
   with
   multiple logical CPUs.
   
   
   Problem Description: The aggregate CPU statistics "User CPU
   (Percent)",
   "System CPU (Percent)", "Idle CPU (Percent)" and "Wait I/O
   (Percent)"
   that belong to the "System" attribute group do not match with
   the
   corresponding metrics of the AIX commands mpstat, vmstat and
   lparstat.
   In particular, the Unix OS Agent aggregates the CPU statistics
   by
   averaging over the number of logical CPUs, whereas the mpstat,
   vmstat
   and lparstat take into account further partition data such as
   the
   entitled CPU capacity.
   
   
   Detailed Recreation Procedure:
   1. Launch a Unix Os Agent on an shared LPAR with AIX 5.3 onward.
   2. Create an historical data collection on the attributes "User
   CPU
   (Percent)", "System CPU (Percent)", "Idle CPU (Percent)" and
   "Wait I/O
   (Percent)" belonging to the "System" attribute group, with a
   collection
   interval of 30s
   3. Launch in sync with the historical data collection the
   command
   "mpstat 30", that samples performance statistics with an
   interval of
   30s.
   4. Generate some CPU activity.
   5. Compare the Unix Os agent metrics with the aggregate metrics
   shown
   in the ALL row and under the "us", "sys", "id" and "wt" columns
   of the
   "mpstat 30" output.
   
   
   Related Files and Output: Set the following trace level in order
   to
   follow the agent activity: KBB_RAS1=ERROR (UNIT:stat_daemon ALL)
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  The aggregate CPU statistics "User CPU (Percent)", "System CPU
   (Percent)", "Idle CPU (Percent)" and "Wait I/O (Percent)" that
   belong to the "System" attribute group do not match with the
   corresponding metrics of the AIX commands mpstat, vmstat and
   lparstat.  In particular, the Unix OS Agent aggregates the CPU
   statistics by averaging over the number of logical CPUs, whereas
   the mpstat, vmstat and lparstat take into account further
   partition data such as the entitled CPU capacity.
   
   
    
   
   

PROBLEM CONCLUSION
 *  The fix for this APAR is included in the following maintenance
   vehicle:
   
      | fix pack | 6.2.0-TIV-ITM-FP0003 |
   
   Note: Search the IBM technical support web site for maintenance
   package availability.
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IZ42543
   
   
 * REPORTED COMPONENT NAME
   ITM AGENT UNIX
   
   
 * REPORTED COMPONENT ID
   5724C040U
   
   
 * REPORTED RELEASE
   610
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2009-01-26
   
   
 * CLOSED DATE
   2009-03-31
   
   
 * LAST MODIFIED DATE
   2009-03-31
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   ITM AGENT UNIX
   
   
 * FIXED COMPONENT ID
   5724C040U
   
   

APPLICABLE COMPONENT LEVELS
 * R610 PSY
   UP