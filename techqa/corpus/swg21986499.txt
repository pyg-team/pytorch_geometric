Title: IBM MustGather: Collecting Data for IBM Case History/Case Visualizer 5.2.x issues - United States

Text:
Trace logs; performance TECHNOTE (FAQ)

QUESTION
 What information should be collected when I experience a problem with IBM Case History/Case Visualizer component of the IBM Case Manager 5.2? 

ANSWER
Must Gather for the IBM Case History/Case Visualizer 5.2.x software 


Collecting data before calling IBM support will help you understand the problem and save time analyzing the data. 


Collecting data early, before opening the PMR, helps IBM® Support quickly determine if: 
• Symptoms match known problems (rediscovery). 
• There is a non-defect problem that can be identified and resolved. 
• There is a defect that identifies a workaround to reduce severity.

Locating the root cause of a problem can speed development of a code fix. 



Describing the Problem 


This background information is needed for opening a PMR, but is not gathered by the data collector: 
• How often does this problem occur? 
• Can the problem be reproduced? And if so, how is it reproduced? 
• How many users are affected by this problem? 
• Is the problem in newly exercised functionality? Or was this previously working and now it's stopped working? 
• What, if anything, has been changed? 
• What is the business impact of this problem? 
• Is there a workaround? 


Gathering Operating System Versions, Settings and Logs 

These commands collect: 
• OS Version 
• OS Environment Variables 
• OS Kernel parameters 
• OS running processes 
• OS networking information 
• OS locale information 
• OS log files 

Run the following commands on the Content Foundation Content Platform Engine server and collect the output: 


AIX Servers 

Command​ Collects​ /usr/sbin/instfix -ivq ​ OS Patches or Maintenance level​ env ​ OS Environment Variables​ errpt -a​ OS Configuration & Error Reporting​ /usr/sbin/lsattr -E -l sys0 ​ OS Kernel parameters​ ps -ef​ currently running processes​ netstat -an​ socket information​ locale​
locale -a​ locale information​ /var/adm/syslog/syslog.log​ include system log files​ 

Solaris Servers Command​ Collects​ /usr/bin/showrev -a ​ OS Patches or Maintenance level​ env ​ OS Environment Variables​ /usr/sbin/prtdiag -v ​ OS Configuration & Error Reporting​ /usr/sbin/sysdef -D ​
/usr/bin/getconf -a​ OS Kernel parameters​ ps -ef​ currently running processes​ netstat -an​ socket information​ locale​
locale -a​ locale information​ /var/adm/messages & /var/log/syslog​ include system log files​ 


Windows Servers Command​ Collects​ WMIC /OUTPUT:C:\ProcessList.txt PROCESS get Caption,Processid,Usermodetime,Commandline​ current running processes including the command line​ set​ OS Environment Variables​ Windows 2003: ​
cscript C:\windows\system32\eventquery.vbs ​
/L application /R 1000 /V ​
cscript C:\windows\system32\eventquery.vbs ​
/L system /R 1000 /V ​
​
Windows 2008 and newer:​
wevtutil epl System Systemlog.evtx​
wevtutil epl Application Applicationlog.evtx​ OS Event Logs​ netstat -an​ socket information​ chcp​ display code page​ 


Linux Servers Command​ Collects​ uname -a​ OS Version​ /usr/bin/showrev -a ​ OS Patches or Maintenance level​ env ​ OS Environment Variables​ /usr/sbin/prtdiag -v ​ OS Configuration & Error Reporting​ /usr/sbin/sysdef -D ​
/usr/bin/getconf -a ​ OS Kernel parameters​ /usr/bin/getconf -a​ configuration info​ /bin/dmesg​ messages​ ps -ef​ currently running processes​ netstat -an​ socket information​ locale​
locale -a​ locale information​ /var/log/messages.*​ include system log files​ 


Ping pages for supporting components: 

Because the Case History interacts with the Content Platform Engine, Case Manager, Content Navigator and Case Foundation, it is useful to collect their ping pages to make sure that all the components have the same client versions. 

For Content: http://<cpe-server name>:<cpe-port #>/FileNet/Engine 
For Process: http://<cpe-server name>:<cpe-port #>/peengine/IOR/ping 
For Case Manager: http://<server name>:<port #>/CaseManager/CASEREST/v1/in 
For Content Navigator: http://<icn-server name>:<icn-port #>/navigator/Ping 


Collect the following database information for Case History installation and configuration issues: 

• Database type 
• Database version 
• Local or remote database. 
• Joint or Separate database instance from Target Object Store 


Case History Logs and Traces 

The main log where Case History information is logged is the pesvr_system.log file which can be found under a location similar to the following: 

...\WebSphere\AppServer\profiles\AppSrv01\FileNet\server1\pesvr_system.log 

Depending on the issue you are troubleshooting you will need to enable vwtool tracing. To enable the tracing follow the steps detailed in the link below: 
http://www-01.ibm.com/support/docview.wss?uid=swg21678454 [http://www-01.ibm.com/support/docview.wss?uid=swg21678454] 
Enable the following tracing options:
• Case History Publishing (Trace the Case History event publishing process) 
• Case History Collect (Trace the event collection process which queries the event logs) 
• Case History Database (Trace the database query statements that are run by Case History) 
• Case History RPC (Trace the remote procedure calls from the Administration Console for Content Platform Engine)
• Case History Performance (Trace Case History Performance) 
• Case History Upgrade (Trace the Case History upgrade operation)



Logs: 


Application server logs
Should the issue be related to not being able to see the Case Visualizer data in a Case or issues with the Case Visualizer widget collect the following IBM Case Manager Client log. The IBM® Case Manager Client records log messages to the IBM Content Navigator log file. To configure debug level logging for IBM® Case Manager web applications, you must enable debugging on the IBM Content Navigator server and restart the IBM Content Navigator server. 


Procedure: 
To configure logging settings in IBM Content Navigator: 
1. Log in to the IBM Content Navigator administration desktop. 
2. Click the Settings tab and then click the Logging subtab. 
3. Set the logging level for the applications to Debug. 
4. Click Save and then click Close. 
5. Log out of the IBM Content Navigator administration desktop. 
6. Restart the application server instance where IBM Content Navigator is deployed.

The IBM® Case Manager Client records log messages to the IBM Content Navigator log file. 

For further information about log files in IBM Content Navigator, see the IBM Content Navigator documentation: http://pic.dhe.ibm.com/infocenter/cmgmt/v8r4m0/topic/com.ibm.installingeuc.doc/eucts002.htm [http://pic.dhe.ibm.com/infocenter/cmgmt/v8r4m0/topic/com.ibm.installingeuc.doc/eucts002.htm] 

WebSphere Application Server 
In WebSphere® Application Server, all logging information is written to the SystemOut.log file. By default, this log file is in the following subdirectory of the WebSphere Application Server installation directory: 

WAS_profile_location/logs/server/


Additional data collection: 

 
In order to identify whether the issue is with Case History data collection, run the following database queries and collect the output.

Capture the output of the following SQL statements at the same time. 


From the CE database:
- select max(audit_sequence) FROM Event


From the PE database collect the output of the below statements for each of the event logs on the system:
- select max(F_SeqNumber) FROM VWLog1_111 
- select count(F_SeqNumber) FROM WVL1_111 where F_SeqNumber > 123456789
(Note: 123456789 is an example value. Please set the value that is seen in the CH_X_PEEventState table to run the query.)

From the Case History database:
- select * from CH_X_PEEventState
- select * from CH_X_CEEventState


Check the indexes on CE log tables:

To understand if there any performance issues, check if the following index exists for the Event table on the CE database:
i3 on event (u<xy>_CMACMCASEFOLDER, AUDIT_SEQUENCE desc) 


This database retrieval index efficiently retrieves the case history in the Event table in target object stores.

Maintain the PE Event log tables:

Make sure maintenance is being carried out on a regular basis on the PE Event log tables to prevent performance issues with Case History:
http://www-01.ibm.com/support/docview.wss?uid=swg27036649 [http://www-01.ibm.com/support/docview.wss?uid=swg27036649]


Screenshots: 

 
It may be appropriate to include screenshots of errors or other symptoms that will help us understand the problem.