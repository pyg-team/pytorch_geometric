Title: IBM Rule Execution Server diagnostics failure - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 When running the diagnostics in the Rule Execution Server console, the test "Rule Session Second Execution" fails with a "java.lang.IllegalStateException: Not all XUs have been updated with the new ruleset" error. 

SYMPTOM
When you run the diagnostics in the Rule Execution Server console, the test "Rule Session Second Execution" fails with the following error: 

java.lang.IllegalStateException: Not all XUs have been updated with the new ruleset.
at ilog.rules.res.console.diagnostic.IlrConsoleDiagnostic.testRuleSessionSecondExecution(IlrConsoleDiagnostic.java:395)
at ilog.rules.res.console.diagnostic.IlrConsoleDiagnostic.execute(IlrConsoleDiagnostic.java:120)
at ilog.rules.res.console.jsf.bean.DiagnosticBean.execute(DiagnosticBean.java:56)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at org.apache.myfaces.el.MethodBindingImpl.invoke(MethodBindingImpl.java:132)
at org.apache.myfaces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:61)
at javax.faces.component.UICommand.broadcast(UICommand.java:109)
at javax.faces.component.UIViewRoot._broadcastForPhase(UIViewRoot.java:97)
at javax.faces.component.UIViewRoot.processApplication(UIViewRoot.java:171)
at org.apache.myfaces.lifecycle.InvokeApplicationExecutor.execute(InvokeApplicationExecutor.java:32)
at org.apache.myfaces.lifecycle.LifecycleImpl.executePhase(LifecycleImpl.java:95)
at org.apache.myfaces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:70)
at javax.faces.webapp.FacesServlet.service(FacesServlet.java:139)
...


DIAGNOSING THE PROBLEM
Review the application server logs for more information on what causes the error.


RESOLVING THE PROBLEM
This Rule Execution Server diagnostic error can occur in a number of circumstances. The following is a non-exhaustive list of scenarios that could lead to this issue: 

 

 * The XU has not been called before the Rule Execution Server diagnostics ran:
   
   On WebSphere Application Server, the pool size is not instantiated beforehand and therefore prevents the server diagnostics from validating a Rule Execution Server before the first execution of a rule engine. In this case, the eXecution Unit (XU) might not have been initialized before the diagnostics are run, and hence the error is expected. For more information, refer to the following document for WebSphere Application Server:
   Installing Rule Execution Server > Verifying the Rule Execution Server installation [http://publib.boulder.ibm.com/infocenter/brjrules/v7r1/topic/com.ibm.websphere.ilog.jrules.install.doc/Content/Business_Rules/Documentation/_pubskel/JRules_Application_Servers/ps_Installing_JRules_IC97.html]
   
   If you work with a cluster, the following document might be useful:
   Warnings in diagnostics before first execution in a Rule Execution Server XU cluster [http://www.ibm.com/support/docview.wss?uid=swg21443038]
   
   
 * The application security is not enabled in WebSphere Application Server: 
   
   If working with WebSphere Application Server, make sure that you enable application security, as explained in the documentation under WebSphere ILOG JRules BRMS V7.1: Java EE add-ons > Installing on WebSphere Application Server > Installing Rule Execution Server > Installing Rule Execution Server on WebSphere Application Server V7.0 > Activating security on WebSphere V7.0 > Creating users and groups [http://publib.boulder.ibm.com/infocenter/brjrules/v7r1/topic/com.ibm.websphere.ilog.jrules.install.doc/Content/Business_Rules/Documentation/_pubskel/JRules_Application_Servers/ps_Installing_JRules_IC51.html]. 
   Failing to enable application security results in errors whose root cause (last "Caused by:" entry in the stack trace) is "javax.management.JMRuntimeException: ADMN0022E: Access is denied for the getAdapterVersion operation on IlrXUManagement MBean because of insufficient or empty credentials." 
   To fix the issue, activate application security as explained in the documentation above, map the users to the required roles when deploying the EAR [http://publib.boulder.ibm.com/infocenter/brjrules/v7r1/topic/com.ibm.websphere.ilog.jrules.install.doc/Content/Business_Rules/Documentation/_pubskel/JRules_Application_Servers/ps_Installing_JRules_IC54.html], and restart the server.
   You should then be prompted for a login/password to sign in to the Rule Execution Server console. Note that if you did not set the proper mapping, you will get the error described in the document Authorization failed, Not granted any of the required roles [http://www.ibm.com/support/docview.wss?uid=swg21578192] when logging in.
   
   
 * The application server security is enabled but the Rule Execution Server users do not have the required administrative roles: 
   
   If working with WebSphere Application Server or WebLogic, you must provide some level of administrative role to the Rule Execution Server admin user so that that user can access MBeans. 
   For WebSphere Application Server, refer to technote "Rule Execution Server diagnostic MBean execution fails on WAS [http://www.ibm.com/support/docview.wss?uid=swg21461650]". For WebLogic, refer to technote "Rule Execution Server diagnostic MBean execution fails on WL [http://www.ibm.com/support/docview.wss?uid=swg21589169]".
   
   
 * Asynchronous parsing is enabled and the database connection is slow: 
   
   This issue has been addressed by APAR RS00286 [http://www.ibm.com/support/docview.wss?uid=swg1RS00286] and has been fixed in JRules 7.1 onwards. In earlier versions, as a workaround, set the asynchronousRulesetParsing parameter to false before running the Rule Execution Server diagnostics. 


If the above scenarios do not apply to you, please contact IBM support with the Rule Execution Server console log, the server logs (including the FFDC logs if you work with WebSphere Application Server), and all environmental details, including whether Rule Execution Server is deployed on a cluster. RELATED INFORMATION
 Reporting a problem with JRules Rule Execution Server [http://www.ibm.com/support/docview.wss?uid=swg21470178]
Rule Execution Server LDAP configuration on WebLogic [http://www.ibm.com/support/docview.wss?uid=swg21497512]
"Not granted any of the required roles" error [http://www.ibm.com/support/docview.wss?uid=swg21578192]
Configure security for JRules modules on WAS [http://www.ibm.com/support/docview.wss?uid=swg21439999]
Diagnostics warnings in RES XU cluster [http://www.ibm.com/support/docview.wss?uid=swg21443038]
External authentication & authorization with JRules [http://www.ibm.com/support/docview.wss?uid=swg21420910]
Access is denied for the getGlobalLogs operation [http://www.ibm.com/support/docview.wss?uid=swg21588856]


 


Cross reference information Segment Product Component Platform Version Edition Business Integration IBM Operational Decision Manager Modules:Execution Server Platform Independent 8.8, 8.7, 8.6, 8.5, 8.0, 7.5