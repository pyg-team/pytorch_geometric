Title: IBM JMS error CWSIS1535E 'The messaging engine's unique id does not match that found in the data store' - United States

Text:
JMS; error CWSIS1535E; Messaging Engine; Unique ID; Data Store; UUID TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 After Server/Appliance start, you might notice all requests going to Pending state and there are JMS errors in the logs. 

SYMPTOM
During messaging Engine (ME) startup the following message appears in the SystemOut.log and the ME startup fails:

CWSIS1535E: The messaging engine's unique id does not match that found in the data store. ME_UUID=C5E55A906866B3BA, ME_UUID(DB)=A83FF2EEF9214367

NOTE: The UUID values above will be different from yours but the format will be the same.


CAUSE
This problem occurs if you delete and recreate a ME without also deleting and recreating its associated message store. 

This can be for example caused by:

- restoring ISIM database backup which is not in sync with current ME
- switching to ISIM database in HA/DR configuration which is not in sync with ME
- configuring automatic statistics collection (RUNSTATS) for the ISIM database (please note that per 'ITIM/ISIM Performance tuning guides' SIBOWNER table should be excluded from RUNSTATS for JMS to operate properly)

DIAGNOSING THE PROBLEM
In a correct clustered ITIM installation the "itim_bus" SIBus has:

- 2 (two) bus members, that are the ITIM application cluster and the ITIM messaging cluster

- 1 (one) messaging engine (ME) for the ITIM messaging cluster bus member; this ME is created by default when the ITIM messaging cluster is added in the members list of itim_bus and is named:

<messaging_cluster_name>.000-itim_bus

- <n> messaging engines (ME) for the ITIM application cluster bus member, where <n> is the number of application servers which are members of the application server; these MEs are named:

<application_cluster_name>.000-itim_bus
<application_cluster_name>.001-itim_bus
.................
<application_cluster_name>.0<i><j>-itim_bus

(where <i> and <j> are the two digits representing number <n>-1 in a two digit representation).

The ME <messaging_cluster_name>.000-itim_bus starts on a single application server member of the ITIM messaging cluster (it is the first available cluster member which completed its initialization).
So only one member of the messaging cluster will have in the SystemOut.log the message:

CWSID0016I: Messaging engine <messaging_cluster_name>.000-itim_bus is in state Started

If this server goes down, the ME is started on another node of the messaging cluster.

On the other hand, each member of the ITIM application cluster starts a single distinct ME among the <n> ones defined for the ITIM application cluster bus member.
So each member of the application cluster will have in its SystemOut.log the message:

CWSID0016I: Messaging engine <application_cluster_name>.0<i><j>-itim_bus is in state Started

Normal ME startup sequence example as seen in the SystemOut.log:

SibMessage I [itim_bus:ISIMVa_Application_Cluster.000-itim_bus] CWSID0016I: Messaging engine ISIMVa_Application_Cluster.000-itim_bus is in state Joined.
SibMessage I [itim_bus:ISIMVa_Application_Cluster.000-itim_bus] CWSID0016I: Messaging engine ISIMVa_Application_Cluster.000-itim_bus is in state Starting.
SibMessage I [itim_bus:ISIMVa_Application_Cluster.000-itim_bus] CWSIS1538I: The messaging engine, ME_UUID=C6CEFC91373689EB, INC_UUID=471B7EDF5EAD45B0, is attempting to obtain an exclusive lock on the data store.
SibMessage I [itim_bus:ISIMVa_Application_Cluster.000-itim_bus] CWSIS1545I: A single previous owner was found in the messaging engine's data store, ME_UUID=C6CEFC91373689EB, INC_UUID=76D9CC4154E0311D
SibMessage I [itim_bus:ISIMVa_Application_Cluster.000-itim_bus] CWSIS1537I: The messaging engine, ME_UUID=C6CEFC91373689EB, INC_UUID=471B7EDF5EAD45B0, has acquired an exclusive lock on the data store.
SibMessage I [itim_bus:ISIMVa_Application_Cluster.000-itim_bus] CWSIP0212I: Messaging engine ISIMVa_Application_Cluster.000-itim_bus on bus itim_bus is starting to reconcile the WCCM destination and link configuration.
SibMessage I [itim_bus:ISIMVa_Application_Cluster.000-itim_bus] CWSID0016I: Messaging engine ISIMVa_Application_Cluster.000-itim_bus is in state Started.

Failed ME startup sequence example as seen in the SystemOut.log:

SibMessage I [itim_bus:ISIMVa_Application_Cluster.001-itim_bus] CWSID0016I: Messaging engine ISIMVa_Application_Cluster.001-itim_bus is in state Joined.
SibMessage I [itim_bus:ISIMVa_Application_Cluster.001-itim_bus] CWSID0016I: Messaging engine ISIMVa_Application_Cluster.001-itim_bus is in state Starting.
SibMessage I [itim_bus:ISIMVa_Application_Cluster.001-itim_bus] CWSIS1538I: The messaging engine, ME_UUID=C5E55A906866B3BA, INC_UUID=68C0212682897E09, is attempting to obtain an exclusive lock on the data store.
SibMessage I [itim_bus:ISIMVa_Application_Cluster.001-itim_bus] CWSIS1545I: A single previous owner was found in the messaging engine's data store, ME_UUID=A83FF2EEF9214367, INC_UUID=12409867355ABEA5
SibMessage E [itim_bus:ISIMVa_Application_Cluster.001-itim_bus] CWSIS1535E: The messaging engine's unique id does not match that found in the data store. ME_UUID=C5E55A906866B3BA, ME_UUID(DB)=A83FF2EEF9214367
SibMessage I [itim_bus:ISIMVa_Application_Cluster.001-itim_bus] CWSIS1593I: The messaging engine, ME_UUID=C5E55A906866B3BA, INC_UUID=68C0212682897E09, has failed to gain an initial lock on the data store.
SibMessage I [itim_bus:ISIMVa_Application_Cluster.001-itim_bus] CWSID0016I: Messaging engine ISIMVa_Application_Cluster.001-itim_bus is in state Stopping.
SibMessage I [itim_bus:ISIMVa_Application_Cluster.001-itim_bus] CWSID0016I: Messaging engine ISIMVa_Application_Cluster.001-itim_bus is in state Stopped.

RESOLVING THE PROBLEM
Clear out the Service Integration Bus:


- for ISIM 5.x or 6.0, please follow at least steps 2., 3., 5. and 7. from technote "Technique for removing pending transactions from an ISIM 5.x or 6.0 system",
- for ISIM 7.0 please follow at least steps 3. and 4. from "Reconfiguring the data store connection" section of ISIM 7 Configuring topics.

RELATED INFORMATION
 ITIM 5.x Performance Tuning Guide [http://www-01.ibm.com/support/docview.wss?uid=swg27011444]
ISIM 6.0-7.0 Performance Tuning Guide [http://www-01.ibm.com/support/docview.wss?uid=swg27036205]
Technique for removing pending transactions [http://www-01.ibm.com/support/docview.wss?uid=swg21380384]
Reconfiguring the data store connection [http://www-01.ibm.com/support/knowledgecenter/SSRMWJ_7.0.1/com.ibm.isim.doc/configuring/tsk/t_reconfiguring_datastore.htm]