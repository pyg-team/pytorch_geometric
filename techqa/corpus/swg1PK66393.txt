Title: IBM PK66393: ACCESSDENIEDEXCEPTION RENDERING PROFILECMPNT WHEN CURRENT USER DOESN'T HAVE ACCESS TO CURRENT ITEMS CATEGORIES - United States

Text:
  FIXES ARE AVAILABLE
6.1.0.1 Download: WebSphere Portal and Web Content Management V6.1, fix pack 1 [http://www-01.ibm.com/support/docview.wss?uid=swg24020387]
6.1.0.2 Download: WebSphere Portal and Web Content Management V6.1, fix pack 2 [http://www-01.ibm.com/support/docview.wss?uid=swg24022898]
6.1.0.3 Download: WebSphere Portal and WCM V6.1 fix pack 3, 6.1.5 feature pack [http://www-01.ibm.com/support/docview.wss?uid=swg24025054]
6.1.0.4 Download: WebSphere Portal and WCM V6.1.0 fix pack 4 & 6.1.5 fix pack 1 [http://www-01.ibm.com/support/docview.wss?uid=swg24026394]
6.1.0.5 Download: WebSphere Portal and WCM V6.1.0 fix pack 5 [http://www-01.ibm.com/support/docview.wss?uid=swg24027475]
6.1.0.6 Download: WebSphere Portal and WCM V6.1.0 fix pack 6 [http://www-01.ibm.com/support/docview.wss?uid=swg24030970]



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  If the current user doesn't have access to any of the categories
   selected on a site, site area or content item and a profileCmpnt
   tag is used to render that items categories then the following
   exception can occur:
   
   com.ibm.workplace.wcm.services.repository.RepositoryException:
   IWKMU1062X: Message: Retrieval of obects from repository failed
   with error com.ibm.icm.jcr.access.AccessDeniedException: The
   requested operation violates one or more access constraints.,
   Cause: com.ibm.icm.jcr.access.AccessDeniedException: The
   requested operation violates one or more access constraints.
      at
   com.ibm.workplace.wcm.services.query.CoreQueries.findAncestorIds
   (CoreQueries.java(Compiled Code))
      at
   com.ibm.workplace.wcm.services.query.CoreQueries.findCategoryAnc
   estorIds(CoreQueries.java(Compiled Code))
      at
   com.aptrix.pluto.cmpnt.ProfileCmpnt.getExpandedCategoryIds(Profi
   leCmpnt.java(Compiled Code))
      at
   com.aptrix.pluto.cmpnt.ProfileCmpnt.createCategoriesDisplayCmpnt
   (ProfileCmpnt.java(Inlined Compiled Code))
   Caused by: com.ibm.icm.jcr.access.AccessDeniedException: The
   requested operation violates one or more access constraints.
      at
   com.ibm.icm.jcr.NodeImpl.checkPermissions(NodeImpl.java(Compiled
   Code))
      at
   com.ibm.icm.jcr.WorkspaceImpl.getNodeByUuid(WorkspaceImpl.java(C
   ompiled Code))
      at
   com.ibm.icm.jcr.WorkspaceImpl.getNodeByUuid(WorkspaceImpl.java(C
   ompiled Code))
      ... 43 more
   
   Not displaying the ascendants and descendants of the selected
   categories, ie. setting include="exact" (or not specifying the
   include attribute) will avoid the error, however it would result
   in the secured category being returned which is also incorrect.
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  The ProfileCmpnt class wasn't checking that the current user had
   access to each category before it retrieved the ascendants
   and/or descendants of it, and additionally was returning
   categories that the current user didn't have access to.
   
   
    
   
   

PROBLEM CONCLUSION
 *  The ProfileCmpnt class was modified to exclude from processing
   (and hence from rendering), any categories that the current user
   doesn't have access to.
   
   An interim fix is available from Fix Central at:
   
   6.0.1.3
   
   http://www.ibm.com/eserver/support/fixes/fixcentral/swgquickorde
   r?brandid=2&productid=Workplace%20Web%20Content%20Management&fix [http://www.ibm.com/eserver/support/fixes/fixcentral/swgquickorder?brandid=2&productid=Workplace%20Web%20Content%20Management&fix]
   es=6.0.1.3-WCM-PK66393
   
   You will need to cut/paste the entire URL to resolve the above
   address.
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PK66393
   
   
 * REPORTED COMPONENT NAME
   WRKPLC WEB CON
   
   
 * REPORTED COMPONENT ID
   5724I2900
   
   
 * REPORTED RELEASE
   60F
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2008-05-21
   
   
 * CLOSED DATE
   2008-05-28
   
   
 * LAST MODIFIED DATE
   2008-06-25
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WRKPLC WEB CON
   
   
 * FIXED COMPONENT ID
   5724I2900
   
   

APPLICABLE COMPONENT LEVELS
 * R60F PSY
   UP