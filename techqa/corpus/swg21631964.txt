Title: IBM WAS migration error on FIPS environment - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Error after migrating WebSphere Application Server from Version 6.1 to 7.0 

SYMPTOM
After migrating WebSphere Application Server from Version 6.1 to Version 7.0 on a FIPS enabled Tivoli Provisioning Manager Server, when you want to verify the status by running the command: 

TIO_HOME/tools/tioStatus.cmd | sh

the following error is displayed:

Caused by: com.thinkdynamics.kanaha.util.exception. CryptoException: 
COPCOM624E JVM is not configured for FIPS 140-2 compliance. Check the order of the cryptographic providers in the java.security configuration file and ensure that the IBMJCEFIPS provider is listed before the IBMJCE provider. 


ENVIRONMENT
Tivoli Provisioning Manager Server with FIPS enabled.


DIAGNOSING THE PROBLEM
When WebSphere Application Server Version 6.1 is migrated to WebSphere Application Server Version 7.0 on Tivoli Provisioning Manager 7.2.1, by default JVM is not configured for the FIPS 140-2 compliance. For this reason, after the migration you must manually change some settings in 


<WAS_HOME>/java/jre/lib/security/java.security 

to make it FIPS 140-2 compliant.

where WAS_HOME is: 

Linux: /opt/IBM/WebSphere/AppServer1/ 
Windows: C:\Program Files\IBM\WebSphere\AppServer1\ 



RESOLVING THE PROBLEM
After running successfully the migration script, perform the following changes in the 

 WAS_HOME/java/jre/lib/security/java.security file: 

1) Verify IBMJCEFIPS is listed as first service provider: 
security.provider.1=com.ibm.crypto.fips.provider.IBMJCEFIPS 

2) Renumber other service providers after adding above IBMJCEFIPS service provider: 

security.provider.2=com.ibm.crypto.provider.IBMJCE 
security.provider.3=com.ibm.jsse.IBMJSSEProvider 
security.provider.4=com.ibm.jsse2.IBMJSSEProvider2 
security.provider.5=com.ibm.security.jgss.IBMJGSSProvider 

3) Edit policy provider by changing: 
policy.provider=org.apache.harmony.security.fortress.DefaultPolicy 
to 
policy.provider=<value specified in WAS_BACKUP/java/jre/lib/security/java.security> 

where WAS_BACKUP is: 

Linux: /opt/IBM/WebSphere/BackUpFolder/ 
Windows: C:\Program Files\IBM\WebSphere\BackUpFolder\ 

4) Edit keystore type by changing: 
keystore.type=jks 
to 
keystore.type=<value specified in WAS_BACKUP/java/jre/lib/security/java.security> 

5) Edit system scope by changing: 
system.scope=org.apache.harmony.security.SystemScope 
to 
system.scope=<value specified in WAS_BACKUP/java/jre/lib/security/java.security> 

6) Edit TrustManager algorithm by changing: 
ssl.TrustManagerFactory.algorithm=PKIX 
to 
ssl.TrustManagerFactory.algorithm=<value specified in WAS_BACKUP/java/jre/lib/security/java.security> 

7) Verify that networkaddress.cache.ttl is set to correct value: 
networkaddress.cache.ttl=<value specified in WAS_BACKUP/java/jre/lib/security/java.security>

8) Verify that networkaddress.cache.negative.ttl is set to correct value: 
networkaddress.cache.negative.ttl=<value specified in WAS_BACKUP/java/jre/lib/security/java.security> 

9) Start Tivoli Provisioning Manager: tio.cmd|sh start -t