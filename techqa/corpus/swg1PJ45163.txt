Title: IBM PJ45163: CSS DUMPINDEX "ISDELETED" COMMAND ALWAYS REPORTS "NO DOCUMENT WITH DOC ID '{#####}' FOUND" - United States

Text:
 SUBSCRIBE TO THIS APAR
By subscribing, you receive periodic emails alerting you to the status of the APAR, along with a link to the fix after it becomes available. You can track this item individually or track all items by product.

Notify me when this APAR changes.

Notify me when an APAR for this component changes.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  CSS dumpIndex "isDeleted" command always reports "No document
   with Doc ID '{#####}' found".
   
   Customer reporting an issue with the DumpIndex tool specifically
   the isDeleted command that it doesn't return correctly.
   Customer wanted to compare what's in the index with which
   documents exist in the objectstore.
   This how he ran it:
   
   dumpIndex
   \\CSSservername\ecmfnce01p_csscollections\CSSCollections\GP_ECM_
   HQSTAX_Document_20180107193315_9CEFC9865998475D86B74CCBE3DB8BD0
   To find a list of documents with the search term that he used
   the search command:
   search asdf
   which gives him a list of 20 documents.
   
   The one in question for him is
   {822600E5-9CD8-4EAC-B1D9-2DF8321ED8D3}
   It shows up under Index Doc ID 1405573:
   Index Doc ID        Doc ID
   ----------------------------------------
   1405573             {822600E5-9CD8-4EAC-B1D9-2DF8321ED8D3}
   And he verified that the document exists in the CE and can be
   viewed or downloaded.
   
   However, when he run the isDeleted command, he get the
   following:
   > isDeleted {822600E5-9CD8-4EAC-B1D9-2DF8321ED8D3}
   No document with Doc ID '{822600E5-9CD8-4EAC-B1D9-2DF8321ED8D3}'
   found.
   
   He has tried without curly braces, with curly braces and without
   the dash and none worked.
   
   I am able to reproduce the same on CPE/ CSS 5.2.1.5. Please
   advise if we've entered the syntax wrong or if this is a defect
   on the tool.
   I would expect it to find the document, though it returns
   immediately, so I don't think it's ever searching.
   
   
   Steps to Reproduce:
   1. Run CSS dumpIndex tool
   2. run isDeleted with any valid doc id as argument (e.g.
   isDeleted {822600E5-9CD8-4EAC-B1D9-2DF8321ED8D3} )
   
      Actual Results: Always reports "No document with Doc ID
   '{#####}' found"
   
      Expected Results: Report if the document is deleted or not.
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED:                                              *
   * Users of 5.2.1.7-P8CSS-FP007 and 5.5.0.0-P8CSS and prior     *
   * releases.                                                    *
   ****************************************************************
   * PROBLEM DESCRIPTION:                                         *
   * The CSS dumpIndex utility tool failed to execute the         *
   * "isDeleted" command, entering isDeleted with a valid         *
   * document id would always report " No document with Doc ID    *
   * '{xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxxx}' found." for the    *
   * any document id entered.                                     *
   * Note: In verifying/fixing this issue we determined this same *
   * problem would occur for the dumpTokenVector, and getNorms    *
   * commands also.                                               *
   ****************************************************************
   * RECOMMENDATION:                                              *
   * Upgrade to 5.2.1.7-P8CSS-IF001 or 5.5.1.0-P8CSS or higher.   *
   ****************************************************************
   
   
    
   
   

PROBLEM CONCLUSION
 *  Fixed in 5.2.1.7-P8CSS-IF001 and 5.5.1.0-P8CSS and higher.
   
   The dumpIndex tool did not properly convert the document id to a
   base64 encoded URI which is required for directly accessing the
   document via the Lucene API. The isDeleted, dumpTokenVector,
   getNorms methods were all fixed to base64 encode the document id
   and now function as designed.
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PJ45163
   
   
 * REPORTED COMPONENT NAME
   CONTENT SEARCH
   
   
 * REPORTED COMPONENT ID
   5724R8109
   
   
 * REPORTED RELEASE
   521
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt / Xsystem
   
   
 * SUBMITTED DATE
   2018-01-22
   
   
 * CLOSED DATE
   2018-03-15
   
   
 * LAST MODIFIED DATE
   2018-03-15
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   CONTENT SEARCH
   
   
 * FIXED COMPONENT ID
   5724R8109
   
   

APPLICABLE COMPONENT LEVELS