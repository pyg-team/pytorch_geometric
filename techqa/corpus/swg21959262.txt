Title: IBM Getting a NullPointerException from WorkplaceXT/Application Integration - United States

Text:
WorkplaceXT; AppInt TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Getting a NullPointerException from WorkplaceXT/Application Integration 

SYMPTOM
Getting prompted to logon twice when adding a document through Application Integration for WorkplaceXT/Microsoft Outlook and getting a NullPointerException when logging on at second time.

After the first logon, user was promoted to logon again. When logging on at the second time, the following error occurred:

--------------------------
"IBM FileNet Workplace XT Add: Unable to Perform Add Operation"

Operation: SelectedAddProfile
Error Name: E_SVRCMDXMLPARSERFAILED
HRESULT: 0x8004042b
Description: Unable to parse command XML:null
Details: java.lang.NullPointerException
-------------------------

After the error message dialog box was dismissed, adding a document from Outlook did not prompt for logon again for the current Outlook session. After starting a new Outlook session, the symptom repeated again.


CAUSE
Since the WorkplaceXT was not configured for Single Sign On (SSO), the first logon was expected for each Outlook session. The unexpected second logon was due to the Application Integration error (see above).

This error was caused by the jar files in <install_path>/IBM/WebShpere/AppServer/lib/ext directory of the WebShpere Applicaton Server (WAS) hosting the WorkplaceXT.

In reference to the following page at P8 Knowledge Center 


"Configuring WebSphere Application Server to support user tokens and WebDAV connections for Workplace XT"

http://www-01.ibm.com/support/knowledgecenter/SSNW2F_5.2.1/com.ibm.p8.installingxt.doc/wxtip018.htm [http://www-01.ibm.com/support/knowledgecenter/SSNW2F_5.2.1/com.ibm.p8.installingxt.doc/wxtip018.htm]

there should be only two jar files in the following directory in WAS hosting the WorkplaceXT:
<install_path>/IBM/WebShpere/AppServer/lib/ext


RESOLVING THE PROBLEM
Steps to resolve the problem: 

1. Stopped WAS hosting the WorkplaceXT
2. Removed any additional jar files from the <install_path>/IBM/WebShpere/AppServer/lib/ext directory so that the directory contained only two jar files: 

- authentication-websphere.jar
- log4j_1.2.13.jar

3. Deleted WorkplaceXT folder from the WAS wstemp folder, and clear the browser cache
4. Started WebSphere Application Server 

After implementing the above procedure, the problem was resolved. User started to get a logon prompt only once as expected.