Title: IBM New installation configured for SSO is getting Kerberos errors at logon - United States

Text:
SSO; collocation; kerberos; snoop TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 After a functional IBM FileNet Content Engine and FileNet Application Engine were configured for SSO, Workplace continues to prompt for logon when it should be completing an SSO pass-thru logon. Kerberos logon module errors occur in the web application server logs. Snoop servlet shows a successful authorization - (the correct User Principal and the Negotiate string for Autorization appear in the Request headers in the Snoop output.) Only IBM FileNet logon is failing. 

SYMPTOM
Workplace should be providing pass-thru logon but is prompting for logon and the following error occurs in the Websphere Application Server (WAS) logs: 

javax.security.auth.login.FailedLoginException: Login error:
com.ibm.security.krb5.KrbException, status code: 25
message: Additional pre-authentication required
at
com.ibm.security.jgss.i18n.I18NException.throwFailedLoginException(I18NE
xception.java:13)
at
com.ibm.security.auth.module.Krb5LoginModule.b(Krb5LoginModule.java:125)
at
com.ibm.security.auth.module.Krb5LoginModule.c(Krb5LoginModule.java:416)
at
com.ibm.security.auth.module.Krb5LoginModule.login(Krb5LoginModule.java:
716)
at
com.ibm.ws.security.auth.kerberos.Krb5LoginModuleWrapper.login(Krb5Login
ModuleWrapper.java:542)


CAUSE
IBM FileNet Content Engine requires the FileNet Kerberos login modules to be in place. IBM FileNet Application Engine does not have this requirement. The IBM FileNet Content Engine must be installed in it's own JVM. IBM FileNet Application Engine was installed in the same JVM as the IBM FileNet Content Engine therefore it was attempting to use the same FileNet Kerberos logon module. Based on the requirement documented in the Hardware and Software Requirements document, it's expected the IBM FileNet Content Engine and IBM FileNet Application Engine will be in separate JVMs (and would use separate logon modules.) 


Hardware and Software Requirement document:
https://www-304.ibm.com/support/docview.wss?uid=swg27013654&aid=5 [https://www-304.ibm.com/support/docview.wss?uid=swg27013654&aid=5]

"Content Engine should be deployed in its own application server instance (that is, deployed into a
single JVM). For example, if you are running WebSphere, this means you deploy into the
application server running within a profile. No other Java EE applications (including Application
Engine) may be deployed within this instance. Other Java EE applications may be deployed in
their own, separate application server instance if the server is sized appropriately."


RESOLVING THE PROBLEM
Use the version and web application server specific Information Center Installation sections to follow the steps below: 

 1. Confirm no other J2EE applications (including IBM FileNet Application Engine) are installed in the JVM with the IBM FileNet Content Engine 
 2. If IBM FileNet Application Engine is installed in the same JVM with IBM FileNet Content Engine, undeploy and redeploy to a new or separate JVM, or install to a completely separate web server. Steps for installing IBM FileNet Application Engine 4.0.2.x in a P8 4.5.1 environment on WebSphere can be found here: http://publib.boulder.ibm.com/infocenter/p8docs/v4r5m1/topic/com.ibm.p8.install.doc/p8pin062.htm [http://publib.boulder.ibm.com/infocenter/p8docs/v4r5m1/topic/com.ibm.p8.install.doc/p8pin062.htm]  * Note: Follow the "Removing Software" section of the IBM FileNet P8 Information Center for the specific web application server version if IBM FileNet Application Engine needs to be uninstalled. Steps for removing IBM FileNet Application Engine 4.0.2.x from a P8 4.5.1 WebSphere environment are found here: http://publib.boulder.ibm.com/infocenter/p8docs/v4r5m1/topic/com.ibm.p8.install.doc/p8prm006.htm [http://publib.boulder.ibm.com/infocenter/p8docs/v4r5m1/topic/com.ibm.p8.install.doc/p8prm006.htm]
    
    
 3. The JVM where IBM FileNet Application Engine is to be installed must be configured for SSO (SPNEGO/Kerberos) per the web application servers vendors documentation. 
 4. As part of the IBM FileNet Application Engine reinstall, redeployment process, all of the SSO specific steps for IBM FileNet Application Engine (found in the IBM FileNet Application Engine installation section of the Info Center) must be followed. http://publib.boulder.ibm.com/infocenter/p8docs/v4r5m1/topic/com.ibm.p8.install.doc/p8pin054.htm [http://publib.boulder.ibm.com/infocenter/p8docs/v4r5m1/topic/com.ibm.p8.install.doc/p8pin054.htm]

RELATED INFORMATION
 SSO Solutions for IBM FileNet P8 [http://www.redbooks.ibm.com/redbooks/pdfs/sg247675.pdf]