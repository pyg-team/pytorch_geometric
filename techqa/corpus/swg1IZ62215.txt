Title: IBM IZ62215: ROLLBACK skipped when a CALL in an ANONYMOUS BLOCK encounters anerror - United States

Text:
 
APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 * IN DPF MODE, WHEN CUSTOMER ARE CALLING AN ANONYMOUS BLOCK,
   WHICH HAS A CALL STATEMENT HIT ERRORS WHICH NEED TO ROLLBACK
   
   (FOR EXAMPLE SQL0911 LOCK TIME OUT), WE MAY SKIP THE ROLLBACK
   AT ALL.
   
   THE CONSEQUENCE VARIOUS:
   1) FOR EXAMPLE, IF THE INNER CALL HAS AN UNCOMMITTED
   INSERTION, SKIPPING THE ROLLBACK WOULD CAUSE DATA INCONSISTENCY
   2) SOME INTERNAL FLAGS FOR THE INNER CALL STATEMENT MAY NOT
   GET CLEANED SINCE THE ROLLBACK HAS BEEN SKIPPED
   
   THE CALL STATEMENT INSIDE ANONYMOUS BLOCK COULD BE IMPLICIT
   CALL, SUCH AS TRIGGER
   FOR EXAMPLE, ASSUMING WE HAVE A INSERT TRIGGER DEFINED ON TABLE
   T1, AND WE HAVE BELOW ANONYMOUS BLOCK
   
   BEGIN
   INSERT INTO TABLE T1 VALUES (1);
   END;
   
   THE INSERT TRIGGER WILL BE CONSIDERED AS AN IMPLICIT CALL
   STATEMENT INSIDE THE ANONYMOUS BLOCK
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 * ****************************************************************
   * USERS AFFECTED: *
   * ALL DB2 SYSTEMS ON ALL LINUX, UNIX AND WINDOWS PLATFORMS AT *
   * DB2 VERSION 9.7 GA WITH DPF ENVIRONMENT *
   ****************************************************************
   * PROBLEM DESCRIPTION: *
   * ROLLBACK SKIPPED IN DPF *
   ****************************************************************
   * RECOMMENDATION: *
   * UPGRADE TO DB2 VERSION 9.7 FIX PACK 1 *
   ****************************************************************
   
    
   
   

PROBLEM CONCLUSION
 * THE COMPLETE FIX FOR THIS PROBLEM FIRST APPEARS IN DB2 VERSION
   9.7 FIX PACK 1 AND ALL THE SUBSEQUENT FIX PACKS
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IZ62215
   
   
 * REPORTED COMPONENT NAME
   DB2 POFE
   
   
 * REPORTED COMPONENT ID
   5724N7700
   
   
 * REPORTED RELEASE
   970
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2009-09-29
   
   
 * CLOSED DATE
   2009-12-18
   
   
 * LAST MODIFIED DATE
   2009-12-18
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   DB2 POFE
   
   
 * FIXED COMPONENT ID
   5724N7700
   
   

APPLICABLE COMPONENT LEVELS
 * R970 PSY
   UP