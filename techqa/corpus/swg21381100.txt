Title: IBM ITCAM for SOA 7.1.x with a corrupted SDMS database - United States

Text:
soa; datapower; sdms; database; corruption; CAMSOAALL CAMSOADB TECHNOTE (FAQ)

QUESTION
 How to regenerate the SDMS database after a data corruption or installation problem? 

ANSWER
In this situation, the recommendation is to clear out the SDMS database and persistence files in order to get a clean environment. Once executed the following actions and run the traffic again it will be possible to load the metrics and generate the topology view as expected. 

Here are the necessary steps (assuming the TEMA on a Windows platform and installed in the default path): 

 

 * Stop TEPS and the ITCAM for SOA Agent 
 * Delete the C:\IBM\ITM\TMAITM6\KD4\logs\KD4.DCA.CACHE\persist directory 
 * Delete any files matching *CA in the C:\IBM\ITM\TMAITM6\KD4\logs\KD4.DCA.CACHE directory. At this point the only thing in the C:\IBM\ITM\TMAITM6\KD4\logs\KD4.DCA.CACHE directory should be the archive directory 
 * Drop the KD4SDMS database (e.g. use the DB2 Control Center to do this)


Recreate the KD4SDMS database: 

 * Open a DB2 command prompt 
 * cd C:\IBM\ITM\CNPS\Products\KD4\bin 
 * Run the following scripts and provide them with the name of the SDMS database:
   
   kd4MakeSDMSdb2db.bat KD4SDMS
   kd4MakeSDMSdb2Schema.bat KD4SDMS

 * Restart TEPS and the ITCAM for SOA Agent 
 * On the TEP, there will be subnodes under the Services Management Agent Environment in the physical tree that are offline. Clear out these offline entries 
 * Rerun your traffic.