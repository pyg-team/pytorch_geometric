Title: IBM PM26058: WMQ Z/OS 7.0.1: CSV002I REQUESTS FOR MODULE CSQQCON2 EXCEED MAXIMUM USE COUNT - United States

Text:
z/os  A FIX IS AVAILABLE
Obtain the fix for this APAR.


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  After implementing WebSphere MQ for z/OS V7.0.1, you see an
   error condition using the IMS Adapter. The message in the IMS
   MPP is:
   CSV002I REQUESTS FOR MODULE CSQQCON2 EXCEED MAXIMUM USE COUNT
   .
   The problem does not occur with MQ V6.0.0.  The problem occurs
   with MQ V7.0.1 if the application does not issue MQDISC calls.
   If an explicit MQDISC call is used, the problem does not occur.
   .
   CSQQSTUB does the LOAD for CSQQCON2, but the DELETE does not
   occur if the MQDISC call is not made.
   
   
    
   
   

LOCAL FIX
 *  Code an explicit MQDISC in the application.
   .
   Another option is to link the application with the V6
   CSQQSTUB.  This option is only available if the application is
   not using new V7 API calls having to do with message handles:
   MQCRTMH
   MQDLTMH
   MQDLTMP
   MQINQMP
   MQSETMP
   MQMHBUF
   MQBUFMH
   
   
    
   
   

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED: All users of WebSphere MQ for z/OS Version 7 *
   *                 Release 0 Modification 1                     *
   ****************************************************************
   * PROBLEM DESCRIPTION: IMS BMP or IMS MPP region issues        *
   *                      error message                           *
   *                      CSV002I REQUESTS FOR MODULE CSQQCON2    *
   *                      EXCEED MAXIMUM USE COUNT.               *
   *                                                              *
   *                      Customer may notice a performance       *
   *                      overhead with IMS applications          *
   *                      issuing MQCONNs.                        *
   ****************************************************************
   * RECOMMENDATION:                                              *
   ****************************************************************
   CSQQCON2 is loaded by CSQQSTUB for every MQCONN, but only gets
   deleted again when MQDISC is explicitly issued.
   However, for IMS, implicit disconnects occur during IMS signon
   processing (i.e. when a new transaction starts). So, in a
   long-running MPP region running a lot of transactions that issue
   MQCONN but no MQDISC, the CSV002I will eventually occur (after
   32767 MQCONNs).
   
   A similar problem can occur if the IMS application issues an
   IOPCB GU but no MQDISC. CSQQSSON will cause an implicit
   disconnect and save the address of the QLOA in WAUOQLOA. When
   CSQQCONN is invoked for a subsequent MQCONN it will get a new
   QLOA and release the old one which contained the address of the
   CSQQCON2, hence CSQQCON2 is again reloaded unnecessarily.
   
   
    
   
   

PROBLEM CONCLUSION
 *  CSQQSTUB has been changed to check if CSQQCON2 has already been
   loaded, and if it has, will not load it again.
   Also the address of the old QLOA is copied into the new one
   CSQQNORM has been changed to remember the address of the
   CSQQCON2 address from the previous QLOA.
   CSQQTMID has been changed to check if CSQQCON2 is loaded and
   if so, on thread termination will DELETE it.
   
   Because CSQQCON2 is no longer loaded with each MQCONN there
   will be a significant performance improvement.
   010Y
   CSQQDISC
   CSQQLOAC
   CSQQNORM
   CSQQSTUB
   CSQQTMID
   CSQQWAU
   
   
    
   
   

TEMPORARY FIX
 *  *********
   * HIPER *
   *********
   
   
    
   
   

COMMENTS
 *  &#158;**** PE12/07/19 FIX IN ERROR. SEE APAR PM62137 [http://www-01.ibm.com/support/docview.wss?uid=swg1PM62137]  FOR DESCRIPTION
   &#158;**** PE12/09/05 PTF IN ERROR. SEE APAR PM65164 [http://www-01.ibm.com/support/docview.wss?uid=swg1PM65164]  FOR DESCRIPTION
   
   
    
   
   

APAR INFORMATION
 * APAR NUMBER
   PM26058
   
   
 * REPORTED COMPONENT NAME
   WMQ Z/OS V7
   
   
 * REPORTED COMPONENT ID
   5655R3600
   
   
 * REPORTED RELEASE
   010
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   YesHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2010-11-05
   
   
 * CLOSED DATE
   2011-01-12
   
   
 * LAST MODIFIED DATE
   2012-09-11
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
    UK63858
   
   

MODULES/MACROS
 *  CSQQDISC CSQQLOAC CSQQNORM CSQQSTUB CSQQTMID
   CSQQWAU
   
   
    
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WMQ Z/OS V7
   
   
 * FIXED COMPONENT ID
   5655R3600
   
   

APPLICABLE COMPONENT LEVELS
 * R010 PSY UK63858 [HTTPS://WWW14.SOFTWARE.IBM.COM/WEBAPP/SET2/ORDERMEDIA/SHOPCART?PTFS=UK63858]
   UP11/02/06 P F102
   
   

FIX IS AVAILABLE
 * SELECT THE PTF APPROPRIATE FOR YOUR COMPONENT LEVEL. YOU WILL BE REQUIRED TO SIGN IN. DISTRIBUTION ON PHYSICAL MEDIA IS NOT AVAILABLE IN ALL COUNTRIES.