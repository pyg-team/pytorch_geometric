Title: IBM Sterling Connect:Direct failed to start in Microsoft Window cluster - United States

Text:
cluster; SPE; secure password encryption TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Sterling Connect:Direct failed to start in Microsoft Window cluster and Sterling Connect:Direct Proxy password was corrupted and as a result user was not able to logon. 

CAUSE
The fault is caused by the Microsoft Cluster Software not replicating the Sterling Connect:Direct Registry Hive correctly between the nodes in the Cluster; As Secure Password Encryption (SPE) is enabled by default in Sterling Connect: Direct for Microsoft Windows v4.5.1 and higher this results in the password being encrypted differently on each node in the Cluster, so when Node 1 fails over to Node 2 it is not able to decrypt the passwords correctly leading to the error seen.


RESOLVING THE PROBLEM
The fault is caused by the Microsoft Cluster Software not replicating the Sterling Connect:Direct Registry Hive correctly between the nodes in the Cluster. As Secure Password Encryption (SPE) is enabled by default in Sterling Connect:Direct for Microsoft Windows 4.5.1 and higher, this results in the password being encrypted differently on each node in the Cluster. So when Node 1 fails over to Node 2, it is not able to decrypt the passwords correctly leading to the error seen.

Ultimately, the issue lies with the Microsoft Cluster software and a ticket should be opened with Microsoft to investigate this issue. In the meantime there are two possible work-arounds. Firstly, disable SPE until the Registry Replication issue has been resolved, however this means passwords are not encrypted. Secondly, use the procedure below to bring the encrypted passwords back into step, this is a manual process but will allow processing to continue.

1. Start node 1,
2. Disable SPE in node 1
3. Stop and start node 1. This must happen before starting node 2 otherwise the passwords in the registry will still be encrypted;
4. Stop node 1 and proceed to cluster node 2
5. Start node 2 and disable SPE
6. Stop and start node 2
7. Stop node 2
8. SPE should be disabled

Start Node 1 and failover to Node 2 when required and the passwords should be correct.


NOTE: Follow below procedure to disable SPE (Secure Password Encryption)

1. From the Secure+ Admin Tool Main Menu screen, select Password Encryption from the Edit
menu. The Secure+ Admin Tool - Password Encryption window is displayed.
2. Click the No option for Enable Strong Password Encryption.
3. Click OK to disable Strong Password Encryption. The following message is displayed:

Strong Password Encryption Options
- Warning: The Connect:Direct Server must be restarted for the
changes to Strong Password Encryption to become effective.

4. Restart the Sterling Connect:Direct Server.

When you are happy that Registry Replication is working correctly then you can repeat the process and re-enable SPE in both nodes.