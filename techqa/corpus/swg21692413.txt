Title: IBM Content uploads to a Database Storage Area fails after a Content Platform Engine (CPE) upgrade - United States

Text:
CPE 5.2.1; DB2; JDBC; upgrade TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Content uploads to a Database Storage Area fail after a Content Platform Engine 5.2.1 upgrade ( IBM DB2 database). 

SYMPTOM
Attempts to upload content to a Database Storage Area by EJB or CE WSI clients fail with the following exception : 

ENG FNRCC0036E - ERROR method name: copyElementToInbound principal name: p8admin Global Transaction: false User Transaction: false Exception Info: The content element could not be inserted.
com.filenet.api.exception.EngineRuntimeException: FNRCC0036E: CONTENT_DCA_FAILED_INSERT: The content element could not be inserted.
...
Caused by: com.filenet.api.exception.EngineRuntimeException: FNRCD0009E: DB_ERROR: The database access failed with the following error: ErrorCode 0, Message 'DSRA1300E: Feature is not implemented: PreparedStatement.setBinaryStream' ObjectStore: "OSName"
...
Caused by: java.sql.SQLFeatureNotSupportedException: DSRA1300E: Feature is not implemented: PreparedStatement.setBinaryStream
at com.ibm.ws.rsadapter.AdapterUtil.notSupportedX(AdapterUtil.java:1307)
at com.ibm.ws.rsadapter.jdbc.WSJdbcPreparedStatement.setBinaryStream(WSJdbcPreparedStatement.java:1392)
at com.filenet.engine.dbpersist.DBStatementBase.setBinding(DBStatementBase.java:624)
... 55 more
Caused by: java.lang.AbstractMethodError: java/sql/PreparedStatement.setBinaryStream(ILjava/io/InputStream;)V
at com.ibm.ws.rsadapter.jdbc.WSJdbcPreparedStatement.setBinaryStream(WSJdbcPreparedStatement.java:1376)
... 56 more 




CAUSE
This behavior occurs if as part of the upgrade the IBM DB2 JDBC driver was not also upgraded from Type 3 to Type 4. Content Platform Engine 5.2.1 only supports the DB2 JDBC Type 4 driver. 



DIAGNOSING THE PROBLEM
Inspect the DB2 JDBC driver version reported on the Content Platform Engine Ping Page ( http://<CPE_Server>:<port>/FileNet/Engine ) and cross reference with the following list : 


DB2 JDBC Driver Versions and Downloads [http://www.ibm.com/support/docview.wss?uid=swg21363866] 

 


RESOLVING THE PROBLEM
If the JDBC driver reported on the Ping Page indicates Type 3, then download and install a supported DB2 JDBC Type 4 driver for the specific CPE 5.2.1 installation and DB2 Server version. 

Note : If using IBM WebSphere Application Server, the DB2_JCC_DRIVER_PATH environmental variable should be updated to point to the location of the Type 4 driver ( db2jcc4.jar ) and the value for the the DB2UNIVERSAL_JDBC_DRIVER_PATH variable should be unset.