Title: IBM 'The installation of Lotus iNotes 8.5 Control has been blocked...' installing ActiveX through a .MSI with iNotes - United States

Text:
activex; inotes; dwa; "The installation of Lotus iNotes 8.5 Control has been blocked or declined by the user. Do you want to use this on subsequent Lotus iNotes pages"; "The web-site wants to run with the following add-on"; trusted sites TECHNOTE (TROUBLESHOOTING)

PROBLEM
When installing ActiveX through a .MSI with iNotes, the following message occurs with Internet Explorer 8: 


"The installation of Lotus iNotes 8.5 Control has been blocked or declined by the user. Do you want to use this on subsequent Lotus iNotes pages?"


CAUSE
The issue is due to the increased security settings with Internet Explorer. However the issue occurs even for an administrator with full rights to the machine. The same issue did not occur with Internet Explorer 6.


DIAGNOSING THE PROBLEM
With the "low" security settings in IE6, it was possible to install ActiveX via msi (execute the regsvr command and copy the dwa85w.dll file) and IE6 just executed the pre-installed ActiveX. 

With the higher security settings of IE8, if installing a new ActiveX via the same msi, IE8 prompts you at the first connection with the following messages: 

"The web-site wants to run with the following add-on: "Lotus iNotes 8.5.1 Control..If you trust the web-site and the add-on and want to allow it to run, click here..."

Click "run" and you won't be prompted at the next connection


RESOLVING THE PROBLEM
The user had connected to the server via the IP address, or via hostname only. It means that Internet Explorer believed I was on a internet instead of intranet and applied the wrong security zone. 

This same issue occurs without the .msi accessing with the server name instead of the fully qualified name - unless the iNotes server is in trusted sites or host file.

So, with the server in the host file, i.e. the full qualified domain name (in order to have the workstation resolve the iNotes server) using the msi package previously installed by a administrator to install ActiveX, the end user doesn't have the prompt anymore...