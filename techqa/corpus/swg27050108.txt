Title: IBM Configuring IBM Content Navigator 3.0.1 on WebSphere Application Server Version 9.0 – Resolving the JavaPersistence issue when running the Deploy task on Windows - United States

Text:
 PRODUCT DOCUMENTATION

ABSTRACT
 When configuring IBM Content Navigator 3.0.1 on Windows, the deploy task fails with JavaPersistence exceptions in some instances of WebSphere 9 Profiles. 

CONTENT
Symptoms


On Windows, the Deploy Application Task fails when configuring IBM Content Navigator 3.0.1 on WebSphere Version 9 with the following exception: 

Deploy the Web Application *************
Finished running Deploy the Web Application
An error occurred while running Deploy the Web Application
The task failed with the following messages:

The application deployment failed.
WASX7209I: Connected to process "server1" on node iona1Node01 using SOAP connector; The type of process is: UnManagedProcess
Application=DefaultApplication
Application=ivtApp
Application=navigator
Found existing navigator. Do redeploy.
Configuring JPA level for application server...node= iona1Node01 server = server1
JPA 2.0 configuration successful...Trying to change default persistence provider to WAS JPA 
WASX7017E: Exception received while running file "C:\Program Files (x86)\IBM\ECMClient\configure\tmp/deployapplication.tcl"; exception information: com.ibm.ws.scripting.ScriptingException: WASX7444E: Invalid parameter value "" for parameter "config id" on command "modify"

<missing argument> 

Cause
The IBM Content Navigator 3.0.1 deploy task changes the Default Java Persistence API specification from 2.1 to 2.0 as the product specification. 

The Java Persistence Service is not added to the Server.xml in WebSphere 9 Profiles by default for newly created profiles that haven’t had any updates to their configuration (saves to the server.xml). 

When you attempt to deploy IBM Content Navigator 3.0.1 on WAS 9, it tries to fetch the Java Persistence API specification and since it is not present, the task fails. To work around this issue, any Save action on the Default Java Persistence API settings will add the Java Persistence API Service to the Server.xml which will resolve the issue. 

Note: This issue is seen only in some instances of WebSphere 9 profiles and we are working with WebSphere team to identify why it is failing on some instances only. 

 

Resolving the Problem 

Follow the procedure below when you see the deploy exceptions mentioned earlier. 

After running the Deploy Task and the task fails with the JPA Persistence exception: 

1. Go to the Administration Console -> Application Servers ->server1 . 

Under Container Settings, Click Container Services -> Default Java Persistence API settings. You should see the JPA Specification as 2.0 and Provider as com.ibm.websphere.persistence.PersistenceProviderImpl. 

Change the JPA Specification to 2.1, and the Default Persistence Provider value automatically changes to com.eclipse.persistence.jpa.PersistenceProvider. Refer to the screen capture. 

 Click Apply and Save the setting. 

[/support/docview.wss?uid=swg27050108&aid=1] [/support/docview.wss?uid=swg27050108&aid=1] 

2. Run the deploy task. It should run successfully. 

 

You can avoid the deploy issue by completing the steps below before running the deploy task on the IBM Content Navigator Configuration tool. 

Before Running the Deploy task: 

1. Go to Admin Console -> Application Servers ->server1 . 

Under Container Settings, Click Container Services -> Default Java Persistence API settings and click Apply and then click Save without making any changes. This updates the server.xml with JAVA Persistence API settings which are missing in a newly created application server’s server.xml. 

2. Run the Deploy task in the IBM Content Navigator Configuration tool.