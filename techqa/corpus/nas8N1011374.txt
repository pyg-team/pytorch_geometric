Title: IBM Message TCP2617 RC2 Received with SNDPTFORD or SNDSRVRQS - United States

Text:
MSGTCP2617 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 SNDPTFORD or SNDSRVRQS fails with message TCP2617 RC2. 

RESOLVING THE PROBLEM
SNDPTFORD or SNDSRVRQS fails with message TCP2617 RC2: 

Message . . . . : TCP/IP connection to remote system &2 closed, reason code 2. 
Cause . . . . . : The TCP/IP connection to remote system &2 has been closed.
The connection was closed for reason code 2. Full connection details for
the closed connection include:
- local IP address is &1
- local port is &3
- remote IP address is &2 
- remote port is &4 
Reason codes and their meanings follow: 
2 = TCP connection closed due to R2 retry threshold being run.


Resolution 

1. CHGTCPA and ensure that the TCPKEEPALV and TCPCLOTIMO values are set long enough. The default is 120 seconds which is usually enough time. 2. Run the command again and, before the TCP2617 RC2 error, check WRKTCPPTP to see if the profile is START_IPSEC_SA status. If profiles are in START_IPSEC_SA status, this is almost always a result of the traffic (that is required to establish the VPN tunnel from the system to IBM) being denied access from getting outside of the user's firewall. 

Refer to the system's network administrator to allow the appropriate traffic through their firewall. The traffic that is needed to be allowed through the firewall is UDP 4500 outbound and UDP 500 both inbound and outbound for 207.25.252.196 and 129.42.160.16 (the two VPN gateways at IBM). Also, there must be a valid route to these two VPN gateways. In most cases, the system will have a *DFTROUTE, which shows a Next Hop value of the router that will take the traffic out to the Internet. 
Note: If the system is not behind a NAT, you will need to open protocol ESP in the firewall (in place of UDP 4500).  


Cross reference information Segment Product Component Platform Version Edition Operating System IBM i 6.1 Operating System IBM i 7.1 
HISTORICAL NUMBER
 609377768