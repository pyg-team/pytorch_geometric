Title: IBM CSPA202E SSL handshake failure, reason=GSK_ERR_CERT_VALIDATION after migrating to z/OS V1.12 using SAF keyrings - United States

Text:
Operating Environment; STERLINGNFX TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 CSPA202E SSL handshake failure, reason=GSK_ERR_CERT_VALIDATION after migrating to z/OS V1.12 using SAF keyrings 

SYMPTOM


After migrating to z/OS V1.12 began experiencing GSK_ERR_CERT_VALIDATION error on SSL session that were not failing before the migration.

When migrating to z/OS R12 and using SAF keyrings, gsk_secure_socket_init handshake processing returned an error when validating the partner's certificate.

Error Message CSPA202E SSL handshake failure, reason=GSK_ERR_CERT_VALIDATION 
SVTM055I SESSION (004) ESTABLISHED WITH SNODE=HQNDM1 
CSPA003E Security Violation - SNODE authentication error


RESOLVING THE PROBLEM


Local Fix:

Work Around: Connect the necessary certificates to the SAF Keyring.

See IBM APAR OA35143 PTFs UA59478 & UA59479

From IBM Knowledgebase:

Problem summary

If a SAF keyring contains a non-root trust 
anchor, validation of a certificate in that chain may fail in z/OS V1R12, where 
it would have passed in previous releases.

Problem conclusion System SSL has been altered to allow a trusted intermediate CA certificate located in a SAF keyring to act as a trust anchor, as was the case with previous releases of System SSL. If a sole intermediate CA certificate is found in a SAF keyring and the next issuer certificate in the certificate chain cannot be found in the same keyring, the intermediate CA certificate will be allowed to act as the trust anchor for the validation of the subject certificate. When the validation mode is set to ANY and validation fails, System SSL will return the error produced during validation against RFC2459.  

HISTORICAL NUMBER
 NFX11152 

PRODUCT ALIAS/SYNONYM
 

Severity


Normal


Type


NormalFix