Title: IBM Guardium guard-stap-update error - unexpected EOF while looking for matching `"' - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 When using guard-stap-update utility the S-TAP does not upgrade as expected. In the install log there is a sequence of messages:
Install finished
./guard-stap-update: line 1604: unexpected EOF while looking for matching `"'
./guard-stap-update: line 1607: syntax error: unexpected end of file 

CAUSE
The guard-stap-update utility should not be used to upgrade S-TAPs from one v9 revision to a higher v9 revision or from v9 to v10. 

For these cases the new version installer should be run with the same steps as if it was being installed for the first time. The new installer will find the old install and upgrade it with no reboot required.


DIAGNOSING THE PROBLEM
1. When upgrading the S-TAP using guard-stap-update utility messages like the following example will appear on the command line: 

DB_server:/usr/local/guardium/guard_stap # ./guard-stap-update /var/tmp/guard-stap-9.0.0_r89422_v90_1-suse-11-linux-x86_64.sh /usr/local
Guardium STAP updater version 1.50 August 6, 2013
Checking for free disk space...

<further install messages>

SER----------------------------------------------------------
Guardium STAP config file OK.
Your configuration has been validated.
Using system lsof at /usr/bin/lsof
Starting tee
Install finished
./guard-stap-update: line 1604: unexpected EOF while looking for matching `"'
./guard-stap-update: line 1607: syntax error: unexpected end of file 

 

2. The S-TAP version is showing as upgraded, but the old KTAP is loaded. For example:
DB_server:/usr/local/guardium/guard_stap # lsmod | grep tap
ktap_79390 782453 3

DB_server:/usr/local/guardium/guard_stap # /usr/local/guardium/guard_stap/guard_stap --version
STAP-9.0.0_r89422_v90_1-20160818_0844 

3. The inspection engine section in the guard_tap.ini may have been removed.


RESOLVING THE PROBLEM
In order to get a clean install of the higher version of S-TAP and KTAP after this error, uninstall and reinstall is required. 

1. Deactivate ATAP if one is active. 

<S-TAP install directory>/guardctl deactivate-all 

2. Uninstall S-TAP 

<S-TAP install directory>/uninstall 

3. Reboot the server to remove KTAP 

4. Install higher version S-TAP with shell installer.

RELATED INFORMATION
 Install UNIX S-TAP [http://www.ibm.com/support/knowledgecenter/SSMPHH_10.1.0/com.ibm.guardium.doc.stap/stap/unix_stap_install.html]
When to restart and reboot [http://www-01.ibm.com/support/docview.wss?uid=swg21644770]