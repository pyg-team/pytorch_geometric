Title: IBM How to configure a time-out session for idle views - United States

Text:
view server process; terminate; end; exit; view_server.exe; kill view server process; stop view server; kill clearcase server processes; view-server.exe; view server process; timeout; 1124218; RATLC00716222; ccrc; ccweb; snapshot; dynamic TECHNOTE (FAQ)

QUESTION
 How do you stop the IBM® Rational® ClearCase® view server process when exiting a view on both Microsoft® Windows® or UNIX® and Linux® in order to save on system resources? 

CAUSE
Upon exit of a view, the view server process does not die. It continues to run and takes up system resources.

ANSWER
CONFIGURE VIEW SERVER PROCESS TIMEOUT PERIOD 

There is a feature that allocates a time-out period for view server processes whereby they terminate themselves automatically. 



INSTRUCTIONS:

To extend or shorten the timeout session, set the CCASE_VIEW_IDLE_THRESH variable to the appropriate number of seconds.

Note: The default (and the minimum) timeout for the view server processes using the variable is 2 hours and 10 minutes (7800 seconds).

Setting the CCASE_VIEW_IDLE_THRESH to 0 (zero) turns off the timeout session (views never go idle.)

The following formula can be used to assist in calculating the number of seconds: 

(number of hours * 60 * 60) + (number of minutes * 60) = total seconds 


Example: To calculate a 3 hour and 15 minute timeout value in seconds.

3 * 60 * 60 = 10800 

15 * 60 = 900 

 

10800 + 900 = 11700 seconds 



The environment variable can be set on Windows as a system EV and on UNIX or Linux can be applied by editing the startup script (ccase-home-dir/etc/clearcase or ccase-home-dir/bin/atria_start) to control the idle time-out. On Unix and Linux ensure that the EV is properly exported.

Note: After the timeout period has elapsed, running cleartool lsview may still show the dynamic view as active (an * will precede the name) or running cleartool lsview -long will show active flag set to YES. This "active" status does not refer to the state of the server process. It refers to having an open "handle" in the MVFS, local to the machine running lsview.


 * On Windows you can run albd_list [http://www.ibm.com/support/docview.wss?rs=984&uid=swg21148639] to verify that the view does not have an active process id (as the view will not appear in the list returned).
   
 * On UNIX and Linux you run ps -elf | grep <viewtag> to see that there is no process that is running.
   
 * From ClearCase 8.0.0.1, CLEARCASE_VIEW_THRESH is set to 0 automatically on AIX to prevent the system to hang while trying to start a view_server to respond to an RPC from the MVFS. 




MANUALLY 

If you do not have the above patches installed, to better manage this behavior you need to end the view server process. From the command line, run the cleartool endview -server command to stop the view server process after you have exited the view or are finished using it. 

If running this command manually is not a viable option, consider creating a script to automate the job (see UNIX or Linux reference below for an example). There is no known script to use on Windows currently. 


SCRIPT EXAMPLE (UNIX or Linux):


Here is an optional script that can be run on UNIX or Linux:


1. Create a shell script (in this example the script is named "quit") and make it executable.


 * 
 * =============
   #! /usr/bin/sh
   # this script is called "quit"
   
   cleartool pwv -short |xargs cleartool endview -server
   exit
   =============
 * 



2. When exiting the view shell on UNIX or Linux, run "quit" instead of "exit" and the process will be terminated.  


Cross reference information Segment Product Component Platform Version Edition Software Development Rational ClearCase View: Snapshot Software Development Rational ClearCase View: Snapshot Software Development Rational ClearCase Environment Variables Software Development Rational ClearCase ClearCase Remote Client (CCRC) Software Development Rational ClearCase ClearCase Web (CCWeb)