Title: IBM Users cannot export into PDF or Excel for a filtered query studio query - United States

Text:
query studio hang TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Users cannot export into PDF or Excel for an unfiltered query studio query. However when a filter is applied , it will run in html but will appear hang when export to pdf or excel. 

SYMPTOM
Export to pdf or excel a filtered query studio query will appear to run forever. Such run will generate a new BIBusTKServerMain.exe at the app server with little or not activity. Stop the Cognos BIServer will show such BIBusTKServerMain process still prevailing.


CAUSE
Issue is cause by :
(1) They are running in cognosisapi.dll and they had not restart the IIS service to flush the webserver.
(2) They cognos server appear hang after numerous such query studio attempt as it fills up with orphaned BIBusTKServerMain.exe

ENVIRONMENT
windows 2008R2

DIAGNOSING THE PROBLEM
Check task manager->process and see lots of BIBusTKServerMain.exe which remain idle with no acitivity
Test in report studio same query and render in pdf to confirm that it works. Also confirm with client this had work in the past. Also test in query studio in html the filtered query studio and confirm that query do work. 
Then test a filtered query studio query in pdf and check that task manager->process to see the behavior of the BIBusTKServerMain. Note a new one created with little or no activity.


RESOLVING THE PROBLEM
Stop the cognos BI server and kill off all orphaned BIBusTKServerMain. Also take the opportunity to clean up old uda or dmc files leftover in the ..\temp folder. Start the BIserver and ensure proper startup of cognos service. Also check whether the IIS server is using cognosisapi.dll or not and if it does use isapi, recycle the IIS to flush off cognos gateway codes that may be cache.