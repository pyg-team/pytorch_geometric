Title: IBM Unable to reach Rule Execution Server using the EJB3 client API from a remote server - United States

Text:
RES; BRES; EJB2; EJB3; remote; JNDI; name; J2EE TECHNOTE (FAQ)

QUESTION
 How do I set the JNDI properties through the Rule Execution Server EJB3 client API? 

CAUSE
The new EJB3 Rule Execution Server remote client API does not provide a way to set JNDI properties programmatically, as the EJB2 API (now deprecated) does (see the IlrRuleSessionProviderFactory API documentation [http://publib.boulder.ibm.com/infocenter/brjrules/v7r1/topic/com.ibm.websphere.ilog.jrules.doc/html/api/html/ilog/rules/bres/session/IlrRuleSessionProviderFactory.Builder.html]).
The alternative is to use a JNDI property file. However, even when the JNDI properties are correct, errors such as the following one can occur when the client application is running from a server (whether from the same vendor or not) remote to Rule Execution Server:

SystemErr R ilog.rules.res.session.IlrSessionCreationException: An error occurred while the rule session was created.:
javax.naming.NameNotFoundException: Context: TestNode01Cell/nodes/TestNode01/servers/server1, name: ilog.rules.res.session.impl.ejb3.IlrStatelessSessionRemote: First component in name ilog.rules.res.session.impl.ejb3.IlrStatelessSessionRemote not found.
org.omg.CosNaming.NamingContextPackage.NotFound: IDL:omg.org/CosNaming/NamingContext/NotFound:1.0 

Moreover, it is not recommended to use JNDI property files in a Java EE container as this could be picked up by other applications and affect their behavior.


ANSWER
The solution is to bypass the EJB3 IlrSessionFactory API and use the Java EJB API to look up rule sessions directly: 

 * 
 * Properties props = new Properties();
   props.setProperty(Context.PROVIDER_URL, "...");
   props.setProperty(Context.INITIAL_CONTEXT_FACTORY, "...");
   InitialContext context = new InitialContext(props);
   IlrStatelessSession session = (IlrStatelessSession)context.lookup(jndiName);
   ...


After the IlrStatelessSession object is retrieved, use the Rule Execution Server client API as documented. 

 

Starting in the V7.5 version of the product, it is possible again to set JNDI properties through the Rule Execution Server remote client API (see V7.5 IlrEJB3SessionFactory API documentation [http://publib.boulder.ibm.com/infocenter/dmanager/v7r5/topic/com.ibm.dserver.reference.res/html/api/html/ilog/rules/res/session/IlrEJB3SessionFactory.html]). Therefore, it is ultimately recommended to upgrade to the latest version (see download document below).

RELATED INFORMATION
#WODM/ODM Download document [http://www.ibm.com/support/docview.wss?uid=swg24031636]
"Hello World" EJB3 remote client for RES V7 on WAS V7 [http://www.ibm.com/support/docview.wss?uid=swg21461685]
Assembling and packaging a RES EJB application [http://publib.boulder.ibm.com/infocenter/brjrules/v7r1/topic/com.ibm.websphere.ilog.jrules.doc/Content/Business_Rules/Documentation/_pubskel/JRules/ps_JRules_Global967.html]