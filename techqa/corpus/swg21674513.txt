Title: IBM Firmware upgrade via AMP or sending a large AMP request to a virtual appliance might encounter an out of memory condition - United States

Text:
600limitation 601limitation 700limitation xg xi ve virtual edition upgrade AMP TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 When you use AMP to upgrade firmware or when you send a large AMP request to a virtual DataPower appliance, the appliance might encounter an out of memory condition and reload. You will see the following error message in system log:

"Throttler forced a system reload. Reason : Low Memory" 

SYMPTOM
In the following situations, the virtual appliance encounters an out of memory condition and reloads: 

 * A firmware upgrade via AMP fails 
 * An AMP request fails to send


CAUSE
DataPower consumes memory to process AMP messages. When an AMP message is large and the required memory to process an AMP message exceeds available memory, the DataPower appliance runs out of memory and reloads.

ENVIRONMENT
The problem is limited to the DataPower virtual appliances.



DIAGNOSING THE PROBLEM
When you use AMP to do firmware upgrade or you send a large AMP request to a virtual appliance and then the DataPower virtual appliance reloads, the system log might contain the following message: 


20140507T124717Z [file][success][0x8240002a] (SYSTEM:default:*:*): Creating file "config:/temp_00010"
20140507T124803Z [sys][failure][0x82400024] (SYSTEM:default:*:*): Throttler forced a system reload. Reason : Low Memory
20140507T124804Z [conf][success][0x8240001c] (SYSTEM:default:*:*): ssh 'SSH Service' - Operational state down
20140507T124812Z [sys][success][0x82400013] (SYSTEM:default:*:*): Booting device serial #0000000 DPOS running 1.1, installed 1.1
20140507T124812Z [sys][success][0x82400015] (SYSTEM:default:*:*): Booting product id 5725 revision None firmware XG45.6.0.0.3
20140507T124812Z [sys][success][0x82400017] (SYSTEM:default:*:*): Booting build 236646 on 2013/11/11 11:04:50 count 3. Uptime 7076

The likely cause of the out of memory condition is that the amount of memory that is allocated by the DataPower appliance exceeds the reserved memory for the virtual appliance.


RESOLVING THE PROBLEM
Check the virtual appliance reserved memory size and increase it to 8 GB or more. Or use the WebGUI to do firmware upgrade.

 



Cross reference information Segment Product Component Platform Version Edition Business Integration WebSphere DataPower Integration Appliance XI52 Virtual Edition Business Integration WebSphere DataPower Service Gateway XG45 Virtual Edition