Title: IBM JR51707: UNKNOWN TYPE SHOWS FOR BUSINESS ALIASES WHEN NO INSTANCES ARE PRESENT AND <USE-BUSINESS-ALIASES-FOR-PROCESS-INSTANCES> IS TRUE - United States

Text:
  DIRECT LINKS TO FIXES
8.5.0.1-WS-BPM-IFJR51707 [http://www.ibm.com/support/fixcentral/quickorder?product=ibm%2FWebSphere%2FIBM+Business+Process+Manager+Standard&fixids=8.5.0.1-WS-BPM-IFJR51707&source=SAR]
8.0.1.3-WS-BPM-IFJR51707 [http://www.ibm.com/support/fixcentral/quickorder?product=ibm%2FWebSphere%2FIBM+Business+Process+Manager+Standard&fixids=8.0.1.3-WS-BPM-IFJR51707&source=SAR]
8.0.1.2-WS-BPM-IFJR51707 [http://www.ibm.com/support/fixcentral/quickorder?product=ibm%2FWebSphere%2FIBM+Business+Process+Manager+Standard&fixids=8.0.1.2-WS-BPM-IFJR51707&source=SAR]
Version 8.5 Refresh Pack 6 for the IBM Business Process Manager products [http://www-01.ibm.com/support/docview.wss?uid=swg24039185]
Version 8.5.0 Fix Pack 2 for the IBM Business Process Manager products [http://www-01.ibm.com/support/docview.wss?uid=swg24040683]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  When the business data aliases cache is populated by using only
   business process definition (BPD) instance data, no instances
   are available, and <use-business-aliases-for-process-instances>
   is set to true, searches on specific aliases are not found in
   the cache and resolve to Unknown. If no instances are present,
   the cache should show all available data.
   
   
   In this WLE.*=all trace example, the business variable
   CustomerAddress is not properly initialized. Note that the data
   name is labeled "Unknown"
   
   wle_search 1
   com.lombardisoftware.server.core.pse.impl.ProcessSearchQueryEngi
   ne prepareQuery propertyNames [instanceId, instanceStatus,
   businessData.CustomerAddress@Unknown]
   wle_search 1
   com.lombardisoftware.server.core.pse.impl.ProcessSearchQueryEngi
   ne prepareQuery searchConstraints
   [SimpleConstraint(PropertyValueExpression(instanceStatus)
   Operator(=) ConstantExpression(Active)),
   SimpleConstraint(BusinessDataConstraintVariableNameExpression(va
   riable name: CustomerAddress, type: Unknown ) Operator(=)
   BusinessDataValueExpression(CSEZS0258845368))]
   
   In the SystemOut.log files, you see the following exception
   stack related to looking up values in the pivot tables. However,
   the STRING_VALUE column is not a pivot table column.
   
   Caused by: [TeamworksException name='<JSScript>',
   message='PreparedStatementCallback; bad SQL grammar [SELECT *
   FROM (
   SELECT searchWithInstanceIdx.*, ROW_NUMBER() OVER ( order by
   instanceId, taskDueDate, taskPriorityRanking, taskId ) AS
   search_result_row_idx
   FROM (
   SELECT actualSearch.*, ROW_NUMBER() OVER ( PARTITION BY
   instanceid order by instanceId, taskDueDate,
   taskPriorityRanking, taskId ) AS instance_result_row_idx
   FROM (
   select t.bpd_instance_id as instanceId, istatus.name as
   instanceStatus, vp.CUSTOMERID AS PSCUSTOMERID, t.due_date as
   taskDueDate, tpriority.ranking as taskPriorityRanking,
   t.task_id as taskId
    from lsw_task t
   inner join lsw_bpd_instance i on t.bpd_instance_id =
   i.bpd_instance_id
   left join lsw_bpd_status_codes istatus on i.execution_status =
   istatus.status_id
   left join lsw_priority tpriority on t.priority_id =
   tpriority.priority_id
   inner join lsw_bpd_instance_vars_pivot vp on
   vp.bpd_instance_id=i.bpd_instance_id
    where ( UPPER(istatus.name) = UPPER(?) AND  (
   (CAST(vp.DATE_VALUE AS VARCHAR(128))  || CAST(vp.DATE_VALUE AS
   VARCHAR(128))  || CAST(vp.DEC_VALUE AS VARCHAR(128))  ||
   CAST(vp.INT_VALUE AS VARCHAR(128))  || CAST(vp.BOOLEAN_VALUE AS
   VARCHAR(128))  || CAST(vp.STRING_VALUE AS VARCHAR(512)) ) =
   UPPER(?) )  )
   
   ) actualSearch
   ) searchWithInstanceIdx
   WHERE searchWithInstanceIdx.instance_result_row_idx = 1
   ) searchWithRowIdx
   WHERE search_result_row_idx <= ?
    order by instanceId, taskDueDate, taskPriorityRanking, taskId
   ]; nested exception is java.sql.SQLSyntaxErrorException:
   ORA-00904: "VP"."STRING_VALUE": invalid identifier
   ', line=42, pos=0 nested=<none>]
    at
   com.lombardisoftware.core.script.js.JavaScriptRunner$MyErrorRepo
   rter.runtimeError(JavaScriptRunner.java:568)
    at
   org.mozilla.javascript.Context.reportRuntimeError(Context.java:9
   38)
    at
   org.mozilla.javascript.Context.reportRuntimeError(Context.java:9
   94)
    at
   com.lombardisoftware.core.script.js.TWSearchScriptable.executeSe
   archInternal(TWSearchScriptable.java:381)
    at
   com.lombardisoftware.core.script.js.TWSearchScriptable.jsFunctio
   n_execute(TWSearchScriptable.java:180)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native
   Method)
    at
   sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessor
   Impl.java:60)
    at
   sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethod
   AccessorImpl.java:37)
    at java.lang.reflect.Method.invoke(Method.java:611)
    at
   org.mozilla.javascript.MemberBox.invoke(MemberBox.java:161)
    ... 83 more
   
   
   PRODUCTS AFFECTED:
   IBM Business Process Manager (BPM) Advanced
   IBM BPM Standard
   IBM BPM Express
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  No additional information is available.
   
   
    
   
   

PROBLEM CONCLUSION
 *  A fix is available for IBM BPM that modifies the loading
   behavior of the business data aliases cache when the operational
    flag to use process instances is set to true and only applies
   when there are no instances available.
   
   On Fix Central (http://www.ibm.com/support/fixcentral), search
   for JR51707:
   
   1. Select IBM Business Process Manager with your edition from
   the product selector, the installed version to the fix pack
   level, and your platform, and then click Continue.
   2. Select APAR or SPR, enter JR51707, and click Continue.
   
   When you download fix packages, ensure that you also download
   the readme file for each fix. Review each readme file for
   additional installation instructions and information about the
   fix.
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   JR51707
   
   
 * REPORTED COMPONENT NAME
   BPM STANDARD
   
   
 * REPORTED COMPONENT ID
   5725C9500
   
   
 * REPORTED RELEASE
   801
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2014-11-03
   
   
 * CLOSED DATE
   2014-11-20
   
   
 * LAST MODIFIED DATE
   2014-11-20
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   BPM STANDARD
   
   
 * FIXED COMPONENT ID
   5725C9500
   
   

APPLICABLE COMPONENT LEVELS
 * R801 PSY
   UP