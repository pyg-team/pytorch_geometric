Title: IBM IV92857: HIGH CPU ON APM SERVER WHEN AGENTS ARE UNINSTALLED AND OFFLINE DELAY IS SET LESS THAN 10 MINS - United States

Text:
 SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS FIXED IF NEXT.
    
   
   

ERROR DESCRIPTION
 *  Severity:  3
   
   Abstract:    High CPU occurs on the APM server when there are a
   large number of agents and/or subnodes are uninstalled and the
   Remove Offline System Delay config property is less than 10
   minutes
   
   Environment:     APM server
   APM version:  8.1.3.0
   
   High CPU occurs on the APM server when there are a large number
   of agents and/or subnodes are uninstalled and the Remove Offline
    System Delay config property is less than 10 minutes because
   the OSLC provider service does not see the managed systems
   transition from online to offline and then from offline to
   deleted (removed).   This causes the OSLC provider service to
   see out of sync information in different database tables and
   issue queries over and over for deleted managed systems.
   
   Detailed Recreation Procedure:
   
   1) Set the Remove Offline System Delay config property   for the
   Agent Subscription Facility category on the Advanced
   Configuration UI page to a value less than 10 minutes (for
   example, 5 minutes)
   
   2) Uninstall many agents  and/or an agent with a large number of
   subnodes
   
   
   Related Files and Output:
   
   This message is logged over and over for multiple managed
   systems in the  <apm-server-home>/ccm/oslc_pm/logs/*.log files:
   
        Attempt to find parent record for node
   <managed-systen-name> failed
   
   
    
   
   

LOCAL FIX
 *  Workaround:
   
   1) Set the Remove Offline System Delay config property   for the
   Agent Subscription Facility category on the Advanced
   Configuration UI page to a value greater than 15 minutes.
   
   2)  apm stop_all
   
   3)  cd <apm-server-home>/ccm/oslc_pm/config
   4)  Edit the as.environment and add these lines:
   
   KAS_MERGE_MSN=NO
   KAS_KEEP_ALL_MSN=NO
   
   5)  apm start_all
   
   6) Wait at least 20 minutes after the start_all completes and
   then
   
   6a) Remove the 2 environment variables that were added in step 4
   6b) apm restart oslc
   
   
    
   
   

PROBLEM SUMMARY
 *  Fixed
   
   
    
   
   

PROBLEM CONCLUSION

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IV92857
   
   
 * REPORTED COMPONENT NAME
   OSLC
   
   
 * REPORTED COMPONENT ID
   5725U05LC
   
   
 * REPORTED RELEASE
   813
   
   
 * STATUS
   CLOSED FIN
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt / Xsystem
   
   
 * SUBMITTED DATE
   2017-01-30
   
   
 * CLOSED DATE
   2017-02-28
   
   
 * LAST MODIFIED DATE
   2017-02-28
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION

APPLICABLE COMPONENT LEVELS
 * R813 PSY
   UP