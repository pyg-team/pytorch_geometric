Title: IBM What to do if you cannot un-install SA IOM V2.1.1 - United States

Text:
saiom sa iom broken install registry uninstall un-install installation TECHNOTE (FAQ)

QUESTION
 Having problems uninstalling SA IOM V2.1.1 using the Windows Add or Remove Programs function? 

CAUSE
This can happen when something goes wrong during the install process, then when you try to uninstall SA IOM using Add or Remove Programs you receive a message, "The application cannot be found, do you want to remove it from the list?"

ANSWER
You can carry out the following steps to manually cleanup the machine and prepare your PC for a fresh SA IOM V2.1.1 install: 

Resolving an incomplete SA IOM V2.1.1 installation - a 'How To' document. 

NOTE: Read all the instructions before proceeding.

Note: this only applied to SA IOM V2.1.1, because we switched to the Windows Installer for V2.1.2

1. Save the install logs 

The logfiles are located in the following subdirectory 

<install dir>\IBM\SA IOM\install\logs 

Save all files from this directory because they could be necessary to trace a broken installation. 

2. Save the install.properties file 

The install.properties file is a file which is saved by the installer to disk to get back information about the last install. It contains important information about the last install and parameters. 
Save the file install.properties from <install dir>\IBM\SA IOM\install 


3. Save artifacts from the temp directory 

Installation artifacts could be helpful to get behind what was wrong 

Save the following directory: 
<system dir>\Users\Administrator\AppData\Local\Temp 
This directory may be a hidden directory 


4. The Zero G Registry 

The Zero G Registry is the internal registry from the software product Install Anywhere which is used to track installations done by this product. We use the product to install SA IOM. 

Other software might use the same installer. If we are the only product which is on the system we can just delete directory and file. Otherwise we have to get us out of this registry by manually deleting our entries. 

The hidden directory <system dir>\Program Files (x86)\Zero G Registry or on 32-bit systems 
<system dir>\Program Files\Zero G Registry contains a file named .com.zerog.registry.xml 

It is a hidden file, same as the directory containing the file. 

Browse the file 

If all entries refer to rpweb, rpserver, rpclient and / or derby, this indicates the only product which is installed with install anywhere was SA IOM then delete the directory and the file, if other products were installed before with Install Anywhere call SA IOM customer support to get the file cleaned for you


5. Save your data first 

In case of installation and upgrade problems first save your user data and scripts. 
If you want to reinstall or install the update from scratch and save the user data do the following: 

Save the following directories from the old installation for 32:bit systems it is:

<system dir>\Program Files\IBM\SA IOM\config 
<system dir>\Program Files\IBM\SA IOM\scripts 

For 64-bit systems it is:

<system dir>\Program Files (x86)\IBM\SA IOM\config 
<system dir>\Program Files (x86)\IBM\SA IOM\scripts 

These two directories contain all user data needed to restore your valuable user data 
If you installed derby and the Alert and escalation feature save the DBNOTIFY database 
<systems dir>\Program Files (x86)\IBM\SA IOM\derby\DBNOTIFY 
<systems dir>\Program Files\IBM\SA IOM\derby\DBNOTIFY 

The database contains all data from your alert installation 


6. Uninstall prerequisites 

Uninstall the following prerequisites from the system using Add or Remove Programs

a) DB2 RunTime Client Lite or (IBM Data Server Runtime Client - DB2)
b) Microsoft Visual C++ 2008 Redistributable x86 9.0.30411 


7. Cleaning process 

Try to uninstall Tivoli system Automation IOM v2.1 using the Windows Add or Remove Programs function first. If it fails leave the uninstallation alone and remove the files and entries manually

For 32-bit systems directory refer to <system dir>\Program Files\ 

For 64-bit systems use <system dir>\Program Files (x86)\ 

Deletion list: 
<system dir>\Program Files (x86)\IBM\SA IOM 
<system dir>\Program Files (x86)\Zero G Registry 

Have a look into the dir 
<system dir>\Users\Administrator\AppData\Local\Temp if possible clean it temp file should always be clean its not easy to give advice for the temp dir because its can look very different in each case so please use caution

From <system dir>\Windows\SysWOW64 or <system dir>\Windows\SysWOW64 

Delete the files autoexnt.bat, autoexnt.exe, autoexnt1.bat, autoexnt2.bat 

The files are used for the start of the derby and web component 

From <system dir>\Windows\SysWOW64\drivers delete the file rp3270.sys 
If the files are absent ignore them on 32bit systems the files are under 
<system dir>\Windows\System32 and <system dir>\Windows\System32\drivers 

The jvm for SA IOM is located under <system dir>\Program Files (x86)\jre 
You may delete it or reuse it delete <system dir>\ProgramData\Microsoft\Windows\Start Menu\Programs\Tivoli System Automation IOM v2.1 and entries therein 

Delete <system dir>\Users\Public\Desktop\SA IOM Management folder and content 

8. Registry Entries 

Always backup your Registry before making ANY changes.

For 64-bit systems some keys are under Wow6432Node so if you have a 64-bit system look at this subkey also 

Open the registry editor regedit using a Command prompt.

Delete the following keys and subkeys 

HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\IBM\SA IOM\ 

In case of 32-bit system its 

HKEY_LOCAL_MACHINE\SOFTWARE\IBM\SA IOM\ 

HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\ODBC\ODBC.INI\ODBC Data Sources\DBNOTIFY 

HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\ODBC\ODBC.INI\DBNOTIFY 

HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session 
Manager\Environment\DERBY_HOME 

HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session 
Manager\Environment\DERBy_INSTALL 

HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session 
Manager\Environment\DERBY_SERVER_HOST 

HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session 
Manager\Environment\DERBY_SERVER_PORT 

HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment\SAIOM_HOME 

HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment\JAVA_HOME if it points to our directory <system dir>\Program Files (x86)\jre

HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment\Path

Clean the path entry from <system dir>\Program Files (x86)\jre\jre\bin;<system dir>\Program Files (x86)\jre\bin; or whatever points to our java directory if the SA IOM is installed as a service delete the following keys also 

HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\RP_Primary and all subkeys 
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\Rp3270 and all subkeys 
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\eventlog\System\Rp3270 

HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion 
\Uninstall\Tivoli System Automation IOM v2.1 

To verify everything is gone, you can Search the Registry for 'Tivoli System Automation' and remove all entries you find, but the entries mentioned above are the necessary ones. 

After following all steps above reboot the system. 

The system should be clean and an initial installation of SA IOM should be possible. 
If it is desired restore your userdata scripts and config after the installation.