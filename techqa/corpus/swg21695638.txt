Title: IBM Issue with the purging Netezza history database version 3. - United States

Text:
nzhistcleanupdb TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 The error received when invoking the nzhistcleanupdb command. 

SYMPTOM
[nz@NZ10185 logs]$ cat QueryHist_purge.log
Force delete option is specified. Will delete entries without waiting for user response.
[nzhistcleanupdb] ERROR: Database 'histdb' has unsupported schema version: 3; Supported versions: (1) 

 


CAUSE
The above error is due to the old script /nz/kit.7.1.0.3/bin/adm/nzhistcleanupdb which support query history database version 1, and 2 only. 


ENVIRONMENT
Netezza Query History Database..........



RESOLVING THE PROBLEM
There is a engineering defect RTC 92686 and fix will be available in NPS 7.1.0.5 release date is end of March 2015. However, following is the work around that you can modify that script and request customer to make a copy of the original script /nz/kit.7.1.0.3/bin/adm/nzhistcleanupdb, rename it as nzhistcleanupdb.old. Now modify the copy of this script as below and give it same name nzhistcleanupdb with same privileges...................this works with one of my PMRs - 18133,756,000 


Change nzhistcleanupdb SUPPORTED_VERSIONS variable to include version 3:

#for checkSupportedSchemaVersion
#SUPPORTED_VERSIONS=( 1 2 )
SUPPORTED_VERSIONS=( 1 2 3 ) #this fixes the problem