Title: IBM DB2 shows error SQL0440N when configuring Administrative Task Scheduler (ATS) in IBM Data Server Manager (DSM) - United States

Text:
DB2 error SQL0440N Administrative Task Scheduler ATS Data Server Manager DSM IBM_RTMON SQLCODE 551 440 SQLSTATE 42501 prod.test_ats_priviliges 42884 REPLACE PROCEDURE TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 DB2 shows error SQL0440N in db2diag.log file, when configuring Administrative Task Scheduler (ATS), or watchdogs, in IBM Data Server Manager (DSM)


SYMPTOM
In DB2 db2diag.log file, there are several errors related to the SQL0440N error, for example: 

FUNCTION: DB2 UDB, Administrative Task Scheduler, AtsTask::executeTask, probe:600
MESSAGE : ZRC=0xFFFFFE48=-440
SQL0440N No authorized routine named "" of type "" having compatible
arguments was found.

SQL0440N No authorized routine named "prod.test_ats_priviliges" of type "PROCEDURE" having compatible arguments was found. SQLSTATE=42884 

 

In DSM RtmonWeb log file, there are errors related to the missing privileges for the user:
ERROR EvmonWatchdog::sicWatchdog: <database_name> watchdog SP for 'rtmon_evmon_locking' not created due to exception:
com.ibm.db2.jcc.am.SqlSyntaxErrorException: The statement failed because the authorization ID does not have the required authorization or privilege to perform the operation. Authorization ID: "<USER_A>". Operation: "REPLACE PROCEDURE". Object: "IBM_RTMON.RTMON_EVMON_LOCKING_WATCHDOG".. SQLCODE=-551, SQLSTATE=42501, DRIVER=3.72.16


CAUSE
The user configured in DSM to connect to the monitored database, does not have authorization to run the REPLACE PROCEDURE command in DB2


RESOLVING THE PROBLEM
Check if the user has the Privileges Required for DSM on DB2 LUW [https://www.ibm.com/developerworks/community/wikis/home?lang=en#!/wiki/W377e39cb6e13_42a7_b752_005b67cb913f/page/Privileges%20Required%20for%20DSM%20on%20DB2%20LUW] 

 

If the privileges are correct, please check the users who own the stored procedures in SYSCAT.ROUTINES catalog view [https://www.ibm.com/support/knowledgecenter/en/SSEPGG_11.1.0/com.ibm.db2.luw.sql.ref.doc/doc/r0001045.html], for example: 

ROUTINESCHEMA ROUTINENAME OWNER IBM_RTMON RTMON_EVMON_LOCKING_WATCHDOG USER_B IBM_RTMON RTMON_EVMON_THRESH_WATCHDOG USER_B IBM_RTMON RTMON_EVMON_UTIL_WATCHDOG USER_B IBM_RTMON RTMON_EVMON_ACTIVITIES_WATCHDOG USER_A According to the DB2 manual, the DB2 REPLACE PROCEDURE command must be executed by the owner of the stored procedure: 

CREATE PROCEDURE (sourced) statement [https://www.ibm.com/support/knowledgecenter/en/SSEPGG_11.1.0/com.ibm.db2.luw.sql.ref.doc/doc/r0023603.html]
To replace an existing procedure, the authorization ID of the statement must be the owner of the existing procedure (SQLSTATE 42501).