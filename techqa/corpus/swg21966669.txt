Title: IBM Replacing a failed XC10 appliance in a collective - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 There are two or more XC10 appliances in a collective, namely appliance A, appliance B, and appliance C. Appliance B has a hardware problem and IBM has provided a replacement for appliance B. This document provides the step-by-step instructions on how to remove the failed appliance from the collective, and then introduce a replacement appliance. 

RESOLVING THE PROBLEM
Before you begin, you will need: 

 * A backup of the configuration details from any appliance in the collective. For more information, see Importing and exporting configurations [https://www-01.ibm.com/support/knowledgecenter/SSS8GR_2.5.0/com.ibm.websphere.datapower.xc.doc/tpreserve.html]. 
 * A replacement appliance that was shipped to you by IBM Support.

 * PART A: Remove the failed appliance from the collective
 * 
 * 
 * Important: 
 * 
 * 
 * 
 *  Log into appliance A. In the user interface, click Collective > Members. Look for the failed appliance you want to remove from the collective and click Delete. Because this appliance is offline, you will be prompted to force a disconnect. Click Force. This may take a few minutes to complete. 
 * 
 * PART B:
 *  
 * Make sure all existing appliances are running the same firmware version
 * 
 * 
 * 
 * must 
 * 
 * show version
 * 
 * 
 * 
 * 
 * 
 * 
 * Updating the firmware
 * 
 * 
 * 
 * PART C: 
 * Make sure the replacement appliance is running the same firmware version as existing appliances
 * 
 * 
 * 
 * show version 
 * 
 * 
 * 
 *  If the versions of the appliances are the same as the replacement appliance, then proceed to the next section of this technote, PART D: Add the replacement appliance into the collective. 
 *  If the versions are not the same between the replacement appliance and the collective, then the version on replacement appliance needs to be either downgraded or upgraded to match the appliances in the collective. There are two variants of the XC10 firmware that are available depending on the hardware, so you must determine the version to download. Follow the instructions outlined in this technote: Determine which firmware to upgrade to download for WebSphere DataPower XC10 Appliance [https://www-304.ibm.com/support/docview.wss?uid=swg21682625]. After determining the firmware and if you need to upgrade, following the instructions: Updating the firmware [https://www-01.ibm.com/support/knowledgecenter/SSS8GR_2.5.0/com.ibm.websphere.datapower.xc.doc/aa/aat_updating_firmware.html]. 
 * PART D: Add the replacement appliance into the collective
 * 
 *  Assemble the replacement appliance using a serial console and ethernet cables. For more information, see Quick Start: Installing the appliance hardware [https://www-01.ibm.com/support/knowledgecenter/SSS8GR_2.5.0/com.ibm.websphere.datapower.xc.doc/tquickstart.html]. Log into the replacement appliance using the serial console and initialize and configure the appliance. If you need more information on this step, see Initializing and configuring IBM WebSphere DataPower XC10 Appliance [http://www-01.ibm.com/support/knowledgecenter/SSS8GR_2.1.0/com.ibm.websphere.datapower.xc.doc/tinitappl.html]. Configure the IP addresses, default gateway, static routes, DNS, NTP, and SNMP that you had previously set for the removed appliance. Verify that network connectivity between the appliances is working by issuing the following command: net-test ping <IP address of the remaining appliance>. . Import the configuration details you had previously backed up. For more information, see steps 2-5 in the following topic Importing and exporting configurations [https://www-01.ibm.com/support/knowledgecenter/SSS8GR_2.5.0/com.ibm.websphere.datapower.xc.doc/tpreserve.html]. Note: Do not specify the -silent option. If you have any issues with the import, immediately run platform must-gather <file-name>. Do not re-run this command as it will overwrite details required by IBM support. The command creates a TGZ formatted file which you must upload to IBM support. Log into appliance A and add the replacement appliance to the collective. Wait for the collective task to complete. There is no need to restart either appliance. For more information, see Creating a collective [https://www-01.ibm.com/support/knowledgecenter/SSS8GR_2.5.0/com.ibm.websphere.datapower.xc.doc/tcollective.html]. 
 * 
 * PART E: Verify that catalog and container servers are running as expected on both appliances, run the following commands
 * 
 *  Issue thexscmd -c placementservicestatus command:
    * Note: 
    * 
   
   
   For success, you should the output: numOutstandingWorkItems 0
   Issue thexscmd -c showplacement and the xscmd -c showmapsizes commands
    * Note:
    * 
    * showplacement 
    * 
    * showmapsizes 
    * 
   
   
   For success, you should see a mix of primary and replica shards on both appliances. 
   
   If you do not see a mix of primary and replica shards then run:  *  xscmd â€“c balanceShardTypes 
    * 
    * showplacement 
    * 
    * showmapsizes 
    * 
   
   

 

Cross reference information Segment Product Component Platform Version Edition Application Servers WebSphere DataPower XC10 Appliance Application Servers Hardware