Title: IBM FSR - TargetInvocationException under Citrix - United States

Text:
TargetInvocationException; Citrix TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 When opening a report under Citrix users sometimes receive a TargetInvocationException error. 

SYMPTOM
When opening reports under Citrix the following error is intermittently received: 

Type: TargetInvocationException 
Message: Exception has been thrown by the target of an invocation. 
Stack Trace: at System.RuntimeType.InvokeDispMethod(String name, 
BindingFlags invokeAttr, Object target, Object[] args, Boolean[] 
byrefModifiers, Int32 culture, String[] namedParameters) 
at System.RuntimeType.InvokeMember(String name, BindingFlags bindingFlags, 
Binder binder, Object target, Object[] providedArgs, ParameterModifier[] 
modifiers, CultureInfo culture, String[] namedParams) 
at System.Type.InvokeMember(String name, BindingFlags invokeAttr, Binder 
binder, Object target, Object[] args) 
at Clarity.FSR.UI.Controls.ExcelControl.LoadWorkbook(String filename) 
at Clarity.FSR.UI.Forms.LayoutForm.ProcessExcelContent_Helper(Int32 ObjID, 
String XmlData) 
at Clarity.FSR.UI.Forms.LayoutForm.ProcessExcelContent(Int32 ObjID, String 
XmlData) 
at Clarity.FSR.UI.Forms.LayoutForm.SetContentType(ContentType contentType) 
at Clarity.FSR.UI.Forms.LayoutForm.HandleSectionObjectSelection() 
at Clarity.FSR.UI.Forms.LayoutForm.InitControls() 
at Clarity.FSR.UI.Forms.LayoutForm.InitData(Boolean Refresh, Boolean All, 
Boolean bLoadAllObjects) 
at Clarity.FSR.UI.Forms.LayoutForm.Refresh(Boolean All) 
at Clarity.FSR.UI.Forms.LayoutForm.ProcessOnWorkflowStatusChange(ObjectRow& 
or, Int32 iCurrent, Int32 iDefault, String sWorkflowXml, String 
sWorkflowDueDate, String Para) 
at 
Clarity.FSR.UI.Forms.LayoutForm._workflowStatusListBox_SelectedValueChanged 
(Object sender, EventArgs e) 
at 
DevExpress.XtraEditors.Repository.RepositoryItemComboBox.RaiseSelectedValueChanged 
(EventArgs e) 

at DevExpress.XtraEditors.ComboBoxEdit.UpdatePopupEditValueIndex(Int32 
prevIndex) 
at DevExpress.XtraEditors.ComboBoxEdit.set_EditValue(Object value) 
at DevExpress.XtraEditors.ImageComboBoxEdit.set_EditValue(Object value) 
at DevExpress.XtraEditors.PopupBaseEdit.AcceptPopupValue(Object val) 
at DevExpress.XtraEditors.PopupBaseEdit.DoClosePopup(PopupCloseMode 
closeMode) 
at DevExpress.XtraEditors.PopupBaseEdit.ClosePopup(PopupCloseMode 
closeMode) 
at DevExpress.XtraEditors.PopupBaseEdit.ClosePopup() 
at DevExpress.XtraEditors.Popup.PopupListBox.OnMouseUp(MouseEventArgs e) 
at System.Windows.Forms.Control.WmMouseUp(Message& m, MouseButtons button, 
Int32 clicks) 
at System.Windows.Forms.Control.WndProc(Message& m) 
at DevExpress.Utils.Controls.ControlBase.WndProc(Message& m) 
at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message& m) 
at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message& m) 
at System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, Int32 msg, 
IntPtr wparam, IntPtr lparam) 

CAUSE
Citrix loses connection to the database, due to faulty profile settings.



ENVIRONMENT
FSR Version: 6.6.0.1 (6.6.1.150)
FSR DB Version: 6.6.1.10



DIAGNOSING THE PROBLEM
Open any report under Citrix. If you receive the above error you might be experiencing this issue.



RESOLVING THE PROBLEM
Re-create the Citrix profile.