Title: IBM Oracle stored procedure returns only 1 of multiple rows when called from WTX 64 bit ODBC Adapter on Linux or Unix - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 When using a WebSphere Transformation Extender (WTX) map with the ODBC Adapter and the DataDirect Oracle Wire Protocol driver to call a stored procedure that returns multiple rows, you may find that a map returns all rows when using the WTX Design Studio on Windows but the map may return only one of the multiple rows on Linux or Unix.

Note: The following error may also occur if the "ProcedureRetResults" setting for the DataDirect ODBC Oracle Wire Protocol data source has not been enabled.

PLS-00306: wrong number or types of arguments in call to '<stored_procedure_name>'


SYMPTOM
The ODBC Adapter output contains only 1 of the multiple rows expected from the stored procedure. 

Note: The following error may also occur if the "ProcedureRetResults" setting has not been enabled in the odbc.ini file for the DataDirect ODBC Oracle Wire Protocol data source.

<6220-1184>: Error in SQLExecDirect
Message: [IBM WTX][ODBC Oracle Wire Protocol driver][Oracle]ORA-06550:
line 1, column 8:
PLS-00306: wrong number or types of arguments in call to '<stored_procedure_name>'
ORA-06550: line 1, column 8:
PL/SQL: Statement ignored
SQL State: S1000
<6220-1184>: Returned status: (-1009)
Failed_to_execute_the_SQL_statement



CAUSE
A defect in Data Direct 7.1 Oracle Wire Protocol driver delivered with WTX 8.4.1.x means that the DataDirect Oracle Wire Protocol data source "WireProtocolMode=2" option is required when a stored procedure returns more than one row.

The defect is discussed in the following document:

When WireProtocolMode=1 is set on the Oracle Wire Protocol data, data fetched from a stored procedure returns only the first row of data [http://knowledgebase.progress.com/articles/Article/000037309]

Note: On Windows, the default value for the Data Direct 7.1 Oracle Wire Protocol data source “Wire Protocol Mode” option is set to "2" on the "Performance" tab which avoids the problem.



ENVIRONMENT
Linux or Unix WTX 8.4.1.x 64 bit execution environments using Data Direct 7.1 ODBC Oracle Wire Protocol driver



RESOLVING THE PROBLEM
The DataDirect Oracle Wire Protocol data source "WireProtocolMode=2" option must be set in the odbc.ini file to enable returning multiple rows from an Oracle stored procedure.

To resolve issue, the following option is required for the Oracle Wire Protocol data source defined in the odbc.ini file:

WireProtocolMode=2


Note: The DataDirect Oracle Wire Protocol data source "ProcedureRetResults=1" option must be set in the odbc.ini file to enable returning results from an Oracle stored procedure.

On Windows, the "Procedure Returns Results" check box must be checked under the "Advanced" tab when configuring the ODBC data source.

Reference information:

PLS-00306: wrong number or types of arguments in call to storedprocedurename [http://knowledgebase.progress.com/articles/Article/PLS-00306-wrong-number-or-types-of-arguments-in-call-to-storedprocedurename]

Connect for ODBC Performance - Oracle Wire Protocol and Oracle Client [https://www.progress.com/products/datadirect-connect/odbc-drivers/odbc-developer-center/odbc-tutorials/increasing-connect-for-odbc-driver-performance/oracle-wire-protocol-and-oracle-client]