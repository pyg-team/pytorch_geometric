Title: IBM Configuration guidelines for the CCRC WAN server - United States

Text:
RN8.0; RNCC8.0; RNCC8.0.0.1; http://www-01.ibm.com/support/docview.wss?uid=isg1fixinfo112964 TECHNOTE (FAQ)

QUESTION
 How do you configure the CCRC WAN server to ensure optimal performance and high scalability for ClearCase Remote Client (CCRC) users in ClearCase Version 8.0 and later? 

ANSWER
NOTE: These guidelines are derived from benchmark testing on servers with the minimum recommended hardware configuration. The testing entailed various commonly used ClearCase operations with an average transaction rate of 15 operations per hour per user. Start with the settings listed in this document and then adjust them based on your expected peak load.






Required System Resources 

All platforms 
 *  8 GB of memory. If the CCRC WAN server is to host more than a single WAS profile (for example, ClearCase, ClearQuest, Requisite Pro), additional resources may be needed. Quad-core server CPUs provide a strong processor base. 

Windows 
 *  Services associated with the CCRC WAN server profile e.g. IBM WebSphere Application Server V7.0 - ccrcprofile must be set to allow the service to interact with the desktop system: 
 *  Click Administrative Tools->Services 
   Right-click IBM WebSphere Application Server V7.0 - ccrcprofile 
   Click Log On 
   Select Allow service to interact with desktop 
 *  Increase the desktop heap size. See technote 1142584: ClearCase processes unexpectedly die on Microsoft Windows [http://www-01.ibm.com/support/docview.wss?uid=swg21142584] for instructions. This may not be needed for 64 bit machines.
   Set the Session size for scalability. The value depends on the peak concurrent usage. 

 * Set Windows registry key HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management\SessionViewSize to 96 or 192 based on expected peak load. 
   
   Start with 96 and increase to 192 if out-of-memory errors are seen in CCRC WAN server profile's SystemOut.log e.g. \Program Files\IBM\RationalSDLC\Common\ccrcprofile\logs\server1\SystemOut.log during peak load. 


All UNIX/Linux 
 *  The minimum requirement for swap space is twice the size of memory. 
 *  Increase the maximum number of open file descriptors to handle the user load. Refer to operating system documentation for instructions on how to set this parameter. CAUTION: Setting this value too high increases size of the ClearCase back end (CCBE) and view server processes. Start with 16K file handles and then adjust as needed. 


Solaris 10 

 * 
 * 
 * 
 * 
 * 



AIX 

 *  Use an AIX Power 5, 6 or 7 host system. 
 *  You must install the fix for APAR IZ55804 (AIX 5.3) or IZ52038 (AIX 6.1) to correct a problem that causes the portmapper daemon to hang. The fix is included in the 5300-11 technology level. To obtain the fix for AIX 6.1 refer to fixinfo112964: Fix pack information for: PORTMAPPER HANGS [http://www-01.ibm.com/support/docview.wss?uid=isg1fixinfo112964] 
 *  Set the following operating system parameters: 
 * 
 * no -o tcp_nagle_limit=0
 * 
 * 
 * 
 * 
 * 
 * 
 * no -o clean_partial_conns=1
 * 
 * 
 * 
 * 
 * 
 * no -o tcp_nodelayack=1
 * 
 * 
 * 
 * tcp_nodelayack
 * 
 * 
 * 
 * no -o rfc1323=1
 * 
 * 
 * 
 * tcp_recvspace
 * 
 * tcp_sendspace
 * 
 * 
 * 
 * 



HP 

 *  Increase the following tunable kernel parameter: 
 *  maxfiles=4096 
   maxfiles_lim=8192 
   nfile=16384 
 * 
 *  Disable the Nagle algorithm: 
 * 
 * 
 * 
 * 


Linux 

 *  If PAM authentication is in use 
 *  cd /etc/pam.d 
   cp login clearcase 
   Edit file clearcase and comment out the line that contains the string securetty (usually the first line). 
 *  Increase max # files, edit /etc/security/limits.conf and set lines as follows: 
 * 
 * * soft nofile 16383
 * 
 * * hard nofile 16383
 * 







CCRC WAN server Parameters 

CCRC WAN server configuration parameters are defined in 

<CC_HOME>/config/ccrc/server.conf e.g. c:\Program Files\IBM\RationalSDLC\Clearcase\config\ccrc\server.conf 

For reference, use 

<CC_HOME>/config/ccrc/server.conf.sample 

 * ccrcLoginSessionTimeout

 * Description : 
 * 
 * 
 * 
 * Value : 
 * 
 * 
 * 
 * Default : 
 * 
 * 
 * 
 * Note : 
 * 

 * ccrcPrimaryGroup

 * Description : 
 * 
 * 
 * 
 * Value : 
 * 
 * 
 * 
 * Default : 
 * 
 * 
 * 
 * Note : 
 * 


 * ccrcTempDir

 * Description : 
 * 
 * 
 * 
 * Value : 
 * 
 * 
 * 
 * Default : 
 * 
 * 
 * 
 * 
 * 
 * Note : 
 * 
 *  
 * 


 * ccrcUploadLimit

 * Description : 
 * 
 * 
 * 
 * Value : 
 * 
 * 
 * 
 * Default : 
 * 
 * 
 * 
 * Note : 
 * 


 * ccrcUseViewHostPathForGlobalPath

 * Description : 
 * 
 * 
 * 
 * Value : 
 * 
 * 
 * 
 * Default : 
 * 
 * 
 * 
 * Note : 
 * 
 * true
 * 


 * ccrcViewStorage

 * Description : 
 * 
 * 
 * 
 * Value : 
 * 
 * ccrcUseViewHostPathForGlobalPath=false
 * 
 * ccrcUseViewHostPathForGlobalPath=true
 * 
 * 
 * 
 * Default : 
 * 
 *   *  CC_HOME\var\ccweb if CC_HOME path does not contain embedded spaces CC_HOME drive root:\ccweb if CC_HOME path contains embedded spaces 
   
   
 * 
 * /var/adm/rational/clearcase/ccweb
 * 
 * 
 * Note : 
 * 
 * ccrcUseViewHostPathForGlobalPath
 * 
 * 

 * ccrcVobLineTerminator 

 * Description : 
 * 
 * 
 * 
 * Value : 
 * 
 * 
 * 
 * Default : 
 * 
 * 
 * 
 * Note : 
 * 
 * 

 * ccrcClearQuestDatabaseMapFile

 * Description : 
 * 
 * 
 * 
 * Value : 
 * 
 * 
 * 
 * Default : 
 * 
 *  
 * 
 * 
 * Note :
 * 
 * 

 * ccrcDownloadCompressionThreshold

 * Description : 
 * 
 * 
 * 
 * Value : 
 * 
 * 
 * 
 * Default :
 * 
 *  
 * 
 * 
 * Note : 
 * 


 * ccrcSupportsParallelLoad

 * Description : 
 * 
 * 
 * 
 * Value : 
 * true
 * 
 * false
 * 
 * 
 * Default : 
 * true
 * 
 * 
 * Note : 
 * 
 * 1515393: About CCRC WAN Server parallel view loading
 * 
 * ccrcMaxRequestsPerSession, ccrcMaxRequestsOverall and ccrcMaxSessionsOverall
 * 
 *  


 * ccrcMaxRequestsPerSession

 * Description : 
 * 
 * 
 * 
 * Value : 
 * 
 * 
 * 
 * Default : 
 * 
 * 
 * 
 * Note :
 * 
 * ccrcSupportsParallelLoad, ccrcMaxRequestsOverall , ccrcMaxSessionsOverall and ccrcSupportsParallelLoad
 * 


 * ccrcMaxRequestsOverall 

 * Description :
 * 
 * 
 * 
 * Value : 
 * 
 * 
 * 
 * Default : 
 * 
 * 
 * 
 * Note :
 * 
 * ccrcSupportsParallelLoad, ccrcMaxRequestsPerSession and ccrcMaxSessionsOverall
 * 


 * ccrcMaxSessionsOverall

 * Description :
 * 
 * 
 * 
 * Value : 
 * 
 * 
 * 
 * Default : 
 * 
 * 
 * 
 * Note :
 * 
 * ccrcSupportsParallelLoad, ccrcMaxRequestsPerSession and ccrcMaxRequestsOverall
 * 




NOTE:  * ccrcMaxRequestsPerSession * ccrcMaxSessionsOverall = the maximum number of active CCBE (ClearCase Back End) processes expected when ccrcMaxSessionsOverall number of CCRC sessions are active with peak activity. Each instance of CCBE processes only one request at a time.

 * ccrcMaxRequestsOverall should NOT be set to (ccrcMaxRequestsPerSession * ccrcRequestsPerSession). ccrcMaxRequestOverall should be set to the maximum number of CCBE processes (in addition to other processes on the server machines e.g. view servers, etc) that are sustainable on the system (based on system resources).

 * Refer to technote 1515393 [http://www-01.ibm.com/support/docview.wss?uid=swg21515393] for configuration guidelines for Parallel Web View load.

 * Set WAS thread pool max limits to be >= maxRequestsOverall.







WAS Configuration parameters for the CCRC WAN server Profile 
Use the WAS console (http://server:port/ibm/console) to make changes. The port for the console is listed in <profile-home>/logs/server1/AboutThisProfile.txt, where <profile-home> is the CCRC profile's home directory. See "Commonly Used Commands" below. 

The default values are applied to the default CCRC WAN server Profile, ccrcprofile, if a new profile is created during install. 

If the CCRC WAN server is deployed in an existing profile, the defaults must be applied after careful consideration if the profile is shared with other applications. 

To apply the default values to the profile hosting the CCRC WAN server : 
 *  In a command window, change directory to : 
 *   * 
    * <ccase-home-dir>\var\web, 
    * 
    * 
    * 
    * /opt/rational/clearcase/web
    * 
    * 
   
   Run the following command : 
 *  
   On Windows, <profile-home>\bin\wsadmin.bat -c "source ccrcAdminUtils.jacl" -c "setCCRCRecommendedDefaults" On UNIX/Linux, profile-home/bin/wsadmin.sh -c "source ccrcAdminUtils.jacl" -c "setCCRCRecommendedDefaults" 
   
   
   where <profile-home> is the CCRC profile's home directory. See "Commonly Used Commands" below.
   
   



Servers->Server Types>WebSphere Application Server>server1>Web container>Custom property 
 * com.ibm.ws.webcontainer.channelwriteType
 * 
 * sync



Servers>Server Types-WebSphere Application Server>server1>Web container transport chains>WSInboundDefault>Http inbound channel 
 * Write timeout=300 seconds
 * 
 * Persistent timeout=120 seconds



Servers>Server Types>WebSphere Application Server>server1>Process definition>Java Virtual Machine 
 * Initial heap size=1024 MB
 * 
 * Maximum heap size=1024MB
 * 


Servers>Server Types>WebSphere Application Server>server1>Thread Pools 
 * Web Container=300
 * 
 * Default=300



Environment>WebSphere Variables> 
 * AIX_THREAD_SCOPE=S



Troubleshooting>Logging and Tracing>server1>Diagnostic trace service 
 * Maximum File Size=20MB
 * 
 * Maximum number of Historical files=20






Commonly Used Commands 

This section contains commonly used command referred to in this document. 

Locating the WAS profile home directory (profile-home) 
 * 
 * 
 * 
 * 
 * <was-home>\bin\manageprofiles.bat -getPath -profileName <profile name>
 * 
 * 
 * 
 * <was-home>\bin\manageprofiles.sh -getPath -profileName <profile name>
 * 
 * 
 * 


Listing WAS profiles on the system 
 * 
 * 
 * 
 * 
 * <was-home>\bin\manageprofiles.bat -listProfiles
 * 
 * 
 * 
 * <was-home>\bin\manageprofiles.sh -listProfiles
 * 
 * 
 *