Title: IBM Virtual machine backup with tags fails with the ANS2630E error message - United States

Text:
sp4ve spforve tsm4ve tsmforve TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 In an IBM Spectrum Protectâ„¢ for Virtual Environments: Data Protection for VMware system, a data mover is installed on a Linux operating system, and the data mover is configured as a tag-based node. A virtual machine (VM) backup schedule fails with the following error:
ANS2630E The Java runtime library for the vCloud Suite plug-in library failed to load or initialize. 

DIAGNOSING THE PROBLEM
This error indicates that the link to the Java Runtime Environment (JRE) does not exist or that the LD_LIBRARY_PATH environment variable is not set correctly.
To verify the LD_LIBRARY_PATH environment variable, run the following Linux command:
env | grep LD_LIBRARY_PATH

To verify whether a link to the JRE exists in the client directory, run the following command:
ls -la /opt/tivoli/tsm/client/ba/bin

To verify the path of the libjvm.so file, run the following command:
find / | grep libjvm.so



RESOLVING THE PROBLEM
Verify that your system meets the requirements in Setting a data mover node as a tag-based node [https://www.ibm.com/support/knowledgecenter/SSERB6_8.1.0/ve.user/t_ve_dpext_set_tagdatamover.html]. 


Specifically, ensure that the following requirements are met:


 1. At least one data mover and the Data Protection for VMware vSphere graphical user interface (GUI) must be installed on the same server. This data mover node must be configured so that the vCenter server credentials are saved. You can save the credentials by running the configuration wizard to save the data mover node password, or by using the dsmc set password command on the data mover command line.
    
    If you use additional data movers, which run on VMs or physical computers, you can install them on other servers. For tagging support, all these data movers must also be configured with the vmtagdatamover=yes option. These additional data movers do not require the Data Protection for VMware vSphere GUI to be installed on the same server in order for them to work correctly as tag-based data movers.
    
 2. For Linux data movers, ensure that you specify the data mover installation directory and the Java shared library libjvm.so in the LD_LIBRARY_PATH environment variable. The path to libjvm.so is used for tagging support when you enable the vmtagdatamover option on the data mover. 


As per the ANS2630E message, verify that a link named jre, referencing the jre directory under your Java installation path, exists in the backup-archive client installation directory. If a link does not exist, create the link, for example: 

ln -s /opt/ibm/java-x86_64-70/jre /opt/tivoli/tsm/client/ba/bin/jre 

Alternatively, modify the LD_LIBRARY_PATH environment variable to include the path to libjvm.so, for example: 
export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/opt/tivoli/tsm/client/ba/bin:/opt/ibm/java-x86_64-70/jre/bin/classic 

Modify the Java path as required by your system installation. 

In this case, the JRE link was missing. After the link was added, the VM backup ran successfully.