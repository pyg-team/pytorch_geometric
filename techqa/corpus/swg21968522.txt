Title: IBM How to stop PureData System for Analytics Appliance and reboot both hosts? - United States

Text:
reboot host; linux; netezza; IBM PureData for Analytics; N1001; N2002; N3003 TECHNOTE (FAQ)

QUESTION
 How do I stop the PureData System for Analytics and reboot both hosts? 

CAUSE
In order to recognize OS components or any other pertinent maintenance reason.

ANSWER

This procedure assumes HA1 is active. If HA2 is active, reverse HA1/HA2 order. 

Disable Callhome (as nz)

1. $ nzcallhome -status
2. $ nzcallhome â€“off 

Perform a backup of the catalog (as NZ)
3. $ nzhostbackup /nzscratch/hostbackup_<date>.tgz

- Connect to the HA1 host and stop NPS. (as NZ)
4. $ nzstop

- Stop the heartbeat services (as ROOT)
5. $ ssh ha2 service heartbeat stop; service heartbeat stop

- Change the heartbeat service initialization (as ROOT)
6. $ ssh ha2 chkconfig heartbeat off; chkconfig heartbeat off

- Reboot both hosts one by one to guarantee at lease one host is up at all times (as ROOT)
7. HOST1$ reboot
(wait until HOST1 is up to reboot HOST2)
8. HOST2$ reboot

- Certify the DRBD services are up and running. (as ROOT)
9. $ ssh ha2 service drbd status; service drbd status

- Start the heartbeat services again (as ROOT)
10. $ ssh ha2 service heartbeat start; service heartbeat start

- Monitor heartbeat startup using crm_mon command until all resources are started (about 10 min. ) (as ROOT)
11. $ watch crm_mon -i1

- Monitor NZ startup using command below until all blades are ACTIVE and ONLINE(as NZ)
12. $ watch nzhw -type spu

- Check NPS status; must be online.(as NZ)
13. $ nzstate

- Change heartbeat services initialization.
14. $ ssh ha2 chkconfig heartbeat on; chkconfig heartbeat on 

- Re-enable callhome (as nz)
15. $nzcallhome -on