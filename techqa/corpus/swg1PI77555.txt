Title: IBM PI77555: ECLIPSELINK SCROLLABLE CURSOR RESULTS IN A CLASSCASTEXCEPTION - United States

Text:
  FIXES ARE AVAILABLE
9.0.0.5: WebSphere Application Server traditional V9.0 Fix Pack 5 [http://www-01.ibm.com/support/docview.wss?uid=swg24044067]
9.0.0.6: WebSphere Application Server traditional V9.0 Fix Pack 6 [http://www-01.ibm.com/support/docview.wss?uid=swg24044242]
9.0.0.7: WebSphere Application Server traditional V9.0 Fix Pack 7 [http://www-01.ibm.com/support/docview.wss?uid=swg24044620]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  Execution of Named native query fails with
   CWWJP9991W(ClassCastException) after using a
   ScrollableCursor
   with the same named native query.
   eclipselink   W   CWWJP9991W: java.lang.ClassCastException:
   org.eclipse.persistence.queries.SQLCall incompatible with
   java.util.Vector
   eclipselink   3   throwable
   java.lang.ClassCastException:
   org.eclipse.persistence.queries.SQLCall incompatible with
   java.util.Vector
   at
   org.eclipse.persistence.internal.queries.DatasourceCallQuery
   Mech
   anism.executeSelectCall(DatasourceCallQueryMechanism.java:29
   9)
   Once the named native query with ScrollableCursor is
   invoked,
   the getResultList of the following same named native query
   resulted into the ClassCastException.
   
   
    
   
   

LOCAL FIX
 *  By using the different named native query or non-native query,
   the issue didn't happen.
   
   
    
   
   

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED:  All users of IBM WebSphere Application      *
   *                  Server Liberty - Java Persistence APA - JPA *
   *                  2.1 & EclipseLink                           *
   ****************************************************************
   * PROBLEM DESCRIPTION: Using EclipseLink's                     *
   *                      "eclipselink.cursor.scrollable" query   *
   *                      hint on NamedQuery's results in a       *
   *                      ClassCastException                      *
   ****************************************************************
   * RECOMMENDATION:                                              *
   ****************************************************************
   Application is using EclipseLink's
   "eclipselink.cursor.scrollable" query hint and encountering the
   following ClassCastException.
   
   Exception:
   java.lang.ClassCastException:
   org.eclipse.persistence.queries.SQLCall incompatible with
   java.util.Vector
   	at
   java.lang.ClassCastException.<init>(ClassCastException.java:63)
   	at
   org.eclipse.persistence.internal.queries.DatasourceCallQueryMech
   anism.executeSelectCall(DatasourceCallQueryMechanism.java:299)
   	at
   org.eclipse.persistence.internal.queries.DatasourceCallQueryMech
   anism.selectAllRows(DatasourceCallQueryMechanism.java:694)
   	at
   org.eclipse.persistence.queries.ReadAllQuery.executeObjectLevelR
   eadQuery(ReadAllQuery.java:559)
   	at
   org.eclipse.persistence.queries.ObjectLevelReadQuery.executeData
   baseQuery(ObjectLevelReadQuery.java:1175)
   
   
    
   
   

PROBLEM CONCLUSION
 *  The fix for this APAR changes the EclipseLink implementation and
   involves an update to the thirdparty source. See
   https://bugs.eclipse.org/bugs/show_bug.cgi?id=511426 [https://bugs.eclipse.org/bugs/show_bug.cgi?id=511426]
   
   The fix for this APAR is currently targeted for inclusion in
   Service Level (Fix Pack) 9.0.0.5 of WebSphere Application Server
   version 9.0 and in fix pack 17.0.0.3 for WebSphere Application
   Server Liberty.  Please refer to the Recommended Updates page
   for delivery information:
   http://www.ibm.com/support/docview.wss?rs=180&uid=swg27004980 [http://www.ibm.com/support/docview.wss?rs=180&uid=swg27004980]
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PI77555
   
   
 * REPORTED COMPONENT NAME
   LIBERTY PROFILE
   
   
 * REPORTED COMPONENT ID
   5724J0814
   
   
 * REPORTED RELEASE
   855
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt / Xsystem
   
   
 * SUBMITTED DATE
   2017-03-02
   
   
 * CLOSED DATE
   2017-09-14
   
   
 * LAST MODIFIED DATE
   2017-09-14
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   LIBERTY PROFILE
   
   
 * FIXED COMPONENT ID
   5724J0814
   
   

APPLICABLE COMPONENT LEVELS
 * R855 PSY
   UP