Title: IBM I am getting "Out of memory" messages during a 'ccmdb check' on AIX. How can this be resolved? - United States

Text:
 TECHNOTE (FAQ)

QUESTION
 I am getting "Out of memory" messages during a 'ccmdb check' on AIX. How can this be resolved? 

ANSWER
 

This FAQ does not apply to Windows, Linux or other UNIX platforms outside of AIX . If you encounter the problem on any of those platforms please reportit to Technical Support.Provide the full output of the ccmdb check command when contacting Support. 

This issue is due to the AIX default maximum heap size of the executable "ccmdb_refchk_inf". The ccmdb check program is heavy on memory usage. Most AIX installations will restrict the memory usage of individual processes to 256MB. In very large databases,the check program may require more memory. It may crash with a core dump after reporting 'Out of Memory'.  For CM 6.3 or older: You may solve the problem by increasing the maximum heap size of "ccmdb_refchk_inf". This can be done by executing the command " ldedit -b maxdata:0x40000000 ccmdb_refchk_inf ". 

(Note that the above example will increase the heap size to 1 gigabyte which may not be optimal for your server. You should adjust the size for your server accordingly.) 

 For CM 6.4 and newer: You may solve the problem by modifying the ccmdb_check_inf script on AIX under $CCM_HOME/bin/dbutil to add the line "LDR_CNTRL=MAXDATA=0x20000000 " just before calling ccmdb_refchk_inf. For example; 


To allow the program take more memory you can modify the ccmdb_check_inf script under $CCM_HOME/bin/dbutil . 

Locate the section: >  ....... 
echo "Checking SYNERGY/CM Database Consistency...">&2 
$DBCHECK $DBNAME 
....... 
Set the memory allocation to 512MB bysetting the LDR_CNTRL variable before the check is called: >  ...... 
echo "Checking SYNERGY/CM Database Consistency...">&2 
export LDR_CNTRL=MAXDATA=0x20000000 
$DBCHECK $DBNAME 
....... 
512MB should be sufficient in most cases. However if you are still receiving 'Out of Memory' errors during the check try setting it to 1024MB: >  ....... 
echo "Checking SYNERGY/CM Database Consistency...">&2 
export LDR_CNTRL=MAXDATA=0x40000000 
$DBCHECK $DBNAME 
....... 
Then ccmdb_refchk_inf can use up to 1024 MB of memory in AIX. This should only be done within the modified script rather than in the environment, in case it has an unwanted effect on any other applications. This environment variable should be set before bringing up the IBM Informix Dynamic Server instance. If the server is already up, bring down and then bring up the server for the environment variable to take effect. 

If you continue to encounter the errorafter this change, please report the problem to Technical Support.Provide the full output of the ccmdb check command when contacting Support. 

6.1, 6.2, 6.3, 6.4, 6.5NACM00752AnswerProduct versionPartner ContentInternal ContentCategoryReference IDAuthor 



HISTORICAL NUMBER
 KB7434