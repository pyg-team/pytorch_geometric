Title: IBM RS02891: [DSI][STARTUP] ILLEGALSTATEEXCEPTION WHEN CALLING DATALOADMANAGER 'FINALIZE' COMMAND - United States

Text:
 SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS DUPLICATE OF ANOTHER APAR.
    
   
   

ERROR DESCRIPTION
 *  In SVT disaster recovery test, we call dataloadManager (load -
   progress - finalize) at the start (empty db) and also when
   there is a disaster recovery situation.
   An error happened when calling 'finalize' at the start.  'Load'
   and 'progress' did not shown any problem. However, when
   'finalize' is called, an IllegalStateException is thrown at com.
   ibm.ia.persistence.preload.impl.DataLoadManagerMXBeanImpl.
   setGridOnline.
   See: http://odm-services.francelab.fr.ibm.
   com/vtt/c/results/view?campaignId=1505737866268&requestId=59bfbc [http://odm-services.francelab.fr.ibm.com/vtt/c/results/view?campaignId=1505737866268&requestId=59bfbc]
   cf97f81f2b7909b045&success&failures&errors
   <b>At the test client:</b>
   !!!! 20170918 14:53:37 Result of running dataLoadManager --
   readTimeout=240000 load: ======
   CWMBD9712W: Hostname verification is disabled by the
   "disableSSLHostnameVerification" connection property. The
   client will not check the hostname specified in the server
   certificate.
   CWMBD9659I: Persisted data is being restored to the system. The
   total number of batches of data is 0.
   !!!! 20170918 14:53:37 End of result of running dataLoadManager
   ========
   !!!! 20170918 14:53:39 Result of running dataLoadManager --
   readTimeout=240000 progress: ======
   CWMBD9712W: Hostname verification is disabled by the
   "disableSSLHostnameVerification" connection property. The
   client will not check the hostname specified in the server
   certificate.
   CWMBD9741I: There is no persisted data in the disaster recovery
   database to restore.
   !!!! 20170918 14:53:39 End of result of running dataLoadManager
   ========
   !!!! 20170918 14:55:05 Result of running dataLoadManager --
   readTimeout=240000 finalize: ======
   CWMBD9712W: Hostname verification is disabled by the
   "disableSSLHostnameVerification" connection property. The
   client will not check the hostname specified in the server
   certificate.
   CWMBD9662E: An error occurred when determining the state of the
   system. Exception message: transaction marked rollback only,
   see caused by exception
   java.lang.IllegalStateException: transaction marked rollback
   only, see caused by exception
   at com.ibm.ia.persistence.preload.impl.
   DataLoadManagerMXBeanImpl.setGridOnline(
   DataLoadManagerMXBeanImpl.java:398)
   ....
   From<b> vtt-odm563-cisContainer</b> message log, I found the
   following stack trace:
   [9/18/17 14:55:05:630 CEST] 00000213 om.ibm.ia.persistence.
   preload.impl.DataLoadManagerMXBeanImpl E CWMBE3624E: An
   ObjectGridException was caught while attempting to access data
   held in the server. Exception Message: transaction marked
   rollback only, see caused by exception
   com.ibm.websphere.objectgrid.TransactionException: transaction
   marked rollback only, see caused by exception
       at com.ibm.ws.objectgrid.SessionImpl.unexpectedThrowable(
   SessionImpl.java:3936)
       at com.ibm.ws.objectgrid.ObjectMapImpl.clear(ObjectMapImpl.
   java:791)
       at com.ibm.ia.persistence.preload.impl.
   DataLoadManagerMXBeanImpl.clearMap(DataLoadManagerMXBeanImpl.
   java:414)
       at com.ibm.ia.persistence.preload.impl.
   DataLoadManagerMXBeanImpl.setGridOnline(
   DataLoadManagerMXBeanImpl.java:374)
       at sun.reflect.NativeMethodAccessorImpl.invoke0(Native
   Method)
      ...
       at com.ibm.ws.tcpchannel.internal.WorkQueueManager$Worker.
   run(WorkQueueManager.java:1018)
       at java.util.concurrent.ThreadPoolExecutor.runWorker(
   ThreadPoolExecutor.java:1160)
       at java.util.concurrent.ThreadPoolExecutor$Worker.run(
   ThreadPoolExecutor.java:635)
       at java.lang.Thread.run(Thread.java:785)
   Caused by: com.ibm.websphere.objectgrid.
   ObjectGridRuntimeException: Clear times out after 50003 ms.
       at com.ibm.ws.objectgrid.CommonClearCallbackImpl.block(
   CommonClearCallbackImpl.java:295)
       at com.ibm.ws.objectgrid.XIOClearCallbackImpl.block(
   XIOClearCallbackImpl.java:80)
       at com.ibm.ws.objectgrid.ObjectMapImpl.clear(ObjectMapImpl.
   java:719)
       ... 105 more
   Attached server logs. First time encountering this error at
   finalize.
   There are 2 technical issues in the startup:
   1. the startup must NOT abort just because we cannot drop the
   batches tables
   2. it must be retried x times
   GIT branch with the fix: https://github.ibm.com/ibm-odm/dsi- [https://github.ibm.com/ibm-odm/dsi-]
   runtime/tree/rtc105994
   Risk: low risk of regression
   Benefit: avoid DSI to abort the startup just because there is
   short and temporary stress of the server for any reason
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY

PROBLEM CONCLUSION

TEMPORARY FIX

COMMENTS
 *  This APAR is a duplicate of RS02890 [http://www-01.ibm.com/support/docview.wss?uid=swg1RS02890]
   
   
    
   
   

APAR INFORMATION
 * APAR NUMBER
   RS02891
   
   
 * REPORTED COMPONENT NAME
   DEC SVR INSIGHT
   
   
 * REPORTED COMPONENT ID
   5725B6906
   
   
 * REPORTED RELEASE
   881
   
   
 * STATUS
   CLOSED DUB
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt / Xsystem
   
   
 * SUBMITTED DATE
   2017-09-21
   
   
 * CLOSED DATE
   2017-09-21
   
   
 * LAST MODIFIED DATE
   2017-09-27
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION

APPLICABLE COMPONENT LEVELS