Title: IBM Relationship workflows fail when used interface maps are converted to mediation flows in WebSphere Process Server (WPS) Version 7 - United States

Text:
WID; WebSphere Integration Developer; WPS; WebSphere Process Server TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 When an interface map that is used in a relationship workflow is converted into a mediation flow by means of automatic conversion using WebSphere Integration Developer v7, the resulting workflow component might fail. 

SYMPTOM
Starting with WebSphere Process Server Version 7, interface maps are marked as deprecated and should not be used. If you use WebSphere Integration Developer Version 7 and attempt to use interface maps in your application workflow, an informational dialog box opens to inform you that you need to use mediation flows instead. As a WebSphere Integration Developer Version 7 user, you are also offered the option to have interface maps automatically converted into equivalent mediation flows. When you opt for the automatic conversion, WebSphere Integration Developer removes any existing interface maps from the your application assembly diagram and replaces them with mediation flows. 

When you have an interface map that is part of a relationship workflow and the mapped interface contains a request-response operation, the automatic conversion performed by WebSphere Integration Developer Version 7 results in a failing mediation flow. When the application containing the newly created mediation flow is deployed, any execution of the flow leads to a mediation runtime error with a stack trace like the following messages: 


CWSXM0202E: An unexpected exception occurred when processing mediation flow for component Component1 in module test
CWSXM1025E: An unexpected exception occurred when the flow was called: 
CWSXM0111E: Service runtime exception calling an import from mediation component Component1 
in module test
CWSXM0205E: An unexpected business logic exception occurred.: 
CWSXM3655E: Exception while executing Business Object map: 
CWLAS0015E: The Submap transform #1 in the response_Map map did not complete because of the following exception: 
CWLAS0015E: The Submap transform #2 in the response_Submap map did not complete because of the following exception: 
CWLAS0015E: The Relationship transform #5 in the response_Submap2 map did not complete because of the following exception: Business object is null.


CAUSE
The automatic conversion of deprecated interface maps to mediation flows offered by WebSphere Integration Developer Version 7 does not work properly when the interface maps to be converted are part of a relationship.


DIAGNOSING THE PROBLEM
The following conditions must be met for the problem to occur: 

 * You are running WebSphere Process Server Version 7.0.0.0, 7.0.0 Fix Pack 1, 7.0.0 Fix Pack 2, 7.0.0 Fix Pack 3 or 7.0.0 Fix Pack 4. 
 * You are using WebSphere Integration Developer Version 7 as an authoring tool for composing your business application. 
 * Your business application contains at least one relationship that uses interface maps. 
 * Any of the mapped interfaces contains a request-response operation. 
 * You have used the automatic conversion offered by WebSphere Integration Developer to convert the deprecated interface maps to equivalent mediation flows. 
 * After the automatic conversion, your business application can be deployed successfully but fails at runtime while throwing a mediation runtime error as outlined in the previous symptom section.

RESOLVING THE PROBLEM
To resolve this problem, complete the following steps: 

 1. Upgrade to Version 7.0.0 Fix Pack 4, if you are running WebSphere Process Server Version 7.0.0.0, 7.0.0 Fix Pack 1, 7.0.0 Fix Pack 2 or 7.0.0 Fix Pack 3, 
 2. Install the WebSphere Enterprise Service Bus APAR fix IC79270 and the WebSphere Process Server APAR fix JR40785, which can be obtained from Fix Central. 
 3. Try the automatic conversion again after completing steps 1 and 2. 
 4. After the conversion, edit the mediation flow that results from the automatic conversion in WebSphere Integration Developer and look for a business object map primitive in the mediation's request and response flows respectively. The display names of those primitives will differ, but must be equal for the mediation to work properly. 
 5. Change the display names of the business object maps in the request and response flows to match each other and save the mediation flow component afterwards.


After these steps are successful, the problem will no longer occur.  

PRODUCT ALIAS/SYNONYM
 WPS