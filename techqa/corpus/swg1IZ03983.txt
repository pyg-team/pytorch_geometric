Title: IBM IZ03983: ALL ACCOUNTS' ACI'S WITH FILTERS DON'T EVALUATE CORRECTLY - United States

Text:
 SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  *****************************
   Server APAR
   
   Title: 'All Accounts' ACI's with filters don't evaluate
   correctly
   
   Problem Description:
   Customer has created multiple 'All Acccounts' ACI's with filters
   for
   specific types of accounts:
   
   simple example:
   1 ACI with filter: (objectclass=erADAccount)
   another with filter: (objectclass=erAIXAccount)
   
   (They are doing this to try and reduce the amount of ACI's they
   need to
   configure.)
   
   One of the ACIs Denies all operations (in this example
   (objectclass=erADAccount) ACI.)
   While the other ACI Grants both Search and Add Operations (as
   well as
   read/write access to all attributes).
   
   There is an All Services ACI that Grants Search rights.
   
   All of these ACIs have the same ITIM Group associated with them.
   
   A user in this ITIM group logs into ITIM and attempts to add a
   new
   (erAIXAccount) to a user in ITIM.
   
   The user navigates to My Org > Manage People
   He selects a Person and clicks on Manage Accounts
   Then clicks on the "New" button.
   At this point, no Services are listed (even though they have
   Search/Add
   rights for this account type, and Search rights on All
   Services).
   
   If they change first ACI (objectclass=erADAccount) to Grant
   Search/Add
   opeartions (and allow for ACICache to refresh)....everything
   works fine.
   
   The problem appears to be that the filters are not being
   evaluated
   properly...and the Deny settings on one of the filtered ACI's is
   overriding the Grant settings on any of the other filtered ACI's
   (even
   though the two filters are different.
   
   If these ACI's are configured to be explicitly ADAccount and
   AIXAccount
   (using the ACI dropdown menus), they work fine.  So this appears
   to be
   related to filter evaluation.
   
   When the ACI's display the problem, the trace.log is showing the
   following (from support lab):
   
   <Trace Level="MAX">
    <Time Millis="1188432196438"> 2007.08.29
   17:03:16.438-07:00</Time>
    <Server Format="IP">gumfudgin</Server>
    <ProductId>CTGIM</ProductId>
    <Component>com.ibm.itim.authorization</Component>
    <ProductInstance>server1</ProductInstance>
    <LogText><![CDATA[Result: {erSAPAccount=false,
   erLDAPUserAccount=false,
   erAIXAccount=false, erUPAAccount=false, erTAM4Account=false,
   erADAccount=false, erFVRSAccount=false, erWinLocalAccount=false,
   erHpuxAccount=false, erNotesAccount=false}]]></LogText>
    <Source FileName="com.ibm.itim.authorization.AccessAuthority"
   Method="isClassOperationAllowed"/>
    <Thread>Servlet.Engine.Transports : 0</Thread>
   </Trace>
   
   
   When the ACI's are changed...so they both (all) Grant Search/Add
   rights (which allows the end user to add the accounts)...we see
   the
   following in the trace.log (from support lab):
   
   <Trace Level="MAX">
    <Time Millis="1188432736312"> 2007.08.29
   17:12:16.312-07:00</Time>
    <Server Format="IP">gumfudgin</Server>
    <ProductId>CTGIM</ProductId>
    <Component>com.ibm.itim.authorization</Component>
    <ProductInstance>server1</ProductInstance>
    <LogText><![CDATA[Result: {erSAPAccount=true,
   erLDAPUserAccount=true,
   erAIXAccount=true, erUPAAccount=true, erTAM4Account=true,
   erADAccount=true, erFVRSAccount=true, erWinLocalAccount=true,
   erHpuxAccount=true, erNotesAccount=true}]]></LogText>
    <Source FileName="com.ibm.itim.authorization.AccessAuthority"
   Method="isClassOperationAllowed"/>
    <Thread>Servlet.Engine.Transports : 2</Thread>
   </Trace>
   
   Even though both ACIs are configured for 'All Accounts', the
   filters
   should be evaulated properly, so one ACI doesn't override
   another...if
   the filters effect completely different account types.
   
   
   Customer Recreate: Customer and Support can reproduce.
   
   Desired Behavior: need to be able to configure multiple 'All
   Account'
   ACI's....with filters to narrow down which account types to
   effect.
   
   Steps to Duplicate (assuming you already have AD and AIX
   services):
   1. Create a Person
   2. Create an ITIM Group with Org Tree access
   3. Provision an ITIM account for the Person (in step 1) and add
   their
   ITIM account to the ITIM Group (created in step 2)
   4. Create a Person ACI Granting Search rights to the group (in
   step 2)
   5. Create an 'All Service' ACI Granting Search rights to the
   group (in
   step 2).
   6. Create an 'All Account' ACI with the following:
   filter: (objectclass=erAIXAccount)
   scope: subtree
   Attribute Permissions: Grant All read/write
   Operations: Grant Search and Add (can leave the rest at None)
   Associate the group (in step 2) with this ACI
   
   7. Create another 'All Account' ACI with the following:
   filter: (objectclass=erADAccount)
   scope: subtree
   Attribute Permissions: Deny (or None) all read/write
   Operations: Deny All
   Associate the group (in step 2) with this ACI
   
   8. Allow for ACI Cache to refresh (or restart ITIM)
   9. Login with the ITIM account (created in step 3)
   10. Navigate to another Person record
   11. Select Manage Accounts for this person
   12. Click the "New" button
   At this point you should not see any services available (even
   though the
   ACI's were configured to allow you to add at least an AIX
   account for
   this Person.
   
   13. Log back in as ITIM Manager
   14. Modify the ACI that was created in step 7
   (objectclass=erADAccount)...to Grant both Search and Add
   Operations.
   15. Save the ACI and allow for ACICache to refresh (or restart
   ITIM).
   16. Attempt steps 9 - 12 again...this time you should see some
   services
   (at least the AIX Service) now...and be able to provision an
   account for
   this Person.
   
   BUSIMPACT
   Environment: ITIM 4.6 FP48 / IF50 Windows 2003
   *****************************
   *****************************
   
   
    
   
   

LOCAL FIX
 *  n/a
   
   
    
   
   

PROBLEM SUMMARY
 *   Users affected.
   Customers using ACI's defined for target "All Accounts".
   
   
    
   
   

PROBLEM CONCLUSION
 *   This fix for this APAR is contained in the
   following maintenance packages:
   | Interim Fix | 4.6.0-TIV-TIM-IF0056
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IZ03983
   
   
 * REPORTED COMPONENT NAME
   IBM TIV ID MGR
   
   
 * REPORTED COMPONENT ID
   5724C3403
   
   
 * REPORTED RELEASE
   460
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2007-08-30
   
   
 * CLOSED DATE
   2007-10-05
   
   
 * LAST MODIFIED DATE
   2008-08-19
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
    IZ30023 [http://www-01.ibm.com/support/docview.wss?uid=swg1IZ30023]
   
   

MODULES/MACROS
 *     SERVER
   
   
    
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   IBM TIV ID MGR
   
   
 * FIXED COMPONENT ID
   5724C3403
   
   

APPLICABLE COMPONENT LEVELS
 * R460 PSY
   UP