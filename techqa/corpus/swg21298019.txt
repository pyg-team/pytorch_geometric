Title: IBM Importing openssl certificates into a gskit kdb file - United States

Text:
idsldapsearch; CMS; gskit; TLSCertificateKeyFile; TLSCertificateFile; TLSCertificateKeyFile; openldap server; openssl; bwm8 TECHNOTE (FAQ)

QUESTION
 This technote shows how to import an SSL certificate (created for use with an openldap server with the openssl utilities) into a kdb file for use by the ITDS client utilities 

ANSWER
1. Create the SSL cert using openssl (if needed):
openssl req -newkey rsa:1024 -x509 -nodes -out server.pem -keyout server.pem -days 365

Fill out the prompts requesting additional info. Make sure the common name is the fully qualified hostname of the server.

2. Open the generated file (server.pem in this example), and copy out the public key including the "BEGIN CERTIFICATE" and "END CERTIFICATE" lines

3. Copy into another file, let's call it client.pem

4. Configure the openldap server by editing the appropriate section in the slapd.conf file. Usually, you need to edit the following lines:

TLSCACertificateFile /etc/pki/tls/certs/server.pem
TLSCertificateFile /etc/pki/tls/certs/server.pem
TLSCertificateKeyFile /etc/pki/tls/certs/server.pem

5. Copy the client.pem to your client server.

6. Start up gskit (and make sure that the Java SDK you're using has been edited to allow creating CMS keystores [http://publib.boulder.ibm.com/infocenter/tivihelp/v2r1/index.jsp?topic=%2Fcom.ibm.IBMDS.doc%2Finstall243.htm&path=8_3_35]):

For example:

export JAVA_HOME=/opt/ibm/ldap/V6.2/java
gsk7ikm

(The Java SDKs distributed with later versions of ITDS are generally enabled to handle CMS keystores.)

7. Create (or open an existing) cms keystore. I created test.kdb

8. Open test.kdb and do:
a) Under "Key database content" make sure "Signer certificates" is selected. 
b) Select "Add" and browse to the client.pem file
c) Select OK

9. Your server's public key should be in the client's kdb keystore.

10. Point idsldapsearch at the kdb file just created:

idsldapsearch -Z -K /root/test.kdb -P secret -h foo.test.ibm.com -p 636 -b o=sample '(objectclass=*)'
o=sample
objectClass=organization
o=sample

ou=Tivoli,o=sample
ou=Tivoli
objectClass=top
objectClass=organizationalUnit

ou=Austin,o=sample
ou=Austin
objectClass=top
objectClass=organizationalUnit

ou=ITDS,ou=Tivoli,o=sample
ou=ITDS
objectClass=top

It worked and you are all done!

 

PRODUCT ALIAS/SYNONYM
 ITDS
TDS
Secureway
IDS
LDAP
Secureway Directory Server
Directory Server