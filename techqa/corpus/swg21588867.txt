Title: IBM Known issues in DB2 V9.7 Fix Pack 1 through Fix Pack 4 that impact database monitoring with IBM InfoSphere Optim Performance Manager - United States

Text:
upgrade to DB2 V9.7 Fix Pack 5; database monitored by IBM InfoSphere Optim Performance Manager TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 This document lists known issues in DB2 V9.7 Fix Pack 1 through Fix Pack 4 that significantly impact InfoSphere Optim Performance Manager (OPM), and workarounds or fixes for these issues. 

RESOLVING THE PROBLEM
Use of in-memory metrics 

If you use InfoSphere Optim Performance Manager V5.1 to monitor a DB2 V9.7 database, InfoSphere Optim Performance Manager collects in-memory metrics from this database by default. Some new in-memory metrics have been introduced with DB2 V9.7 Fix Pack 5. InfoSphere Optim Performance Manager collects these new metrics and displays them on the dashboards in the InfoSphere Optim Performance Manager web console.

The following list shows the new metrics: 

 * Latest size on the Buffer Pools tab of the Buffer Pool and I/O dashboard 
 * Asynchronous read time and asynchronous write time on the Buffer Pools tab of the Buffer Pool and I/O dashboard 
 * Asynchronous read time and asynchronous write time on the Table Spaces tab of the Buffer Pool and I/O dashboard 
 * OS time breakdown, load average and paging information on the At a Glance view or the Overview dashboard.


If you have enabled the collection of table information in the I/O and disk space monitoring profile, InfoSphere Optim Performance Manager collects in-memory metrics only if the monitored database is on DB2 V9.7 Fix Pack 5 or later. For fix packs previous to Fix Pack 5, InfoSphere Optim Performance Manager collects a combination of in-memory metrics and snapshot data because metrics about object sizes are not yet available in the in-memory metrics for tables. Collecting the additional snapshot data might impact the performance of your monitored database, especially if the monitored database is a partitioned database. 

If you use Optim Performance Manager V4.1 to monitor a DB2 V9.7 database, or if you have upgraded to Optim Performance Manager V5.1 without changing to in-memory metrics collection, InfoSphere Optim Performance Manager collects snapshot data from the monitored database. If you have turned on the statement concentrator on your monitored database, the package cache contains the concentrated statement and, in addition, the original pre-concentrated statements containing the literals. Fix Pack 5 includes APAR IC77166 that reduces the number of the pre-concentrated statements in the package cache to contain only executing pre-concentrated statements and not all already executed pre-concentrated statements. 
This reduces also the amount of dynamic SQL data that InfoSphere Optim Performance Manager collects from the monitored database because the snapshot command returns concentrated statements and pre-concentrated statements. Known DB2 issues This is not an exhaustive list of DB2 issues or Optim Performance Manager issues. Additional issues are described here:  * DB2 support portal [http://www.ibm.com/support/entry/portal/Overview/Software/Information_Management/DB2_for_Linux,_UNIX_and_Windows] 
 * Optim Performance Manager support portal [http://www.ibm.com/support/entry/portal/Overview/Software/Information_Management/InfoSphere_Optim_Performance_Manager]


Click the APAR number for additional information, including details about which DB2 fix packs contain fixes for the issue.  

DB2 APAR Impact to OPM Workaround in OPM (if available) IC73959 [http://www.ibm.com/support/docview.wss?uid=swg1IC73959]: DB2 may crash while using MON_GET_TABLE or MON_GET_INDEX functions when a system temp table is being created at the same time. This issue impacts OPM repository servers that are below DB2 V9.7.0.5. DB2 V9.7.0.5 or higher is required as the repository server. IC78879 [http://www.ibm.com/support/docview.wss?uid=swg1IC78879]: Time-spent metrics reported by MON_GET_ACTIVITY_DETAILS interface may be inconsistent. OPM SQL dashboard shows some inconsistencies in the wait times provided for the statement execution. Activity metrics are collected directly into activity control block instead of rolled up as a group. Leads to potential for inconsistency in the time hierarchy if metrics are queried after an interval is measured but before the parent interval is measured. Apply the DB2 fix. IC76425 [http://www.ibm.com/support/docview.wss?uid=swg1IC76425]: A HANG ISSUE MAY OCCUR with statement monitor active or MON_GET_PKG_CACHE_STMT table function is used Occurs when aggregated SQL data or server-side Extended Insight data is being collected. Disable the collection of aggregated SQL data or server-side Extended Insight data using the configuration wizard. IC81252 [https://www.ibm.com/support/docview.wss?crawler=1&uid=swg1IC81252]: MON_GET_ACTIVITY_DETAILS TABLE FUNCTION MAY RETURNS INVALID XML TAGS IN THE DETAILS COLUMN The "Top Individual Executions" tab of the SQL Dashboard is empty, some SQL-related data on the Connection dashboard is missing, and numerous XML parsing errors are reported as Operational Alerts. Only occurs on Linux operating systems. Use the configuration wizard to disable "Top SQL executions and connections" in the SQL Statements and Connections monitoring profile. 

Note that this workaround disables all data on the "Top Individual Executions" tab of the SQL Statements dashboard and some SQL-related data on the Connection dashboard. IC85985 [http://www.ibm.com/support/docview.wss?uid=swg1IC85985]: DB2 MIGHT CRASH ON SQLRWSENDGETWLMTABLEFUNCTIONRESULT WHEN USING MON_GET_LOCKS TABLE FUNCTION Occurs when lock monitoring is enabled for a large number of tables. Disable lock monitoring using the configuration wizard. IC85203 [http://www.ibm.com/support/docview.wss?uid=swg1IC85203]: Partial event messages with SQL443N are logged in db2diag.log from EVMON_FORMAT_UE_TO_XML table function Adds clutter in the db2diag.log. This issue can occur when LOCKING or UNIT OF WORK event monitors are enabled. Disable lock monitoring and extended insight transaction tracking using the configuration wizard. Alternatively, you can reduce occurrences by using lock monitoring only for active problem determination.