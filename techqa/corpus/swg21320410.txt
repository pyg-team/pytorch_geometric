Title: IBM Warehouse Proxy Agent startup failure - United States

Text:
WPA TDW Warehouse Proxy Agent Startup Failure getDbConnection DB2ConnectionCorr elator: null TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 The Warehouse Proxy Agent fails to startup after some DB2 configuration activity. 

SYMPTOM
The Warehouse Proxy Agent error message seen was: 

== 1 t=main com.ibm.db2.jcc.c.DisconnectException: java.lang.reflect.InvocationTargetException : Error opening socket to server localhost/127.0.0.1 on port 60000 with message : null DB2ConnectionCorrelator: null

A direct DB2 connection showed all tables existed and appeared normal.


CAUSE
The above message indicated that the DB2 instance was not responding on port 60000.



ENVIRONMENT
AIX 5.3 server ITM 6.2 base, but this could occur in any Linux/Unix environment



DIAGNOSING THE PROBLEM
See topic "Activating the DB2 listeners on a UNIX DB2 server" in the Installation and Setup Guide for background: 


http://publib.boulder.ibm.com/infocenter/tivihelp/v15r1/topic/com.ibm.itm.doc_6.2.fp1/itm_install233.htm#db2_listeners [http://publib.boulder.ibm.com/infocenter/tivihelp/v15r1/topic/com.ibm.itm.doc_6.2.fp1/itm_install233.htm#db2_listeners]

Do the command "db2set -all" to list the DB2 registry variables; the results should look something like:

$db2set -all
[i] DB2ENVLIST=EXTSHM
[i] DB2COMM=tcpip
[g] DB2SYSTEM=xxxx487
[g] DB2ADMINSERVER=xxxx1

After some DB2 configuration activity in the affected environment, the "[i] DB2COMM=tcpip" line was missing, which means that DB2 was not listening for a tcpip connection. This resulted in the error seen.


RESOLVING THE PROBLEM
To verify how the connection should have been made. do: 


$db2 get dbm cfg | grep Service
TCP/IP Service name (SVCENAME) = 60000 db2inst1@goxsd487:/opt/db2inst/db2inst1/sqllib

See that instance "db2inst1" uses port 60000. Then check /etc/services to verify that this is indeed the correct port for that instance:

$ grep 60000 /etc/services
DB2_db2inst1 60000/tcp

To correct the condition. execute:

db2set DB2COMM=tcpip

Recycle DB2, start the WPA and verify it correctly connects to the database and says "Tivoli Export Server Ready for Operations" in the WPA's RAS1 log.