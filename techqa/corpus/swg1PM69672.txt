Title: IBM PM69672: ALT ALTER TABLE DROP FOREIGN KEY ENDS SQLCODEN204 - United States

Text:
z/os  A FIX IS AVAILABLE
Obtain the fix for this APAR.


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  The DB2 Administration Tool for z/OS' ALT function's APPLY job
   ALTER TABLE DROP FOREIGN KEY ends with a SQLCODE -204
   SQLCODEN204 as earlier ALTER TABLE DROP PRIMARY KEY statements
   had removed the FOREIGN KEY.
   ADB5044I *** INPUT STATEMENT:
      ALTER TABLE >schema<.>table<
        DROP FOREIGN KEY >fkey<;
   sqlerror on ALTER      command, EXECUTE    function
    DSNT408I SQLCODE = -204, ERROR:  >schema<.>table<.>fkey<
   IS AN UNDEFINED NAME
    DSNT418I SQLSTATE   = 42704 SQLSTATE RETURN CODE
    DSNT415I SQLERRP    = DSNXISB3 SQL PROCEDURE DETECTING ERROR
    DSNT416I SQLERRD    = 13  0  0  -1  0  0 SQL DIAGNOSTIC
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED: Users of the DB2 Administration Tool and     *
   *                 DB2 Object Comparison Tool for z/OS who      *
   *                 alter a column which is part of a primary    *
   *                 key of the table, and the primary key is     *
   *                 involved in more than one referential        *
   *                 constraint.                                  *
   ****************************************************************
   * PROBLEM DESCRIPTION: When altering a column which is part    *
   *                      of a primary key of the table, and      *
   *                      the primary key is involved in more     *
   *                      than one referential constraint, the    *
   *                      APPLY job may fail with a               *
   *                      SQLCODE= -204 / SQLCODEN204:            *
   *                                                              *
   *                      ADB5044I *** INPUT STATEMENT:           *
   *                         ALTER TABLE tablename                *
   *                           DROP RESTRICT ON DROP              *
   *                           DROP FOREIGN KEY FKname;           *
   *                      DSNT408I SQLCODE = -204,                *
   *                      ERROR:  >schema<.>table<.>fkey<         *
   *                       IS AN UNDEFINED NAME                   *
   *                      DSNT418I SQLSTATE   = 42704             *
   *                      SQLSTATE RETURN CODE                    *
   *                      ADB5185E The run is ending due to       *
   *                      errors.                                 *
   *                      ADBT010W - Rollback performed due       *
   *                      to previous error                       *
   ****************************************************************
   * RECOMMENDATION:                                              *
   ****************************************************************
   When altering a column which is part of the primary key of
   a table, and the primary key is involved in more than one
   referential constraint, the APPLY job may fail with a
   SQLCODE= -204 / SQLCODEN204.  This is caused by a redundant
   DROP FOREIGN KEY statement to drop a referential constraint
   in the changes file, but the referential constraint is
   already dropped implicitly when dropping its parent key.
   
   ADB5044I *** INPUT STATEMENT:
      ALTER TABLE tablename
        DROP RESTRICT ON DROP
        DROP FOREIGN KEY FKname;
   DSNT408I SQLCODE = -204,
        ERROR:   >schema<.>table<.>fkey<
    IS AN UNDEFINED NAME
   DSNT418I SQLSTATE   = 42704
   SQLSTATE RETURN CODE
   ADB5185E The run is ending due to errors.
   ADBT010W - Rollback performed due to previous error
   
   
    
   
   

PROBLEM CONCLUSION
 *  Problem has been resolved.
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PM69672
   
   
 * REPORTED COMPONENT NAME
   DB2 ADMIN TOOL
   
   
 * REPORTED COMPONENT ID
   568851500
   
   
 * REPORTED RELEASE
   A10
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2012-07-26
   
   
 * CLOSED DATE
   2013-03-15
   
   
 * LAST MODIFIED DATE
   2013-04-02
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

MODULES/MACROS
 *     ADB2CMF  ADB2CMP  ADB2CMR  ADB2CMT
   
   
    
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   DB2 ADMIN TOOL
   
   
 * FIXED COMPONENT ID
   568851500
   
   

APPLICABLE COMPONENT LEVELS
 * RA10 PSY UK92575 [HTTPS://WWW14.SOFTWARE.IBM.COM/WEBAPP/SET2/ORDERMEDIA/SHOPCART?PTFS=UK92575]
   UP13/03/19 P F303
   
   
 * RA20 PSY UK92576 [HTTPS://WWW14.SOFTWARE.IBM.COM/WEBAPP/SET2/ORDERMEDIA/SHOPCART?PTFS=UK92576]
   UP13/03/19 P F303
   
   

FIX IS AVAILABLE
 * SELECT THE PTF APPROPRIATE FOR YOUR COMPONENT LEVEL. YOU WILL BE REQUIRED TO SIGN IN. DISTRIBUTION ON PHYSICAL MEDIA IS NOT AVAILABLE IN ALL COUNTRIES.