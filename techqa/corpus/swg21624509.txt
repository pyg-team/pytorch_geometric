Title: IBM ITCAM4Tx, LAST_ACK network connections, Robotic agent with RPT test playback - United States

Text:
roboter schedule TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Playing back with the ITCAM for Tx robotic agent a RPT performance schedule, which involves 2 test scripts, leaves over time many TCP network connections in 'LAST_ACK' state 

SYMPTOM
Many TCP network connections in 'LAST_ACK' state seen using "netstat -an" command. ITCAM for Transaction robotic response time agent service no longer running after a while.


CAUSE
Possible cause could be the use of many Virtual Users (5 instead of 1 as default) and both RPT test scripts involving the same monitored target server, with its variable data setting set to :
visible in = "All tests for this user".

ENVIRONMENT
ITM v6.2, ITCAM for Tx v7.3, RPT v8.2, Robotic Response Time agent v7.3 on Windows 20003

DIAGNOSING THE PROBLEM
What proved helpful in another environment, to avoid the Robotic Response Time agent service from stopping after a while, has been to upgrade the ITM environment from v6.22 to v6.23.




Then you should attempt and verify if the problem is reproduced as well using the RPT workbench (recorder) system, by playing back manually the same involved RPT performance schedule in a RPT loop. If that's true, RPT test log and extra RPT debug tracing can help to investigate further.


RESOLVING THE PROBLEM
Modify your RPT performance test schedule settings and set :
a) User Load = 1 (instead of 5 for example) 
b) in each RPT test script, for the monitored host variable, set : visible in = "this test only", instead of visible in = "All tests for this user".

For reference, as documented in chapter "Limitations on using Rational Performance Tester schedules", of ITCAM for Transactions Administration Guide:

The ITCAM for Transactions Robotic Response Time Agent provides the ability to run performance schedules defined in the Rational Performance Tester Workbench and exported to the Application Management Console Agent using the ITCAM Rational Performance Tester Export Plug-in. When running performance schedules on a Robotic Response Time agent, the agent uses only one virtual user and ignores any other schedule options defined during the creation of performance schedule.

A performance schedule on a Robotic Response Time agent is only used for ordering of Rational Performance Tester scripts and tests, and not for any other operation or function that you can define in the Rational Performance Tester Workbench (such as using loops, delays, synchronization points and
random selectors). When run on the Robotic Response Time agent, a performance schedule runs the Rational Performance Tester tests and scripts in the order they are defined inside the schedule, and ignores all other settings. This results in overall edge transactions for the whole schedule execution, and individual subtransactions for each of the Rational Performance Tester tests and scripts inside the schedule.

When tests are added to a schedule that has similar variable names, the variable names from one script are overwritten by the values of another script, and can cause connection issues. For example, in the case where a schedule contains two scripts that connect to the same server, but each script uses different ports, when they are run in the schedule, the second script uses the port valuefrom the first test because the visibility and scope is set to "All tests for this user". 

To define test variables for each test separately, set the visibility for each test to "This test only".

 

PRODUCT ALIAS/SYNONYM
 ITM ITCAM ITCAM4Tx ITCAMforTx Robotic Response Time RRT Rational Performance Tester