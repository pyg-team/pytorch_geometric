Title: IBM CSPA202E Handshake failure, Certificate is not valid â€“ Connect:Direct for z/OS - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 CSPA202E Handshake failure, Certificate is not valid RC=414 (0x0000019e) 

SYMPTOM
When Connect:Direct for z/OS is the PNODE (client) the following Secure+ errors are received. The client has correctly installed the certificate from the SNODE (server) into their key database or keyring.

CSPA202E Handshake failure, Certificate is not valid 
SVTM055I SESSION (002) ESTABLISHED WITH SNODE=xxxx 
CSPA003E Security Violation - SNODE authentication error 

Connect:Direct for z/OS trace shows the following:

TLS/SSL Socket Init Error, 0x0000019e (Certificate is not valid). 
ENDING TLS/SSL HANDSHAKE, RC=414



CAUSE
Client Authentication was requested by the server but the server did not have the certificate from the client installed. 

RESOLVING THE PROBLEM
If Client Authentication is not wanted, have the server turn it off. If Client Authentication is needed, then the certificate from the client should be installed on the server side.

When debugging Client Authentication issues, we recommend verifying that Server Authentication works without Client Authentication first.