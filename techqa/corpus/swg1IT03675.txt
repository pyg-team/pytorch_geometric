Title: IBM IT03675: DB2EXMIG DOES NOT PRESERVE PERMISSIONS ON RECREATED TABLES - United States

Text:
z/os  A FIX IS AVAILABLE
DB2 Version 10.5 Fix Pack 9 for Linux, UNIX, and Windows [http://www-01.ibm.com/support/docview.wss?uid=swg24044110]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS FIXED IF NEXT.
    
   
   

ERROR DESCRIPTION
 *  It is expected that the migrated explain tables are usable by
   the same users before/after the db2exmig, but that doesn't
   happen on 10.5 . After upgrading a database  to v10.5 FP3 there
   are new/recreated function and tables from the db2exmig output
   however the permission granted to tables that existed before the
   migration are lost. Looking at the permissions before/after the
   db2exmig (using the db2look tool) no permissions are granted to
   the tables before the migration.
   
   Example:
   
   $ db2look -d test -x -a
   -- Generate statistics for all creators
   -- This CLP file was created using DB2LOOK Version "10.5"
   -- Timestamp: Mon Jul 28 15:14:50 EDT 2014
   -- Database Name: TEST
   -- Database Manager Version: DB2/AIX64 Version 10.5.3
   -- Database Codepage: 1208
   -- Database Collating Sequence is: SYSTEM_819
   -- Alternate collating sequence(alt_collate): null
   -- varchar2 compatibility(varchar2_compat): OFF
   
   -- Binding package automatically ...
   -- Bind is successful
   -- Binding package automatically ...
   -- Bind is successful
   
   CONNECT TO TEST;
   
   --------------------------------------------
   -- Authorization Statements on Tables/Views
   --------------------------------------------
   
   
   GRANT SELECT ON TABLE "DB2INST  "."EXPLAIN_PREDICATE" TO USER
   "TEST    " ;
   
   COMMIT WORK;
   
   CONNECT RESET;
   
   TERMINATE;
   
   
   
   $ db2exmig -d test -e DB2INST
   DB2 Universal Database Version 10.5, 5622-044 (c) Copyright IBM
   Corp. 1999, 2012
   Licensed Material - Program Property of IBM
   IBM DATABASE 2 Explain Table Migration Tool
   
   Connecting to the Database.
   Connect to Database Successful.
   Binding package - Bind was Successful
   Migrating Explain Tables from v9.7FP1 or later to current
   release.
   
   Examining the columns for table DB2INST.EXPLAIN_INSTANCE
   Found table DB2INST.EXPLAIN_STATEMENT. No changes required for
   this migration.
   Found table DB2INST.EXPLAIN_ARGUMENT. No changes required for
   this migration.
   Examining the columns for table DB2INST.EXPLAIN_OBJECT
   Found table DB2INST.EXPLAIN_OPERATOR. No changes required for
   this migration.
   
   Examining the columns for table DB2INST.EXPLAIN_PREDICATE
   Found table DB2INST.EXPLAIN_STREAM. No changes required for this
   migration.
   Found table DB2INST.EXPLAIN_DIAGNOSTIC. No changes required for
   this migration.
   Found table DB2INST.EXPLAIN_DIAGNOSTIC_DATA. No changes required
   for this migration.
   Found table DB2INST.EXPLAIN_ACTUALS. No changes required for
   this migration.
   Found table DB2INST.ADVISE_INSTANCE. No changes required for
   this migration.
   
   Examining the columns for table DB2INST.ADVISE_INDEX
   Found table DB2INST.ADVISE_WORKLOAD. No changes required for
   this migration.
   Found table DB2INST.ADVISE_MQT. No changes required for this
   migration.
   Found table DB2INST.ADVISE_PARTITION. No changes required for
   this migration.
   Found table DB2INST.ADVISE_TABLE. No changes required for this
   migration.
   Found all tables OK. Start migration.
   
   Old tables renamed...begin creating new explain tables.
   
   Altering Explain table DB2INST.EXPLAIN_INSTANCE
   Altering Explain table DB2INST.EXPLAIN_OBJECT
   Creating Explain table DB2INST.EXPLAIN_PREDICATE
   Creating Explain table DB2INST.EXPLAIN_PREDICATE with NOT LOGGED
   INITIALLY
   Creating Explain table DB2INST.OBJECT_METRICS (New)
   Altering Explain table DB2INST.ADVISE_INDEX begin insert into
   tables.
   Copying to Explain table EXPLAIN_PREDICATE from
   EMPRD_001406574918
   Check all tables where copied properly.
   
   All tables confirmed to have been copied properly.
   
   Dropping old Explain table EMPRD_001406574918(EXPLAIN_PREDICATE)
   Dropped old Explain function DB2INST.EXPLAIN_GET_MSGS.
   Created new Explain function DB2INST.EXPLAIN_GET_MSGS.
   Migration of the explain tables to Version 10.05.3 format has
   succeeded.
   
   
   ******** WARNING **********
   Because the 'NOT LOGGED INITIALLY' option was used in migrating
   the explain
   tables it is recommended that a backup of the explain tables be
   taken as soon
   as possible, if your backup procedures include the backing up of
   the explain tables.
   ******** WARNING **********
   
   
   $ db2look -d test -x -a
   -- Generate statistics for all creators
   -- This CLP file was created using DB2LOOK Version "10.5"
   -- Timestamp: Mon Jul 28 15:15:31 EDT 2014
   -- Database Name: TEST
   -- Database Manager Version: DB2/AIX64 Version 10.5.3
   -- Database Codepage: 1208
   -- Database Collating Sequence is: SYSTEM_819
   -- Alternate collating sequence(alt_collate): null
   -- varchar2 compatibility(varchar2_compat): OFF
   
   
   CONNECT TO TEST;
   
   COMMIT WORK;
   
   CONNECT RESET;
   
   TERMINATE;
   
   
    
   
   

LOCAL FIX
 *  Backup permissions using db2look before running the db2exmig
   tool and grant it back after running it.
   
   
    
   
   

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED:                                              *
   * Users running on DB2 10.5 before Fix Pack 5                  *
   ****************************************************************
   * PROBLEM DESCRIPTION:                                         *
   * See Error Description                                        *
   ****************************************************************
   * RECOMMENDATION:                                              *
   * Upgrade to DB2 10.5 Fix Pack 5 or later.                     *
   ****************************************************************
   
   
    
   
   

PROBLEM CONCLUSION

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IT03675
   
   
 * REPORTED COMPONENT NAME
   DB2 FOR LUW
   
   
 * REPORTED COMPONENT ID
   DB2FORLUW
   
   
 * REPORTED RELEASE
   A50
   
   
 * STATUS
   CLOSED FIN
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2014-08-08
   
   
 * CLOSED DATE
   2015-03-31
   
   
 * LAST MODIFIED DATE
   2015-03-31
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION

APPLICABLE COMPONENT LEVELS
 * RA50 PSY
   UP