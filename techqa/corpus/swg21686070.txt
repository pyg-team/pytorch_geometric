Title: IBM Message broker agent does not show brokers in TEP - United States

Text:
temp tmp java subprocess TECHNOTE (FAQ)

QUESTION
 The message broker agent is starting fine but the java sub-process needed for monitoring brokers can't start and so no brokers can be shown in TEP. This is due to permissions of some temporary files in /tmp directory. What are those files? 

ANSWER
The temporary files mentioned have names similar to the following (actual names depend on instance name of the KQI agent and on the installation path of the monitored message broker):

kqijtemp_<inst>__opt_IIB_ibm_mqsi_9.0.0.2
kqijtemp_<inst>__opt_IIB_ibm_mqsi_9.0.0.2__BeforeMqsiprofile
kqijtemp_<inst>__opt_IIB_ibm_mqsi_9.0.0.2__BeforeMqsimqsetenv
kqijtemp_<inst>__opt_IIB_ibm_mqsi_9.0.0.2__BeforeRunJava

KQI agent needs to create a java process which invokes Broker's ConfigManagerProxy API to get Broker data. This java process depends on some WebSphere MQ/WebSphere MB jar files. Hence it needs some Broker's environment variables, e.g."CLASSPATH".
The tmp file kqijtemp_<inst>__opt_IIB_ibm_mqsi_9.0.0.2 contains a call to 'mqsiprofile', 'mqsisetmqenv' and some other shell scripts.
Agent invokes this file to set up a Broker environment and the environment variables obtained are put into the other temporary files.

If you run KQI agent for the first time and you use root user, the files under /tmp will be generated by root user. So these files cannot be written by other users.
When you switch to a non-root user (start agent with non-root user), KQI agent will encounter a problem because it can not open the existing temporary files kqijtemp_<inst>__opt_IIB_ibm_mqsi_9.0.0.2 in write mode.
And that will cause java sub-process startup to fail.
To resolve this issue, you just need to remove KQI related files under /tmp before restarting it.