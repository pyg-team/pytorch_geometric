Title: IBM PK86431: DURING QMGR INITIALIZATION ABN=0C4-00000011WITH SYMPTOM STRING  CSQMCHKM,M=CSQGFRCV,LOC=CSQMLPLM.CSQMQCST+01AE - United States

Text:
z/os  A FIX IS AVAILABLE
Obtain the fix for this APAR.


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  A new service task exists to load the data conversion
   tables for conversion between CCSIDs (212.DATACN00).
   It is created and initialized by code in csqmerst.
   Initialization of the task storage obtains a data
   conv common table (which describes which tables are
   loaded) and its address is placed in
   MGBL.pmgblCCSIDctrl. Before this has taken place
   MGBL.pmgblCCSIDctrl contains x'00000001'
   (CSQA_FAILED).
   Incorrectly, the create and initialize code in
   csqmerst was placed AFTER the create/initialize for
   the Deferred Put task 212.DPATSC00.csqmerst WAITs for
   DPAT initialization to finish before going on
   to create/initialize the data conversion service task.
   Initialization (CSQM_DEF_PUT_INIT function) in
   csqmdpat consists of opening SYSTEM.PENDING.DATA.QUEUE,
   processing any deferred puts necessary and
   rescheduling itself to restart after a time interval,
   thereafter terminating.
   IF any deferred puts exists on the queue at restart
   time these are then processed (by get and then put to
   the original destination) during the CSQM_DEF_PUT_INIT
   function. During the PUT part of the flow is
   csqmput->csqmputv->csqmpgrv->csqmchkm who needs to call
   data conversion for any headers present by calling
   csqacstr passing the MGBL.pmgblCCSIDctrl (which is
   x'00000001' at this time) Flow continues via
   csqaqcst(csqdqcst) or csqmqcst which uses the x00000001
   pointer, gets its index to the ccsid table incorrectly
   and abends S0C4.
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED: All users of WebSphere MQ for z/OS Version 7 *
   *                 Release 0 modification 0                     *
   ****************************************************************
   * PROBLEM DESCRIPTION: Abend ABN=0C4 during qmgr startup with  *
   *                      symptom string CSQMCHKM,M=CSQGFRCV,     *
   *                      LOC=CSQMLPLM.CSQMQCST                   *
   ****************************************************************
   * RECOMMENDATION:                                              *
   ****************************************************************
   During startup CSQMDPAT is called to process any deferred put's
   on SYSTEM.PENDING.DATA.QUEUE, removing the messages and putting
   them to the correct destination queue. If the messages include
   any headers in a ccsid other than the queue manager's, CSQMCHKM
   (called during the put) calls the data conversion routines to
   convert the header in to the qmgr ccsid. However, at this stage
   in startup the data conversion tables have not been initialised
   and so the 0c4 in CSQMQCST occurs when attempting to access
   them.
   
   
    
   
   

PROBLEM CONCLUSION
 *  CSQMERST has been changed to start the service task that runs
   CSQMDPAT after the data conversion tables have been
   initialised.
   000Y
   CSQMERST
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PK86431
   
   
 * REPORTED COMPONENT NAME
   WMQ Z/OS V7
   
   
 * REPORTED COMPONENT ID
   5655R3600
   
   
 * REPORTED RELEASE
   001
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2009-05-12
   
   
 * CLOSED DATE
   2009-06-09
   
   
 * LAST MODIFIED DATE
   2009-07-01
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
    UK47289
   
   

MODULES/MACROS
 *  CSQMERST
   
   
    
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WMQ Z/OS V7
   
   
 * FIXED COMPONENT ID
   5655R3600
   
   

APPLICABLE COMPONENT LEVELS
 * R000 PSY UK47289 [HTTPS://WWW14.SOFTWARE.IBM.COM/WEBAPP/SET2/ORDERMEDIA/SHOPCART?PTFS=UK47289]
   UP09/06/23 P F906
   
   

FIX IS AVAILABLE
 * SELECT THE PTF APPROPRIATE FOR YOUR COMPONENT LEVEL. YOU WILL BE REQUIRED TO SIGN IN. DISTRIBUTION ON PHYSICAL MEDIA IS NOT AVAILABLE IN ALL COUNTRIES.