Title: IBM Tips and Tricks when Formatting a Microsoft Excel Table using Cognos Disclosure Management - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Microsoft Tables do not convert properly as part of the report generation process for Cognos Disclosure Management 

SYMPTOM
. 


ENVIRONMENT
Windows

RESOLVING THE PROBLEM
The following are Tips and Tricks when working with Microsoft Excel tables with Cognos Disclosure Management: 

Tables split on 2 pages 

When Excel objects are generated, CDM takes into consideration the object properties. Under object properties, there is a section named Enforcement Settings. When a setting is checked/selected (highlighted in yellow in the picture below), it means that during report generation, CDM will apply the setting defined in the Page Setup object (for example, if in the Page Setup object we have a font size of 13 and this setting is checked, it means that object will be generated with size 13). When these settings are not checked, the settings found in that object will be applied 

[/support/docview.wss?uid=swg21979012&amp;aid=1] 

Figure 1 - shows the enforcement settings 

One setting that can be enforced from the Page Setup object is Keep with Next Paragraph/ Table. With the help of this setting, you can dictate whether a table will be split on 2 pages or not. 

[/support/docview.wss?uid=swg21979012&aid=2] [/support/docview.wss?uid=swg21979012&aid=2] 

Figure 2 - shows text and table settings 

The following provides tips on how not to split a table for Microsoft Excel: 

In order to make sure that the tables are not split, you have to 

 * make sure that for each Excel object this setting is enforced 
 * navigate to the Page Setup object, Check Out and select the dummy paragraph and click on Paragraph


[/support/docview.wss?uid=swg21979012&aid=3] [/support/docview.wss?uid=swg21979012&aid=3] 
Figure 3 - shows the default page set up c) on the tab Line and Page Breaks make sure that the options Keep with next and Keep lines together are selected.


[/support/docview.wss?uid=swg21979012&amp;aid=4] 


Figure 4 - shows the default page set up d) Save and Checkin the Page Setup object 

More details can be found here: 

http://www-01.ibm.com/support/knowledgecenter/SSQK59_10.2.1/com.ibm.swg.ba.cognos.cdm_ag.10.2.1.doc/t_cdm_ag_page_setup_format_apply.html [http://www-01.ibm.com/support/knowledgecenter/SSQK59_10.2.1/com.ibm.swg.ba.cognos.cdm_ag.10.2.1.doc/t_cdm_ag_page_setup_format_apply.html] 

and here : 

http://www-01.ibm.com/support/knowledgecenter/SSQK59_10.2.1/com.ibm.swg.ba.cognos.cdm_ag.10.2.1.doc/t_cdm_ag_exclude_object_from_common_format.html?lang=en [http://www-01.ibm.com/support/knowledgecenter/SSQK59_10.2.1/com.ibm.swg.ba.cognos.cdm_ag.10.2.1.doc/t_cdm_ag_exclude_object_from_common_format.html?lang=en] 

General formatting hints 

The process of formatting is pretty much manual - the users have to resize the rows/columns, to merge/unmerge cells and wrap text, to change the font size, etc, in order to make sure that the tables fit properly on the page. 

The users should pay attention to the table size in pixels. Each table is made out of one or more columns, each column has a width in pixels. If the size of each column is added, the user will get the total width of the table in pixels. 

The page margins of the Word Page Setup object determine the amount of pixels of a table that fits properly when the report is generated. So, for example, if you have a 1 inch page margins, this means that a table with a total width of 660 pixels will fit properly. 

Also, some Excel objects might have the padding value set to “0” (zero) – when the Excel objects are generated, by default, CDM adds a padding value of 0.017 inches, meaning that the content of the cells is indented from the border with 0.017 inches; the user can control the padding value by placing a desired value at the intersection of the ##RS column with the ###RE row; we have put “0” (zero) meaning that the cells are not indented from the border. 

In addition, the users can control the position of a table in the generated report with the help of break type (New Page/ Blank Row) and with the number of breaks.


[/support/docview.wss?uid=swg21979012&amp;aid=5] 

Figure 5 - Report Object Configuration  
Details here: 

http://www-01.ibm.com/support/knowledgecenter/SSQK59_10.2.1/com.ibm.swg.ba.cognos.cdm_ag.10.2.1.doc/t_cdm_ag_insert_row_page_breaks.html?lang=en [http://www-01.ibm.com/support/knowledgecenter/SSQK59_10.2.1/com.ibm.swg.ba.cognos.cdm_ag.10.2.1.doc/t_cdm_ag_insert_row_page_breaks.html?lang=en] 

Enforce the table margin to fit the text outside the table 
You can achieve this by performing the following:

1. In CDM create a "Page Setup" object, set it as the first object of the report and enforce the desired margins.
2. Insert in the object a random text containing your specified Font and add below a random table:
[/support/docview.wss?uid=swg21979012&aid=6] [/support/docview.wss?uid=swg21979012&aid=6]
Figure 6 - Table Configuration 

3. Right click on the table - Table properties - Indent from left="0.1 inch"
4. Save the object
5. Go to the Word destination object and from the object properties make sure to deselect "Text Alignment" form the "Text Settings" enforcement setting.
6. You should be able to have the D variables resolve the tables and align them with the text margins
[/support/docview.wss?uid=swg21979012&aid=7] [/support/docview.wss?uid=swg21979012&aid=7]
Figure 7 - Resolve variable