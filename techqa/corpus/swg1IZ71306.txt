Title: IBM IZ71306: WMQ V7 JMS AND WMQ CLASSES FOR JAVA CLIENT FAIL TO CONNECT TO A QUEUE MANAGER WITH AMQ9503 WHEN USING CCSID 943 - United States

Text:
  FIXES ARE AVAILABLE
WebSphere MQ V7.0.1 for i5/OS Fix Pack 7.0.1.3 [http://www-01.ibm.com/support/docview.wss?uid=swg24026933]
WebSphere MQ V7.0 Fix Pack 7.0.1.3 [http://www-01.ibm.com/support/docview.wss?uid=swg24026932]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  An attempt to connect to a queue manager which is configured to
   use CCSID 943 on Solaris or HP-UX with a WebSphere MQ v7 classes
   for Java Message Service (JMS) or WebSphere MQ Classes for Java
   client fails with AMQ9503: Channel negotiation failed.
   
   The JMS exception shows the following stack trace when a
   connection is requested from the connection factory:
   
   com.ibm.msg.client.jms.DetailedIllegalStateException:
   JMSWMQ0018: Failed to connect to queue manager 'someQM'
   with connection mode 'Client' and host name
   'somehost.somedomain'. Check the queue manager is started
   and if running in client mode, check there is a listener
   running. Please see the linked exception for more
   information.
   
   Caused by: com.ibm.mq.MQException: JMSCMQ0001: WebSphere MQ
   call failed with compcode '2' ('MQCC_FAILED') reason '2059'
   ('MQRC_Q_MGR_NOT_AVAILABLE').
   
   Caused by: com.ibm.mq.jmqi.JmqiException: CC=2;RC=2059;
   AMQ9204: Connection to host 'somehost.somedomain(1414)'
   rejected. [1=com.ibm.mq.jmqi.JmqiException[CC=2;RC=2059;
   AMQ9503: Channel negotiation failed. [3=SYSTEM.DEF.SVRCONN]
   ], 3=somehost.somedomain(1414),5=RemoteConnection.initSess]
   
   Caused by: com.ibm.mq.jmqi.JmqiException: CC=2;RC=2059;
   AMQ9503: Channel negotiation failed. [3=SYSTEM.DEF.SVRCONN]
   
   Key Words
   DetailedIllegalStateException Detailed Illegal State Exception
   JMSWMQ0018 AMQ9503 Channel negotiation failed
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  ****************************************************************
   USERS AFFECTED:
   This issue affects users of the WebSphere MQ v7 Classes for JMS
   or WebSphere MQ v7 Classes for Java who are running the client
   on one of the following platforms:
   
   Sun Solaris
   HP-UX
   
   and are connecting to a WebSphere MQ v6 or v7 queue manager,
   which is configured to use CCSID 943.
   
   Platforms affected:
   HP-UX (Itanium),HP-UX (PA-RISC),Solaris (SPARC),
   Solaris (x86-64)
   
   ****************************************************************
   PROBLEM SUMMARY:
   During the build of the WebSphere MQ v7 client, a table which
   maps IBM CCSID values to Java Codepage names is constructed.
   
   This table is used during the opening channel negotiation
   between the client and the server to determine if the platform's
   Java Virtual Machine (JVM) supports conversion from the queue
   manager's native CCSID.  If the queue manager's CCSID is not
   found within the map, channel negotiation fails with the
   exception:
   
   com.ibm.mq.jmqi.JmqiException: CC=2;RC=2059;
   AMQ9503: Channel negotiation failed.
   
   The problem here is that the machines used to build the client
   uses a 1.4.2 Java Development Kit (JDK).  At this level, the
   compilers for Solaris and HP-UX do not have conversion tables
   for CCSID 943 within the java.nio package, that which is used by
   the client at runtime.
   
   However, the 1.5 JDK for these platforms does contain suitable
   conversion tables, which means that a customer's runtime JVM is
   capable of communicating with a queue manager using this native
   CCSID, providing this build-time CCSID to Codepage name mapping
   file contained an appropriate entry.
   
   
    
   
   

PROBLEM CONCLUSION
 *  The generation of the CCSID to JVM Codepage name mapping file
   has been updated to include an entry for CCSID 943.
   
   Note that to have access to the JVM conversion table, which is
   required to successfully communicate with the queue manager,
   your client application must be running within a 1.5 (or later)
   JVM environment, in addition to having the code fix associated
   with this APAR.
   
   Note that this problem is the same as that reported to be
   resolved in APAR IZ59900 [http://www-01.ibm.com/support/docview.wss?uid=swg1IZ59900]
   (http://www.ibm.com/support/docview.wss?uid=swg1IZ59900), which
   was included in v7.0.1.1.  However IZ59900 [http://www-01.ibm.com/support/docview.wss?uid=swg1IZ59900] did not fully resolve
   the problem.
   
   
   | MDVPARTL 7.0.1-WS-MQ-SolarisX64-FP0001     |
   | MDVPARTL 7.0.1-WS-MQ-SolarisSparc64-FP0001 |
   | MDVPARTL 7.0.1-WS-MQ-HpuxPaRISC64-FP0001   |
   | MDVPARTL 7.0.1-WS-MQ-HpuxIA64-FP0001       |
   
   | MDVPARTL 7.0.1-WS-MQ-SolarisX64-FP0002     |
   | MDVPARTL 7.0.1-WS-MQ-SolarisSparc64-FP0002 |
   | MDVPARTL 7.0.1-WS-MQ-HpuxPaRISC64-FP0002   |
   | MDVPARTL 7.0.1-WS-MQ-HpuxIA64-FP0002       |
   
   ---------------------------------------------------------------
   The fix is targeted for delivery in the following PTFs:
   
                      v7.0
   Platform           Fix Pack 7.0.1.3
   --------           --------------------
   HP-UX (PA-RISC)    U834414
   HP-UX (Itanium)    U834413
   Solaris (SPARC)    U834986
   Solaris (x86-64)   U834210
   
   The latest available maintenance can be obtained from
   'WebSphere MQ Recommended Fixes'
   http://www-1.ibm.com/support/docview.wss?rs=171&uid=swg27006037 [http://www-1.ibm.com/support/docview.wss?rs=171&uid=swg27006037]
   
   If the maintenance level is not yet available, information on
   its planned availability can be found in 'WebSphere MQ
   Planned Maintenance Release Dates'
   http://www-1.ibm.com/support/docview.wss?rs=171&uid=swg27006309 [http://www-1.ibm.com/support/docview.wss?rs=171&uid=swg27006309]
   ---------------------------------------------------------------
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IZ71306
   
   
 * REPORTED COMPONENT NAME
   WMQ SOL SPARC
   
   
 * REPORTED COMPONENT ID
   5724H7223
   
   
 * REPORTED RELEASE
   701
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2010-03-01
   
   
 * CLOSED DATE
   2010-03-26
   
   
 * LAST MODIFIED DATE
   2011-08-09
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WMQ SOL SPARC
   
   
 * FIXED COMPONENT ID
   5724H7223
   
   

APPLICABLE COMPONENT LEVELS
 * R701 PSY
   UP