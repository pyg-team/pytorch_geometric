Title: IBM Unable to login to FileNet Content Manager using any client application - United States

Text:
Can't load metadata cache for object store; Unable to login to FileNet Content Manager; database marked suspect; Cannot open database TECHNOTE (TROUBLESHOOTING)

THIS DOCUMENT APPLIES ONLY TO THE FOLLOWING LANGUAGE VERSION(S):
 English 

PROBLEM(ABSTRACT)
 Logging in using FileNet Workplace XT or IBM Content Navigator produces a generic login exception, System error has occurred. 

SYMPTOM
Unable to login to FileNet Content Manager


CAUSE
Microsoft SQL Server database marked suspect.

ENVIRONMENT
This particular Technote only applies to environments where Microsoft SQL Server is used as the database engine.

DIAGNOSING THE PROBLEM
The following exception logged in the P8_server_error.log multiple times:

ENG FNRCE0024I - INFO Can't load metadata cache for object store #1: 'objectstore name here' : {4153E822-F961-4D4D-8CD1-9D99022FCF60} com.filenet.api.exception.EngineRuntimeException: FNRCE0024E: E_FAILED_TO_GET_DATASOURCE: The server cannot get the data source 'data source name here'. Message was: Cannot open database "objectstore name here" requested by the login. The login failed. ClientConnectionId:1ed8ff16-bb94-46ff-b327-1c8e419ae1e9DSRA0010E: SQL State = S0001, Error Code = 4,060

Caused by: java.sql.SQLException: Cannot open database "objectstore name here" requested by the login. The login failed. ClientConnectionId:1ed8ff16-bb94-46ff-b327-1c8e419ae1e9DSRA0010E: SQL State = S0001, Error Code = 4,060

RESOLVING THE PROBLEM





 1. Open Microsoft SQL Server Management Studio and connect to your database
    
    
 2. Click the New Query button
    
    
 3. Paste the following SQL script into your New Query page replacing [YourDatabase] with the name of your actual database name.
    
    EXEC sp_resetstatus [YourDatabase];
    ALTER DATABASE [YourDatabase] SET EMERGENCY
    DBCC checkdb([YourDatabase])
    ALTER DATABASE [YourDatabase] SET SINGLE_USER WITH ROLLBACK IMMEDIATE
    DBCC CheckDB ([YourDatabase], REPAIR_ALLOW_DATA_LOSS)
    ALTER DATABASE [YourDatabase] SET MULTI_USER
    
    
 4. Click Execute
    
    
 5. In the left-hand pane (object explorer), right-click databases and select refresh.
    
    
    Your database should no longer be tagged as (suspect) and you should be able to access it.
    
    Note. The above procedure will alter your database and should be performed by a Microsoft SQL dba. Backing up the affected database should be considered before making any direct changes to it.