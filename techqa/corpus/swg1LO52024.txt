Title: IBM LO52024: CALLING NOTESDOCUMENT.SAVE FROM A BEFORE NEW MAIL ARRIVES AGENT MAY PREVENT IT FROM SHOWING IN THE INBOX - United States

Text:
 SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS FIXED IF NEXT.
    
   
   

ERROR DESCRIPTION
 *  If you have a before new Mail arrive agent that makes a change
   to the
   DocumentContext and then call a NotesDocument.Save,  the email
   may not show up
   in the users inbox.  The customer  sees this on some of their
   servers but not
   others.  I have not been able to reproduce this issue at all in
   house.  We did
   rule out the customers agent by using a very simple
   BeforeNewMail arrives agent
   that just appended the current date/time to the end of the
   subject and then
   called saved.  In the customer's environment,  when the document
   is saved using
   the beforeNewMail arrives agent,  the mail does not appear in
   the users inbox
   until F9 is pressed.  The mail file is a server replica and not
   a local and is
   the actual replica that the router is putting the mail into.  We
   enabled the
   client clock and saw the following:
   
   Enabled client clock and see output containing the following:
   
   
   05/13/2010 10:42:34.36 AM [0818:0008-1784:newmail]
   PollForNewMailGuts>
   Time to p
   oll: 05/13/2010 10:42:29 AM Now: 05/13/2010 10:42:34 AM.
   05/13/2010 10:42:34.36 AM [0818:0008-1784:newmail]
   NewMailThread>
   Waiting for De
   skFindMailFile to be executed
   05/13/2010 10:42:34.36 AM [0818:0008-1784:newmail]
   PollForNewMailGuts>
   Skipped r
   estore, because failed file is still open
   (53-572 [53]) POLL_DEL_SEQNUM: (Connect to MAIL01a:
   144 ms) (
   OPEN_SESSION: 69 ms)
   73 ms. [58+38=96]
   05/13/2010 10:42:34.64 AM [0818:0008-1784:newmail]
   PollForNewMailGuts>
   Polled CN
   =MAIL01a mailil\dca\xxxxx.nsf with 41 seq.
   Server V
   ersion: 323.
   NewMailNotify skipped on Equal - SeqNum:41 LastSeqNum 41
   05/13/2010 10:42:34.64 AM [0818:0008-1784:newmail]
   PollForNewMailGuts>
   Next time
   to poll (Update): 05/13/2010 10:47:34 AM.
   
   So it looks like the sequence number is not getting updated as
   expected.
   
   
    
   
   

LOCAL FIX
 *  IF we remove the call to the save in the before new mail arrives
   agent,  the
   changes do take effect and the email is displayed in the inbox
   as expected.
   From the designer help file we see the following indicating that
   a save is not
   required in a before newMail arrives agent.-
   
   For an agent activated "Before New Mail Arrives," the in-memory
   document is the
   email that is about to be delivered. Because the agent is
   activated instantly
   for each email as it's about to be saved into the mail database,
   each time the
   agent runs you are working with a single unsaved document.
   
   
    
   
   

PROBLEM SUMMARY
 *  The problem will be fixed in the next release of the product.
   
   
    
   
   

PROBLEM CONCLUSION

TEMPORARY FIX

COMMENTS
 *  This APAR is associated with SPR# PALT85SQEF.
   The problem will be fixed in the next release of the product.
   
   
    
   
   

APAR INFORMATION
 * APAR NUMBER
   LO52024
   
   
 * REPORTED COMPONENT NAME
   DOMINO SERVER
   
   
 * REPORTED COMPONENT ID
   5724E6200
   
   
 * REPORTED RELEASE
   802
   
   
 * STATUS
   CLOSED FIN
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2010-05-25
   
   
 * CLOSED DATE
   2010-06-04
   
   
 * LAST MODIFIED DATE
   2010-06-04
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION

APPLICABLE COMPONENT LEVELS
 * R802 PSN
   UP