Title: IBM WASPostUpgrade fails to migrate applications with error ADMA5026E: No valid target is specified - United States

Text:
wp8migrate Portal 8 migration WASPostUpgrade webserver ADMA5026E ADMA5077E WASX7017E MIGR0340W TECHNOTE (TROUBLESHOOTING)

PROBLEM
Some applications fail to deploy during WASPostUpgrade in a migration to Portal 8.0

SYMPTOM
Error in the WASPostUpgrade logs: 

===================================
[03/17/2013 17:53:27:140 EDT] ADMA5016I: Installation of TemplateLibrary_Servlets started.
[03/17/2013 17:53:29:862 EDT] ADMA5058I: Application and module versions are validated with versions of deployment targets.
[03/17/2013 17:53:29:997 EDT] ADMA5005I: The application TemplateLibrary_Servlets is configured in the WebSphere Application Server repository.
[03/17/2013 17:53:30:020 EDT] ADMA5005I: The application TemplateLibrary_Servlets is configured in the WebSphere Application Server repository.
[03/17/2013 17:53:30:020 EDT] ADMA5081I: The bootstrap address for client module is configured in the WebSphere Application Server repository.
[03/17/2013 17:53:30:095 EDT] ADMA5053I: The library references for the installed optional package are created.
[03/17/2013 17:53:30:139 EDT] ADMA5005I: The application TemplateLibrary_Servlets is configured in the WebSphere Application Server repository.
[03/17/2013 17:53:30:199 EDT] ADMA5005I: The application TemplateLibrary_Servlets is configured in the WebSphere Application Server repository.
[03/17/2013 17:53:30:199 EDT] SECJ0400I: Successfully updated the application TemplateLibrary_Servlets with the appContextIDForSecurity information.
[03/17/2013 17:53:30:202 EDT] ADMA5005I: The application TemplateLibrary_Servlets is configured in the WebSphere Application Server repository.
[03/17/2013 17:53:30:253 EDT] ADMA5005I: The application TemplateLibrary_Servlets is configured in the WebSphere Application Server repository.
[03/17/2013 17:53:31:119 EDT] ADMA5113I: Activation plan created successfully.
[03/17/2013 17:53:31:119 EDT] ADMA5011I: The cleanup of the temp directory for application TemplateLibrary_Servlets is complete.
[03/17/2013 17:53:31:120 EDT] ADMA5013I: Application TemplateLibrary_Servlets installed successfully.
[03/17/2013 17:53:31:910 EDT] ADMA5075I: Editing of application TemplateLibrary_Servlets started.
[03/17/2013 17:53:31:981 EDT] ADMA5026E: No valid target is specified in ObjectName
WebSphere:node=MyWebserverNode,server=webserver1 for
module lwp.templatelibraryexport.war+WEB-INF/web.xml.
[03/17/2013 17:53:31:981 EDT] ADMA5011I: The cleanup of the temp directory for application TemplateLibrary_Servlets is complete.
[03/17/2013 17:53:31:982 EDT] ADMA5077E: Editing of application TemplateLibrary_Servlets failed.
[03/17/2013 17:53:31:982 EDT] com.ibm.websphere.management.exception.AdminException: ADMA5026E: No valid target is specified in ObjectName WebSphere:node=MyWebserverNode,server=webserver1 for module lwp.templatelibraryexport.war+WEB-INF/web.xml.
[03/17/2013 17:53:31:982 EDT] at com.ibm.ws.management.application.task.ConfigRepoHelper.getServerNames(ConfigRepoHelper.java:2270)
[03/17/2013 17:53:31:982 EDT] at com.ibm.ws.management.application.task.ConfigRepoHelper.getAddRemoveServerNames(ConfigRepoHelper.java:2175)
[03/17/2013 17:53:31:982 EDT] at com.ibm.ws.management.application.task.ConfigRepoHelper.getServerNames(ConfigRepoHelper.java:2048)
[03/17/2013 17:53:31:982 EDT] at com.ibm.ws.management.application.AppAssociation.getServerNames(AppAssociation.java:1451)
[03/17/2013 17:53:31:982 EDT] at com.ibm.websphere.management.application.AppDeploymentUtil.getNodeInfoForTargets(AppDeploymentUtil.java:307)
.
.
.
[03/17/2013 17:53:31:991 EDT] WASX7017E: Exception received while running file
"/opt/WebSphere/portal61/portal_bak/install_TemplateLibrary_Servlets.ear.jy"; exception information: com.ibm.websphere.management.exception.AdminException: ADMA5026E: No valid target is specified in ObjectName WebSphere:node=MyWebserverNode,server=webserver1 for module lwp.templatelibraryexport.war+WEB-INF/web.xml.
[03/17/2013 17:53:31:991 EDT]
[03/17/2013 17:53:31:993 EDT] at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:60)
[03/17/2013 17:53:31:993 EDT] at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)
[03/17/2013 17:53:31:993 EDT] at java.lang.reflect.Method.invoke(Method.java:611)
[03/17/2013 17:53:31:993 EDT] at org.eclipse.core.launcher.Main.invokeFramework(Main.java:340)
[03/17/2013 17:53:31:994 EDT] at org.eclipse.core.launcher.Main.basicRun(Main.java:282)
[03/17/2013 17:53:31:994 EDT] at org.eclipse.core.launcher.Main.run(Main.java:981)
[03/17/2013 17:53:31:994 EDT] at com.ibm.wsspi.bootstrap.WSPreLauncher.launchEclipse(WSPreLauncher.java:371)
[03/17/2013 17:53:31:994 EDT] at com.ibm.wsspi.bootstrap.WSPreLauncher.main(WSPreLauncher.java:142)
[03/17/2013 17:53:32:139 EDT] MIGR0340W: Application TemplateLibrary_Servlets.ear did not deploy.
===================================

This can happen for several applications.

CAUSE
On the source environment, the applications are mapped to a Webserver that has a different nodename than the Portal server. As part of the migration process, the v8 profile is created using the same nodename as the Portal server from the source environment. WASPostUpgrade creates the webserver definition under this nodename and correctly maps the applications to the Webserver on the target environment using the nodename specified for the v8 profile. However, Portal migration scripts still used the nodename from the source environment for the Webserver instead of the newly specified one for the v8 profile.



RESOLVING THE PROBLEM
1. Locate the Jython script for the application that failed to deploy in the backup_dir created by the WASPreUpgrade command: 

 

<backup_dir>/profiles/wp_profile/PortalApps 

 

2. Open the Jython script in a text editor and change the webserver nodename to the one specified for the v8 profile in the manageprofiles command. For example, you may change this: 


# Add Mapping for "TemplateLibrary_Servlets" to server "webserver1" on node "MyWebserverNode".
AdminApp.edit('TemplateLibrary_Servlets', ['-MapModulesToServers', [['.*', '.*', '+WebSphere:node=MyWebserverNode,server=webserver1']]]) 
AdminConfig.save()


to this:


# Add Mapping for "TemplateLibrary_Servlets" to server "webserver1" on node "newV8Nodename".
AdminApp.edit('TemplateLibrary_Servlets', ['-MapModulesToServers', [['.*', '.*', '+WebSphere:node=newV8Nodename,server=webserver1']]]) 
AdminConfig.save()


3. Save and close the file.
4. Use wsadmin to deploy the application ( wsadmin is located in <AppServer root>/bin ). For example,

wsadmin> execfile("install_TemplateLibrary_Servlets.py")

Reference the following link for details on the wsadmin command:
http://pic.dhe.ibm.com/infocenter/wasinfo/v8r0/index.jsp?topic=/com.ibm.websphere.base.doc/info/aes/ae/welc6topscripting.html [http://pic.dhe.ibm.com/infocenter/wasinfo/v8r0/index.jsp?topic=/com.ibm.websphere.base.doc/info/aes/ae/welc6topscripting.html]


5. Repeat the above steps for every application that failed to deploy. 

 

This is fixed in APAR PM87204 which will be included in CF06 and higher for Portal 8. It is recommended to apply the latest CF to both the source and target environments prior to starting the migration process.




 * 
 *