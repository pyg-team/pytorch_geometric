Title: IBM ENOLCK Error in db2diag.log and NFS File System - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 In the db2diag.log, the ENOLCK error may be returned along with the "TOO MANY OPEN FILES" messages when a target file system is an NFS mounted file system and the lock and/or status daemon is not running. 

SYMPTOM
In the db2diag.log, the ENOLCK error may be returned along with the "TOO MANY OPEN FILES" messages when a target file system is an NFS mounted file system and the lock and/or status daemon is not running. 

This could cause failures with backups, loads, and other activities that access the NFS file system.

2009-01-22-07.40.27.556263-420 E193060E804 LEVEL: Error (OS)
PID : 2013 TID : 47960532445504PROC : db2sysc
INSTANCE: db2inst1 NODE : 000
EDUID : 96 EDUNAME: db2lmr
FUNCTION: DB2 UDB, oper system services, sqloflock, probe:100
MESSAGE : ZRC=0x850F0006=-2062614522=SQLO_FHNL "TOO MANY OPEN FILES"
DIA8306C Too many files were opened.
CALLED : OS, -, fcntl OSERR: ENOLCK (37)
DATA #1 : File handle, PD_TYPE_SQO_FILE_HDL, 8 bytes
0x00002B9EAE7FC3E8 : 1F00 0000 0000 0000 ........
DATA #2 : Hex integer, 1 bytes
0x02
DATA #3 : Hex integer, 1 bytes
0x03
DATA #4 : String, 105 bytes
Search for ossError*Analysis probe point after this log entry for
further
self-diagnosis of this problem.

2009-01-22-07.40.27.557124-420 E193865E406 LEVEL: Severe
PID : 2013 TID : 47960532445504PROC : db2sysc
INSTANCE: db2inst1 NODE : 000
EDUID : 96 EDUNAME: db2lmr
FUNCTION: DB2 UDB, database utilities, sqluInitFileDevice, probe:609
MESSAGE : ZRC=0x850F0006=-2062614522=SQLO_FHNL "TOO MANY OPEN FILES"
DIA8306C Too many files were opened.


CAUSE
DB2 is attempting to acquire locks on the file(s) and is unable to do so because the lock and/or status daemon is not running.


DIAGNOSING THE PROBLEM
On linux, the "rpcinfo -p" command can list all the registered RPC services.



RESOLVING THE PROBLEM
Ensure the NFS lock and/or rpc.statd daemons are running. 

 

When using NFS in conjunction with DB2, please read the following additional information:
http://publib.boulder.ibm.com/infocenter/db2luw/v9r5/index.jsp?topic=/com.ibm.db2.luw.qb.server.doc/doc/c0025100.html [http://publib.boulder.ibm.com/infocenter/db2luw/v9r5/index.jsp?topic=/com.ibm.db2.luw.qb.server.doc/doc/c0025100.html]