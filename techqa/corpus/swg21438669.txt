Title: IBM "Standard Error 5 ... (0x800A005B): Object variable or With block variable not set ... COM+ has determined that your machine is running very low on available memory" when running a consolidation. - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
User launches a consolidation. After a while, an error message appears.

SYMPTOM
Screen errors: 

Information
Standard Error
Number: 5
Source: ControllerProxyClient
Description: System.Web.Services.Protocols.SoapException: Server was unable to process request. ---> System.Runtime.InteropServices.COMException (0x800A005B): Object variable or With block variable not set
at FrBatchBT.clsBatchTClass.Batch(String sGuid, String sUser, Int16 iProcessId, String sJobName, String sParams, Int32 lRegDate, Int32 lRegTime, Int32 lSchedDate, Int32 lSchedTime, Int16 iScheduleType, String sUdl, Int32 lDependentBy, String sTimeChain, Boolean bBatchMode)
at Cognos.Controller.Proxy.CCRWS.clsBatchT_Batch(String sGuid, String sUser, Int16 iProcessId, String sJobName, String sParams, Int32 iRegDate, Int32 iRegTime, Int32 iSchedDate, Int32 lSchedTime, Int16 iScheduleType, String sUdl, Int32 iDependentBy, String sTimeChain, Boolean bBatchMode)
--- End of inner exception stack trace ---
at Cognos.Controller.ControllerSoapHttpClientProtocol.Invoke(String methodname, Object[] parameters)
at Cognos.Controller.Proxy.FrBatchBT.WSFrBatchBT.clsBatchT_Batch(String sGuid, String sUser, Int16 iProcessId, String sJobName, String sParams, Int32 iRegDate, Int32 iRegTime, Int32 iSchedDate, Int32 lSchedTime, Int16 iScheduleType, String sUdl, Int32 iDependentBy, String sTimeChain, Boolean bBatchMode)
at Cognos.Controller.Direct.Batch.Batch(Int16 iProcessId, String sJobName, String sParam, Int32 iRegDate, Int32 iRegTime, Int32 iSchedDate, Int32 iSchedTime, Int16 iScheduleType, Int32 iDependentBy, String& sTimeChain, Boolean bBatchMode)
at Cognos.Controller.Forms.Form.frmConsolidate.IRun_DoRun()
[OK]

Information
The connection with the server was lost.
Controller will terminate.
If a process was not completed, data may be lost.
Please check your work
[OK]

Event Viewer (Application Log):
Event Type: Warning
Event Source: Cognos Controller
Event Category: None
Event ID: 0
Date: 24/06/2010
Time: 13:12:29
User: N/A
Computer: SERVERNAME
Description:
Standard Error
Number: 5
Source: ControllerProxyClient
Description: System.Web.Services.Protocols.SoapException: Server was unable to process request. ---> System.Runtime.InteropServices.COMException (0x800A005B): Object variable or With block variable not set
at FrBatchBT.clsBatchTClass.Batch(String sGuid, String sUser, Int16 iProcessId, String sJobName, String sParams, Int32 lRegDate, Int32 lRegTime, Int32 lSchedDate, Int32 lSchedTime, Int16 iScheduleType, String sUdl, Int32 lDependentBy, String sTimeChain, Boolean bBatchMode)
at Cognos.Controller.Proxy.CCRWS.clsBatchT_Batch(String sGuid, String sUser, Int16 iProcessId, String sJobName, String sParams, Int32 iRegDate, Int32 iRegTime, Int32 iSchedDate, Int32 lSchedTime, Int16 iScheduleType, String sUdl, Int32 iDependentBy, String sTimeChain, Boolean bBatchMode)
--- End of inner exception stack trace ---
at Cognos.Controller.ControllerSoapHttpClientProtocol.Invoke(String methodname, Object[] parameters)
at Cognos.Controller.Proxy.FrBatchBT.WSFrBatchBT.clsBatchT_Batch(String sGuid, String sUser, Int16 iProcessId, String sJobName, String sParams, Int32 iRegDate, Int32 iRegTime, Int32 iSchedDate, Int32 lSchedTime, Int16 iScheduleType, String sUdl, Int32 iDependentBy, String sTimeChain, Boolean bBatchMode)
at Cognos.Controller.Direct.Batch.Batch(Int16 iProcessId, String sJobName, String sParam, Int32 iRegDate, Int32 iRegTime, Int32 iSchedDate, Int32 iSchedTime, Int16 iScheduleType, Int32 iDependentBy, String& sTimeChain, Boolean bBatchMode)
at Cognos.Controller.Forms.Form.frmConsolidate.IRun_DoRun()

Event Type: Warning
Event Source: VBRuntime
Event Category: None
Event ID: 1
Date: 24/06/2010
Time: 13:12:29
User: N/A
Computer: SERVERNAME
Description:
The VB Application identified by the event source logged this Application FrBatchBT: Thread ID: 1320 ,Logged: Error occured at 24/06/2010 13:12:29 in FrBatchBT, Error No=91, Source=FrBatchBT, Description=Object variable or With block variable not set, HelpFile= HelpContext=0 

Event Type: Warning
Event Source: COM+
Event Category: (107)
Event ID: 4830
Date: 24/06/2010
Time: 13:12:29
User: N/A
Computer: SERVERNAME
Description:
COM+ has determined that your machine is running very low on available memory. In order to ensure proper system behavior, the activation of the component has been refused. If this problem continues, either install more memory or increase the size of your paging file. Memory statistics are: dwMemoryLoad = 81
ullTotalPhys = 0x03ff67000
ullAvailPhys = 0x00be6b000
ullTotalPageFile = 0x0825f4000
ullAvailPageFile = 0x005a6c000
ullTotalVirtual = 0x07ffe0000
ullAvailVirtual = 0x040fe4000

Process Name: dllhost.exe
Comsvcs.dll file version: ENU 2001.12.4720.3959 shp

Event Type: Warning
Event Source: VBRuntime
Event Category: None
Event ID: 1
Date: 24/06/2010
Time: 13:12:29
User: N/A
Computer: SERVERNAME
Description:
The VB Application identified by the event source logged this Application FrMiscBT: Thread ID: 1320 ,Logged: Error occured at 24/06/2010 13:12:29 in FrMiscBT, Error No=7, Source=FrMiscBT.ConsBusinessT.RunConsol, Description=Out of memory, HelpFile= HelpContext=0



CAUSE
Controller application server has run out of memory.



RESOLVING THE PROBLEM
Ensure that: 

 1. The Controller application server has a sensible about of physical RAM installed (for example, typically 4Gb RAM) 
 2. The Windows virtual memory settings of the application server are configured correctly (for example set to 'system managed size').