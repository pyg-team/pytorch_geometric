Title: IBM How to troubleshoot Redhat patches failed problem - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Many customers may meet the redhat patches failed problem and don't know how to troubleshoot. 

RESOLVING THE PROBLEM
There are many reasons that can cause the redhat patches failed, such as RHSM plug-in not configured, patches installed with non-zero exit code for OS reasons, client is not configured with the right settings, etc. 

Here are the steps to troubleshoot what's wrong. 

Firstly you need to check the scope of the problem by the following two questions. 

How many clients have the problem? Only one, or all redhat clients?
How many fixlets of the same site has the problem, only one? Or all? 

1) If all redhat clients failed to install all patches, then probably the problem exists on the RHSM plug-in. 

a) Check if you have configured RHSM plug-in successfully. 

b) enable the DEBUG mode for the RHSMPlugin.log in the following folder of bigfix server 

 * On Windows systems: %PROGRAM FILES%\BigFix Enterprise\BES Server\DownloadPlugins\RHSMProtocol 
 * On Linux systems: /var/opt/BESServer/DownloadPlugins/RHSMProtocol

c) Check on debug RHSMPlugin.log to see if there are any download errors are there to confirm if this is a plug-in issue 

 

d) If yes, first check if you have followed all the plug-in configuration steps and if the certificate can access the right repo by the following commands.The results identify the number of accessible repositories which the certificate is entitled to against the available Red Hat repositories that BigFix supports. 

--check-baserepos
Checks if the entitlement certificates in the 'certs' folder has access to the base repositories.
--check-allrepos
Checks if the entitlement certificates in the 'certs' folder has access to the base repositories and the sub-repositories.

For example:
C:\Program Files (x86)\BigFix Enterprise\BES Server\DownloadPlugins\RHSMProtocol\RHSMPlugin.exe--check-baserepos


2) If only one client failed to install all patches, then maybe some OS or library pre-requisites is not fulfilled. 

Please check if the client can be showed on console with the latest report time and if other actions can work. If the only problem for the client is patching failed, but other actions can work, then check the besclient log(var/opt/BESClient/__BESData/__Global/Logs) 

You may see such error in the client log,
At 10:40:26 +0800 - Warning: execute prefetch plug-in command taking more than 2 seconds to complete. It took 3 seconds.
At 10:41:27 +0800 - 'execute prefetch plug-in' didn't complete within 60 seconds. Black listing plug-ins matching the sha256 hash of 'name of 'bash' until agent is restarted
. ActionLogMessage: (group:209467,action:209468) Execute prefetch plug-in taking too long to execute. 

For this problem, please follow the steps:

a) Change the timeout length to 600
_BESClient_ActionManager_PrefetchPlugInTimeoutSeconds
Default: 60
Min: 60
Max: 6000 (100 mins)
b) restart the besclient on the problematic client machine
c) Check if you have put the whole bigfix installation folder to anti-virus exclusion for the problematic client machine 

3) If only one client failed to install only one patch or two, then check if the exit code is returned. If there are non-zero exit code, then manually install the patch on the problematic client to see if it succeed or not 

If you can manually install the redhat patch on the problematic client successfully but couldn't install the same patch by bigfix console, then please gather and send the besclient log and the whole folder /var/opt/BESClient/EDRDeployData to Bigfix support team. 

Also, please tell support team the detailed date and time when you run the action on console and the action name.