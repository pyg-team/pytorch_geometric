Title: IBM Tivoli Integrated Portal upgrade failure caused by insufficient memory. - United States

Text:
TIPL2INST; upgrade failure; Resources Memory; No space left on device TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Lack of available memory can cause upgrade failures. In this case, the system didn't have enough disk space for the partition where TIPHOME resides, and also the already running processes used up a lot of the available RAM. "java.io.IOException: No space left on device" 

SYMPTOM
FAILURE: The overall installation fails. Check <install user's home directory>/TIPInstaller-00.log. 

The log file contains errors like this, 


2013-05-14 14:47:03.820-04:00 : SEVERE : Raw Exception in 
DeploymentPlanProcessor.process(INSTALL): COIEventType.ERROR reported 
(from com.ibm.ac.coi.ext.ia.COIWrapperPluginImpl.install) Caused by: 
com.ibm.ac.coi.api.exception.DeploymentPlanExecutionException: One or 
more Machine Plans within the DeploymentPlan failed. Failure count = 1.


CAUSE
Lack of both physical disk space and runtime RAM caused this upgrade failure.


ENVIRONMENT
AIX, Solaris, Linux



DIAGNOSING THE PROBLEM
All the logs files referenced in this section are collected using the Tivoli Integrated Portal Mustgather for installation issues, The deployment_plan.log, MachinePlan_localhost.log and TIPCore_postinstall.xml will be under the _uninst directory referenced in the mustgather. 

 https://www-304.ibm.com/support/docview.wss?uid=swg21468983 

TIPInstaller-00.log file from the upgrade: 

SEVERE : Raw Exception in DeploymentPlanProcessor.process(INSTALL) COIEventType.ERROR reported (from com.ibm.ac.coi.ext.ia.COIWrapperPluginImpl.install)
Caused by: com.ibm.ac.coi.api.exception.DeploymentPlanExecutionException: One or more Machine Plans within the DeploymentPlan failed. Failure count = 1

Checking the deployment_plan.log showed this error:

<TIP_HOME>/_uninst/TIPInstall<#>/plan/install/MachinePlan_localhost/ 
MachinePlan_localhost.xml:277: Error executing step: An error was
encountered running step TIPCore-<FP#> 
2013-05-14 14:44:23.931 : Failed: Machine Plan: MachinePlan_localhost 
2013-05-14 14:44:23.931 : Log File: 
<TIPHOME>/_uninst/TIPInstall<#>/plan/install/MachinePlan_localhost/
logs/[INSTALL_0514_14.36]/MachinePlan_localhost.log 

This error was in the MachinePlan_localhost.log

0004_TIPCore-FP7/TIPCore-<FP#>.xml:602: The following error occurred while executing 
this line: 
<TIP_HOME>/_uninst/TIPInstall<#>/plan/install/MachinePlan_localhost/ 
00004_TIPCore-FP7/TIPCore-<FP#>.post.install.xml:116: exec returned: 105 at
org.apache.tools.ant.ProjectHelper.addLocationToBuildException
(ProjectHelper.java:508) 

Checking line 116 in the TIPCore-<fixpack level>.post.install.xml 


<exec dir="${IAGLOBAL_TIP_HOME}/profiles/${IAGLOBAL_WASProfileName}/bin" 
executable="${IAGLOBAL_TIP_HOME}/profiles/${IAGLOBAL_WASProfileName}/bin 
/wsadmin${platform.script.ext}" failonerror="true"> 
<redirector output="${IAGLOBAL_TIP_HOME}/logs/redeploy_connMgr_fp_inst.out"
error="${IAGLOBAL_TIP_HOME}/logs/redeploy_connMgr_fp_inst.err"/> 
<arg value="-lang"/> 

The redeploy logs are in <TIPHOME>/logs ( or <TIPHOME>\logs for windows ). This shows the core problem is a server memory issue:

sys-package-mgr*: processing modified jar, 
'<TIP_HOME>/lib/iscdeploy.jar' 
org.eclipse.jst.j2ee.commonarchivecore.internal.exception.SaveFailureExc 
eption: lmt_admin.war 
Stack trace of nested exception: 
java.io.IOException: No space left on device 
at java.io.FileOutputStream.writeBytes(Native Method) 
at java.io.FileOutputStream.write(FileOutputStream.java:277) 


RESOLVING THE PROBLEM
The install needs 315M in the temp location, 980M for $TIPHOME. Using the "df -kl" command will show the amount of available memory. For RAM, you can use the unix "TOP" command. 

If this doesn't fix the problem, please shut down all instances of DB2 including the DB2 Admin server and retry the upgrade.

If the upgrade still fails, please collect the information in the following technote and contact TIP support:

https://www-304.ibm.com/support/docview.wss?uid=swg21468983