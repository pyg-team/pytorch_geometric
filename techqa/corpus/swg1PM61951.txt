Title: IBM PM61951: POTENTIAL TCPIP PERFORMANCE DEGREDATION WITH PATHMTUDISCOVERY - United States

Text:
z/os  A FIX IS AVAILABLE
Obtain the fix for this APAR.


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  When PATHMTUDISCOVERY is enabled on a system, TCPIP will
   dynamically add Destination Cache entries to the routing table
   for each remote address being used.  Entries that are no longer
   in use are removed from the table periodically by a garbage
   collection process.
   
   On systems with a high volume of short-lived connections with a
   wide variety of remote IP addresses (such as a web server
   accessible from the open Internet), this can cause the number of
   these entries to grow quite large.  This will then cause a
   significant amount of processing by the garbage collection
   process.  While it is running, no other updates to the routing
   table can be performed which can cause:
   
    - Servers to be periodically unresponsive to new connection
      attempts.
   
    - No response to PINGs.
   
    - Repeated IST2273E PACKETS DISCARDED FOR TCPIP - READ QUEUE
      CONGESTION messages.
   
   
    
   
   

LOCAL FIX
 *  Set (or default to) NOPATHMTUDISCOVERY on the IPCONFIG
   statement.
   
   
    
   
   

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED: All users of the IBM Communications Server   *
   *                 for z/OS Version 1 Release(s) 12 and 13 IP:  *
   *                 PATHMTUDISCOVERY                             *
   ****************************************************************
   * PROBLEM DESCRIPTION: PATHMTUDISCOVERY periodic cleanup of    *
   *                      stale information can cause performance *
   *                      degradation.                            *
   ****************************************************************
   * RECOMMENDATION:                                              *
   ****************************************************************
   PATHMTUDISCOVERY periodic cleanup of stale information can cause
   performance degradation.
   
   PATHMTUDISCOVERY maintains the MTU for every TCP connected peer
   IP address in the route table as a destination cache entry.  The
   destination cache entry is retained for a period of time after
   all the connections to the peer IP address have terminated.  A
   garbage collection routine is scheduled to delete destination
   cache entries that are no longer in use and deemed stale.
   
   The performance degradation can occur when there are a large
   number of destination cache entries to be deleted on a single
   garbage collection cycle.  The route table will not allow
   updates while the route table is being scanned, preventing the
   addition of new destination cache entries.  The delete process
   acquires a storage area that can be satisfied from a storage
   cache.  When processing a large number of deletes the storage
   cache is likely to be depleted and any additional deletes will
   result in a STORAGE OBTAIN request.
   +-------------------------------------------------------------+
   + Please check our Communications Server for OS/390 homepages +
   + for common networking tips and fixes.  The URL for these    +
   + homepages can be found in Informational APAR II11334 [http://www-01.ibm.com/support/docview.wss?uid=isg1II11334].       +
   +-------------------------------------------------------------+
   
   
    
   
   

PROBLEM CONCLUSION
 *  The destination cache cleanup routine has been amended to delete
   a limited number of entries in a single cycle.  If the entire
   route table has not been processed the garbage collection is
   rescheduled immediately.  By limiting the number of entries that
   are deleted in a single cycle allows other update requests to
   be processed in a timely manner.  The immediate reschedule of
   the garbage collection will increase the likelihood the storage
   cache can be used to satisfy the storage requirement.
   
   * Cross Reference between External and Internal Names
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PM61951
   
   
 * REPORTED COMPONENT NAME
   TCP/IP V3 MVS
   
   
 * REPORTED COMPONENT ID
   5655HAL00
   
   
 * REPORTED RELEASE
   1C0
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   YesSpecatt / CST
   
   
 * SUBMITTED DATE
   2012-04-05
   
   
 * CLOSED DATE
   2012-05-15
   
   
 * LAST MODIFIED DATE
   2012-11-07
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
    UK79210 UK79211
   
   

MODULES/MACROS
 *  EZBIPRTE EZBIPRT2 EZBITTCB EZB6PNBC EZB6PRTE
   TOIPROCS
   
   
    
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   TCP/IP V3 MVS
   
   
 * FIXED COMPONENT ID
   5655HAL00
   
   

APPLICABLE COMPONENT LEVELS
 * R1C0 PSY UK79210 [HTTPS://WWW14.SOFTWARE.IBM.COM/WEBAPP/SET2/ORDERMEDIA/SHOPCART?PTFS=UK79210]
   UP12/07/06 P F207
   
   
 * R1D0 PSY UK79211 [HTTPS://WWW14.SOFTWARE.IBM.COM/WEBAPP/SET2/ORDERMEDIA/SHOPCART?PTFS=UK79211]
   UP12/07/06 P F207
   
   

FIX IS AVAILABLE
 * SELECT THE PTF APPROPRIATE FOR YOUR COMPONENT LEVEL. YOU WILL BE REQUIRED TO SIGN IN. DISTRIBUTION ON PHYSICAL MEDIA IS NOT AVAILABLE IN ALL COUNTRIES.