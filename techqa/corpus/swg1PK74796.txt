Title: IBM PK74796: SQLCODE302 EXECUTING EXTERNAL SQL PROCEDURE WITH TIMESTAMP      PARAMETER WITH PARAMETER CCSID UNICODE - United States

Text:
z/os  A FIX IS AVAILABLE
Obtain the fix for this APAR.


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  DSNT408I SQLCODE = -302, ERROR:  THE VALUE OF INPUT VARIABLE OR
   PARAMETER NUMBER 89 IS INVALID OR TOO LARGE FOR THE TARGET
   COLUMN OR THE TARGET           VALUE
    DSNT418I SQLSTATE   = 22001 SQLSTATE RETURN CODE
    DSNT415I SQLERRP    = DSNXRIHB SQL PROCEDURE DETECTING ERROR
    DSNT416I SQLERRD    = -190  0  0  11  0  0 SQL DIAGNOSTIC
   INFORMATION
    DSNT416I SQLERRD    = X'FFFFFF42'  X'00000000'  X'00000000'
   X'0000000B'
   
   while executing external stored procedure with timestamp
   variable with PARAMETER CCSID UNICODE
   
   
    
   
   

LOCAL FIX
 *  use native SQL stored proc, if possible
   
   
    
   
   

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED: Users of external SQL procedures using the   *
   *                 PARAMETER CCSID ASCII or PARAMETER CCSID     *
   *                 UNICODE option with datetime parameters on   *
   *                 DB2 for z/OS 810 910.                        *
   ****************************************************************
   * PROBLEM DESCRIPTION: SQLCODE302 or SQLCODE180 when executing *
   *                      an external SQL procedure defined with  *
   *                      PARAMETER CCSID ASCII or PARAMETER      *
   *                      CCSID UNICODE and containing datetime   *
   *                      parameters.                             *
   ****************************************************************
   * RECOMMENDATION:                                              *
   ****************************************************************
   Here are two examples that illustrate the problem:
   
   A table is created as follows:
   CREATE TABLE UNI (TS TIMESTAMP) CCSID UNICODE;
   
   The following procedure will result in SQLCODE302 when executed:
   CREATE PROCEDURE CTEST (IN PTS TIMESTAMP)
     LANGUAGE SQL FENCED PARAMETER CCSID UNICODE
     INSERT INTO UNI VALUES (PTS)
   
   DSNT408I SQLCODE = -302, ERROR:  THE VALUE OF INPUT VARIABLE OR
            PARAMETER NUMBER 1 IS INVALID OR TOO LARGE FOR THE
            TARGET COLUMN OR THE TARGET VALUE
   DSNT418I SQLSTATE = 22001 SQLSTATE RETURN CODE
   DSNT415I SQLERRP  = DSNXRIHB SQL PROCEDURE DETECTING ERROR
   DSNT416I SQLERRD  = -325 0 0 27 0 0 SQL DIAGNOSTIC INFORMATION
   
   
   The following procedure will result in SQLCODE180 when executed:
   CREATE PROCEDURE CTEST (INOUT PTS TIMESTAMP)
     LANGUAGE SQL FENCED PARAMETER CCSID UNICODE
     SELECT TS INTO PTS FROM UNI;
   
   DSNT408I SQLCODE = -180, ERROR:  THE DATE, TIME, OR TIMESTAMP
            VALUE *N IS INVALID
   DSNT418I SQLSTATE = 22007 SQLSTATE RETURN CODE
   DSNT415I SQLERRP  = DSNXRGPL SQL PROCEDURE DETECTING ERROR
   DSNT416I SQLERRD  = -6813 0 0 -1 0 0 SQL DIAGNOSTIC INFORMATION
   
   
   The same errors occur when a DATE or TIME parameter are used.
   
   
    
   
   

PROBLEM CONCLUSION
 *  The DB2 precompiler is modified so that the logic generated for
   external SQL procedures includes CCSID specifications for
   datetime procedure parameters so that the errors no longer
   occur.
   
   Any external SQL Procedure that exhibits the symptoms described
   by APAR PK74796 must be rebuilt after the fix for PK74796 is
   applied for the fix to take effect.
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PK74796
   
   
 * REPORTED COMPONENT NAME
   DB2 OS/390 & Z/
   
   
 * REPORTED COMPONENT ID
   5740XYR00
   
   
 * REPORTED RELEASE
   910
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2008-10-31
   
   
 * CLOSED DATE
   2008-11-06
   
   
 * LAST MODIFIED DATE
   2008-12-02
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
    UK41411 UK41412
   
   

MODULES/MACROS
 *  DSNHSMS2
   
   
    
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   DB2 OS/390 & Z/
   
   
 * FIXED COMPONENT ID
   5740XYR00
   
   

APPLICABLE COMPONENT LEVELS
 * R810 PSY UK41411 [HTTPS://WWW14.SOFTWARE.IBM.COM/WEBAPP/SET2/ORDERMEDIA/SHOPCART?PTFS=UK41411]
   UP08/11/22 P F811
   
   
 * R910 PSY UK41412 [HTTPS://WWW14.SOFTWARE.IBM.COM/WEBAPP/SET2/ORDERMEDIA/SHOPCART?PTFS=UK41412]
   UP08/11/22 P F811
   
   

FIX IS AVAILABLE
 * SELECT THE PTF APPROPRIATE FOR YOUR COMPONENT LEVEL. YOU WILL BE REQUIRED TO SIGN IN. DISTRIBUTION ON PHYSICAL MEDIA IS NOT AVAILABLE IN ALL COUNTRIES.