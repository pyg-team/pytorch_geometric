Title: IBM Hybrid setup in clustered environment - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Hybrid post-install scripts fail to enable InfoSphere Hybrid MDM implementation in clustered environment. 

SYMPTOM
Following a successful InfoSphere MDM installation in clustered environment, the Hybrid post-install script will be created under the InfoSphere MDM installation home directory in Hybrid/bin as expected. However, following the general approach/instructions/steps to run the hybridPostInstall.sh script will fail with “path not found” errors.


CAUSE
In a clustered environment, Hybrid post-install scripts fail to locate native.war and therefore fail to use the MDS utilities in native.war to enable Hybrid MDM implementation.

ENVIRONMENT
The problem can be observed in any clustered environment. Specifically, the affected environment has InfoSphere MDM v11.0 installed on a cluster with multiple nodes.

DIAGNOSING THE PROBLEM
After installing InfoSphere MDM v11.0 in a clustered environment, follow the instructions in [MDM installation home]/Hybrid/HybridPostInstall/doc/ReadMe.txt to set up setupEnvVariables.sh. 


Then, run the following commands:
. setupEnvVariables.sh (ensure to include the dot and the space)
echo $MAD_WAR

The value echoed to the console would be either empty or a nonexistent path, indicating that setupEnvVariables.sh is not setting the correct path to native.war.


RESOLVING THE PROBLEM
1) Skip this step if the nodes and dmgr are on the same server. Otherwise, move the “Hybrid” folder from the InfoSphere MDM installation home directory on the dmgr server to a fully accessible (read/write/execute-enabled) directory on one of the node servers. 


2) Set the variable MAD_VAR in Hybrid/HybridPostInstall/bin/setupEnvVariables.sh to the location of native.war.

The existing value assigned to the variable MAD_VAR is `$WAS_HOME/bin/wsadmin.sh -user $WAS_ADMIN_USER -password $WAS_ADMIN_PASSWORD -f readWASVAR.py $NODE_NAME $INSTANCE_NAME |tail -1 `. Change the value to the absolute path to native.war. On a Node server, native.war is under the directory [WAS home]/[profiles directory]/[node directory]/installedApps/[cell name]/[MDM native ear]/
For example,
MAD_VAR=/usr/IBM/WebSphere/AppServer8.5/profiles/Node01/installedApps/mdmaix005.torolab.ibm.comCell01/MDM-native-MDMVerticalApp01.ear/native.war

3) Follow the instructions in Hybrid/HybridPostInstall/doc/ReadMe.txt as you would in a non-clustered environment. When instructed to set MDM_INSTALL_HOME and only if step 1 was performed, set the variable MDM_INSTALL_HOME in setupEnvVariables.sh as the directory to which the “Hybrid” folder was moved.

4) Manually restart the cluster using the WebSphere Integrated Solutions Console (“Servers” -> “Clusters” -> “WebSphere application server clusters”) after successfully running the Hybrid post-install script.

5) To enable Hybrid event notification, follow the instructions in http://pic.dhe.ibm.com/infocenter/mdm/v11r0/index.jsp?topic=%2Fcom.ibm.swg.im.mdmhs.hybrid.setup.doc%2Ftopics%2Frunning_post_installation_scripts.html [http://pic.dhe.ibm.com/infocenter/mdm/v11r0/index.jsp?topic=%2Fcom.ibm.swg.im.mdmhs.hybrid.setup.doc%2Ftopics%2Frunning_post_installation_scripts.html] and set up the security context for the event handler work manager (step 14) for every node in the cluster. When instructed to restart the server, restart the cluster instead.