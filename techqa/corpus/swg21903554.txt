Title: IBM The upgrade from Portal 8001 CF13 to CF16 fails during the config task with errors, WASX7023E, WASX7213I, WASX8011W, WASX7017E, and EJPXD0015W - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM
While attempting to upgrade Portal 8001 from CF13 to CF16 the upgrade fails during the config task portion of the upgrade.

SYMPTOM
The ConfigTrace.log shows the following...
iseries-switch-back:
[switchprofile] Switching back to original user= USER1
Target finished: iseries-switch-back
Target finished: action-change-workdir-perms-iseries
[wplc-get-host-port-in-server] Task parameters:
[wplc-get-host-port-in-server] Global attributes:
[wplc-get-host-port-in-server] cell="PORTAL_CELL"
[wplc-get-host-port-in-server]
engineinstalllocation="/QIBM/UserData/WebSphere/AppServer/V8/ND
/profiles/WCMAUTH/ConfigEngine"
[wplc-get-host-port-in-server]
enginerootdir="/QIBM/ProdData/WebSphere/PortalServer/V8/ConfigEngine"
[wplc-get-host-port-in-server] pathseparator=":"
[wplc-get-host-port-in-server] osarch="PowerPC"
[wplc-get-host-port-in-server] node="PORTAL_NODE"
[wplc-get-host-port-in-server] server="WebSphere_Portal"

[wplc-get-host-port-in-server] Instance attributes (Set 1 of 1):
[wplc-get-host-port-in-server] endPointName="SOAP_CONNECTOR_ADDRESS"
[wplc-get-host-port-in-server] attribute=[ *** NONE_SPECIFIED *** ]
[wplc-get-host-port-in-server] end point: SOAP_CONNECTOR_ADDRESS found
[wplc-get-host-port-in-server] Settings the host: hostname.acme.com as
ant property: ${hostInJMX}
[wplc-get-host-port-in-server] Settings the port: 11278 as ant
property: ${portInJMX}
[wplc-get-host-port-in-server] Status = Complete
[echo] Determined soap host: hostname.acme.com
[echo] Determined soap connector: 11278
Target started: action-change-workdir-perms-iseries

action-change-workdir-perms-iseries:
Target started: iseries-switch-back

iseries-switch-back:
[switchprofile] Switching back to original user= USER1
Target finished: iseries-switch-back
Target finished: action-change-workdir-perms-iseries
[echo] Default Portal
Target started: action-configengine-log-files-iseries

action-configengine-log-files-iseries:
Target started: iseries-switch-back

iseries-switch-back:
[switchprofile] Switching back to original user= USER1
Target finished: iseries-switch-back
Target finished: action-configengine-log-files-iseries
Target started: iseries-switch-to-was-user

iseries-switch-to-was-user:
[switchprofile] Switching back to original user= USER1
Target finished: iseries-switch-to-was-user
[wsadmin] WASX7209I: Connected to process "WebSphere_Portal" on node
PORTAL_NODE using SOAP connector; The type of process is:
ManagedProcess
[wsadmin] [05/14/15 08:40:08.341 PDT] FFDC1007I: FFDC Provider
Installed: com.ibm.ffdc.util.provider.FfdcOnDirProvider@6be218b1
[wsadmin] logged in as "uid=admin,cn=users,DC=acme,DC=acme,DC=com"
[wsadmin] [05/14/15 08:40:09.124 PDT] logged in as
"uid=admin,cn=users,DC=acme,DC=acme,DC=com"
[wsadmin] [05/14/15 08:40:19.655 PDT] WASX7120E: Diagnostic information
from exception with text "com.ibm.ws.scripting.ScriptingException:
WASX7070E: The configuration service is not available.
[wsadmin] " follows:

[wsadmin] com.ibm.ws.scripting.ScriptingException: WASX7070E: The
configuration service is not available.
[wsadmin] at
com.ibm.ws.scripting.AbstractShell.setAndThrowScriptingException(Abstrac
tShell.java:1865)
[wsadmin] at
com.ibm.ws.scripting.AdminConfigClient.checkService(AdminConfigClient.ja
va:2498)
[wsadmin] at
com.ibm.ws.scripting.WasxShell.leaving(WasxShell.java:1043)
[wsadmin] at
com.ibm.ws.scripting.WasxShell.leaving(WasxShell.java:1007)
[wsadmin] at
com.ibm.ws.scripting.WasxShell$1.run(WasxShell.java:1106)

...

Target started: action-PM76033-fix-duplicate-portletinstances-wp.script

action-PM76033-fix-duplicate-portletinstances-wp.script:
[wsadmin] *sys-package-mgr*: processing new jar,
'/QIBM/ProdData/WebSphere/PortalServer/V8/Server/base/wp.script
/lib/wp.script.jar'
[wsadmin] *sys-package-mgr*: processing new jar,
'/QIBM/ProdData/WebSphere/PortalServer/V8/Server/base/wp.script
/shared/app/scripting/wp.link.jar'
[wsadmin] *sys-package-mgr*: processing new jar,
'/QIBM/ProdData/WebSphere/PortalServer/V8/Server/base/wp.script
/bin/scripting/wp.scrext.jar'
[wsadmin] *sys-package-mgr*: processing new jar,
'/QIBM/ProdData/WebSphere/PortalServer/V8/Server/base/wp.model.
api/shared/app/wp.model.api.jar'
[wsadmin] *sys-package-mgr*: processing new jar,
'/QIBM/ProdData/WebSphere/PortalServer/V8/Server/base/wp.user.a
pi/shared/app/wp.user.api.jar'
[wsadmin] *sys-package-mgr*: processing new jar,
'/QIBM/ProdData/WebSphere/PortalServer/V8/Server/base/wp.cmd.ba
se/shared/app/wp.cmd.base.jar'
[wsadmin] *sys-package-mgr*: processing new jar,
'/QIBM/ProdData/WebSphere/PortalServer/V8/Server/installer/wp.c
onfig/bin/wp.config.jar'
[wsadmin] *sys-package-mgr*: processing new jar,
'/QIBM/ProdData/WebSphere/PortalServer/V8/Server/pzn.ext/wp.wcm
.script/shared/app/wp.wcm.script.jar'
[wsadmin] WASX7023E: Error creating "SOAP" connection to host
"hostname.acme.com"; exception information:
com.ibm.websphere.management.exception.ConnectorNotAvailableException:
[SOAPException: faultCode=SOAP-ENV:Client; msg=Unable to find a valid
IP for host hostname.acme.com]
[wsadmin] WASX7213I: This scripting client is not connected to a
server process; please refer to the log file
/QIBM/UserData/WebSphere/AppServer/V8/ND/profiles/WCMAUTH/logs/
wsadmin.traceout for additional information.
[wsadmin] WASX8011W: AdminTask object is not available.
[wsadmin] length of parameters 3
[wsadmin] WASX7017E: Exception received while running file
"/QIBM/ProdData/WebSphere/PortalServer/V8/Server/base/wp.script/config/s
cripts/fix_duplicate_portlet_entities.py"; exception information:
com.ibm.bsf.BSFException: exception from Jython:
[wsadmin] Traceback (innermost last):
[wsadmin] File "", line 8, in ?
[wsadmin] EJPXD0015W: The scripting client could not connect to the
portal.
[wsadmin] at
com.ibm.wps.scripting.shell.UsageException.throwNew(UsageException.java:
98)
[wsadmin] at
com.ibm.wps.scripting.shell.UsageException.throwNew(UsageException.java:
77)
[wsadmin] at
com.ibm.wps.scripting.script.AbstractBean.getPSC(AbstractBean.java:220)
[wsadmin] at
com.ibm.wps.scripting.script.PortalHandling.loginUser(PortalHandling.jav
a:256)
[wsadmin] at
com.ibm.wps.scripting.script.PortalBean.login(PortalBean.java:218)
[wsadmin] at sun.reflect.NativeMethodAccessorImpl.invoke0(Native
Method)




CAUSE
This message seems to be a deeper symptom and not the root cause... 


[wsadmin] WASX7023E: Error creating "SOAP" connection to host
"hostname.acme.com"; exception information:
com.ibm.websphere.management.exception.ConnectorNotAvailableException:
[SOAPException: faultCode=SOAP-ENV:Client; msg=Unable to find a valid
IP for host hostname.acme.com] 

 

 

Closer review of the ConfigTrace.log output leads to the core problem that the SOAP_CONNECTOR_ADDRESS port defined in the Portal configuration in the serverindex.xml is 11278...

[wplc-get-host-port-in-server] Instance attributes (Set 1 of 1):
[wplc-get-host-port-in-server] endPointName="SOAP_CONNECTOR_ADDRESS"
[wplc-get-host-port-in-server] attribute=[ *** NONE_SPECIFIED *** ]
[wplc-get-host-port-in-server] end point: SOAP_CONNECTOR_ADDRESS found
[wplc-get-host-port-in-server] Settings the host: hostname.acme.com as
ant property: ${hostInJMX}
[wplc-get-host-port-in-server] Settings the port: 11278 as ant
property: ${portInJMX}
[wplc-get-host-port-in-server] Status = Complete
[echo] Determined soap host: hostname.acme.com
[echo] Determined soap connector: 11278

However, in this case the SOAP port in the wkplc.properties file is....

WPS_SOAP_PORT=10031


ENVIRONMENT
Portal 8.0.0.1 

IBM i


RESOLVING THE PROBLEM
In this case, the problem was resolved by editing the wkplc.properties file and changing the WPS_SOAP_PORT to 11278 and then re-running the CONFIG-WP-PTF-CF task.