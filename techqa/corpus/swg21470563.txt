Title: IBM Conflicting session identifiers lead to unexpected session timeout - United States

Text:
ErrorSessionTimeout; JSESSIONID; session timeout; quickr; lotus; connections; sso TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 If another application uses the same session identifier as WebSphere Portal, unexpected session timeouts may occur. 

SYMPTOM
A user authenticates to another WebSphere Application Server-based system (system1). He accesses WebSphere Portal expecting single sign-on functionality (authentication by the LTPA token issued from system1). Instead, he is redirected to WebSphere Portal's session timeout screen.


DIAGNOSING THE PROBLEM
Recreate the problem and capture the HTTP headers with a tool like Fiddler [http://www.fiddlertool.com/fiddler/]. Check the initial request to WebSphere Portal: 

GET /wps/myportal/... 

JSESSIONID=... 

LTPAToken=... 

LTPAToken2=... 

(where "..." represents some actual value) 

 

and the response: 

HTTP/1.1 302 Found ... 

Set-Cookie: JSESSIONID=...
Set-Cookie: LtpaToken2=""; Expires=Thu, 01 Dec 1994 16:00:00 GMT; ...
Set-Cookie: LtpaToken=""; Expires=Thu, 01 Dec 1994 16:00:00 GMT; ...
Set-Cookie: JSESSIONID=""; Expires=Thu, 01 Dec 1994 16:00:00 GMT; Path=/ ...
Location: http://portalserver.com/wps/portal/!ut/p/c5/04_SB8K8xLLM9MSSzPy8xBz9QNeiovyi4NTiYiA_JDM3Nb-0RL8gXVERAK5IVWc!/ [http://portalserver.com/wps/portal/!ut/p/c5/04_SB8K8xLLM9MSSzPy8xBz9QNeiovyi4NTiYiA_JDM3Nb-0RL8gXVERAK5IVWc!/] 

(Notice that this response expires the LtpaToken2, LtpaToken, and JSESSIONID cookies by setting the expires header value in the past.) 

 

Depending on the configuration, additional redirects may occur thereafter. 

 

Compare WebSphere Portal's session identifier to the other application's. Access the WebSphere Application Server Integrated Solutions Console > Application Servers > (WebSphere_Portal / YourApplication) > Session management > Enable cookies > Cookie name.


RESOLVING THE PROBLEM
Set the custom property HttpSessionIdReuse to true for WebSphere Portal's web container so that WebSphere Portal can use the JSESSIONID presented by the browser as its session identifier. 

WebSphere Application Server allows administrators to change the session identifier cookie's name. However, given the Java Servlet specification's (through 2.5) requirement for this to be JSESSIONID, IBM advises against changing WebSphere Portal's session identifier cookie name. WebSphere Portal does not support any session identifier other than JSESSIONID. 

 

Alternatively, depending on the use case, modifying the cookie path could resolve the problem in that setting it appropriately could prevent the client browser from presenting the other application's JSESSIONID to WebSphere Portal in the first place. Similarly, if the other application is running on a different server, modifying the cookie domain might also avoid this problem. 

 

Refer to the Internet Engineering Task Force (IETF) RFC 6265 for more information about cookies and their attributes.

RELATED INFORMATION
 Redirect behavior on session timeout [https://www.ibm.com/support/docview.wss?uid=swg21419230]
IETF RFC 6265 [http://tools.ietf.org/html/rfc6265]
Setting HttpSessionIdReuse [http://www.ibm.com/support/knowledgecenter/SSAW57_8.5.5/com.ibm.websphere.nd.doc/ae/rprs_custom_properties.html]
Java Servlet Specification [http://jcp.org/en/jsr/detail?id=154]