Title: IBM IV05536: MULTIPLE FFDC FILES GENERATED BY THE WMQ V7.0.1.5 JMS CLIENT (XA ENABLED), SOON AFTER A POISON MESSAGE IS BACKED OUT - United States

Text:
  FIXES ARE AVAILABLE
WebSphere MQ V7.0 Fix Pack 7.0.1.7 [http://www-01.ibm.com/support/docview.wss?uid=swg24030911]
WebSphere MQ V7.0.1 for i5/OS Fix Pack 7.0.1.7 [http://www-01.ibm.com/support/docview.wss?uid=swg24030912]
WebSphere MQ v7.0.1.7 Hypervisor for AIX [http://www-01.ibm.com/support/docview.wss?uid=swg24031715]
Fix Pack 7.1.0.2 for WebSphere MQ V7.1 [http://www-01.ibm.com/support/docview.wss?uid=swg24033287]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  The WebSphere MQ classes for JMS client generates many FFDC
   files after backing out a poison message to the Backout Queue.
   This is only observed if the session being used participates in
   a global (XA) transaction.
   
   An FDCs are generated with the following information:
   
   Source Class    :- com.ibm.msg.client.wmq.internal.WMQXASession
   Source Method   :- commit
   ProbeID         :- XN00I001
   .
   | FFST Location :-  java.lang.Exception
   ...
   at
   com.ibm.msg.client.commonservices.trace.Trace.ffst(Trace.java:1
   395)
   at
   com.ibm.msg.client.wmq.internal.WMQXASession.commit(WMQXASessio
   n.java:190)
   at
   com.ibm.msg.client.wmq.internal.WMQPoison.syncpoint(WMQPoison.j
   ava:735)
   at
   com.ibm.msg.client.wmq.internal.WMQPoison.handlePoisonMessage(W
   MQPoison.java:388)
   at
   com.ibm.msg.client.wmq.internal.WMQPoison.handlePoisonMessage(W
   MQPoison.java:293)
   at
   com.ibm.msg.client.wmq.internal.WMQConsumerShadow.getMsg(WMQCon
   sumerShadow.java:1313)
   at
   com.ibm.msg.client.wmq.internal.WMQSyncConsumerShadow.receiveIn
   ternal(WMQSyncConsumerShadow.java:233)
   at
   com.ibm.msg.client.wmq.internal.WMQConsumerShadow.receive(WMQCo
   nsumerShadow.java:1026)
   at
   com.ibm.msg.client.wmq.internal.WMQMessageConsumer.receive(WMQM
   essageConsumer.java:459)
   at
   com.ibm.msg.client.jms.internal.JmsMessageConsumerImpl.receiveI
   nboundMessage(JmsMessageConsumerImpl.java:780)
   at
   com.ibm.msg.client.jms.internal.JmsMessageConsumerImpl.receive(
   JmsMessageConsumerImpl.java:461)
   at
   com.ibm.mq.jms.MQMessageConsumer.receive(MQMessageConsumer.java
   :258)
   
   
   The WMQ JMS Client application calls
   'MQMessageConsumer.receive()' to receive a message and the
   WebSphere MQ classes for JMS internally calls commit() on the
   XASession, leading to the FFDCs being created - commit() must
   not be called on a XASession.
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  ****************************************************************
   USERS AFFECTED:
   This issue affects the users of WebSphere MQ classes for JMS
   v7.0 client applications that use the XASession class and
   attempt to receive a poison message from a destination on a
   WebSphere MQ V7 Queue Manager.
   
   Platforms affected:
   All Distributed (iSeries, all Unix and Windows) +Java
   ****************************************************************
   PROBLEM SUMMARY:
   A WebSphere MQ classes for JMS application that used an
   XASession class, made a call to:
   
   com.ibm.mq.jms.MQMessageConsumer.receive()
   
   in order to receive a message. The v7.0 WebSphere MQ classes for
   JMS internally detected that the message was poisonous (a term
   used to indicate that the message could not be processed and/or
   passed to the application by the receiving classes), and backed
   out the message to the 'Backout Requeue' queue.
   
   The classes then made a commit() method call on the session,
   which led to the FFDCs being created.  It is not legal to make
   a 'commit()' call on a XASession.
   
   
    
   
   

PROBLEM CONCLUSION
 *  A check has now been added in the v7.0 WebSphere MQ classes for
   JMS, so that if the session is actually an XASession, the call
   to Session.commit() is skipped, preventing the FFDC from being
   created.
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IV05536
   
   
 * REPORTED COMPONENT NAME
   WMQ AIX V7
   
   
 * REPORTED COMPONENT ID
   5724H7221
   
   
 * REPORTED RELEASE
   701
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2011-08-10
   
   
 * CLOSED DATE
   2011-10-17
   
   
 * LAST MODIFIED DATE
   2011-10-17
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WMQ AIX V7
   
   
 * FIXED COMPONENT ID
   5724H7221
   
   

APPLICABLE COMPONENT LEVELS
 * R701 PSY
   UP