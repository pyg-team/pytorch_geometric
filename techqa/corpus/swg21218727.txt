Title: IBM "ORA-01000: maximum open cursors exceeded" connecting to an Oracle database from WebSphere Application Server - United States

Text:
ORA-01000 Statement cache size TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Applications running in WebSphere Application Server may see the following error when connecting to an Oracle database:

ORA-01000: maximum open cursors exceeded 

CAUSE
The cause of the problem is that the maximum number of open cursors that are available in Oracle has been exceeded. In Oracle, the maximum number of open cursors is set per connection. The problem will occur if there are too many Statements and ResultSets open on a connection that was obtained from a WebSphere Application Server data source. This could occur if: 

 * The application fails to close Statement and ResultSet objects when it is finished using them 
 * The Statement cache size property for the data source is set to a value higher than the maximum number of open cursors in Oracle

RESOLVING THE PROBLEM
To resolve the problem, you should first review the application code to ensure that it is closing all JDBC Statement and ResultSet objects when it finishes using them. Secondly, you should compare the value of the Statement cache size for your data source to the maximum number of open cursors in Oracle. 

To check the Statement cache size: 

 * In the administrative console, navigate to Resources > JDBC > Data sources > data_source > WebSphere Application Server data source properties


Please note Statement cache size is per each connection. 
For example, if the Prepared Statement Cache Size is 10, each data source connection will use the cache number you configure. That means if you configure data source Max connection pool size 20, and cache size 10, then you will use 200 cursors. If you have 2 cluster members, than you need 2*200 = 400 cursors. If you set cache size as 300, and MAX connection pool size as 100, you have two cluster members, you need 2*300*100=60000 cursors. 

To check the maximum number of open cursors, open the init SID.ora file, where SID is the Oracle system identifier for the database. The file can be found in the <Oracle home>/admin/ SID/pfile directory. Look for the open_cursors setting. Set the open_cursors in Oracle to a value larger than the Statement cache size for the data source in WebSphere Application Server. Also set the following property in the initSID.ora file:
cursor_sharing = force

The purpose of the cursor is to keep track each connection so that if several programs are accessing the database at the same time, the database can keep track of who is trying to do what.. 

These actions will ensure that the number of cursors opened by your application running in WebSphere Application Server will not exceed the maximum number of open cursors in Oracle.

 


Cross reference information Segment Product Component Platform Version Edition Application Servers Runtimes for Java Technology Java SDK