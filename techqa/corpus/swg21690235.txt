Title: IBM CREATE NICKNAME FAILED WITH SQL3324N FOR REMOTE GREENPLUM TABLE - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 CREATE NICKNAME FAILED WITH SQL3324N FOR REMOTE GREENPLUM TABLE WHEN USING ODBC WRAPPER
SQL3324N Column "<name>" has a type of "<type>" which is not
recognized. 

SYMPTOM
 When we define the numberic column without precision in remote greenplum data source , create nickname will be failed with SQL3324N, while create nickname will work well if specify it with precision that db2 could support


CAUSE
 When registering nickname for ODBC data source , Federation Server will map remote numberic data type to decimal data type. According to greenplum documentation ,when we define the numberic column without precision for greenplum ,it means infinite ,while for DB2 , at the maximum precision specification, DECIMAL(32,s) data types can store s-1 decimal digits to the right of the decimal point, if it is an odd number

ENVIRONMENT
Remote database : greenplum


 Data source : ODBC


DIAGNOSING THE PROBLEM
Reproduce steps : 

CREATE WRAPPER ODBC
OPTIONS(MODULE'/xxx/xxxx/xxxxx/fsclient/odbc/64/lib/odbc.so') ;
create server ODBC_MSSQL type odbc version 5 wrapper ODBC options(node
'mssql2012csdl1', dbname 'mssql2012db1');
create user mapping for yileiw server ODBC_MSSQL options (REMOTE_AUTHID
'xxxx',REMOTE_PASSWORD 'xxxx');

db2 set passthru ODBC_MSSQL
db2 "create table t3(c1 numeric(38,0))"
>The remote data type of column c1 is numeric(38,0)
db2 set passthru reset

db2 create nickname nic2 for ODBC_MSSQL.J15USER1.t3
DB21034E The command was processed as an SQL statement because it was
not a
valid Command Line Processor command. During SQL processing it
returned:
SQL3324N Column "c1" has a type of "numeric" which is not recognized.


RESOLVING THE PROBLEM
Create a type mapping for remote numeric data type 


db2 "CREATE TYPE MAPPING numtodec2 FROM LOCAL TYPE SYSIBM.DECIMAL()
TO SERVER ODBC_MSSQL REMOTE TYPE SQL_NUMERIC(38,0)"

DB20000I The SQL command completed successfully.

db2 create nickname nic2 for ODBC_MSSQL.J15USER1.t3
DB20000I The SQL command completed successfully.

db2 describe table nic2

Data type Column
Column name schema Data type name Length
Scale N
------------------------------- --------- -------------------
---------- ----- -
C1 SYSIBM DECIMAL 8
0 Y
(NOTE: By default , if we are not specify the precision for local type SYSIBM.DECIMAL() , after creating nickname , the column length will be 8 digits , sometime may can't meet customer's data expectation , you may adjust it properly.
e.g SYSIBM.DECIMAL(18) )