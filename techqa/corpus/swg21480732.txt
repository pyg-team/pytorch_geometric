Title: IBM How to round row and column %-ages in crosstabs to remove decimals - United States

Text:
 TECHNOTE (FAQ)

QUESTION
 I'm using SPSS for Windows version 12 or later and am generating a series of Crosstabs with row and column percentages. I want to round the row and column percentages so that there aren't any decimal places showing. Is it possible to do that without having to edit the tables individually after they are created? 

ANSWER
This outlines how to make the change in the autoscript file to change the default value of decimal places for only those rows and or columns whose labels contain the string "% within" -- the row and column percentages, in other words. 

Right-click on an existing Crosstabs table, and choose "Create/Edit Autoscript" from the menu which pops up.

The "Autoscript.SBS" file opens, and you should see a script trigger such as this:
Sub Crosstabs_Table_Crosstabulation_Create(objTable As Object, objOutputDoc As Object, lngIndex As Long)
'Autoscript
'Trigger Event: Crosstabulation Table Creation after running Crosstabs procedure.

'Effects: .....

Dim bolSelection As Boolean

End Sub

(There may be additional lines between "Dim bolSelection As Boolean" and "End Sub". You will probably want to leave those lines alone.)

Insert a blank line immediately after "Dim bolSelection As Boolean", and add the following:

Call SelectRowLabelsAndData(objTable, cPCTWITHIN, bolSelection)
If bolSelection = True Then
objTable.NumericFormat("##.#%", 0) 
End If

Check that the first word in the parentheses after Sub ..._Table..._Create is objTable; if it is something else, such as objPivotTable, change the inserted statements to match.

The statement .NumericFormat("##.#%", 0) specifies 0 decimal digits. If some other number is preferred, change the 0 to some other number to reflect the preference.

The Crosstabs area of the autoscript contains several other pre-scripted features. Insert a ' (an apostrophe) in the first position of each line to comment out feature(s) you don't wish to be active.

Save the Autoscript file.

Click on the Edit->Options menu, Scripts tab. Ensure that Autoscripting is enabled, and that the subroutine you edited has a check mark in the box in front of its name.

Hereafter, all Crosstabs tables with Row and/or Column percentages will produce these percentages with the requested number of decimals.


Versions 16.0 and later no longer use autoscripting. Please see the scripting documentation in the Help subsystem for how to convert your exisiting autoscripts from earlier versions

RELATED INFORMATION
 Need more help? Our Statistics forum is Live! [https://developer.ibm.com/answers/topics/statistics.html?smartspace=predictive-analytics]


 

HISTORICAL NUMBER
 51575