Title: IBM How to resolve Health Check mpath issues? - United States

Text:
mpath healthcheck TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Resolving mpath issues present in healthcheck report. 

SYMPTOM
Health check contains entry similar to the following excerpt: 

Rule : SHC106
Issue Detected : Disk path was not optimal
Severity : Low
Components : spa1.spu1.disk[enclosure7.slot9] (from nzmpath) - SPU was not using preferred path to disk on 2015-12-03 08:31:26
spa1.spu1.disk[enclosure10.slot9] (from nzmpath) - SPU was not using preferred path to disk on 2015-12-03 08:31:26 


Expert's Advice :

Multipath allows SPU to access each disk using more than one path, so that when one path fails, the disk can still be used.
However, in some cases, the cost of using this additional (not preferred) path may be bigger, and therefore it may impact system performance.
Also, if some paths are not enabled (broken) then overall system fault tolerance is decreased, even if it does not impact its performance.

Report the issue to IBM Netezza Support.




DIAGNOSING THE PROBLEM
Run following command to confirm if there are any current mpath issues: 

nzpush -a mpath -issues


RESOLVING THE PROBLEM

There are two kinds of mpath issues. An issue is reported when preferred path is not set or when preferred count is set to one. 


If, PrefPath=No, then we can try the following workaround:

nzpush -a mpath dm -r
wait 2-3 mins
rerun nzpush -a mpath -issues

Otherwise if PrefCount=1, then we need an outage to carry out the following workaround:

nzhw -issues
if no issues
nzstop
spapwr.sh -off
spapwr.sh -on
nzstart