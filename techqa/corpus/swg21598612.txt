Title: IBM How to deploy a WebSphere Portal custom theme using configuration tasks - United States

Text:
webdav-deploy-zip-file; nullpointer; resolver; cor; themelist; fs-type1; page; builder; pagebuilder; theme TECHNOTE (FAQ)

QUESTION
 How do you deploy a custom theme utilizing configuration tasks in IBM WebSphere Portal? 

ANSWER
Overview 

The configuration task webdav-deploy-zip-file may be used to deploy a custom theme in IBM WebSphere Portal. The custom theme must be a theme which stores its data in the WebSphere Portal WebDAV file store. In most cases, custom themes based upon the IBM provided themes in Portal v7.0, v8.0 or v8.5 can be deployed utilizing this configuration task. Links to the Portal product documentation are available at the end of this document which provide more details on this configuration task. 

 

The configuration task is not required to deploy a custom theme. Traditional means of deploying custom themes may still be employed (such as working with the WebDAV file store directly). However, for system administrators who wish to further automate their Portal server deployment process across multiple environments, this configuration task may allow customized themes to be included as a part of the deployment automation, rather than as a separate and manual task to be performed after initial deployment. 

 

Deploying a custom theme via a configuration task 

To deploy the theme via the webdav-deploy-zip-file configuration task, perform the following steps: 

 

1) Collect all elements of your theme into a single zip file. For example, when you open the zip file, your zip file should contain the sub-folders such as "css", "images", "js", etc. at the top level, as well as files such as Plain.html, theme.html, etc.

[/support/docview.wss?uid=swg21598612&amp;aid=1] 

 

2) Upload your zip file to your Portal server to a temporary directory (e.g. /tmp) 

 

3a) If you are not utilizing Managed Pages and/or the Staging to Production procedure - use the following steps to execute the configuration task to deploy the theme. 

 

The syntax of the configuration task is: 

 

./ConfigEngine.sh webdav-deploy-zip-file 

-DTargetURI=dav:themelist/mytheme/ 

-DZipFilePath=/tmp/mytheme.zip 

-DUpdateMode=merge 

 

Where 

-DTargetURI corresponds to the name you wish to give your custom theme in the WebDAV file store 

-DZipFilePath corresponds to the name of the zip file in the temporary directory on the Portal server 

-DUpdateMode the option merge should be always used when deploying a custom theme 

 

3b) If you are utilizing Managed Pages and/or the Staging to Production procedure - use the following steps to execute the configuration task to deploy the theme on a SINGLE SYSTEM only. 

 

The syntax of the configuration task is: 

 

./ConfigEngine.sh webdav-deploy-zip-file 

-DTargetURI=dav:themelist/mytheme/ 

-DZipFilePath=/tmp/mytheme.zip 

-DUpdateMode=merge 

 

Where 

-DTargetURI corresponds to the name you wish to give your custom theme in the WebDAV file store.
-DZipFilePath corresponds to the name of the zip file in the temporary directory on the Portal server
-DUpdateMode the option merge should be always used when deploying a custom theme 

 

Use the following steps to execute the configuration task to deploy the theme on EVERY OTHER SYSTEM. The staging to production procedures to create an entry in the release database for this theme must be performed prior to this executing the following configuration task or it will fail. 

 

The syntax of the configuration task is: 

 

./ConfigEngine.sh webdav-deploy-zip-file 

-DTargetURI=dav:fs-type1/themes/mytheme/ 

-DZipFilePath=/tmp/mytheme.zip 

-DUpdateMode=merge 

 

Where 

-DTargetURI corresponds to the name you wish to give your custom theme in the WebDAV file store. -DZipFilePath corresponds to the name of the zip file in the temporary directory on the Portal server
-DUpdateMode the option merge should be always used when deploying a custom theme 

 

Avoiding Trouble 

- DO include a trailing slash (/) in the -DTargetURI parameter 

- DO NOT use the -DUpdateMode=replace option. 

- DO use the -DUpdateMode=merge option. 

 

By default, the configuration task will default to using the replace option. Per the Portal Infocenter: 

"When you execute this task, by default the referenced target folder is replaced by the extracted contents of the referenced archive or compressed file. This means that if there are files or folders contained in the referenced WebDAV folder, those files and folders are deleted before the new content is added. If you want to avoid this behavior and merge the contents, set the optional UpdateMode parameter to the value merge. If you do this, the task merges the contents of the archive or compressed file into the content that already exists at the target URI". 

 

Therefore, it is possible the default Portal themes included with WebSphere Portal could accidentally be deleted if the -DUpdateMode=replace option is used. If other parameters are set correctly, this behavior should not occur, but, there is a possibility it could occur if the -DUpdateMode=replace option is utilized. This may leave the Portal system in an inoperable state, as one or more of the IBM themes shipped with Portal would no longer be available, and any pages dependent on those default themes would no longer render correctly. To avoid this possibility from occurring, always use the -DUpdateMode=merge option as files and folders are never deleted with this option. 

 

- DO use the -DTargetURI=dav:themelist/mytheme/ option for the first system. 

- DO NOT use the -DTargetURI=dav:themelist/mytheme/ option for additional systems. Use -DTargetURI=dav:fs-type1/themes/mytheme/ instead.


The use of the WebDAV entry point dav:themelist will create a new entry in the release database for the theme with a new objectID. Running this configuration task with the themelist entry point on multiple system will cause the systems to go out of sync. This could lead to a number of functions breaking - most notable being managed pages will may not longer syndicate between two different systems. Ensure you only run this on a single environment, such as a DEV environment, then utilize staging to production procedures to copy the theme entry in the release database to subsequent systems - such as QA, PROD, DR, etc. environments.

RELATED INFORMATION
 Portal v7 Infocenter: webdav-deploy-zip-file configurat [http://www-10.lotus.com/ldd/portalwiki.nsf/dx/Task_webdavdeployzipfile_wp7]
Portal v8 Infocenter: webdav-deploy-zip-file configurat [http://www-10.lotus.com/ldd/portalwiki.nsf/dx/Task_webdavdeployzipfile_wp8]
Portal v8 Infocenter: webdav-deploy-zip-file [http://www-01.ibm.com/support/knowledgecenter/SSHRKX_8.5.0/mp/dev-theme/themeopt_move_devopaspect.dita]


 


Cross reference information Segment Product Component Platform Version Edition Organizational Productivity- Portals & Collaboration WebSphere Portal End of Support Products AIX, HP-UX, IBM i, Linux, Solaris, Windows, z/OS 7.0