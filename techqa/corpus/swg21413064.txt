Title: IBM How to configure CM z/OS under IBM HTTP Server V5.3 for IPv6 environment - United States

Text:
 TECHNOTE (FAQ)

QUESTION
 There is no documentation that describes how to configure the resource manager for Content Manager for z/OS® running under the IBM HTTP Server V5.3 (aka Domino Go Webserver) to work with an Apache server to support IPv6 

ANSWER
For customers that run Content Manager on z/OS resource manager under the IBM HTTP Server V5.3 (aka Domino Go Webserver), and are not yet ready to migrate fully to the IBM HTTP Server powered by Apache, then in order to have IPv6 support, the IBM HTTP Server (IHS) powered by Apache must be utilized as a proxy server. Customers who are ready to migrate fully to Apache, do not need to follow these instructions, as Apache supports IPv6 in a way that is transparent to the CM on z/OS resource manager. Note that the IBM HTTP Server V5.3 is only supported by z/OS up to z/OS V2R1; after that, customers must migrate to Apache. 

There are several tasks that need to be performed for this configuration. An IHS powered by Apache on z/OS will be configured to receive Content Manger resource manager requests in an IPv6 pipe. IHS powered by Apache will then forward the requests to the IBM HTTP Server (IHS) V5.3 on the same image via an internal IPv4 loop back pipe on a different port supported by both servers. 

The procedure below applies to IHS V7.0 and later. IHS is a component of WebSphere Application Server (WAS). Please consult Content Manager for z/OS software requirement for the supported WAS. 

 

1. Install IHS powered by Apache on z/OS 

Follow the IHS (IBM HTTP Server) 7.0 install instructions in the link provided (http://publib.boulder.ibm.com/infocenter/wasinfo/v7r0/index.jsp [http://publib.boulder.ibm.com/infocenter/wasinfo/v7r0/index.jsp]). And some additional steps below. It is not a requirement to use the same names for directory, proc, userid, etc., 

 * Create HFS(Hierarchical File System) and mountpoint /usr/lpp/zWebSphere_OM/V7R0 and mount HFS prior to doing the pax

 * Create directory /etc/Apache and then directories /etc/Apache/APWEBSRx (where x is A,B,C for each of the Apache servers to build)

 * Setup RACF group, userid, and Started class profile. The following are commands that might be issued to accomplish this task:

 * AG WWWGROUP OWNER(SYS1) SUPGROUP(SYS1) 
 * 
 * ALG WWWGROUP OMVS(GID(999)) 
 * 
 * 
 * 
 * AU WWWSERV DFLTGRP(WWWGROUP) OWNER(SYS1) - 
 *  NAME('APACHE SERVER ID') NOPASSWORD DATA('SYSTEM ID') - 
   OMVS(UID(999) HOME(/) MEMLIMIT(512M) PROGRAM('/bin/sh')) 
 * 
 * 
 * RDEF STARTED APWEBSR*.** STDATA(USER(WWWSERV)) 
 * 
 * SETR RACLIST(STARTED) REFRESH 

 * 

 * Change ownership of /etc/Apache/APWEBSRx to WWWSERV id (created above) and change group ownership to a group that could access files in that directory. Also change the PERM to 770 for these directories. 

 * Because the user running the installer program must have the same UID as the userid under which the server runs, change the UID to what is used for WWWSERV.

 * Execute the installer program pointing to the directory created above. Below is an example: 

 * 

 * where 1085 was the port that was assigned to this Apache server 

 * When executing bin/apachectl -v to verify installation, if there is an error that the version.signature file does not exist, then create a file in /usr/lpp/zWebSphere_OM/V7R0/HTTP/Server/ with its contents being the text "IBM HTTP Server 7.0.0.0" and then verify again.

 * Create APWEBSRA proc in a user or group proclib. 

 * Start the Apache server with the MVS command: S APWEBSRA

 * 

 * 

 * 
 * 
 * 
 * 


2. Configure Resource Manager for z/OS via IHS Server 
Once the IHS server is installed on z/OS, add the following content to http.conf: 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * <VirtualHost *:
 * 80
 * >
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * </VirtualHost>
 * 
 * 

 * 
 * 


3. Change IP/Hostname and port in sysadmin client to point to IHS server 
The library server must be configured to point to the IP address and port in which the Apache server is listening. The IP address and port that Apache is listening is specified in the “ServerName” statement of the Apache httpd.conf file. 

The changes to library server are affected as follows: the IP address or host name is stored in table ICMSTResourceMgr column InetAddr, and the port number is stored in table 
ICMSTRMAccessTypes column Port. You can use CM system admin client to access the Resource Manager Properties panel to make the changes in the Hostname field and the Port number in the Access types fields. 

4. Adding an additional RM on z/OS 

If we have two or more RM Servers, in order to support multi-proxies, we must enclose any proxy configuration with <VirtualHost>. 

Listen port2 

<IfModule mod_proxy.c> 
<VirtualHost *: port2 > 
ProxyRequests Off 
<Proxy *> 
Order deny,allow 
Allow from all 
</Proxy> 
ProxyPass /ICMResourceManager http//127.0.0.1:RM_listen_port3/ICMResourceManager 
</VirtualHost> 
</IfModule> 
The port2: gives the port that for Apache server to accept connections, you can choose any unused port on z/OS. The RM_listen_port3 is the port that the RM is listening on, in CM LS Configuration, specify Port2 as the RM port.