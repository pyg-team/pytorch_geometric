Title: IBM PK71831: MIGRATION DOESN'T CHECKOUT PUBLISHED ITEMS THAT HAVE DRAFTS - United States

Text:
  FIXES ARE AVAILABLE
6.0.1.7 Download: WebSphere Portal and Web Content Manager V6.0.1, fix pack 7 [http://www-01.ibm.com/support/docview.wss?uid=swg24025748]
6.0.1.5 Download: WebSphere Portal and Web Content Management V6.0.1 fix pack 5 [http://www-01.ibm.com/support/docview.wss?uid=swg24021241]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  The migration engine when importing draft documents does not
   mark the associated published items as checked out. The failure
   to check out the published item results in an end user being
   allowed to edit it which is not allowed and produces the
   following error when the published item is saved:
   
   [9/10/08 18:23:24:881 EDT] 00000068 VersionNode   E
   REPOS_EXCEPTION_CAUGHT_DURING_SAVE
   
   com.ibm.icm.jcr.access.AccessDeniedException: The requested
   operation violates one or more lock constraints.:
   [ErrorCode:7591]
           at com.ibm.icm.jcr.NodeImpl.save
           at com.ibm.icm.jcr.NodeImpl.save
           at
   com.ibm.icm.jcr.service.version.VersionServiceImpl.saveVersionab
   eNodeOrWorkspace
           at
   com.ibm.icm.jcr.service.version.VersionServiceImpl.checkin
           at com.ibm.icm.jcr.NodeImpl.checkin
           at
   com.ibm.workplace.wcm.services.transaction.steps.versioning.Vers
   onNode.versionNode
           at
   com.ibm.workplace.wcm.services.transaction.steps.versioning.Vers
   onNode.execute
           at
   com.ibm.workplace.wcm.services.transaction.CompositeTransactionS
   ep.execute
           at
   com.ibm.workplace.wcm.services.transaction.steps.repository.Repo
   itoryUpdate.execute
           at
   com.ibm.workplace.wcm.services.transaction.TxUnitOfWork$1.call
           at
   com.ibm.workplace.wcm.util.transaction.TransactionManager.doCall
   
           at
   com.ibm.workplace.wcm.util.transaction.TransactionManager.call
           at
   com.ibm.workplace.wcm.services.transaction.TxUnitOfWork.run
           at
   com.ibm.workplace.wcm.services.content.ContentServiceImpl.save
           at
   com.ibm.workplace.wcm.services.content.ContentServiceImpl.save
           at
   com.ibm.workplace.wcm.app.ui.portlet.command.CommandUtils.saveOb
   ect
           at
   com.ibm.workplace.wcm.app.ui.portlet.command.SaveObjectCommand.d
   Command
           at
   com.ibm.workplace.wcm.app.ui.portlet.command.SaveObjectCommand.d
   Command
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  Migration doesn't checkout published items that have drafts
   The migration engine when importing draft documents does not
   mark the associated published items as checked out. The failure
   to check out the published item results in an end user being
   allowed to edit it which is not allowed and produces the
   following error when the published item is saved:
   
   [9/10/08 18:23:24:881 EDT] 00000068 VersionNode   E
   REPOS_EXCEPTION_CAUGHT_DURING_SAVE
   
   com.ibm.icm.jcr.access.AccessDeniedException: The requested
   operation violates one or more lock constraints.:
   [ErrorCode:7591]
           at com.ibm.icm.jcr.NodeImpl.save
           at com.ibm.icm.jcr.NodeImpl.save
           at
   com.ibm.icm.jcr.service.version.VersionServiceImpl.saveVersionab
   leNodeOrWorkspace
           at
   com.ibm.icm.jcr.service.version.VersionServiceImpl.checkin
           at com.ibm.icm.jcr.NodeImpl.checkin
           at
   com.ibm.workplace.wcm.services.transaction.steps.versioning.Vers
   ionNode.versionNode
           at
   com.ibm.workplace.wcm.services.transaction.steps.versioning.Vers
   ionNode.execute
           at
   com.ibm.workplace.wcm.services.transaction.CompositeTransactionS
   tep.execute
           at
   com.ibm.workplace.wcm.services.transaction.steps.repository.Repo
   sitoryUpdate.execute
           at
   com.ibm.workplace.wcm.services.transaction.TxUnitOfWork$1.call
           at
   com.ibm.workplace.wcm.util.transaction.TransactionManager.doCall
           at
   com.ibm.workplace.wcm.util.transaction.TransactionManager.call
           at
   com.ibm.workplace.wcm.services.transaction.TxUnitOfWork.run
           at
   com.ibm.workplace.wcm.services.content.ContentServiceImpl.save
           at
   com.ibm.workplace.wcm.services.content.ContentServiceImpl.save
           at
   com.ibm.workplace.wcm.app.ui.portlet.command.CommandUtils.saveOb
   ject
           at
   com.ibm.workplace.wcm.app.ui.portlet.command.SaveObjectCommand.d
   oCommand
           at
   com.ibm.workplace.wcm.app.ui.portlet.command.SaveObjectCommand.d
   oCommand
   The migration engine was checking out the associated published
   doc when importing its draft copy but was incorrectly checking
   it back in once the draft was imported
   
   
    
   
   

PROBLEM CONCLUSION
 *  The migration engine was changed to remove the incorrect checkin
   command.
   
   A fix for this problem is available for WCM 6.0.1.3 from Fix
   Central at:
   
   http://www.ibm.com/eserver/support/fixes/fixcentral/swgquickorde
   r?brandid=2&productid=Workplace%20Web%20Content%20Management&fix [http://www.ibm.com/eserver/support/fixes/fixcentral/swgquickorder?brandid=2&productid=Workplace%20Web%20Content%20Management&fix]
   es=6.0.1.3-WCM-PK71831
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PK71831
   
   
 * REPORTED COMPONENT NAME
   WEBSPHERE PORTA
   
   
 * REPORTED COMPONENT ID
   5724E7600
   
   
 * REPORTED RELEASE
   60G
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2008-09-11
   
   
 * CLOSED DATE
   2008-10-17
   
   
 * LAST MODIFIED DATE
   2009-01-06
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WEBSPHERE PORTA
   
   
 * FIXED COMPONENT ID
   5724E7600
   
   

APPLICABLE COMPONENT LEVELS
 * R60G PSY
   UP