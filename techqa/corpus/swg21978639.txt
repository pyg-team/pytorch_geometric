Title: IBM Transitioning Call Home Support from email to HTTPS - PureData System for Analytics - United States

Text:
netezza; callhome; puredata; pda; nzopenpmr; nzcallhome; callhome; sendmail NEWS

ABSTRACT
 Support for the Call Home feature has transitioned from email (SMTP) to secure sockets via HTTPS. Starting February 1st, 2017, requests submitted via e-mail will no longer result in the generation of a PMR. This note discusses the differences in the tool versions, the NPS versions affected and options going forward. 

CONTENT
The Call Home feature on your PureData for Analytics appliance creates automated PMRs in the IBM ticketing system. Early versions of this feature sent these service requests via email. Since late 2014, we have enhanced this feature to utilize secure sockets (HTTPS) transport. In 2016, we announced that support for the Call Home feature would be transitioned from email (SMTP) to secure sockets via HTTPS. Starting February 1st, 2017, requests submitted via e-mail will not longer result in the generation of a PMR and there will not be a notification of such a failure. Please note that this change will not apply to IDAA clients. E-mails submitted by Call Home service for IDAA clients will continue to generate a PMR. 

The nzOpenPmr utility was available from NPS releases 6.0.8.15 P1, 7.0.0.14, 7.0.2.11, 7.0.4.3, 7.1.0.0 and later. With the release of NPS 7.2.0.0 in October 2014 the next generation of our callhome utility (nzcallhome) was first made available. As well as enhanced call management capabilities, this provided support for logging tickets over the encrypted secure sockets (HTTPS) interface.

Sending call home requests via HTTPS provides greater security for customers with end to end encryption, and greater reliability over a synchronous channel. The newer nzcallhome utility provides more intelligent handling of multiple requests, reducing or eliminating the logging of duplicate calls, allowing us to focus on your actual issues more efficiently. 

If your appliance is still relying on email transport for Call home, you need to disable the callhome feature on your PureData appliance or move to nzcallhome over HTTPS via a NPS upgrade to release 7.2.0.0 or above. The currently recommended NPS version is V7.2.1.1. IBM PureData support can be engaged for assistance in planning this upgrade and scheduling the downtime needed. 

If you have already upgraded to NPS 7.2.0.0 or better, please refer below for detailed instructions on migrating Call Home from email to HTTPS.

If an upgrade is not permissible at this time, and nzOpenPmr is in use, the option to disable it and return to manual PMR creation is available. Once disabled, PMRs can be opened at IBM.com. 

Note: Disabling Call Home has no effect on system availability or performance and does not require an outage. 

To disable nzOpenPmr, log in to the active host as nz user and run the following:
nzOpenPmr --off 

To disable nzcallhome, log in to the active host as nz user and run the following:
nzcallhome -disable 

To change nzcallhome to communicate over HTTPS from a current email configuration, log in to the active host as the nz user and run the following: 
nzcallhome -disableEmailOnly 

More information on nzcallhome functionality can be found in the database system administrator guide: 
https://www.ibm.com/support/knowledgecenter/SSULQD_7.2.0/com.ibm.nz.adm.doc/c_sysadm_about_callhome_service.html?lang=en [https://www.ibm.com/support/knowledgecenter/SSULQD_7.2.0/com.ibm.nz.adm.doc/c_sysadm_about_callhome_service.html?lang=en] 


IBM DB2 Analytics Accelerator (IDAA) systems are not affected by this change. Call Home PMRs created for IDAA systems via nzOpemPmr and nzcallhome over SMTP (Email Only) will continue to be supported. 

 

Enabling nzcallhome
The upgrade to NPS 7.2.0.0 or later does not automatically transition nzOpenPmr to nzcallhome. This migration can be completed using the steps in the following table when run as NZ user. There are no changes needed to the callHome.txt configuration file when making this transition.

Assuming the appliance and internal network are behind a firewall, port 443 (HTTPS) will need to be open for outbound traffic from the appliance to a set of addresses within IBM. These are documented in System Admin Guide and Knowledge Center [https://www.ibm.com/support/knowledgecenter/SSULQD_7.2.1/com.ibm.nz.adm.doc/c_sysadm_cfg_access_ibm_serv.html]. [https://www.ibm.com/support/knowledgecenter/SSULQD_7.2.1/com.ibm.nz.adm.doc/c_sysadm_cfg_access_ibm_serv.html]

The following steps you through reconfiguring CallHome from email to the new sockets based transport.

Before starting, it may help to view the call home log when issuing commands. To do so, open a second console session (as user NZ) and run the following command: 

'tail -f /nz/kit/log/nzCallHome/nzCallHome.0.log'.

The following steps will complete and validate the transition from email to sockets based Call Home.



nzcallhome -on this enables the new call home service nzcallhome -remove this will remove event entries pointing to nzOpenPmr nzcallhome -enablePmr this creates and enables the new events and enables the problem reporting service nzcallhome -status displays status to the call home log nzcallhome -validateConfig this option will check the contents of callHome.txt (there are no configuration changes required when moving Call Home from v1 to v2). this should result in the following message in the call home log: 
INFO: CallHome configuration is good. nzcallhome -verifyConnectivity

(only supported on NPS 7.2.1 or greater) this option will attempt communication across port 443 to the call home back-end and will post the results to the call home log and to the console. Assuming the firewall configuration has been done, the console and the log should contain the following text:
Connectivity Verification: Alias: Edge_Gateway_1, Host: esupport.ibm.com, IP: 129.42.56.189 : SUCCESS
note that the numeric IP address may vary based on geography nzcallhome -generatePmr hwSPU generates a test event which should generate a TEST PMR 
After the "generate", the log should display INFO: srid=xxxxxyyyzzz where xxxxx,yyy,zzz is the opened PMR number. Please note that there can be a delay of up to five minutes or more before you see this response, this is due to the time spent collecting diagnostic data. 

You should also get an email notification sent to you to indicate that the PMR was opened. If you do not see this message, you should see some sort of error in the logs, which may or may not be easily understandable. If Call Home v1 was working previously, there should be no changes required to the callHome.txt configuration file. 

If you require assistance with any issue that you have been unable to resolve through the documented process above you may open a PMR to request for assistance.