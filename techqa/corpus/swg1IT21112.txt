Title: IBM IT21112: CLUSTER SENDER CHANNELS FAIL TO RESTART FOLLOWING CPU FAILURE ON 2 CPU SYSTEM - United States

Text:
  A FIX IS AVAILABLE
WebSphere MQ for HP NonStop Server V5.3.1 fix pack 5.3.1.14 [http://www-01.ibm.com/support/docview.wss?uid=swg24044095]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  The issue ocurs only when the primary instances of the channel
   server and the execution controller are on the failing CPU.
   Root cause is a race condition during takeover between
   MQCHANSVR and MQECSVR, when no new backup process could be
   created. Usually this happens only during CPU down on a two CPU
   system
   
   
    
   
   

LOCAL FIX
 *  Once the second cpu is back up and the backup processes are back
   running, the issue situation, if present, could be resolved, by
   1. manually stopping the primary MQCHSVR using its CPU,PID
   2. manually stopping MCA, PID shown in channelstatus
    mqsc> display chs(CHANNEL) all
   Additionally, the problem could be avoided on 2 cpu systems, by
   placing primary MQCHSVR on the CPU running the backup MQECSVR.
   
   
    
   
   

PROBLEM SUMMARY
 *  The root cause is a race condition between failover procedures
   of the MQECSVR and the MQCHSVR, when both primaries fail
   simultaneously and no new backup processes could be created.
   This usually only happens on CPU down on two CPU systems.
   Due to the race condition the MQCHSVR uses the process-handle
   of the failed/lost primary MQECSVR during EC health check,
   resulting in initialization problems, and ending up with
   this reported issue.
   
   
    
   
   

PROBLEM CONCLUSION
 *  Added additional step to EC health check, retrieve current
   process-handle for known process name of MQECSVR using OS APIs,
   before performing health check operations requiring
   process-handle of MQECSVR.
   
   
    
   
   

TEMPORARY FIX
 *  Configure MQ pathway environment on two CPU systems, to start
   primary MQCHSVR on the CPU hosting the backup of MQECSVR.
   This avoids the problem at least for one CPU down.
   
   
    
   
   

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IT21112
   
   
 * REPORTED COMPONENT NAME
   WEBS MQ NSS ITA
   
   
 * REPORTED COMPONENT ID
   5724A3902
   
   
 * REPORTED RELEASE
   531
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt / Xsystem
   
   
 * SUBMITTED DATE
   2017-06-21
   
   
 * CLOSED DATE
   2017-06-28
   
   
 * LAST MODIFIED DATE
   2017-06-28
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WEBS MQ NSS ITA
   
   
 * FIXED COMPONENT ID
   5724A3902
   
   

APPLICABLE COMPONENT LEVELS
 * R531 PSY
   UP