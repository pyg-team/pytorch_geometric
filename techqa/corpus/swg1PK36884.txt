Title: IBM PK36884: MSG ON CLUSTER CMDQ READ MULTIPLE TIMES - United States

Text:
z/os  A FIX IS AVAILABLE
Obtain the fix for this APAR.


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  A MQCMD_CLUS_CHANNEL_FAIL msg on the cluster command queue can
   be read multiple times. This msg is written to the cmdq when the
   channel stops, and is used by the repos mgr to drive the logic
   to reallocate msgs to other qmgrs in the cluster, in
   rrmReallocMsgs. If the reallocate fails such the msg read from
   the cluster xmitq cannot be put to any queue in the cluster,
   e.g. because the queue no longer exists, or there is a 2189
   (MQRC_CLUSTER_RESOLUTION_ERROR), the msg is backed out to the
   cluster xmitq again. This backout also backs out the msg on the
   cluster cmdq, and so the msg is read again when the
   rrmProcessMsg finishes. The solution is to commit the msg read
   from the cmdq before reading any msgs from the xmitq.
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED: All Users of Websphere MQ for z/OS           *
   *                 Version 6 using Clustering                   *
   ****************************************************************
   * PROBLEM DESCRIPTION: Messages can remain on the              *
   *                      SYSTEM.CLUSTER.TRANSMIT.QUEUE and       *
   *                      retried constantly if there is no       *
   *                      longer a valid destination for them     *
   *                      and there is no dead-letter queue.      *
   *                      The reallocation is constantly being    *
   *                      redriven by a message on the            *
   *                      SYSTEM.CLUSTER.COMMAND.QUEUE.           *
   ****************************************************************
   * RECOMMENDATION: Apply this fix                               *
   ****************************************************************
   There is a problem when reallocating messages to other qmgrs in
   the cluster after a cluster channel has ended such that there
   is no possible destination in the cluster, or the destination
   cannot be resolved. If there is no dead-letter queue for the
   messages to be backed out to, they remain on the
   SYSTEM.CLUSTER.TRANSMIT.QUEUE but the command message is also
   backed out to the SYSTEM.CLUSTER.COMMAND.QUEUE, re-driving the
   reallocation process and causing the messages to be retried
   again and again.
   
   
    
   
   

PROBLEM CONCLUSION
 *  If the message on the command queue is MQCMD_CLUS_CHANNEL_FAIL
   then rrmProcessMsg commits it before invoking rrmReallocMsgs to
   read messages from the SYSTEM.CLUSTER.TRANSMIT.QUEUE. This
   prevents the reallocation process from being redriven forever.
   000Y
   CSQXRMRC
   CSQXRRMF
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PK36884
   
   
 * REPORTED COMPONENT NAME
   WMQ Z/OS V6
   
   
 * REPORTED COMPONENT ID
   5655L8200
   
   
 * REPORTED RELEASE
   000
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2007-01-05
   
   
 * CLOSED DATE
   2007-03-30
   
   
 * LAST MODIFIED DATE
   2007-04-18
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
    PK36900 [http://www-01.ibm.com/support/docview.wss?uid=swg1PK36900]
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
    UK23536
   
   

MODULES/MACROS
 *     CSQXRMRC CSQXRRMF
   
   
    
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WMQ Z/OS V6
   
   
 * FIXED COMPONENT ID
   5655L8200
   
   

APPLICABLE COMPONENT LEVELS
 * R000 PSY UK23536 [HTTPS://WWW14.SOFTWARE.IBM.COM/WEBAPP/SET2/ORDERMEDIA/SHOPCART?PTFS=UK23536]
   UP07/04/18 I 1000
   
   

FIX IS AVAILABLE
 * SELECT THE PTF APPROPRIATE FOR YOUR COMPONENT LEVEL. YOU WILL BE REQUIRED TO SIGN IN. DISTRIBUTION ON PHYSICAL MEDIA IS NOT AVAILABLE IN ALL COUNTRIES.