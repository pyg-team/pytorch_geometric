Title: IBM DB2 error SQLCODE: -911, SQLSTATE: 40001, SQLERRMC: 68 when administering Portal - United States

Text:
SQLCODE: -911; SQLSTATE: 40001; SQLERRMC: 68; -911; 911; 40001; 68 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 While performing an administrative task in WebSphere Portal (either with XMLAccess, thru the Portal Adminstration Pages, or a WPSconfig/ConfigEngine script), a DB2 exception with SQLCODE: -911, SQLSTATE: 40001, SQLERRMC: 68 appears. 

SYMPTOM
The exception will resemble the following (taken from an XMLAccess script): 

==============================
<request xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance [http://www.w3.org/2001/XMLSchema-instance]"
build="wp6011_072" type="update" version="6.0.1.1"
xsi:noNamespaceSchemaLocation="PortalConfig_6.0.1_1.xsd">
<status element="[content-node Content.Root.Document_Management
uniquename=ibm.portal.Document Management]" result="failed">
<message
id="EJPXA0043E">com.ibm.wps.command.xml.XmlCommandException:
EJPXA0043E: An error occurred while creating or updating the resource.
[content-node Content.Root.Document_Management
uniquename=ibm.portal.Document Management]</message>
<message id="EJPDB0072E">com.ibm.wps.util.DataBackendException:
EJPDB0072E: Error during cleanup cycle [cycle for component
instances].</message>
<message id="EJPDB0099E">com.ibm.wps.util.DataBackendException:
EJPDB0099E: Error occurred during database access. Last SQL statement
is [SELECT count(*) FROM release.COMP_INST WHERE (PORT_INST_OID = ?)].
Transaction has status [STATUS_ACTIVE], global ID
[00000129843e5e06000000010000014254385628752660952b178373e74d43676a7206
3100000129843e5e06000000010000014254385628752660952b178373e74d43676a7206
3100000001] and local ID [322].</message>
<message>com.ibm.db2.jcc.c.SqlException: DB2 SQL error:
SQLCODE: -911, SQLSTATE: 40001, SQLERRMC: 68</message>
</status>
</request>
==============================


CAUSE
The DB2 exception SQLCODE: -911, SQLSTATE: 40001, SQLERRMC: 68 means that the transaction has rolled back due to a lock timeout. 

This can happen if the Portal datasources have been configured to be 'unshared'. Portal requires that the datasources be 'shared' and it is unsupported to configure them otherwise. 

To check to see if your datasources are configured to be unshared, you can follow these steps:

1. Login to the WebSphere Application Server administration console
2. Navigate to Resources -> JDBC -> Data Sources
3. Click the link for the RELEASE datasource
4. Navigate to Connection Pool Properties -> Connection Pool Custom Properties
5. If the following properties are set, then your datasource is configured to be unshared:

globalConnectionTypeOverride value="unshared"
defaultConnectionTypeOverride value="unshared"


RESOLVING THE PROBLEM
To resolve the issue, remove the 'globalConnectionTypeOverride' and 'defaultConnectionTypeOverride' properties from the Connection Pool properties, restart the WebSphere_Portal server, and attempt your task again. 

 



Cross reference information Segment Product Component Platform Version Edition Organizational Productivity- Portals & Collaboration WebSphere Portal AIX, HP-UX, IBM i, Linux, Solaris, Windows, z/OS 7.0, 6.1