Title: IBM What does the 'Missing rich text object' error message mean? - United States

Text:
Missing rich text object; error; server log; log; agent; LotusScript programming TECHNOTE (TROUBLESHOOTING)

PROBLEM
In Lotus Notes/Lotus Domino, what does the "Missing rich text object" error message mean? What causes this error? Sometimes, this message appears in the server log for an agent execution.

CAUSE
This error occurs when LotusScript code passes the special value, "Nothing," to a function that requires a NotesRichTextItem as argument. If you retrieved the object using NotesDocument.GetFirstItem, this implies that the item does not exist in the document. 
Example:
Dim rti As NotesRichTextItem
Set rtiBody = doc.GetFirstItem("Body") ' <-- GetFirstItem returns Nothing
Call rtiOther.AppendRTItem(rtiBody) ' <-- Error occurs on this line


DIAGNOSING THE PROBLEM
You may have to go back to where the rich text item was supposed to be created. It is also possible that you are processing a document of a different form that doesn't contain the item in question. 



RESOLVING THE PROBLEM
 

To avoid the error, use an On Error statement to trap it or test your argument with an If statement before attempting to use the value:

Dim rti As NotesRichTextItem
Set rtiBody = doc.GetFirstItem("Body")
If Not (rtiBody Is Nothing) Then 

 * Call rtiOther.AppendRTItem(rtiBody)

Else
' Write code here to handle the case that the Body item did not exist.
' In many cases, you might just want to ignore the error and continue,
' since this would be the same as if the item were present, but blank.
End If 


 * 
 *