Title: IBM PM80577: WHEN RUNNING A PRE-V710 VERSION OF CSQBRRSI WITH V710 VERSION SCSQAUTH, AN MQRC 2002 CAN OCCUR EVEN AFTER MQDISC. - United States

Text:
z/os  A FIX IS AVAILABLE
Obtain the fix for this APAR.


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  The customer is running a batch job was running fine until
   they upgraded their early code and SCSQAUTH to V710. The batch
   job in question is issuing MQCONN, followed by some MQPUTs /
   PUT1 and then a MQDISC. It then attempts another MQCONN but
   unexpectedly fails with a 2002 MQRC_ALREADY_CONNECTED.
   .
   The change team looked at the code and can see the cause of
   the problem. The problem occurs when an application linked
   with a pre-V710 version of CSQBRRSI is run with a V710 version
   of the SCSQAUTH dataset (so that the application is using the
   V710 version of CSQBCON, CSQBDSC etc). The offset of the
   fRRSDisc flag in the BLOA has changed between V701 and V710,
   hence the MQRC 2002 may occur even though an MQDISC has been
   issued.
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED: All users of WebSphere MQ for z/OS Version 7 *
   *                 Release 1 Modification 0.                    *
   ****************************************************************
   * PROBLEM DESCRIPTION: An application linked using CSQBRRSI or *
   *                      CSQBRSTB at a release prior to 710      *
   *                      receives MQRC_ALREADY_CONNECTED         *
   *                      (MQRC2002) when using MQCONN to         *
   *                      reconnect to the queue manager, even    *
   *                      if MQDISC was previously issued.        *
   *                      If the application was linked at        *
   *                      701 with the fix for PM70746 [http://www-01.ibm.com/support/docview.wss?uid=swg1PM70746] applied,   *
   *                      and MQCONN is called to reconnect to    *
   *                      the queue manager, it receives          *
   *                      MQRC_ENVIRONMENT_ERROR (MQRC2012).      *
   ****************************************************************
   * RECOMMENDATION:                                              *
   ****************************************************************
   When an application linked with an RRS stub calls MQDISC to
   disconnect from the queue manager, a flag is set in the bloa to
   indicate this.
   An optimisation in the stubs uses this flag to check if the
   application has disconnected without the overhead of loading
   CSQBCON.
   Between 701 and 710 the offset of this flag within the BLOA was
   changed, causing this optimisation to incorrectly flag that
   the application is still connected when the application was
   compiled with 701 stub code, and connects to the queue manager
   using 710 adapter code.
   
   Additional Keywords: 2002 2012
   
   
    
   
   

PROBLEM CONCLUSION
 *  The adapter code is changed to set the flags required for the
   optimisation at the correct offsets for both the 701 and 710 RRS
   stubs.
   100Y
   CSQBCON
   CSQBDSC
   CSQBRRSI
   CSQBRSTB
   CSQBSRV
   CSQBTEXT
   CSQMEOTC
   CSQXACON
   CSQXDSC
   IMQS23DR
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PM80577
   
   
 * REPORTED COMPONENT NAME
   WMQ Z/OS V7
   
   
 * REPORTED COMPONENT ID
   5655R3600
   
   
 * REPORTED RELEASE
   100
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2013-01-14
   
   
 * CLOSED DATE
   2013-03-18
   
   
 * LAST MODIFIED DATE
   2013-05-06
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
    UK92602
   
   

MODULES/MACROS
 *  CSQBCON  CSQBDSC  CSQBRRSI CSQBRSTB CSQBSRV
   CSQBTEXT CSQMEOTC CSQXACON CSQXDSC  IMQS23DR
   
   
    
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WMQ Z/OS V7
   
   
 * FIXED COMPONENT ID
   5655R3600
   
   

APPLICABLE COMPONENT LEVELS
 * R100 PSY UK92602 [HTTPS://WWW14.SOFTWARE.IBM.COM/WEBAPP/SET2/ORDERMEDIA/SHOPCART?PTFS=UK92602]
   UP13/04/04 P F304
   
   

FIX IS AVAILABLE
 * SELECT THE PTF APPROPRIATE FOR YOUR COMPONENT LEVEL. YOU WILL BE REQUIRED TO SIGN IN. DISTRIBUTION ON PHYSICAL MEDIA IS NOT AVAILABLE IN ALL COUNTRIES.