Title: IBM How do you submit a Connect:Direct Windows process using the CLI in Power Shell. - United States

Text:
STERLINGHTG TECHNOTE (FAQ)

QUESTION
 How do you submit a Connect:Direct Windows process using the CLI in Power Shell. 

ANSWER
Following are some simple examples; you can use the concepts to build from.
Note: The Power Shell does not recognize the "<" character as a redirection of standard input.
The piping symbol "|" is used to pipe input to a program. 

The files used in the examples are:
pstest.cmd:
powershell 
get-content commands.txt | ./direct > test.log

commands.txt:
sub file=pstest.cdp &infile=c:\temp\install.txt &outfile=pstest.tst;

pstest.cdp:
/*BEGIN_REQUESTER_COMMENTS
$PNODE$="csd.desmond.4600" $PNODE_OS$
$SNODE$="CSD.DESMOND.4600" $SNODE_OS$
$OPTIONS$="WDOS"
END_REQUESTER_COMMENTS*/
PSTEST PROCESS
&infile=default
&outfile=default
SNODE=CSD.DESMOND.4600
STEP10 COPY
FROM (
FILE="&infile"
)
TO (
FILE="&outfile"
DISP=RPL
)
PEND

testps.ps1:
get-content commands.txt | ./direct > test.log

To run manually from the PowerShell PS prompt:
PS C:\Program Files\Sterling Commerce\Connect Direct v4.6.00\Common Utilities>
type:
get-content commands.txt | ./direct > test.log <enter> ==>This will pipe the contents of the commands.txt into direct
and put the results to the log file test.log

To utilize a batch file create a file, for example pstest.cmd or pstest.bat, create the file containing the following commands:
powershell -------------> invokes the Power Shell
get-content commands.txt | ./direct > test.log -------------> the command to invoke the direct command
with commands.txt as input and test.log as output

To utilize a Connect:Direct Run Task to kick off a Power Shell script us the following syntax in Optional Parameters and Command field:
pgm(C:\WINDOWS\system32\windows\powershell\v1.0\powershell) args(C:\WINDOWS\system32\windows\powershell\v1.0\examples\testps.ps1)

 

HISTORICAL NUMBER
 HTG2587