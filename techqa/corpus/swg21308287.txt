Title: IBM How does the JDBC management layer know which driver to use? - United States

Text:
 TECHNOTE (FAQ)

QUESTION
 How does the JDBC management layer know which driver to use? 

ANSWER
The internals of this Sun supplied class DriverManager are controlled by Sun. As with all classes, for a given class name such as java.sql.DriverManager, there is only one java.sql.DriverManager class loaded per Java™ Virtual Machine (JVM). Also, the static methods of java.sql.DriverManager (as with any other class) operate on the internal data structures of that class (not for each object that is an instance of that class). Therefore, the DriverManager attempts to select an appropriate driver from the set of registered JDBC drivers. 

The DriverManager.getConnection method takes a URL string as an argument. The JDBC management layer will attempt to locate a driver that can connect to the database represented by the URL. The JDBC management layer does this by asking each driver in turn if it can connect to the given URL. The driver examines the URL to see if it specifies a subprotocol that the driver supports, and if so, the driver then attempts to connect to the specified database. If the driver succeeds in establishing a connection, then it returns an appropriate java.sql.Connection object. 

Both drivers, (1) COM.ibm.db2.jdbc.app.DB2Driver, and (2) com.ibm.db2.jcc.DB2Driver, support the URL that is passed in as the first parameter of DriverManager.getConnection(url, properties) in the DB2® Information Integrator for Content code. 


This fact, combined with the fact that there is one DriverManager class per JVM, means that the static method DriverManager.getConnect(url, properties) uses the registered driver that is first returned from the DriverManager internal hash table (provided that the registered driver supports the URL). So, if some other code that previously ran in the JVM (such as another application) registered the driver com.ibm.db2.jcc.DB2Driver, then when the DB2 Information Integrator for Content code runs the previously listed code, it might be the driver com.ibm.db2.jcc.DB2Driver that is “chosen” by the DriverManager to connect to the library server database. 

However, DB2 Information Integrator for Content V8.3 does not support the driver com.ibm.db2.jcc.DB2Driver. That is, a connection can be made to the library server database with the driver com.ibm.db2.jcc.DB2Driver, but DB2 Information Integrator for Content V8.3 itself does not support doing anything with such a connection. The DB2 Information Integrator for Content V8.3 code itself does not prevent (and cannot prevent) the DriverManager from using the driver com.ibm.db2.jcc.DB2Driver (if this driver is registered with the DriverManager).