Title: IBM QRadar: Creating an Offense for Monitoring an Internal Log Source - United States

Text:
verify sim audit data; create rule for internal log sources; trigger offense sim audit TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 I would like to know how to create a rule for QRadar to generate offenses when my internal log sources stop sending events, such as SIM-Audit.



SYMPTOM
This rule is intended to fire offenses every 30 minutes when QRadar has not seen events from an internal log source for 1 hour. Internal log sources, especially SIM Audit are critical to QRadar as many administrators use SIM Audit data for reporting on QRadar user activity and meeting compliance requirements in corporate environments. 


ENVIRONMENT
All QRadar appliances. 

RESOLVING THE PROBLEM
What are internal log sources? 

There are several internal DSMs that ship by default with QRadar that are non-configurable as these DSMs are specific to parsing events generated by QRadar itself. As of QRadar 7.2.7 these internal log sources do not count against your EPS limit. Internal log sources that cannot be added as a "Log Source Type" in the interface as they are intentionally hidden from the log source configuration user interface. These log sources can be searched on from the Log Activity screen for administrators interested in tracking events generated by QRadar. 

Types of data collected by internal log sources: 

 * Anomaly detection engine events 
 * Asset Profile events 
 * Health Metric events 
 * Search Result events 
 * System Notification 
 * SIM Generic events (General bucket for unparsed 'Unknown' events) 
 * SIM Audit - events of activity that took place in QRadar by users. SIM Audit events are written to disk in /var/log/audit.



How to view internal log sources 
Internal log sources are by default added to the log source group 'Other'. On new QRadar installations, these log sources will be the only items listed in the 'Other' category. In the Log Activity tab, if you use Add Filter > Log Sources [Indexed] > Other, you can see all DSMs and filter against internal DSMs, as all events display in the Log Activity screen. 

When you install a fresh QRadar installation, there are no log sources listed, however, can see events from other processes communicating in the deployment. For example, Health Metrics, Asset Profiler, QRadar Risk Manager has a DSM, if it is activated in QRadar. Our internal DSMs on a default appliance usually have a -2 at the end. There is also a Custom Rule Engine DSM and a SIM Generic DSM, however, these only create events based on rule responses or when unknown events are forwarded to QRadar, which are user actions. You can think of internal DSMs as QRadar processes communicating and creating messages for the deployment of things we want to keep track of, like system notifications and health metrics. 

[/support/docview.wss?uid=swg21993556&aid=1] [/support/docview.wss?uid=swg21993556&aid=1] 
Figure 1: Example of several QRadar Internal DSMs  

 

How to create a rule in QRadar that monitors SIM-Audit events 

 1.  Log in to QRadar. 
 2.  Click the Offenses tab. 
 3.  Click the Rules icon. 
 4.  Click Actions > New Event Rule. 
 5.  Double-click to add the rule test: when the events(s) have not been detected by one or more of these log source types for this many seconds.
     [/support/docview.wss?uid=swg21993556&aid=2] [/support/docview.wss?uid=swg21993556&aid=2]
     Figure 2: Use the rule test 'these log source types' to keep the rule test host independent. 
 6.  Type a name for the rule, such as QRadar SIM Audit Events Stopped. 
 7.  From the rule editor, click these log sources types and select SIM Audit. 
     [/support/docview.wss?uid=swg21993556&aid=3] [/support/docview.wss?uid=swg21993556&aid=3]
     Figure 3: Select SIM Audit as the log source type. 
 8.  Click Submit. 
 9.  From the Rule Response Wizard, configure the following values:
     [/support/docview.wss?uid=swg21993556&aid=4] [/support/docview.wss?uid=swg21993556&aid=4]
     Figure 4: Configure your rule similar to the screen capture and ensure the rule indexes the offense by Log Source. 
 10. Click Next. 
 11. Review the rule summary.
     [/support/docview.wss?uid=swg21993556&aid=5] [/support/docview.wss?uid=swg21993556&aid=5]
     Figure 5: Review the log source summary. 
 12. Click Finish.
     
     Results
     The rule is created to monitor for SIM Audit events that do not send data for 1 hour. If an administrator receives this offense, they should run a search sorted by SIM Audit to verify when the log source stopped sending. A search can be run to verify that SIM Audit data is being generated. If for any reason your SIM Audit log source has stopped producing data, you should contact QRadar Support [http://ibm.biz/qradarsupport] (http://ibm.biz/qradarsupport [http://ibm.biz/qradarsupport]).






To find more information? 


[/support/docview.wss?uid=swg21993556&aid=6] [http://ibm.biz/QRadar-KC] [/support/docview.wss?uid=swg21993556&aid=7] [https://ibm.biz/qradarforums] [/support/docview.wss?uid=swg21993556&aid=8] [http://ibm.biz/qradarknowledge] [/support/docview.wss?uid=swg21993556&aid=9] [http://ibm.biz/SecSuptUTube] [/support/docview.wss?uid=swg21993556&aid=10] [http://ibm.biz/qradarsoftware] [/support/docview.wss?uid=swg21993556&aid=11] [http://ibm.biz/MyNotification] [/support/docview.wss?uid=swg21993556&aid=12] [http://ibm.biz/SuptRegQuikStart]