Title: IBM Duplicated named snapshots created from multiple Process Centers can lead to a deployment failure with BPMInstallOfflinePackage command for IBM Business Process Manager (BPM) - United States

Text:
Multiple Process Center; Duplicate Acronym; Offline Deployment TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 You use the BPMInstallOfflinePackage command to deploy snapshots with the same name, but from by multiple Process Centers, to a single Process Server. These duplicate names can lead to deployment failure on the Process Server. 

SYMPTOM
For example, you might have three snapshots in Process Center with the following name and acronym that is deployed on Process Server: 

MYAPPS v1.1.0 MYAPP_1 
MYAPPS v1.1.1 MYAPP_2 
MYAPPS v1.1.2 MYAPP_3 

You then complete the following steps: 

 1. Set up a new Process Center or clean the old Process Center by restoring the database. 
    
    
 2. Import the latest snapshot of "MYAPPS v1.1.2."
    
    
 3. Develop more services and create a new snapshot called MYAPPS v1.1.3, which uses the same naming convention.
    
    
 4. Create a package for offline deployment. The generated acronym is MYAPP_1, which leads to a deployment failure on Process Server because of the duplicate acronym. For example: 
    
    MYAPPS v1.1.3 MYAPP_1 
    
    


You see SqlIntegrityConstraintViolationException messages like the following text: 
WASX7015E: Exception running command: "$AdminTask
BPMInstallOfflinePackage {-inputFile /tmp/APSAP_1.zip}"; exception 
information: 
java.lang.Exception: java.lang.Exception: 
com.lombardisoftware.client.delegate.BusinessDelegateException:
PreparedStatementCallback; SQL [update LSW_SNAPSHOT set CREATED_ON = 
?,NAME = ?,ACRONYM = ?,DESCRIPTION = ?,SEQ_NUM = ?,ERROR_COUNTER = 
?,ORIG_CREATED_ON = ?,ACTIVATED_ON = ?,STATUS = ?,ARCHIVED_ON =
?,LAST_MODIFIED = ?,REPOSITORY_BRANCH_ID = ?,CREATED_BY_USER_ID =
?,BRANCH_ID = ?,PROJECT_ID = ?,LAST_MODIFIED_BY_USER_ID = ?,CHANGE_DATA
= ?,IS_ACTIVE = ?,IS_BLA_ACTIVE = ?,IS_STARTED = ?,IS_INSTALLED =
?,IS_BLA_INSTALLED = ?,IS_TIP_DEPLOYED = ?,IS_DEFAULT =
?,TIP_DEPLOYMENT_IN_PROGRESS = ?,IS_ARCHIVED = ? where SNAPSHOT_ID = ?]; 
Error for batch element #1: DB2 SQL Error: SQLCODE=-803, SQLSTATE=23505, 
SQLERRMC=2;BPMBDBA.LSW_SNAPSHOT, DRIVER=4.11.69; nested exception is 
com.ibm.db2.jcc.am.SqlIntegrityConstraintViolationException: Error for 
batch element #1: DB2 SQL Error: SQLCODE=-803, SQLSTATE=23505, 
SQLERRMC=2;BPMBDBA.LSW_SNAPSHOT, DRIVER=4.11.69 
CAUSE
After you recreate the Process Center, it becomes out of synch with its Process Server and the counter that is associated with acronym starts back at 1. The new snapshot starts with 1, for example MYAPP_1, as expected. Process Center is not aware of the all the acronyms for the snapshots that are installed on Process Server so it cannot automatically adjust the counter that is associated with the acronym.


DIAGNOSING THE PROBLEM
This scenario applies to both Process Application and Toolkit snapshots. The snapshot acronyms are appended with a number if they are not unique. However, it is best to avoid this situation. 


The snapshot acronym is equal to the first 4-7 capital letters, numbers and special characters. You should put the version numbers first so that the acronyms can be unique and match with the snapshot name.

Using a large number of duplicate acronyms for your snapshots, which include automatically generated numbers appended to them, makes it much harder to keep them unique across multiple Process Center environments. Any automatically generated numbers only take the current environment into account.


RESOLVING THE PROBLEM
You can use one of the following two options to resolve this issue: 

 * Use a new naming convention.
   For any snapshots that currently have non-unique acronyms, you need to create a new snapshot and ensure it has an acronym that is unique across your environments. Then, you need to update the snapshots to use the correct toolkits.
   
   
 * Clean up the Process Server by deleting the snapshots using the BPMDeleteSnapshot command. For more information on this command, see the BPMDeleteSnapshot command [http://pic.dhe.ibm.com/infocenter/dmndhelp/v8r0m1/index.jsp?topic=/com.ibm.wbpm.ref.doc/topics/rref_deletesnapshot.html] topic in the information center.



After the snapshots are deleted or removed from the Process Server, you can use any naming convention. 

You must be aware of this synchronization problem when you create new Process Centers and use an old Process Server. RELATED INFORMATION
#A simplified Chinese translation is available [http://www.ibm.com/support/docview.wss?uid=swg21659582]


 


Cross reference information Segment Product Component Platform Version Edition Business Integration IBM Business Process Manager Express Application Deployment Linux, Windows 8.5, 8.0.1, 8.0, 7.5.1 Business Integration IBM Business Process Manager Standard Application Deployment AIX, Linux, Windows 8.5, 8.0.1, 8.0, 7.5.1 
PRODUCT ALIAS/SYNONYM
 BPM