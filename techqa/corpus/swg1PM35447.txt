Title: IBM PM35447: DOCUMENT RESTRICTION OF 1 UNCOORDINATED ODBC DATABASE CONNECTION ON Z/OS - United States

Text:
z/os SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS DOCUMENTATION ERROR.
    
   
   

ERROR DESCRIPTION
 *  Occasionally, the following SQL exception will be raised on WMB
   6.1 on zOS
   
   <values>{DB2 FOR OS/390}{ODBC DRIVER}{DSN09015}
   DSNT408I SQLCODE = -981, ERROR: THE SQL STATEMENT FAILED BECAUSE
   THE RRSAF CONNECTION IS NOT IN A STATE THAT ALLOWS SQL
   OPERATIONS, REASON 00C12219
   
   Currently, WebSphere Message Broker 6.1 allows only one (1)
   uncoordinated transaction per thread and this needs to be
   documented for future reference.
   
   Perhaps this restriction will be removed in the future, but will
   not occur duing a service cycle, but rather through a release
   cycle.
   
   
    
   
   

LOCAL FIX
 *  Do not configure for multiple uncoordinted
   transactions in a single flow.
   
   
    
   
   

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED: All users of WebSphere Message Broker on     *
   *                 z/OS using uncoordinated ODBC database       *
   *                 access outside of the message flow           *
   *                 transaction.                                 *
   ****************************************************************
   * PROBLEM DESCRIPTION: Only 1 uncoordinated ODBC database      *
   *                      connection is supported per thread on   *
   *                      z/OS. The Information Center does not   *
   *                      document this restriction.              *
   ****************************************************************
   * RECOMMENDATION:                                              *
   ****************************************************************
   WebSphere Message Broker Information Center has been updated
   to document the restriction that only 1 uncoordinated ODBC
   database connection is supported on z/OS.
   
   The following topics have been updated:
   
   Topic ah10030_ - Supported databases
   Under
    Note 1 - XA Support
   add a new additional condition:
    * Additional conditions for z/OS
     On z/OS all transactions are globally coordinated using RRS.
     As with other platforms you can choose for ODBC database
     operations to be committed or rolled back irrespective of
     the success or failure of the message flow transaction as a
     whole. However only 1 uncoordinated ODBC database
     connection per thread is supported.
   
   Topic au16620_ - Resolving problems when using databases
   Add a new entry:
   Title:
    SQLCODE -981 is issued when you access DB2 on z/OS
   Scenario:
    You are running a message flow which uses ODBC database
    interaction and whilst trying to issue a commit or rollback
    DB2 reports an  error with SQLCODE=-981 and SQLSTATE=57015.
    An error message is seen similar to:
    {DB2 FOR OS/390}{ODBC DRIVER}{DSN09015} DSNT408I SQLCODE =
    -981, ERROR: THE SQL STATEMENT FAILED BECAUSE THE RRSAF
    CONNECTION IS NOT  IN A STATE THAT ALLOWS SQL OPERATIONS,
    REASON 00C12219
   Explanation:
    You can choose for ODBC database operations to be committed
    or rolled back irrespective of the success or failure of the
    message flow transaction as a whole. This error can be seen
    if you attempt to use more than one uncoordinated ODBC
    database connection on a  single message flow thread.
   Solution:
    Only 1 uncoordinated ODBC database connection per thread is
    supported. You will need to update your message flow to only
    perform ODBC database operations outside of the message flow
    transaction to one database. Any number of different
    databases are supported as part of a coordinated message flow
    transaction.
   
   
    
   
   

PROBLEM CONCLUSION

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PM35447
   
   
 * REPORTED COMPONENT NAME
   WMB Z/OS V6
   
   
 * REPORTED COMPONENT ID
   5655M7400
   
   
 * REPORTED RELEASE
   100
   
   
 * STATUS
   CLOSED DOC
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2011-03-23
   
   
 * CLOSED DATE
   2011-05-31
   
   
 * LAST MODIFIED DATE
   2011-05-31
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION

APPLICABLE COMPONENT LEVELS