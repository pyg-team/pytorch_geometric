Title: IBM DS3K/DS4K/DS5K controller failover leads to slow I/O or application hangs on AIX   ZDOC - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 DS3K/DS4K/DS5K controller failover leads to slow I/O or application hangs on AIX ZDOC 

SYMPTOM
I/O or applications hangs or very slow I/O during controller failover on DS3K/4K/5K


CAUSE
Disk tunable values improperly set

DIAGNOSING THE PROBLEM
Normal/default AIX tunable values for DS3K/DS4K/DS5K do not provide optimum/efficient controller failover in an AIX MPIO configuration. 

The normal default values for the following tunables are:
cntl_delay_time 90
cntl_hcheck_int 10


RESOLVING THE PROBLEM
The optimum tunables for controller failover for AIX MPIO configurations are: 

cntl_delay_time=30
cntl_hcheck_int=2

LEAVING THESE TUNABLES AT DEFAULT VALUES ON AN AIX HOST OR VIO SERVER CAN LEAD TO I/O HANGS, APPLICATIONS HANGS, ETC. WHENEVER THERE IS A CONTROLLER FAILOVER ON THE STORAGE ARRAY. (including those times where there is a complete controller failure)

Also remember to follow MPIO Best practices as they relate to hcheck_interval and rw_timeout value.
https://www.ibm.com/developerworks/aix/library/au-aix-mpio/ [https://www.ibm.com/developerworks/aix/library/au-aix-mpio/]
(where hcheck_interval should be > rw_timeout value)