Title: IBM ANR1791W HBAAPI wrapper library hbaapi.dll failed to load or is missing. - United States

Text:
tsm hba TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Following errors are logged in the activity log:
ANR1791W HBAAPI wrapper library hbaapi.dll failed to load or is missing.
ANR8965W The server is unable to automatically determine the serial number for the device. 

CAUSE
HBAAPI.DLL is missing or corrupted.

ENVIRONMENT
Tivoli Storage Manager server / Storage Agent running on Windows Platform.

RESOLVING THE PROBLEM
The hbaapi.dll file should be located in the following locations: 

 * Tivoli Storage Manager server on 32-Bit Windows
   In the Tivoli Storage Manager server installation directory where the dsmserv.exe executable is located. This file can be extracted from the package CD or package download. 
 * Tivoli Storage Manager Server on 64-Bit Windows
   In \Windows\System32 
 * Storage Agent (32-Bit) on 32-Bit Windows
   In the Tivoli Storage Manager Storage Agent installation directory where the Storage Agent executable is located. 
 * Storage Agent (32-Bit) on 64-Bit Windows:
   In \Windows\SysWOW64 

NOTE: On 32-Bit Windows, The Tivoli Storage Manager server and Storage Agent provide and use its own HBAAPI.DLL. On 64-Bit Windows, the Operating System provides the HBAAPI.DLL. Both the Tivoli Storage Manager server and Storage Agent should use the one provided by the Operating System.