Title: IBM IC72043: Db2look dependency on locale settings might introduce wrong values on mimic information - United States

Text:
z/os SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  Given the following table:
   
   CREATE TABLE "TEST"."TAB1"  (
                     "FIELDTYPE" CHAR(1) FOR BIT DATA )
   
   
   db2 " select hex(HIGH2KEY) from sysstat.columns  WHERE COLNAME =
   'FIELDTYPE' AND TABNAME = 'TAB1' AND TABSCHEMA = 'TEST' "
   27E827
   
   The db2look output of
   
   db2look -d tlook -m -l -a -e -z TEST -t TAB1 -o tlook.out
   
   Depending on the locale settings, can show in the mimic
   information:
   
   
   UPDATE SYSSTAT.COLUMNS
   SET COLCARD=36,
       NUMNULLS=0,
       SUB_COUNT=-1,
       SUB_DELIM_LENGTH=-1,
       AVGCOLLENCHAR=-1,
       HIGH2KEY=X'1A',  <<< This is incorrect and we are
   introducing incorrect values if we replay this ddl
       LOW2KEY=X'14',
       AVGCOLLEN=2
   WHERE COLNAME = 'FIELDTYPE' AND TABNAME = 'TAB1' AND TABSCHEMA =
   'TEST';
   
   or
   
   UPDATE SYSSTAT.COLUMNS
   SET COLCARD=36,
       NUMNULLS=0,
       SUB_COUNT=-1,
       SUB_DELIM_LENGTH=-1,
       AVGCOLLENCHAR=-1,
       HIGH2KEY='',  In here we have the character representation
   of 0xE28 which is a e with a tilde <<< this is incorrect and if
   we replay this ddl it will actually fail
       LOW2KEY=X'14',
       AVGCOLLEN=2
   WHERE COLNAME = 'FIELDTYPE' AND TABNAME = 'TAB1' AND TABSCHEMA =
   'TEST';
   
   Depending on the locale settings
   
   
   The correct value should be:
   
   UPDATE SYSSTAT.COLUMNS
   SET COLCARD=36,
       NUMNULLS=0,
       SUB_COUNT=-1,
       SUB_DELIM_LENGTH=-1,
       AVGCOLLENCHAR=-1,
       HIGH2KEY=X'E8',
       LOW2KEY=X'14',
       AVGCOLLEN=2
   WHERE COLNAME = 'FIELDTYPE' AND TABNAME = 'TAB1' AND TABSCHEMA =
   'TEST '
   
   
    
   
   

LOCAL FIX
 *  Check settings of LC_CTYPE as db2look is using isalnum calls.
   
   
    
   
   

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED:                                              *
   * ALL                                                          *
   ****************************************************************
   * PROBLEM DESCRIPTION:                                         *
   * The fix will review the use of isalnum calls by db2look      *
   * code, as                                                     *
   * these calls are locale dependent (on LC_CTYPE).              *
   ****************************************************************
   * RECOMMENDATION:                                              *
   * Upgrade to DB2 Version 9.1 and Fix Pack 10                   *
   ****************************************************************
   
   
    
   
   

PROBLEM CONCLUSION
 *  Problem was first fixed in DB2 Version 9.1 and Fix Pack 10
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IC72043
   
   
 * REPORTED COMPONENT NAME
   DB2 FOR LUW
   
   
 * REPORTED COMPONENT ID
   DB2FORLUW
   
   
 * REPORTED RELEASE
   910
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2010-10-20
   
   
 * CLOSED DATE
   2011-06-10
   
   
 * LAST MODIFIED DATE
   2011-06-10
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
    IC71820 [http://www-01.ibm.com/support/docview.wss?uid=swg1IC71820]
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   DB2 FOR LUW
   
   
 * FIXED COMPONENT ID
   DB2FORLUW
   
   

APPLICABLE COMPONENT LEVELS
 * R910 PSY
   UP