Title: IBM IT17608: IMPROPER SHUTDOWN OF IBM SPECTRUM CONTROL CAN RESULT IN DUPLICATE IDS BEING CREATED IN THE DATABASE - United States

Text:
AIX  FIXES ARE AVAILABLE
IBM Spectrum Control V5.2.13 (March 2017) [http://www-01.ibm.com/support/docview.wss?uid=swg24043142]
IBM Spectrum Control V5.2.14 (May 2017) [http://www-01.ibm.com/support/docview.wss?uid=swg24043414]
IBM Spectrum Control V5.2.15 (August 2017) [http://www-01.ibm.com/support/docview.wss?uid=swg24043749]
IBM Spectrum Control V5.2.15.2 (November 2017) [http://www-01.ibm.com/support/docview.wss?uid=swg24044286]
IBM Spectrum Control V5.2.16 (March 2018) [http://www-01.ibm.com/support/docview.wss?uid=swg24044454]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  In cases where the IBM Spectrum Control device server process
   does not shut down cleanly, duplicate IDs can be created in the
   database resulting in failures to run jobs (probes, performance
   monitors, etc).
   The following example shows a probe job that fails to start
   (from the failing probe's job log):
   2016-MM-DD HH:MM:SS.xxx HWN021709I Collection for storage system
   Storwize <storage_device_name> completed.
   2016-MM-DD HH:MM:SS.xxx BTADS0102E The discover process that has
   the Device server run ID 393038 and job ID 870076 completed with
   one or more errors. The process status is 4 and the return code
   is 8 .
   The device server trace log shows the following being logged
   behind the above generic failure message:
   2016-MM-DD HH:MM:SS.xxx-xxxx Subsystem = <storage_device_wwpn>
   com.ibm.tpc.monitor.NAPIEventQueue notifyProbeFinished()
   NAPIPostProcess-10.123.48.187_<storage_device_name>
   2016-MM-DD HH:MM:SS.xxx-xxxx Batching is on.
   com.ibm.saas.agent.Dispatch run Dispatch
   2016-MM-DD HH:MM:SS.xxx-xxxx
   com.ibm.db2.jcc.am.SqlIntegrityConstraintViolationException: DB2
   SQL
   Error: SQLCODE=-803, SQLSTATE=23505,
   SQLERRMC=1;TPC.T_RES_SNAPSHOT_METADATA, DRIVER=3.65.77
   The referenced SQLCODE=-803 and SQLSTATE=23505 messages indicate
   a column unique value constraint violation in the database and
   this is caused by invalid/duplicate ID values that IBM Spectrum
   Control is trying to use.
   RECREATE STEPS:
   Device Server gets shut down but the shut down does not complete
   cleanly/as expected
   ________________________________________________________________
   DB2 Version used for Server:    N/A (any supported DB2 version)
   The defect is against component:   5608TPC00 (device server
   process)
   Server/Manager build/release (TPC):   5.2.11
   
   ________________________________________________________________
   Problem as described by customer:   scheduled and manual probes
   fail to run
   Initial customer impact (low/med/high): med
   Apply fixing level when available; contact support
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED:                                              *
   * IBM Spectrum Control 5.2.x users.                            *
   ****************************************************************
   * PROBLEM DESCRIPTION:                                         *
   * In cases where the IBM Spectrum Control device server        *
   * process does not shut down cleanly, duplicate IDs can be     *
   * created in the database resulting in failures to run jobs    *
   * (probes, performance monitors, etc).                         *
   ****************************************************************
   * RECOMMENDATION:                                              *
   * Apply fix maintenance when available                         *
   ****************************************************************
   
   
    
   
   

PROBLEM CONCLUSION
 *  The fix for this APAR is targeted for the following maintenance
   package:
   
   | refresh pack | 5.2-TIV-TPC-RP0014 - target May 2017
   
   Fixed in IBM Spectrum Control 5.2.14
   
   http://www.ibm.com/support/docview.wss?&uid=swg21320822 [http://www.ibm.com/support/docview.wss?&uid=swg21320822]
   
   The target dates for future refresh packs do not represent a
   formal commitment by IBM. The dates are subject to change
   without notice.
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IT17608
   
   
 * REPORTED COMPONENT NAME
   TPC
   
   
 * REPORTED COMPONENT ID
   5608TPC00
   
   
 * REPORTED RELEASE
   52B
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt / Xsystem
   
   
 * SUBMITTED DATE
   2016-10-21
   
   
 * CLOSED DATE
   2017-01-26
   
   
 * LAST MODIFIED DATE
   2017-02-24
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   TPC
   
   
 * FIXED COMPONENT ID
   5608TPC00
   
   

APPLICABLE COMPONENT LEVELS
 * R52B PSY
   UP
   
   
 * R52C PSY
   UP