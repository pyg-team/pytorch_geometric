Title: IBM SEA Failover flapping on backup SEA - United States

Text:
 TECHNOTE (FAQ)

QUESTION
 Why is the backup SEA adapter of my SEA failover flapping from Primary to Backup repeatedly? 

CAUSE
The Shared Ethernet Adapter (SEA) failover hung or became unresponsive. The backup SEA adapter was flapping between Primary and Backup states which is seen as contention on the control channel between primary ( 1) and backup (2) of SEAs.

ANSWER
This issue can be caused by 2 different problems: 

1) The backup SEA sends a pulse to the primary SEA to see if it is still alive. The primary VIO is not able to send heart beats to backup SEA fast enough due to a lack of available CPU cycles. The backup SEA with trunk priority 2 tries to become primary before it receives the reply and logs these SEAHA_PRIMARY, SEAHA_BACKUP errors. This can sometimes be resolved by changing the VIO CPUs from shared to dedicated.

Another resolution is to update the VIO servers to at least 2.2.0.12 FP24 SP02 to get the SEA fixes for this issue. 

2) CPU folding enabled on VIO servers can cause SEA flapping and in turn will cause the VIO SEA to hang.

Processor folding: Processor folding currently is not supported for VIOS partitions. If processor folding is enabled on your VIOS, and migration media is used to move from VIOS 1.5 to 2.1.0.13 FP 23, or later, processor folding remains enabled. Upgrading via migration media does not change the processor folding state. If you have installed VIOS 2.1.3.0, or later, and have not changed the folding policy, then folding is disabled.

Check for CPU folding on VIOS:

$ oem_setup_env

# schedo -o vpm_fold_policy

If the value is anything other than 4, turn it off with this command:

# schedo -p -o vpm_fold_policy=4


The current value can also found in the ./kernel/kernel.snap file in the VIO snap.