Title: IBM LO51455: ACCESS TO THE URL CONTAINING BODY?OPENFIELD MAKES DOUBLE ENTRY O F CONTENT-TYPE IN HTTP HEADER. - United States

Text:
 SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS FIXED IF NEXT.
    
   
   

ERROR DESCRIPTION
 *  1. Locate ibm.nsf on a Domino 8.5.1 FP1 on Windows 2003 server.
   
   
     2. Open ibm.nsf on notes client and check out the doc id as
   below
   
     3. Access to the doc contained in ibm.nsf  from IE 6.X using
   this URL format
   => http://Dominio server/ibm.nsf/notes_doc_id(case sensitive.
   Refer to the bold
   character at the below example URL)/Body?OpenField
   (
   eg.http://9.187.209.217/ibm.nsf/75d8e71ebeaBEAB61A149257719001F4
   0BE
   /A686F6E75E7D5A644925771900251247/Body?OpenField )
   
   4. In http tread debug, on clicking this URL containing
   Body?OpenField , double
   entry of Content-Type created in the http header as below ;
   
   *** New Request -- Parse and Check Request: Session 3f, Thread
   864, Clock
   6760219
   GET
   /ibm.nsf/75d8e71ebeaBEAB61A149257719001F40BE/A686F6E75E7D5A64492
   5771900251247/Bo
   dy?OpenField HTTP/1.1
   Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg,
   */*
   Accept-Language: en-us
   UA-CPU: x86
   Accept-Encoding: gzip, deflate
   User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2;
   SV1; .NET CLR
   1.1.4322)
   Host: 9.187.209.217
   Connection: Keep-Alive
   
   *** Process Request: Session 3f, Thread 864, Clock 6760234
   *** Client IP Address [9.187.209.217], Server IP Address
   [9.187.209.217]:
   Session 3f, Thread 864, Clock 6760234
   
   *** Start Request Step: Session 3f, Thread 864, Clock 6760234
   *** Raw Request Step: Session 3f, Thread 864, Clock 6760281
   *** Pre Authenticate Step: Session 3f, Thread 864, Clock
   6760281
   *** Authenticate Step: Session 3f, Thread 864, Clock 6760281
   *** Post Authenticate Step: Session 3f, Thread 864, Clock
   6760281
   *** Get Group List Step: Session 3f, Thread 864, Clock 6760281
   *** Authorized Server Access Step: Session 3f, Thread 864, Clock
   6760281
   *** Translate Step: Session 3f, Thread 864, Clock 6760297
   *** Post Translate Step: Session 3f, Thread 864, Clock 6760297
   *** Authorized Step: Session 3f, Thread 864, Clock 6760297
   *** Process Request for User Anonymous: Session 3f, Thread 864,
   Clock 6760297
   *** Calling Url Cache Process Request: Session 3f, Thread 864,
   Clock 6760297
   *** Calling Inotes Process Request: Session 3f, Thread 864,
   Clock 6760297
   *** Post write Buffer, bytes [140]: Session 3f, Thread 864,
   Clock 6760297
   
   
   HTTP/1.1 200 OK
   Server: Lotus-Domino
   Date: Tue, 04 May 2010 09:21:14 GMT
   Content-Type: Content-Type: text/html
   Content-Length: 17881
   
   
   *** Returned from Process Request, Request Processed: Session
   3f, Thread 864,
   Clock 6760297
   *** End Request Step: Session 3f, Thread 864, Clock 6760313
   *** Log Request: Session 3f, Thread 864, Clock 6760313
   
   ----------------------------------------------------------------
   ----------------
   ----------------------------------------------------------------
   -
   
   *  Double "Content-type: Content-type:" header does not comply
   with RFC 2616,
   the HTTP/1.1  and causes working with other application servers
   (eg. Web Seal)
   following RFC 2616 as below ;
   
   ----- Forwarded by Kyung Soo Suh/Korea/IBM on 2010-05-04
   06:27 -----
   
   
   
    Re: PMR 57688,999,766
   
   
    Sagar S Shah
    to:
    Kyung Soo Suh
    2010-05-04      12:58
   
   
    Cc:
   Support Software, ByongJun Na, Soo_Yong Kim, tivoli_support,
   HyungKeun Park
   
   
   
   
   
   
   Hi All,
   
   Customer's problem description
   If a specific parameter, Openfield, is used in the URL access to
   Domino through
   WebSEAL, it causes 500 error.
   
   Investigations so far
   1. I've reviewed WebSEAL debug and snoop traces for working HTTP
   request and
   failing HTTP request. We can confirm that WebSEAL is working as
   designed.
   
   - Whenever User gets "HTTP/1.1 500 Internal Server Error" error
   we see that
   back-end server has sent below HTTP header
   Content-Type: Content-Type: text/html
   
   You can notice the double "Content-type: Content-type:" header
   above.
   It is very important that the Content-Type header generated by
   the back-end
   server must comply with the requirements of RFC 2616, the
   HTTP/1.1
   
   
   Refer below DCF which clearly states above.
   http://www-01.ibm.com/support/docview.wss?uid=swg21247283 [http://www-01.ibm.com/support/docview.wss?uid=swg21247283]
   
   This is also clear from the WebSEAL server log
   DPWNS0452E   Invalid MIME type 'Content-Type'.
   2010-04-29-13:25:58.617+09:00I----- 0x38B9A1C4 webseald ERROR
   wns  mimetype
   mimetable.c 237 0xaf13cbb0
   Above error is explained in TAM error guide as below.
   
   
   
   
   DPWNS0452E Invalid MIME type ?%s?.
   
   Explanation: An attempt was made to lookup a match for a MIME
   type that did not
   contain a ?/?.
   
   Action: Check the MIME type configuration of your servers to
   verify that they
   are returning valid MIME types for all documents.
   
   
   -  It may happen that  "Without Web Seal, direct access to the
   same URL opens
   without problem"
   This is possible because most of the browsers are able to read
   such responses
   by making a best try attempt to display the HTTP contents even
   though it may
   have noncompliant HTTP header.
   
   However, when using reverse proxy such as WebSEAL, this won't be
   accepted as
   WebSEAL has to break the message, process its contents and
   reconstruct it.
   WebSEAL 5.1 onwards strictly implements HTTP 1.1 specifications
   as described by
   RFC 2616.
   
   
   - When User are able to access other working URLs from Domino,
   we see that
   back-end server is sending the right HTTP header as below.
   Content-Type: text/html; charset=US-ASCII
   
   Next steps:
   
   - Lotus L2 to investigate why there is a difference in HTTP
   header
   "Content-type:" for responses from the same backend
   application.
   I think they need to work with the application team to fix the
   double
   "Content-type: Content-type:" header coming from backend domino
   application to
   WebSEAL server.
   
   - This issue is reported to Lotus team through new PMR
   57841.999.766.  Tivoli
   L2 will wait till this new PMR with Lotus team is resolved.
   
   
    
   
   

LOCAL FIX
 *  n/a
   
   
    
   
   

PROBLEM SUMMARY

PROBLEM CONCLUSION

TEMPORARY FIX

COMMENTS
 *  This APAR is associated with SPR# KSSH855CPM.
   This spr is being closed due to no more maintenance releases
    for 7x.  If this issue persists in a later releases (8.5.1 or
    above) it may be re-raised for investigation.
   
   
    
   
   

APAR INFORMATION
 * APAR NUMBER
   LO51455
   
   
 * REPORTED COMPONENT NAME
   DOMINO SERVER
   
   
 * REPORTED COMPONENT ID
   5724E6200
   
   
 * REPORTED RELEASE
   702
   
   
 * STATUS
   CLOSED FIN
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2010-05-06
   
   
 * CLOSED DATE
   2010-05-28
   
   
 * LAST MODIFIED DATE
   2010-05-28
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

MODULES/MACROS
 *  NA
   
   
    
   
   

FIX INFORMATION

APPLICABLE COMPONENT LEVELS
 * R702 PSN
   UP