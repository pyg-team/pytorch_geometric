Title: IBM Stale connection exception when attempting to access an idle Portal server - United States

Text:
stale connection; unable to access database TECHNOTE (TROUBLESHOOTING)

PROBLEM
Stale connections can occur after Portal server has been idle for a period of time and attempts to access the database. 

[1/19/12 22:16:42:351 EST] 00000036 SchedulerDaem E SCHD0104E: The
Scheduler poll daemon WPSTaskScheduler (wps/Scheduler) failed to load
tasks from the database due to an exception: com.ibm.websphere.
scheduler.SchedulerNotAvailableException: com.ibm.websphere.ce.cm.
StaleConnectionException: IO Error: A remote host did not respond
within the timeout period.


SYMPTOM
After a period of inactivity, the Portal server becomes unresponsive.


CAUSE
The Portal connection to the database is closed externally by a firewall or by the remote database due to inactivity. Because Portal is still holding onto this connection, we still think the connection is available, and so receive the stale connection exception.



DIAGNOSING THE PROBLEM
Reviewing the Portal's systemOut.log we see the stale connection exception when attempting to access the database.



RESOLVING THE PROBLEM
The solution is to reduce the Minimum Connections to 0 on the data source. 


This will cause WAS to remove all connections after a period of inactivity.

In the WAS admin console, go to Resources -> JDBC -> Data sources

For each of the 6 db domains, select the Connection pools link and
edit the Minimum connection folder.

Restart the servers after the changes are made.