Title: IBM SHA-1 signed certificates on the Security Network IPS sensor - United States

Text:
GX; SHA; cert; sign TECHNOTE (FAQ)

QUESTION
 How do you address SHA-1 signing vulnerabilities on the Security Network IPS (GX) sensor? 

CAUSE
When the GX sensor is installed at firmware 4.6.1 or 4.6.2, it uses SHA-256 by default. However, GX sensors that are upgraded from firmware 4.6 to versions 4.6.1 or 4.6.2 still use SHA-1. Because of this, vulnerability scanners may report the following vulnerability on the sensor:

SHA-1-based Signature in TLS/SSL Server X.509 Certificate (tls-server-cert-sig-alg-sha1)


ANSWER
Follow the instructions below to re-create the certificates using SHA-256: 

 

 1.  Log in to the GX sensor with the root account via SSH or console connection.
     
 2.  Enter the following commands to make a backup of the current certificate and key:
     
     cp /etc/apache2/ssl.crt/server_lmi.crt /etc/apache2/ssl.crt/server_lmi.crt.old
     cp /etc/apache2/ssl.key/server_lmi.key /etc/apache2/ssl.key/server_lmi.key.old
     
 3.  Create a temporary directory to use as a workspace and change to the directory:
     
     mkdir keys && cd keys
     
 4.  Generate a key file. The command below will generate a 2048-bit key file:
     
     openssl genrsa -out domain.key 2048
     
 5.  Generate a certificate signing request (CSR) and certificate key with SHA-256:
     
     openssl req -new -nodes -key domain.key -out domain.csr -sha256
     
     [/support/docview.wss?uid=swg21968097&aid=1] [/support/docview.wss?uid=swg21968097&aid=1]
     
     Note: The common name in the form above is the important part. You need to enter the device's hostname in this field, which you can find with the hostname command. The other fields are optional and can be left blank. 
     
 6.  Create the self-signed certificate from the certificate-signing request:
     
     openssl x509 -req -sha256 -days 3650 -in domain.csr -signkey domain.key -out domain.crt
     
 7.  Rename and copy the key:
     
     mv domain.key /etc/apache2/ssl.key/server_lmi.key
     
     Press y to overwrite the old key when asked.
     
 8.  Copy the certificate:
     
     mv domain.crt /etc/apache2/ssl.crt/server_lmi.crt
     
     Press y to overwrite the old key when asked.
     
 9.  Leave and delete the temporary workspace directory:
     
     cd .. && rm -rf keys
     
 10. Restart the Apache service:
     
     service apache2-lmi restart




[/support/docview.wss?uid=swg21968097&aid=2] [http://ibm.biz/KC-SNIPS] [/support/docview.wss?uid=swg21968097&aid=3] [http://ibm.biz/InfraSecForumTechnote] [/support/docview.wss?uid=swg21968097&aid=4] [http://ibm.biz/SecSuptUTube] [/support/docview.wss?uid=swg21968097&aid=5] [http://ibm.biz/InfraSecFixes] [/support/docview.wss?uid=swg21968097&aid=6] [http://ibm.biz/FlexLicLogin] [/support/docview.wss?uid=swg21968097&aid=7] [http://ibm.biz/MyNotification] [/support/docview.wss?uid=swg21968097&aid=8] [http://ibm.biz/ContactSecSupport]