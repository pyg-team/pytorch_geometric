Title: IBM Determining the amount of extent space that can be reclaimed from an MDC table. - United States

Text:
MDC extent space; reclaim extents from MDC; RECLAIM EXTENT ONLY option; ADMINTABINFO TECHNOTE (FAQ)

QUESTION
 What is the recommended method to determine the amount of space that can be reclaimed from an MDC using the RECLAIM EXTENT ONLY option of the REORG command? 

CAUSE
Data within MDCs is organized into blocks that are each equal to an extent of pages. When all data is deleted from the blocks they are marked as free but the extents are not immediately returned to the tablespace for reuse. The extents must be reclaimed from the MDC. This is done through the REORG command using the RECLAIM EXTENTS ONLY clause.

ANSWER
For versions 9.7 and above, the ADMINTABINFO administrative view contains a column called RECLAIMABLE_SPACE. To determine the amount of space that can be reclaimed, we only need to query this column for the appropriate MDC.

For example:
Our MDC table is called TESTMDC. 

To check the reclaimable space, we execute:
$ db2 "select RECLAIMABLE_SPACE from SYSIBMADM.ADMINTABINFO where TABNAME= 'TESTMDC'"

We get an output of:

/home/db2inst1
$ db2 "select RECLAIMABLE_SPACE from SYSIBMADM.ADMINTABINFO where TABNAME= 'TESTMDC'"

RECLAIMABLE_SPACE
--------------------
58240

1 record(s) selected.


This tells us that there are 58240 kb of space that can be reclaimed in the REORG operation and returned to the tablespace for use.

Please note that for versions 9.7 and 9.8, this information can be queried similarly from the ADMIN_GET_TAB_INFO_V97 table function; however, this table function was deprecated and may not be available in later releases.

RELATED INFORMATION
 Multidimensional clustering extent management [http://www-01.ibm.com/support/knowledgecenter/SSEPGG_9.7.0/com.ibm.db2.luw.admin.partition.doc/doc/c0054692.html]
Use RECLAIM with REORG to free up space in DB2 (version [http://www.ibm.com/developerworks/data/library/techarticle/dm-1102reclaimdb2reorg/]