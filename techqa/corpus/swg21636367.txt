Title: IBM OpenSSL created p12/pfx file cannot be imported into a kdb file. - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 OpenSSL is used to create and manage certificates. A personal certificate for a server is created and put in a .p12 file. Attempts to import this certificate into a .kdb file for use by WebSEAL fail in various ways. 

SYMPTOM
Ensure the .kdb file already contains the certificate's CA signer certificate,

$ gsk8capicmd_64 -cert -list -db example.kdb -pw *****
Certificates found
* default, - personal, ! trusted
! ISAMCA 

Problems seen may include:

Run the import command with -file and it appears successful but the cert was not imported.

$ gsk8capicmd_64 -cert -import -target example.kdb -target_pw **** -file SERVER.p12 -pw ****
$
$ gsk8capicmd_64 -cert -list -db example.kdb -pw *****
$ gsk8capicmd_64 -cert -list -db example.kdb -pw *****
Certificates found
* default, - personal, ! trusted
! ISAMCA


Run the import command with -db and receive error message CTGSK3046W. 

$ gsk8capicmd_64 -cert -import -db SERVER.p12 -pw ***** -type pkcs12 -label SERVER \
-target example.kdb -target_pw ***** -target_type cms
CTGSK3046W The key file "SERVER.p12" could not be imported.

The above may be encountered while trying to import the certificate into a kdb file on the Web Gateway Appliance using the LMI.


CAUSE
GSKIT 8 requires the "Friendly Name" attribute to be set.


DIAGNOSING THE PROBLEM
Use a brower such as Firefox or Internet Explorer to verify the .p12 file. If either of these can successfully import the certificate but displays the "Friendly Name" as "<None>" then the .p12 file needs to be recreated using the openssl -name option. 



RESOLVING THE PROBLEM
Use the openssl -name option, 

openssl pkcs12 -export -out SERVER.p12 -inkey SERVER.key -in SERVER.pem -name SERVER 

The certificate can now be imported, 

$ gsk8capicmd_64 -cert -import -target example.kdb -target_pw ***** -file SERVER.p12 -pw ***** 

$ gsk8capicmd_64 -cert -list -db example.kdb -pw *****
Certificates found
* default, - personal, ! trusted
! ISAMCA
- SERVER

 

PRODUCT ALIAS/SYNONYM
 TAM ISAM Web Gateway Appliance WGA