Title: IBM Creating a profile with -defaultPorts argument results in SECJ0305I UNAUTHENTICATED error - United States

Text:
The role-based authorization check failed; SECJ0305I; UNAUTHENTICATED; error; server profile error; default port TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Attempts to create a WebSphere Application Server 7.0 server profile using the -defaultPorts option results in the error "SECJ0305I: The role-based authorization check failed for admin-authz operation Server:getState. The user UNAUTHENTICATED (unique ID: UNAUTHENTICATED) was not granted any of the following required roles: deployer, operator, configurator, monitor, administrator, adminsecuritymanager, auditor." when using IBM Rational Application Developer for WebSphere Software 8.0.x 

SYMPTOM
Steps to reproduce: 

 1.  Create a profile:
     
     "%WAS_HOME%/bin/manageprofiles.bat" -create -defaultPorts -profileName
     %PROFILE_NAME% -profilePath "%PROFILE_PATH%" -templatePath
     "%WAS_HOME%/profileTemplates/default" -nodeName localNode -cellName
     localCell -hostName localhost 
     
     Where:  * PROFILE_NAME = <server_profile_name> 
      * PROFILE_PATH = C:\Program Files\IBM\SDP\runtimes\base_v7\profiles\<server_profile_name> 
      * WAS_HOME = C:\Program Files\IBM\SDP\runtimes\base_v7
        
        Note: It is possible to create a profile with the same configurations using the GUI
        
        
     
     
 2.  Start the server
     
     "%PROFILE_PATH%\bin\startServer.bat" server1 
     
 3.  Launch Admin Console by opening the URL http://localhost:9060/ibm/console/login.do
     
     
 4.  Navigate to Global Security section
     
     
 5.  Enable Administrative security and Application security options
     
     
 6.  Save configuration in Admin Console
     
     
 7.  Restart the server
     
     
 8.  Start Rational Application Developer 8.0.x
     
     
 9.  Create a server under Servers View
     
     
 10. Add the new profile <server_profile_name> (from step 1) when using the credentials configured in step 3.
     


The following error message will appear in the console view in a loop:  

[12/15/10 16:40:24:515 IST] 00000015 RoleBasedAuth A SECJ0305I: The 

role-based authorization check failed for admin-authz operation 

Server:getState. The user UNAUTHENTICATED (unique ID: UNAUTHENTICATED) 

was not granted any of the following required roles: deployer, operator, 

configurator, monitor, administrator, adminsecuritymanager, auditor. 

[12/15/10 16:40:24:906 IST] 00000017 LTPAServerObj E SECJ0369E: 

Authentication failed when using LTPA. The exception is Authentication 

failed for user admin with the following error message Logon failure: 

unknown user name or bad password.

CAUSE
When a server is defined in the Rational Application Developer Server View, it pings the WebSphere Application Server port on a regular basis (the default time interval is 5 seconds) to check the server state. 


This is needed because the WebSphere Application Server might be started and stopped outside of Rational Application Developer Server at any time. 

Note that the attempt to connect is made even if the WebSphere Application Server appears in Stopped state in the Rational Application Developer Server View.


RESOLVING THE PROBLEM
 

WORKAROUNDS: 

There are three different ways to circumvent this issue. 

 * Under Servers View, remove all WebSphere Application Server 7.0.x related servers, except for the newly created server in step 9. 
   
   As soon as all other servers are removed, the error message in question stops.
   
   
 * If you need to use multiple servers which do not all use the same security credentials, ensure that the corresponding server profiles use distinct port values.
   
   
 * If you absolutely need to have multiple servers with the same port values, and different security credentials, you can limit the impact of this issue by changing the "Update Server Status Interval" in the Servers view from the default value of 5000 milliseconds to a larger number.
   
   This will reduce, but not completely eliminate, the error messages.