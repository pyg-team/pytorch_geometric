Title: IBM MUSTGATHER: Troubleshooting hangs of the scm.exe application - United States

Text:
rtc; hang; troubleshoot; infinite loop; terminate; compare; snapshot; workspace; scm; scm.exe; scm.ini; netstat; java; jvm; javacore TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 If you launch the scm.exe command in IBM Rational Team Concert, you will observe that the command never terminates. 

SYMPTOM
You invoke a comparison, for example you compare a Workspace and a Snapshot, with a command line like the following: 

 
C:\Program Files\IBM\TeamConcert\scmtools\eclipse>scm compare -u userName -P password -r https://localhost:9443/jazzworkspace "MyWorkspace" snapshot "Snapshot1" -I f 

The command then never terminates: it hangs indefinitely. 

Perform the following steps to capture log data to be used to troubleshoot the hanging behavior:

1. Open the file scm.ini, typically located in: 

 
C:\Program Files\IBM\TeamConcert\scmtools\eclipse\scm.ini


The contents of the file look like the following:


-vm
C:\Program Files\IBM\TeamConcert\jdk\jre/bin/java.exe
--launcher.suppressErrors
-data
@noDefault 
-vmargs
-Xmx512m
-Xshareclasses
-Xquickstart
-Dosgi.requiredJavaVersion=1.5 

2. Change directory to the parent folder of java.exe. 

From that directory, run java -version and save the output in a text file. 

The output will indicate if the JVM is an IBM JVM. 

 

 

3. The Steps 3-5 are only applicable to the IBM JVM. 

If you are using another JVM, then you will need to consult the documentation supplied by its vendor. 

Openscm.ini and add the following parameters, each on a separate line, starting after the line that contains vmargs: 

-Xdump:java+system:events=user
-verbose:gc
-Xverbosegclog:verbosegc.%Y%m%d.%H%M%S.%pid.txt 

The contents of scm.ini should then look like this: 

-vm
C:\Program Files\IBM\TeamConcert\jdk\jre/bin/java.exe 
--launcher.suppressErrors 
-data
@noDefault
-vmargs 
-Xdump:java+system:events=user
-verbose:gc 
-Xverbosegclog:verbosegc.%Y%m%d.%H%M%S.%pid.txt
-Xmx512m
-Xshareclasses
-Xquickstart
-Dosgi.requiredJavaVersion=1.5 
After you do this, launch the hanging operation, for example: 

C:\Program Files\IBM\TeamConcert\scmtools\eclipse>scm compare -u userName -P password -r https://localhost:9443/jazzworkspace "MyWorkspace" snapshot "Snapshot1" -I f 

In the same command window where the above command is running, type: 
CTRL+BREAK 

This sends a signal to the JVM and it writes the following: 
JVMDUMP006I Processing dump event "user", detail "" - please wait.

JVMDUMP032I JVM requested System dump using 
'C:\Program Files\IBM\TeamConcert\scmtools\eclipse\core.20111018.121358.3896.0001.dmp' 
in response to an event

C:\Program Files\IBM\TeamConcert\scmtools\eclipse>JVMDUMP010I System dump written to C:\Program Files\IBM\TeamConcert\scmtools\eclipse\core.20111018.121358.3896.0001.dmp JVMDUMP032I JVM requested Java dump using 
'C:\Program Files\IBM\TeamConcert\scmtools\eclipse\javacore.20111018.121358.3896.0002.txt' 
in response to an event

JVMDUMP010I Java dump written to 
C:\Program Files\IBM\TeamConcert\scmtools\eclipse\javacore.20111018.121358.3896.0002.txt 
JVMDUMP013I Processed dump event "user", detail "".

/Project1/src/com/Class3.java
/Project1/src/com/If1.java 

The output indicates that the following files were created: 
File Name Purpose verbosegc.20111018.122106.3848.txt Verbose Garbage Collector log. javacore.20111018.121358.3896.0002.txt Text file thatcontains the list of all threads. core.20111018.121358.3896.0001.dmp System core dump. 
 

4. For an IBM JDK versions 1.6 and lower, you must process the system core dump with the jextract utility before submitting it to support. 

This is the syntax of the jextract command: 

<installroot>/jre/bin/jextract [corefile]

The jextract command produces a jar file.



5. Repeat the steps 3-4 a few times at a distance of a few minutes.



6. Collect the out output of the command:

netstat -an > netstat.log




7. Configure Command Line Interface tracing as discussed in the following article: Default logging for CLI [https://jazz.net/wiki/bin/view/Main/SCMCommandLineBugReporting]


RESOLVING THE PROBLEM
Submit the following artifacts to IBM Rational Client Support for investigation: 

 * Output of java -version 
 * Verbose Garbage Collector Log 
 * javacore files 
 * core file (processed with jextract) 
 * Output of the netstat -an command 
 * Provide the output of the Command Line interface trace.


RELATED INFORMATION
#IBM JDK Diagnosis [http://www.ibm.com/developerworks/java/jdk/diagnosis/]
Source control command line reference [http://publib.boulder.ibm.com/infocenter/clmhelp/v3r0/index.jsp?topic=%2Fcom.ibm.team.scm.doc%2Ftopics%2Fr_scm_cli_scm.html]