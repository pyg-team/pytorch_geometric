Title: IBM Improve overall Streams performance on upgrade by clearing java class cache - United States

Text:
peformance cache streams TECHNOTE (FAQ)

QUESTION
 Why do you see a performance degredation with streamtool commands after a Streams upgrade? 

CAUSE
The java class cache is filled with old class files from the old product location, so new classes don't get cached

ANSWER
In order to populate the cache with the new classes you need to clear the java class cache. To do this perform the steps below. 

 1. List the class caches on each node with
    $java -Xshareclasses:listAllCaches
    Note the names of the caches that begin with com.ibm.streams 
 2.  Clear each of the streams java class caches on each node with
    $ java -Xshareclasses:name=<cache_name>,destroy


This is done on all nodes. It can be done while streams is started but the new cleared cache won't be used until the process restarts, for example, new streamtool executions. It is not required to restart streams as the performance issue is only on process start. 

Below is an example: 

$ java -Xshareclasses:listAllCaches 

Listing all caches in cacheDir /tmp/javasharedresources/ 

Cache name level cache-type feature OS shmid OS semid last detach time 

Compatible shared caches 
com.ibm.streams.streamtool_jane Java8 64-bit persistent default Thu May 18 16:45:53 2017 
com.ibm.streams_jane Java8 64-bit persistent default Thu May 25 16:38:07 2017 
sharedcc_jane Java8 64-bit persistent default Thu May 25 16:38:23 2017 

Incompatible shared caches 
sharedcc_jane Java8 64-bit persistent mt In use 
com.ibm.streams_jane Java8 64-bit persistent mt In use 
com.ibm.streams.streamtool_jane Java8 64-bit persistent mt Thu May 18 16:01:59 2017 

$ java -Xshareclasses:name=com.ibm.streams_jane,destroy 
JVMSHRC256I Persistent shared cache "com.ibm.streams_jane" has been destroyed 
$ java -Xshareclasses:name=com.ibm.streams.streamtool_jane,destroy 
JVMSHRC256I Persistent shared cache "com.ibm.streams.streamtool_jane" has been destroyed 

Note: Starting with IBM Streams version 4.2.1.0 , the streams java class cache will be cleared automatically on host controller startup, so this manual step is not necessary. RELATED INFORMATION
 java -Xshareclasses documentation [https://www.ibm.com/support/knowledgecenter/SSYKE2_8.0.0/com.ibm.java.lnx.80.doc/diag/appendixes/cmdline/Xshareclasses.html]