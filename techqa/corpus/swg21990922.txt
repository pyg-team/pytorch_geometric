Title: IBM Push Notifications Fail after Upgrade to IBM Connections 5.5 CR1 - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM
Push Notifications Fail after Upgrade to IBM Connections 5.5 CR1

SYMPTOM
No Push Notifications are received by mobile and desktop users. The following error is an example of what is shown in SystemOut.log when starting the IBM Connections server:
[9/9/16 15:31:38:966 ICT] 00000073 FfdcProvider W com.ibm.ws.ffdc.impl.FfdcProvider logIncident FFDC1003I: FFDC Incident emitted on /opt/IBM/WebSphere/AppServer/profiles/AppSrv01/logs/ffdc/AppsCluster_server1_5dda2639_16.09.09_15.31.38.8622559008409858432937.txt com.ibm.ws.sib.msgstore.persistence.objectManager.PersistableMessageStoreImpl.checkAndUpdateMEOwner 1:2227:1.81.1.8
[9/9/16 15:31:38:967 ICT] 00000073 SibMessage E [ConnectionsBus:AppsCluster.000-ConnectionsBus] CWSIS1567E: Messaging engine AppsCluster.000-ConnectionsBus cannot obtain the lock on its file store, which ensures it has exclusive access to the data.
[9/9/16 15:31:38:979 ICT] 00000073 FfdcProvider W com.ibm.ws.ffdc.impl.FfdcProvider logIncident FFDC1003I: FFDC Incident emitted on /opt/IBM/WebSphere/AppServer/profiles/AppSrv01/logs/ffdc/AppsCluster_server1_5dda2639_16.09.09_15.31.38.9694637292890232104295.txt com.ibm.ws.sib.msgstore.transactions.XidManager.restart 1:516:1.62
[9/9/16 15:31:39:002 ICT] 00000073 FfdcProvider W com.ibm.ws.ffdc.impl.FfdcProvider logIncident FFDC1003I: FFDC Incident emitted on /opt/IBM/WebSphere/AppServer/profiles/AppSrv01/logs/ffdc/AppsCluster_server1_5dda2639_16.09.09_15.31.38.979596340558826440194.txt com.ibm.ws.sib.msgstore.impl.MessageStoreImpl.start 755
[9/9/16 15:31:39:003 ICT] 00000073 SibMessage E [ConnectionsBus:AppsCluster.000-ConnectionsBus] CWSIS0002E: The messaging engine encountered an exception while starting. Exception: com.ibm.ws.sib.msgstore.TransactionException: CWSIS1099E: An unexpected exception has occurred. Exception: com.ibm.ws.sib.msgstore.MessageStoreUnavailableException: Operation not possible as MessageStore is unavailable!
[9/9/16 15:31:39:004 ICT] 00000073 SibMessage I [ConnectionsBus:AppsCluster.000-ConnectionsBus] CWSIS1589I: The file store has stopped successfully. 






 The following error is an example of what is shown in the referenced ffdc log, AppsCluster_server1_5dda2639_16.09.09_15.31.38.8622559008409858432937.txt: 


[9/9/16 15:31:38:865 ICT] FFDC Exception:com.ibm.ws.objectManager.ObjectStoreFullException SourceId:com.ibm.ws.sib.msgstore.persistence.objectManager.PersistableMessageStoreImpl.checkAndUpdateMEOwner ProbeId:1:2227:1.81.1.8 Reporter:com.ibm.ws.sib.msgstore.persistence.objectManager.PersistentMessageStoreImpl@dd456d13
com.ibm.ws.objectManager.ObjectStoreFullException: CWSOM1042E: ObjectStore=AbstractObjectStore(PermanentStore)/fb521136(ObjectStore) was asked to allocate space for ManagedObject=null(ManagedObject) when it was full. 
at com.ibm.ws.objectManager.AbstractSingleFileObjectStore.reserve(AbstractSingleFileObjectStore.java:794)
at com.ibm.ws.objectManager.ManagedObject.reserveSpaceInStore(ManagedObject.java:655)
at com.ibm.ws.objectManager.ManagedObject.getSerializedBytes(ManagedObject.java:629)
at com.ibm.ws.objectManager.InternalTransaction.replace(InternalTransaction.java:978)
at com.ibm.ws.objectManager.Transaction.replace(Transaction.java:302)
at com.ibm.ws.sib.msgstore.persistence.objectManager.PersistentMessageStoreImpl.checkAndUpdateMEOwner(PersistentMessageStoreImpl.java:2171)
at com.ibm.ws.sib.msgstore.persistence.objectManager.PersistentMessageStoreImpl.start(PersistentMessageStoreImpl.java:672)
at com.ibm.ws.sib.msgstore.impl.MessageStoreImpl.start(MessageStoreImpl.java:1570)
at com.ibm.ws.sib.admin.impl.JsMessagingEngineImpl.start(JsMessagingEngineImpl.java:638)
at com.ibm.ws.sib.admin.impl.HAManagerMessagingEngineImpl.conditionalStart(HAManagerMessagingEngineImpl.java:2338)
at com.ibm.ws.sib.admin.impl.HAManagerMessagingEngineImpl.activate(HAManagerMessagingEngineImpl.java:1358)
at com.ibm.ws.sib.admin.impl.JsActivationThread.run(JsActivationThread.java:94)

==> Performing default dump from com.ibm.ws.sib.utils.ffdc.SibDiagnosticModule :Fri Sep 09 15:31:38 ICT 2016
SIB FFDC dump for::com.ibm.ws.objectManager.ObjectStoreFullException: CWSOM1042E: ObjectStore=AbstractObjectStore(PermanentStore)/fb521136(ObjectStore) was asked to allocate space for ManagedObject=null(ManagedObject) when it was full. 


CAUSE
The Message Store is corrupted



RESOLVING THE PROBLEM
Perform the following steps which will automatically re-create the message stores: 

 

 1. Shutdown Connections: ./stopServer.sh && ./stopNode.sh && ./stopManager.sh 
 2. Move the permanent and temporary message stores to another directory. 
 3. Back-up the log file. 
 4. Clear out the log file. 
 5. Start Connections: ./startManager.sh && ./startNode.sh && ./startServer.sh


Note: Messages that are not processed that remain in the message store will be lost.