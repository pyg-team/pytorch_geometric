Title: IBM DataStage Teradata Connector or Teradata Enterprise stage aborts with the error - RDBMS code 3597: Request requires too    
many SPOOL files - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Job log error - Message: InsUpd_TD_Table,0: RDBMS code 3597: Request requires too 
many SPOOL files. 

CAUSE
The error message "RDBMS code 3597: Request requires too many SPOOL files" indicates that 

database has exceeded the maximum number of SPOOL files allowed in the Teradata database Parser while parsing the request parcel from the connector. This is an issue on the database side. Teradata and DBA should work to provide a detailed analysis and correct the problem on the backend.


RESOLVING THE PROBLEM
Some basic guidelines as it applies to DataStage job design: 

 
When processing small # of rows (with small row-sizes), any values set to ArraySize, RecordCount would work fine. These are tunables & need to be set based on the TD-DBS configuration (as per spool space /temp-space allocated in TDBMS). That being said, users can consider the following points (as a rule of thumb), when Teradata jobs encounter "spool-space" issues: 

======================= 
1) Try setting ArraySize = 1 MB / row-size (TDCC will switch to 1 MB processing during the job run automatically if DBS supports 1 MB, unless the user sets a lower-value for the buffer). For example, if row-size is 10K, then set the Array-size = 1 M / 10K = 100. 

2) At each RecordCount interval, TDCC will perform commit (or) checkpoint, for immediate mode (or) bulk-mode jobs respectively. So, it is better to set the record count equal to 10th of the total-# of rows 
being processed (so that, there would be 10 checkpoints, for the job-run). For example, when inserting 1 M records, set RecordCount = 1 M / 10 = 100000.