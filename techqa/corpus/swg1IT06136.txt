Title: IBM IT06136: OPENSTACKITEMNOTFOUNDEXCEPTION WHEN DELETING AN INSTANCE - United States

Text:
 SUBSCRIBE TO THIS APAR
By subscribing, you receive periodic emails alerting you to the status of the APAR, along with a link to the fix after it becomes available. You can track this item individually or track all items by product.

Notify me when this APAR changes.

Notify me when an APAR for this component changes.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  The following scenario results in an error where an instance
   cannot be deleted
   
   1) A project OAP-P1 is defined in IBM Cloud Orchestrator with
   
   user ischwert as admin
   user admin as admin
   user member2 as member
   User ischwert is also member of the admin project.
   
   
   2) Now user ischwert is logged in under the scope of the admin
   project.
   She provisions a new vsys instance via IWD UI, as user ischwert
   within admin project.
   
   Now she adds OAP-P1 to vSys instance ACL, with permission
   "All".
   
   3) Now member2 logs in to IWD.
   He will see the provisioned instance in his list of instances.
   
   He now deletes the provisioned instance as member2. He will not
   be  able to do that, and see the following error message in the
   logs:
   
   OpenStackItemNotFoundException: <itemNotFound code="404"
   xmlns="http://docs.openstack.org/compute/api/v1.1%22%3E%3Cmessag
   e%3EInstance could not be found<
   
   
    
   
   

LOCAL FIX
 *  If ischwert were logged in to OAP-P1 in step 2, the deletion in
   step 3 would work.
   
   
    
   
   

PROBLEM SUMMARY
 *  Automatic ACL assignments to the instance of virtual system or
   virtual application pattern do not reflect the actual access
   level on the OpenStack side. Enabled modification of the ACL
   field allows to set access to projects that effectively will
   not be able to gain access to the virtual machines on the
   OpenStack side. Without correct settings user might experience
   'Access Denied' errors while trying to perform operations on
   the instance.
   Pattern deployment IBM Cloud Orchestrator 2.4 automatically
   assign ACL settings to the user that has created the pattern
   instance. Even that behaviour is correct, it is not aligned
   with the behaviour of the OpenStack that relies on the tenant
   (project) assignment to the instance. What's more, the user
   interface still allows end user to modify the ACL settings but
   not on the OpenStack level. The ACL settings are only modified
   to the Workload Deployer component access rules but it is not
   reflected automatically within OpenStack. Effectively, one can
   assign access to project/user that will not be able to access
   the instance.
   
   
    
   
   

PROBLEM CONCLUSION
 *  When the instance is created, instead of only setting full ACLs
   to the creator user, the current project (tenant) is taken for
   the user ("current" means the one that user is logged to and
   visible at the top of the whole page, in combobox for
   projects). The current project is also set with full
   permissions to instance ACL. This is along the OpenStack
   permissions when the VM instance can be modified by anybody
   from the project (tenant) the instance was started within.
   What's more, the change disables the possibility to modify the
   ACLs in the IWD UI. Given the fact that there might be existing
   instances before installing ICO 2.4.0.1 then the possibility to
   alter ACLs using CLI has been preserved:
     >>> aProject = deployer.groups['my-project']
     // set permissions: Virtual Systems Instance (Classic)
     >>> deployer.virtualsystems[0].acl[aProject] =
   deployer.READ_PERMISSIONS
     // remove ACL entry: Virtual Systems Instance (Classic)
     >>> del deployer.virtualsystems[0].acl[aProject]
     // for Virtual Systems or Virtual Applications use the
   following prefix
     >>> deployer.virtualapplications...
   
   IBM Cloud Orchestrator 2.4.0.1 deliverable is published with
   the code change to addresses this issue.
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IT06136
   
   
 * REPORTED COMPONENT NAME
   IWD FOR SCO/SCP
   
   
 * REPORTED COMPONENT ID
   5765PS1SC
   
   
 * REPORTED RELEASE
   400
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2014-12-17
   
   
 * CLOSED DATE
   2015-04-28
   
   
 * LAST MODIFIED DATE
   2015-04-28
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

MODULES/MACROS
 *  999
   
   
    
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   IWD FOR SCO/SCP
   
   
 * FIXED COMPONENT ID
   5765PS1SC
   
   

APPLICABLE COMPONENT LEVELS
 * R400 PSY
   UP