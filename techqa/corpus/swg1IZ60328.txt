Title: IBM IZ60328: JAVA/JMS CLIENT APPLICATIONS USING WEBSPHERE MQ V7 JARS REPORT  JAVA.LANG.OUTOFMEMORYERROR WITH CONNECTION BROKEN EXCEPTIONS - United States

Text:
  FIXES ARE AVAILABLE
WebSphere MQ V7.0 Fix Pack 7.0.1.1 [http://www-01.ibm.com/support/docview.wss?uid=swg24024528]
WebSphere MQ V7.0.1 for i5/OS Fix Pack 7.0.1.1 [http://www-01.ibm.com/support/docview.wss?uid=swg24025627]
WebSphere MQ V7.0 Fix Pack 7.0.1.2 [http://www-01.ibm.com/support/docview.wss?uid=swg24026518]
WebSphere MQ V7.0.1 for i5/OS Fix Pack 7.0.1.2 [http://www-01.ibm.com/support/docview.wss?uid=swg24026566]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  You have a Java application  which is connected to WebSphere MQ.
   If the connection to WebSphere MQ breaks, the MQ Java classes
   do not remove connection objects properly.  These objects build
   up and cause a memory leak and out of memory (OOM) errors.  Any
   thread in the Java Virtual Machine (JVM), even multiple threads,
   can receive a java.lang.OutOfMemoryError as a result of this
   problem.
   
   The WebSphere MQ Java classes write the following two FDCs at
   Websphere MQ client side:
   
   Probe Id :- JM041006
   Component :- JmqiConsumerFunction
   Major Errorcode :- MQRC_UNEXPECTED_ERROR
   Probe Description :- AMQ6125: An internal WebSphere MQ error has
   occurred.
   Comment1 :- java_mqmd_buf is null
   .
   Probe Id :- JM041100
   Component :- JmqiConsumerFunction
   Probe Description :- AMQ6125: An internal WebSphere MQ error has
   occurred.
   Comment1 :- Pending exception
   
   In the heap dumps one can observe the OOM to be triggered from
   the RemoteConnectionPool class.
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  ****************************************************************
   USERS AFFECTED:
   This issue affects any users of WebSphere MQ V7 classes for
   Java applications that connect to WebSphere MQ and experience
   frequent connection broken issues.
   
   Platforms affected:
   All Distributed (iSeries, all Unix and Windows) +Java
   ****************************************************************
   PROBLEM SUMMARY:
   When an application attempts to connect to WebSphere MQ, the
   connection object references are stored internally. When an
   connection broken exception happens, it is important that these
   stored connection object references are removed. In some
   situations, however, the connection objects were not removed
   and lie in memory without getting garbage collected, eventually
   leading to an OutOfMemoryError.
   
   
    
   
   

PROBLEM CONCLUSION
 *  The code has been modified within the RemoteConnectionPool
   class to ensure that, if an exception occurs when connecting,
   the connection object reference is removed from the internal
   list.
   
   ---------------------------------------------------------------
   The fix is targeted for delivery in the following PTFs:
   
                      v7.0
   Platform           Fix Pack 7.0.1.1
   --------           --------------------
   Windows            U200310
   AIX                U827232
   HP-UX (PA-RISC)    U826485
   HP-UX (Itanium)    U826884
   Solaris (SPARC)    U827125
   Solaris (x86-64)   U827374
   iSeries            tbc_p700_0_1_1
   Linux (x86)        U826321
   Linux (x86-64)     U827231
   Linux (zSeries)    U827105
   Linux (Power)      U826779
   
   The latest available maintenance can be obtained from
   'WebSphere MQ Recommended Fixes'
   http://www-1.ibm.com/support/docview.wss?rs=171&uid=swg27006037 [http://www-1.ibm.com/support/docview.wss?rs=171&uid=swg27006037]
   
   If the maintenance level is not yet available, information on
   its planned availability can be found in 'WebSphere MQ
   Planned Maintenance Release Dates'
   http://www-1.ibm.com/support/docview.wss?rs=171&uid=swg27006309 [http://www-1.ibm.com/support/docview.wss?rs=171&uid=swg27006309]
   ---------------------------------------------------------------
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IZ60328
   
   
 * REPORTED COMPONENT NAME
   WMQ AIX V7
   
   
 * REPORTED COMPONENT ID
   5724H7221
   
   
 * REPORTED RELEASE
   700
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2009-09-09
   
   
 * CLOSED DATE
   2009-10-26
   
   
 * LAST MODIFIED DATE
   2009-12-01
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WMQ AIX V7
   
   
 * FIXED COMPONENT ID
   5724H7221
   
   

APPLICABLE COMPONENT LEVELS
 * R700 PSY
   UP