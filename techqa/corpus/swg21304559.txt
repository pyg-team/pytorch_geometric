Title: IBM Process to get a thread dump or javacore during server shutdown - United States

Text:
 TECHNOTE (FAQ)

QUESTION
 How can I get a thread dump or javacore at server shutdown? 

CAUSE
There are many different situations where it could be useful to have a thread dump during server shutdown.

The following are examples: 

 * Server shutdown because nodeagent stopped the hung server.
   
   
 * Server shutdown by calling System.exit() from application code running in server.
   
   
 * Sporadic server shutdown.

ANSWER
A new diagnostic was added in IBM WebSphere Application Server V5.1.1.16, V6.0.2.23, and V6.1.0.11 and higher, to trigger a javacore/thread dump during server shutdown.

This feature is disabled by default and can be enabled by adding a system property as described in the following document.

Once this property is set, a thread dump will be triggered during server shutdown. For platforms where an IBM Software Development Kit is used, a javacore will be generated in the working directory of the application server. For all other platforms, a thread dump will be written to the native_stdout.log (Solaris/HP thread dumps are written out to the native_stdout.log as well as verbosegc).file for the application server. In addition to the thread dump, the stack trace of the current thread that is processing shutdown will be printed in the SystemErr.log for the application server.

For WebSphere Application Server V6.0 and higher: 

 1. Open the administrative console.
    
    
 2. Select Servers > Application Servers > server_name > Server Infrastructure > Java and Process Management > Process Definition > Java Virtual Machine > Custom Properties > New.
    
    
 3. Add a new Custom Property for the JVM:
    
    System Property Name: com.ibm.ws.runtime.dumpShutdown
    System Property Value: true
    
    
 4. Save your changes and restart the Application Server.


For WebSphere Application Server V5.1:  1. Open the administrative console.
    
    
 2. Select Servers > Application Servers > server_name > Process Definition > Java Virtual Machine > Custom Properties > New.
    
    
 3. Add a new Custom Property for the JVM:
    
    System Property Name: com.ibm.ws.runtime.dumpShutdown
    System Property Value: true
    
    
 4. Save your changes and restart the Application Server.