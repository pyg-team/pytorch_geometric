Title: IBM How to set up multiple Host On-Demand Servers on z/OS - United States

Text:
Multiple HOD servers; HOD; zOS; HOD 10; HOD 11 TECHNOTE (FAQ)

QUESTION
 How do you set up more than one IBM Rational Host On-Demand Server on a z/OS system? 

CAUSE
The z/OS platform is the only platform that will allow more than one Host On-Demand server to run simultaneously. The different versions of the product are installed in separate SMP/E zones and Hierarchical File Systems (HFS). 

ANSWER
To have more than one Service Manager active on the z/OS system, you need to have the following: 

 * A started task and unique ports for each server 
 * The Web Server configuration file (/etc/httpd.conf), the ServiceManager.sh shell script, the NSMprop and config.properties.ascii files need to be modified. 
   

Note: For this example, the mount points for the Host On-Demand 10 and Host On-Demand 11 HFSs are /usr/lpp/HOD/hod10 and /usr/lpp/HOD/hod11 respectively. 


1. Create a started task for each Service Manager and modify the path of the ServiceManager.sh in each.

///HODSRVA PROC ERRFILE='/tmp/homserv-stderr-hod10',
// OUTFILE='/tmp/homserv-stout-hod10',
// INSTLIB='/usr/lpp/HOD/hod10'
//*
//HODSRV EXEC PGM=BPXBATCH,REGION=0K,TIME=NOLIMIT,
// PARM='sh cd &INSTLIB/hostondemand/private; ./ServiceManager.sh'
//*
//*********************************************************************
//SYSPRINT DD SYSOUT=T 
//SYSIN DD DUMMY
//SYSERR DD SYSOUT=T 
//STDOUT DD PATH='&OUTFILE', 
// PATHOPTS=(OWRONLY,OCREAT,OTRUNC), 
// PATHMODE=SIRWXU 
//STDERR DD PATH='&ERRFILE', 
// PATHOPTS=(OWRONLY,OCREAT,OTRUNC), 
// PATHMODE=SIRWXU 
//SYSOUT DD SYSOUT=* 

---------------------------------------------------------------------

//HODSRVB PROC ERRFILE='/tmp/homserv-stderr-hod11', 
// OUTFILE='/tmp/homserv-stdout-hod11', 
// INSTLIB='/usr/lpp/HOD/hod11' 
//* //HODSRV EXEC PGM=BPXBATCH,REGION=0K,TIME=NOLIMIT, // PARM='sh cd &INSTLIB/hostondemand/private; ./ServiceManager.sh'
//* //*********************************************************************
//SYSPRINT DD SYSOUT=T 
//SYSIN DD DUMMY
//SYSERR DD SYSOUT=T
//STDOUT DD PATH='&OUTFILE',
// PATHOPTS=(OWRONLY,OCREAT,OTRUNC),
// PATHMODE=SIRWXU
//STDERR DD PATH='&ERRFILE',
// PATHOPTS=(OWRONLY,OCREAT,OTRUNC),
// PATHMODE=SIRWXU
//SYSOUT DD SYSOUT=* 

2. Determine the port for each Service Manager. 

In this example, Host On-Demand V10 uses port 8999 and Host On-Demand V11 uses port 8989. 
Since port 8999 is the default port, only the server for Host On-Demand V11 needs to have the port modifications. 
 * For the Server, modify /usr/lpp/HOD/hod11/hostondemand/private/NSMprop to specify port 8989.
   
   CONFIGSERVER_PARMS = %INSTALL_PATH% 8989
   
   
 * For the clients, create a config.properties.ascii file on an ASCII machine (or use an ASCII editor on z/OS) with the following contents:
   
   ConfigServerPort = 8989


FTP config.properties.ascii in binary to the publish directory of the Host On-Demand V11 server, in this example, /usr/lpp/HOD/hod11/hostondemand/HOD.  * 

3. Modify the pass rules in the /etc/httpd.conf file to allow for both versions of Host On-Demand. 

In this example, Host On-Demand 10 is accessed with the alias /hod10/ and Host On-Demand V11 is accessed with the alias /hod11/. 
# HOD V10
Pass /hod10/*.css /usr/lpp/HOD/hod10/hostondemand/HOD/*.css.ascii
Pass /hod10/*.jnlp /usr/lpp/HOD/hod10/hostondemand/HOD/*.jnlp.ascii
Pass /hod10/*.html /usr/lpp/HOD/hod10/hostondemand/HOD/*.html.ascii
Pass /hod10/*.HTML /usr/lpp/HOD/hod10/hostondemand/HOD/*.HTML.ascii
Pass /hod10/*.js /usr/lpp/HOD/hod10/hostondemand/HOD/*.js.ascii
Pass /hod10/*.properties /usr/lpp/HOD/hod10/hostondemand/HOD/*.properties.ascii
Pass /hod10/*.props /usr/lpp/HOD/hod10/hostondemand/HOD/*.props.ascii
Pass /hod10/* /usr/lpp/HOD/hod10/hostondemand/HOD/*

# HOD V11
Pass /hod11/*.css /usr/lpp/HOD/hod11/hostondemand/HOD/*.css.ascii
Pass /hod11/*.jnlp /usr/lpp/HOD/hod11/hostondemand/HOD/*.jnlp.ascii
Pass /hod11/*.html /usr/lpp/HOD/hod11/hostondemand/HOD/*.html.ascii
Pass /hod11/*.HTML /usr/lpp/HOD/hod11/hostondemand/HOD/*.HTML.ascii
Pass /hod11/*.js /usr/lpp/HOD/hod11/hostondemand/HOD/*.js.ascii
Pass /hod11/*.properties /usr/lpp/HOD/hod11/hostondemand/HOD/*.properties.ascii
Pass /hod11/*.props /usr/lpp/HOD/hod11/hostondemand/HOD/*.props.ascii
Pass /hod11/* /usr/lpp/HOD/hod11/hostondemand/HOD/*

After making modifications to /etc/httpd.conf, you will need to stop, then start the Web Server. 


4. Modify setInstPath.sh found in the install directory.

In this example, /usr/lpp/HOD/hod10 and /usr/lpp/HOD/hod11 

Set the install path and publish directory path in this script. 
This will set the correct path in the ServiceManager.sh shell script.

In setInstPath.sh for Host On-Demand V10: 
HOD_INST_DIR=/usr/lpp/HOD/hod10
MY_PUBLISHED_DIRECTORY=/usr/lpp/HOD/hod10/hostondemand/HOD

In setInstPath.sh for Host On-Demand V11: 
HOD_INST_DIR=/usr/lpp/HOD/hod11
MY_PUBLISHED_DIRECTORY=/usr/lpp/HOD/hod11/hostondemand/HOD


5. Start both tasks created in step 1. 

Both servers will start. 


 * To access the Host On-Demand V10 server, the client would enter in the URL address of his Web browser:
   
   http://"server name"/hod10/"pagename.html" 
 * To access the Host On-Demand V11 server, the client would enter in the URL address of his Web browser:
   
   http://"server name"/hod11/"pagename.html"





Cross reference information Segment Product Component Platform Version Edition Networking WebSphere Host On-Demand General OS/390, z/OS 10.0, 11.0