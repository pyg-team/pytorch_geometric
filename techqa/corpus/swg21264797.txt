Title: IBM Unable to raise the VOB Family Feature Level - United States

Text:
ClearCase MultiSite; --; AIX; Linux; Solaris; Windows; 2003.06.00; 2003.06.01; 2003.06.10; 2003.06.12; 2003.06.13; 2003.06.14; 2003.06.15; 2003.06.16; 7.0; 7.0.0.1; 1264797; not valid while VOB feature level is less than 2 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 This technote explains why the error, cleartool: Error: Name "<some-element-type>" already exists. cleartool: Error: Unable to raise the VOB family feature level - error detected by ClearCase subsystem, might occur when performing an IBM® Rational® ClearCase MultiSite® cleartool chflevel command. 

SYMPTOM
 

Attempts to run the cleartool chflevel command to raise the feature level of a VOB results in any one of the errors listed below:

Scenario 1:
cleartool chflevel -force -family 4 \VOB_TAG

cleartool: Error: Name "ms_word" already exists.
cleartool: Error: Unable to raise the VOB family feature level - error detected by ClearCase subsystem 

 

Scenario 2: 

Attempting to raise the feature level on a VOB after upgrading the VOB server from ClearCase 3.x to 4.x or greater: 

cleartool chflevel -force -override -family 2 vob:/vobs/FSAN/bw_mgt

cleartool: Error: Name "rose" already exists.
cleartool: Error: Unable to raise the VOB family feature level - error detected by ClearCase subsystem 

 

Scenario 3: 

Attempting to raise the feature level of a family of a replicated VOB:

cleartool chflevel -family 2 vob:.
cleartool: Error: Name "ms_word" already exists.
cleartool: Error: Unable to raise the VOB family feature level - error
detected by ClearCase subsystem.

CAUSE
 

When a feature level 1 VOB is upgraded to feature level 2 or greater, ClearCase attempts to create new element types xml, html, rose and ms_word. When you run the chflevel command, ClearCase performs a check for these element types and will fail if an element type by that same name already exists in the VOB. This may have been the result of add-on packages that added this type manager (either by third party or added manually). 

Note: This can occur for different types as seen in the errors listed in the above symptoms, however, the resolution steps are the same only differing by the name of the element type.



DIAGNOSING THE PROBLEM
 

The steps below refer to the ms_word element type, however, the same steps can be used to resolve any of the symptoms listed above by simply replacing the ms_word element type name with the element type listed in the error message.


 * Check the VOB where you issued the chflevel command to determine if the element type reported in the error message (ms_word, rose,...) already exists:
   
   cleartool lstype -kind eltype
   
   NOTE: You should see an ms_word element type that was NOT created by chflevel. 
   
    * Here is an example of an ms_word custom element type that a user manually created which may be causing the conflict:
      element type "ms_word"
      2008-01-09T17:46:05-05 by User1 (user1.user@HOST-I)
      master replica: original@\dmm
      owner: DOMAIN1\user1
      group: DOMAIN1\user
      scope: this VOB (ordinary type)
      type manager: whole_copy (inherited from type "file")
      supertype: file
      meta-type of element: file element
      
      
    * Here is an example of the ms_word element type that was created in a VOB with a higher feature level or as a result of changing the VOB feature level (chlevel). 
      
      The comment "Predefined element type..." in the output below indicates that this element type was created by a ClearCase operation and is not a manually created type.
      
      element type "ms_word"
      2007-08-27T16:33:25-04 by User1 (user1.user@HOST-I)
      "Predefined element type used to represent a Microsoft Word document."
      master replica: original@\dmm
      owner: DOMAIN1\user1
      group: DOMAIN1\user
      scope: this VOB (ordinary type)
      type manager: _ms_word
      supertype: file
      meta-type of element: file element 
   
   

RESOLVING THE PROBLEM
 


Follow the steps below to resolve the problem:


 1. Rename the element type reported in the error message to something like oldname_old.
    
    Examples:
    cleartool rename eltype:MS_Word eltype:MS_Word_old
    cleartool rename eltype:rose eltype:rose_old
    cleartool rename eltype:xml eltype:xml_old
    cleartool rename eltype:html eltype:html_old
    
    If you encounter an error similar to the following during the rename, contact IBM Rational Support for the steps to resolve the issue.
    
    cleartool rename eltype:"xml" eltype:"xml_different" 
    cleartool: Error: Operation "rename global type" not valid while VOB feature level is less than 2.
    cleartool: Error: Unable to rename element type from "xml" to "xml_different". 
    
    
 2. Rerun the chflevel [http://publib.boulder.ibm.com/infocenter/cchelp/v7r0m0/topic/com.ibm.rational.clearcase.cc_ref.doc/topics/ct_chflevel.htm]command. 
    
    cleartool chflevel -family 4 vob:<vob tag>
    
    
 3. You then need to associate all elements in the VOB with the Feature Level 4 new-type (ms_word, rose, ...) element type that is now the predefined element type in the VOB. In the below example, changing the element type on all the files that are of this feature level 1 type is done from the root of the VOB:
    
    cleartool find -all -element "eltype(<old-type>)" -print -exec 'cleartool chtype <new-type> $CLEARCASE_PN' 
    



Review the ClearCase Command Reference Guide on the topic of [http://publib.boulder.ibm.com/infocenter/cchelp/v7r0m0/topic/com.ibm.rational.clearcase.cc_ref.doc/topics/ct_chflevel.htm] chtype [http://publib.boulder.ibm.com/infocenter/cchelp/v7r0m1/topic/com.ibm.rational.clearcase.cc_ref.doc/topics/ct_chtype.htm](cleartool man chtype) for more information. 

RELATED INFORMATION
#About feature levels and ClearCase [http://www.ibm.com/support/docview.wss?uid=swg21119269]