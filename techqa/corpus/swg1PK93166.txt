Title: IBM PK93166: Fix that Portal UI is unavailable when customization domain is u navailable - United States

Text:
  FIXES ARE AVAILABLE
6.1.0.3 Download: WebSphere Portal and WCM V6.1 fix pack 3, 6.1.5 feature pack [http://www-01.ibm.com/support/docview.wss?uid=swg24025054]
6.1.0.4 Download: WebSphere Portal and WCM V6.1.0 fix pack 4 & 6.1.5 fix pack 1 [http://www-01.ibm.com/support/docview.wss?uid=swg24026394]
6.1.0.5 Download: WebSphere Portal and WCM V6.1.0 fix pack 5 [http://www-01.ibm.com/support/docview.wss?uid=swg24027475]
6.1.0.6 Download: WebSphere Portal and WCM V6.1.0 fix pack 6 [http://www-01.ibm.com/support/docview.wss?uid=swg24030970]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  If the customization domain is unavailable the Portal UI is
   currently also unavailable.  WebSphere Portal should still run
   if the customization domain is unavailable.
   
   
   Tracing with:
   
   com.ibm.wps.engine.*=all:com.ibm.wps.ac.*=all:com.ibm.wps.datast
   ore.*=all
   
   can help identify the problem.  The trace.log will contain
   errors like:
   
   ... DataStoreCont E com.ibm.wps.datastore.impl.DataStoreContext
   handleException EJPDB0001E: Error occurred during database
   access. Last SQL statement is [SELECT OID, CREATED, MODIFIED,
   RES_TYPE, EXTERNAL_OID, EXTERNAL_UID, PARENT_OID, OWNER_TYPE,
   OWNER_UID, INHERITANCE, PROPAGATION, EXTERNALIZED, IS_PRIVATE,
   NAME, IS_LEAF FROM customization.PROT_RES WHERE (OWNER_UID = ?
   AND RES_TYPE = ?)].
   
   com.ibm.wps.datastore.domains.DomainUnavailableException:
   EJPDB0101E: Database domain [Domain: cust] is currently
   unavailable.
    at
   com.ibm.wps.datastore.impl.DataStoreContext.handleException(Data
   StoreContext.java:315)
   ...
    at
   com.ibm.wps.ac.impl.AccessControlImpl.checkEntitlements(AccessCo
   ntrolImpl.java:119)
   ...
   Caused by: com.ibm.websphere.ce.cm.ObjectClosedException:
   DSRA9110E: Connection is closed.
   ...
   ... AccessControl < com.ibm.wps.ac.impl.AccessControlImpl
   [Domain: cust].checkEntitlements RETURN null
   ...
   ... WPRenderPhase 2 com.ibm.wps.engine.phases.WPRenderPhase
   getThemeTemplate(aState, aStateManager) Navigation selection
   model: <?xml version="1.0" encoding="UTF-8"?>
   ...
   <selectedNode value="null"/>
   ...
   ... Servlet       E com.ibm.wps.engine.Servlet handleException
   EJPEJ0069E: URL parsing problem, URL= http://... [http://...]
   ... Servlet       1 com.ibm.wps.engine.Servlet handleException
   An exception occurred while processing the request.
   
   com.ibm.portal.state.phases.exceptions.PhaseException:EJPEI0105E
   : An error occurred during the rendering in phase
   com.ibm.wps.engine.phases.WPRenderPhase@153b153b.
   ...
   Caused by: java.lang.NullPointerException
    at
   com.ibm.wps.engine.phases.WPRenderPhase.getThemeTemplate(WPRende
   rPhase.java:128)
   
   
   
   The exact cause of the database communications failure may
   differ from this example, but the results will be the same.
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  If the customization domain is unavailable the Portal UI is
   currently also unavailable.  WebSphere Portal should still run
   if the customization domain is unavailable.
   
   
    
   
   

PROBLEM CONCLUSION
 *  The DomainUnavailableExection is caught now for the
   customization domain in the ContenModel and related classes.
   
   Manual Steps:
      None
   
   Failing Module(s):
      Engine: Tags & Commands
   
   Affected Users:
      All users
   
   Version Information:
       Portal Version(s): 6.0.1.5
        Pre-Requisite(s): PK89122 [http://www-01.ibm.com/support/docview.wss?uid=swg1PK89122]
         Co-Requisite(s): ---
   
       Portal Version(s): 6.0.1.6
        Pre-Requisite(s): PK89122 [http://www-01.ibm.com/support/docview.wss?uid=swg1PK89122]
         Co-Requisite(s): ---
   
       Portal Version(s): 6.1.0.1
        Pre-Requisite(s): PK84208 [http://www-01.ibm.com/support/docview.wss?uid=swg1PK84208] PK86209 [http://www-01.ibm.com/support/docview.wss?uid=swg1PK86209]
         Co-Requisite(s): ---
   
       Portal Version(s): 6.1.0.2
        Pre-Requisite(s): PK86209 [http://www-01.ibm.com/support/docview.wss?uid=swg1PK86209]
         Co-Requisite(s): ---
   
   Platform Specific:
      This fix applies to all platforms.
   
   A fix is available from Fix Central:
   
   http://www.ibm.com/eserver/support/fixes/fixcentral/swgquickorde
   r?apar=PK93166&productid=WebSphere%20Portal&brandid=5 [http://www.ibm.com/eserver/support/fixes/fixcentral/swgquickorder?apar=PK93166&productid=WebSphere%20Portal&brandid=5]
   
   You may need to type or paste the complete address into your Web
   browser.
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PK93166
   
   
 * REPORTED COMPONENT NAME
   WEBSPHERE PORTA
   
   
 * REPORTED COMPONENT ID
   5724E7600
   
   
 * REPORTED RELEASE
   61A
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2009-08-05
   
   
 * CLOSED DATE
   2009-10-07
   
   
 * LAST MODIFIED DATE
   2010-01-28
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WEBSPHERE PORTA
   
   
 * FIXED COMPONENT ID
   5724E7600
   
   

APPLICABLE COMPONENT LEVELS
 * R60J PSY
   UP
   
   
 * R60K PSY
   UP
   
   
 * R61A PSY
   UP
   
   
 * R61B PSY
   UP