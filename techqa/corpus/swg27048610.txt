Title: IBM PureApplication Software Release Note: Networking for a classic virtual system instance stops working after an upgrade to PureApplication Software 2.2.2 - United States

Text:
sw2220rlsnotes RELEASE NOTES

ABSTRACT
 After you upgrade to PureApplicationÂ® System 2.2.2, networking stops working for some classic virtual system instances. 

CONTENT
Problem: Networking stops working for some classic virtual system instances after an upgrade to PureApplication Software 2.2.2.




Specifically, this issue was observed with the following classic virtual system patterns: IBM BPM 8.0.1, IBM BPM 8.5.0.1, and ODM 5.0.1. One common component among the affected patterns is that they are classic virtual system patterns that use Red Hat Enterprise Linux 6 X64. 


Resolution: If possible, upgrade to newer versions of the pattern before you upgrade to PureApplication Software 2.2.2. 

If migrating to a newer version of the pattern before you upgrade is not possible and this issue occurs, you can use the following workaround for existing instances. 

These steps update the virtual machines (VMs) in the instance with a newer NIC type (vmxnet3) to work around the issue:
1. Stop the instance.
2. For each virtual machine in the instance, locate the VM ID. 

 * 
 * 
 * https://
 * <pureapp>
 * /systemconsole/cloud/virtual-machines/?searchString=ipas-lpar-024-017-ODM_DMGR-ODM%20801%20TEST-16#
 * 8e676e55-eed3-488d-9c26-d641c1e70248
 * 
 * 
 * <pureapp>
 * 
 * In the preceding example URL, the VM ID is: 8e676e55-eed3-488d-9c26-d641c1e70248

3. Now a PUT needs to be done to the following URL:  * https://
 * <pureapp>
 * /deployment/resources/instances/
 * <vmId>
 * 
 * 
 * <pureapp>
 * 
 * <vmId>
 * 
 * For example: https://<pureapp>/deployment/resources/instances/8e676e55-eed3-488d-9c26-d641c1e70248 (where <pureapp> is the IP address for host name for your PureApplication Software environment) 
 * The .json contents of the PUT should be:
   { "options" : { "replacevmnics" : "Vmxnet3" } }

4. Repeat steps 2 & 3 for all VMs in the instance. 
5. Start the instance. 

Use the following separate workaround if you want to deploy a new instance of a pattern that is known to have this issue. As previously stated, the preferred option is to use a newer version of the pattern. If using a newer version is not possible and you experience the issue, use the following workaround: 

1. Look up the image on the system with the REST API: /deployment/resources/images/vmtype=virtualimage 
 * 
 *  IBM BPM 801 - image name: IBM Business Process Manager Advanced 8.0.1.0 RHEL 6 x64 (VMware) IBM BPM 8501 - image name: IBM Business Process Manager Advanced 8.5.0.1 RHEL 6 x64 (VMware) ODM 801 - image name: IBM Operational Decision Manager 8.0.1 RHEL 6 x64 (VMware) 

2. After you find the image, look for the id field. For example:  * "id": "/deployment/resources/images/5235d2b9-95c4-4e42-8b2c-99f458c232e5",

3. Do a GET on the image with /deployment/resources/images/ <image_id> (where <image_idvmid> is the image ID that you retrieved in the previous step).  * 
 * 
 * /deployment/resources/images/5235d2b9-95c4-4e42-8b2c-99f458c232e5

4. Copy all the options from the image, and then do a PUT on the image with the existing options, plus this extra option: "PureAppOverride.nicType": "Vmxnet3" ,  * The full .json for the 
 * PUT
 * would be similar to the following example:
 * 
 * {
   "options":{
   "PureAppOverride.nicType": "Vmxnet3",
   "VirtualSystemType":"vmx-04",
   "ovf-env.boolean.ConfigODM.1.autostart": "true",
   "ovf-env.boolean.ConfigODM.1.dmgr_federate": "",
   "ovf-env.boolean.ConfigODM.1.wodm_db_connect": "",
   "ovf-env.boolean.ConfigODM.1.wodm_db_hadr": "" 
   }
   }


After you complete these steps, subsequent deployments of the pattern that use the image will override the nictype in the image and use vmxnet3 instead.