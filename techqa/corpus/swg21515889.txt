Title: IBM Cognos services failing to start with 'Connection Refused' errors, though the DB2 services are running - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Getting error 'Connection Refused' in cogserver.log file, though the DB2 services are running, hence Cognos Service failing to start. 

SYMPTOM
Cogserver.log was having errors as below 

DPR-CMI-4006 Unable to determine the active Content Manager
DPR-CMI-4007 A request to perform an active content manager election failed
CM-SYS-5003 Content Manager is unable to access the content store. Verify your database connection parameters, and then contact your database administrator for assistance
Error opening socket to server /<Server_IP>on port <Database_Port> with message: Connection refused. ERRORCODE=-4499, SQLSTATE=08001


CAUSE
The port on which DB2 services were running was not matching with what has been mentioned in IBM Cognos Configuration.


ENVIRONMENT
Unix



DIAGNOSING THE PROBLEM
1. Check if DB2 services are up and running.
2. Check if there is any error in cogserver.log pertaining to DB2 port number.



RESOLVING THE PROBLEM
Steps to resolve the issue:- 

1. Go to server on which Content store database is setup on DB2 and login with db2admin user or with DB2 administrative credentials. 

2. Check if DB2 parameter DB2COMM is set to 'tcpip' and DB2 service name parameter SVCENAME has been set by executing command 'db2 get dbm cfg'. Note the DB2 service name which is set for parameter SVCENAME. 

3. Using the DB2 service name obtained from above command output execute command 'more /etc/services' and find out against which port the DB2 service is registered and running. You may need root login privileges. 

4. Check if the port number obtained in above step match with the one mentioned in IBM Cognos Configuration. If it does not match change the port number in IBM Cognos configuration. Save the changes and Test if the connection to Content store database is successful. 

If you have deployed Cognos on Application server other then Default Tomcat for example Websphere/Weblogic/Oracle Application Server etc you will need to rebuild and redeploy p2pd.ear file. 

5. Start Cognos services.