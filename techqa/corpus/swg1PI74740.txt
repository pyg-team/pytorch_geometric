Title: IBM PI74740: PROBLEM USING EXTERNAL STORED PROCEDURE AND JDBC - United States

Text:
z/os  A FIX IS AVAILABLE
Obtain the fix for this APAR.


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  Hello,
   we have an external Cobol stored procedure. Using Cobol to call
   it all
   works fine. With JDBC we get the following error:
   "No stored procedure by the name of "CB.ZFP73SPR" having
   compatible
   arguments was found"
   Using SYSIBM.SQLPROCEDURECOLS to check columns/parameters of
   the stored
   procedure shows an additional parameter with COLUMN_TYPE 0 and
   DATA_TYPE 0 (see attached JOBLOG).
   The external stored procedure was created with DB2 V8. A
   DROP/CREATE of
   the procedure in V10&V11 solved the problem.
   
   
    
   
   

LOCAL FIX
 *  n/a
   
   
    
   
   

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED: All users of DB2 10 for z/OS and DB2 11 for  *
   *                 z/OS of ODBC/CLI , IBM Data Server Driver    *
   *                 for JDBC and SQLJ, or IBM Data Server        *
   *                 Driver for ODBC and CLI that connect to      *
   *                 DB2 10 for z/OS or DB2 11 for z/OS.          *
   ****************************************************************
   * PROBLEM DESCRIPTION: SYSIBM.SQLPROCEDURECOLS returned extra  *
   *                      row if the external procedure was       *
   *                      created prior to DB2 9 NFM and then     *
   *                      DB2 system was migrated to DB2 10 z/OS  *
   ****************************************************************
   * RECOMMENDATION:                                              *
   ****************************************************************
   When an external procedure with n parameters was created prior
   to version 9 NFM and then the DB2 system was migrated to DB2
   10 z/OS, DB2 metadata store procedure SYSIBM.SQLPROCEDURECOLS
   should return n rows in the resultset. Instead, it may return
   n + 1 rows. The extra row returned has a COLUMN_NAME of "",
   DATA_TYPE of 0, and COLUMN_TYPE of 0 .
   
   For example a JDBC client tried to find an existing procedure
   "SCH1.PROC1" in the current DB2 version 10 system, where the
   procedure was created on DB2 8 z/OS with 2 VARCHAR
   parameters and a PARAMETER VARCHAR clause specified.
   Because of the extra row, SYSIBM.SQLPROCEDURECOLS cannot
   find a matching procedure with name "SCH1.PROC" and 2
   parameters. SYSIBM.SQLPROCEDURECOLS would return the following
   error message:
   
     No stored procedure by the name of "SH1.PROC1"
     having compatible arguments was found
   
   
    
   
   

PROBLEM CONCLUSION
 *  The extra row is removed and correct resultset is returned
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PI74740
   
   
 * REPORTED COMPONENT NAME
   DB2 OS/390 & Z/
   
   
 * REPORTED COMPONENT ID
   5740XYR00
   
   
 * REPORTED RELEASE
   B10
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt / Xsystem
   
   
 * SUBMITTED DATE
   2017-01-11
   
   
 * CLOSED DATE
   2017-02-25
   
   
 * LAST MODIFIED DATE
   2017-10-17
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
    UI45040 UI45041
   
   

MODULES/MACROS
 *  DSN@PCOU DSNAPCOU
   
   
    
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   DB2 OS/390 & Z/
   
   
 * FIXED COMPONENT ID
   5740XYR00
   
   

APPLICABLE COMPONENT LEVELS
 * RA10 PSY UI45040 [HTTPS://WWW14.SOFTWARE.IBM.COM/WEBAPP/SET2/ORDERMEDIA/SHOPCART?PTFS=UI45040]
   UP17/03/14 P F703
   
   
 * RB10 PSY UI45041 [HTTPS://WWW14.SOFTWARE.IBM.COM/WEBAPP/SET2/ORDERMEDIA/SHOPCART?PTFS=UI45041]
   UP17/03/14 P F703
   
   

FIX IS AVAILABLE
 * SELECT THE PTF APPROPRIATE FOR YOUR COMPONENT LEVEL. YOU WILL BE REQUIRED TO SIGN IN. DISTRIBUTION ON PHYSICAL MEDIA IS NOT AVAILABLE IN ALL COUNTRIES.