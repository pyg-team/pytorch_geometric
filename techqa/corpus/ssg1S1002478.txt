Title: IBM Update drive firmware via the AS/400 host. - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 3580, 3581, 3582, 3583, 3584, TS3310 Drive Firmware - AS/400 

CAUSE
Unable to update LTO Drive Firmware via SCSI/Fibre from the AS/400

RESOLVING THE PROBLEM
PRIMARY PROCEDURE - ITDT 

Enablement to update drive firmware via SCSI/Fibre from the AS/400 on the i5/OS Version V5R3, V5R4, V6R1, etc. 

Download and Install the IBM TotalStorage Tape Diagnostic Tool (ITDT) from the website listed under Related Information below. Make sure to read the README file first to see which versions of OS this tool supports. 

 

SECONDARY Procedure - QTAUPDDV API 

Enablement to update drive firmware via SCSI/Fibre from the AS/400 on all versions of i5/OS:

Prerequisites:
PTF’s for update device microcode (QTAUPDDV) api. 
V5R1 – SI15198; SI15185, MF33985 
V5R2 – SI15200; SI15183, MF33986 
V5R3 – SI15201; SI15182, MF33989
V5R4 - None

QTAUPDDV api does not support the 6501 IOP.

Steps to loading firmware:

1. Finding microcode for your device. 
Save the latest release of drive firmware image (Windows Zip file) to your
PC. Unzip the firmware file image that was downloaded, so that the
XXXXLYT.ro is available. Copy the firmware image from your PC to the
iSeries Integrated File System (IFS). FTP'ing the file to a directory on the
AS/400 is the preferred method. Make sure that the firmware image is sent
as a (BIN) transfer. In addition iSeries Access for Windows can be used to
transfer the file from the PC to the AS/400.

How to FTP:
From a Command Prompt window on your PC.

1. CD (change directory) to the directory/location of the XXXXLYT.ro file on your PC. 
ex: C:\> cd temp\downloads

2. FTP XXXXXX - (XXXXXX = system name) - enter user name and password when prompted. 
ex: C:\temp\downloads> FTP exSystem

3. PWD - to list the present working directory and see where you are at. 
ex: ftp> pwd 
"QGPL" is current library.

Note: If you did a "cd" command while logged in this FTP session prior to going to the next step, step 4, and received a "501 File must be specified by library/file.member." error message, issue the following command to be able to get in to the Integrated File System, 
ex: ftp> quote site namefmt 1

4. CD - to the directory/location on the iSeries where you want to put the .ro file. 
ex: ftp> cd /usr/exDir

5. type bin - to transfer the file in binary. 
ex: ftp> bin

6. type put - to transfer the .ro file. 
ex: ftp> put 4561L1S.ro

7. exit FTP 
ex: ftp> quit 

2. Using the QTAUPDDV api. 
Before using QTAUPDV api, make sure the tape drive is VARIED ON as a stand alone device.
Type the following command at the OS/400 MAIN MENU:
WKRCFGSTS *DEV *TAP

Type the following command at the OS/400 MAIN MENU:
CALL QTAUPDDV (TAPYY ‘/DIR/XXXXLYT.ro’) 
Be sure to include the spaces.

/DIR/ indicates the directory where the firmware image resides.
YY indicates the TAP device number.
XXXX indicates the firmware image version.
Y indicates the drive generation (1 for Ultrium 1, 2 for Ultrium 2)
T indicates connection type (F for fibre channel, S for SCSI)

3. What to expect: 
X SYSTEM: Gives status for about 4 minutes. During the code load tape drive LED will flash, once download is complete tape drive will reboot. AS/400 will come back, after it has set a reserve to the tape drive.

4. Code load confirmation: 
Confirm code load from front panel of the device. For the 3580 attachment note the display at the drive boot up.


 






Trouble Shooting:  * 
 *   * Verify that the tape drive is varied on, as a stand alone device. 
    * If the firmware image was FTP'ed to the AS/400, verify that binary (BIN) transfer was performed. 
    * Ensure that there is no cartridge in the tape drive. 
    * Verify that the proper firmware image is being used, which matches the tape drive type, ie. SCSI, Fibre, etc.. 
    * Check the web page with firmware download for any known issues for your tape drive. Some releases of firmware may require additional PTF's to work properly.
   
   

RELATED INFORMATION
 IBM Tape Diagnostic Tool (ITDT) - Legacy Products [http://www-1.ibm.com/support/docview.wss?rs=543&context=STCVQ6R&dc=D410&uid=ssg1S4000338&loc=en_US&cs=utf-8&lang=en]
IBM Tape Diagnostic Tool (ITDT) - Current Products [http://www-01.ibm.com/support/docview.wss?rs=1170&context=STCQNXV&dc=D410&uid=ssg1S4000662&loc=en_US&cs=utf-8&lang=en]


 

Cross reference information Segment Product Component Platform Version Edition Tape Storage Tape Drives 3580 Ultrium Tape Drive AS/400 Version Independent Standard Tape Storage 3581 Ultrium Tape Autoloader Not Applicable AS/400 Version Independent Standard Tape Storage 3581-2U Ultrium Tape Autoloader Not Applicable AS/400 Version Independent Standard Tape Storage Tape Libraries 3582 Ultrium Scalable Tape Library AS/400 Version Independent Standard Tape Storage Tape Libraries 3583 Ultrium Scalable Tape Library AS/400 Version Independent Standard Tape Storage Tape Libraries 3584 UltraScalable Tape Library AS/400 Version Independent Standard Tape Storage Tape Libraries TS3310 Tape Library Open Systems Version Independent Standard