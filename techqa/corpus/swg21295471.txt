Title: IBM High DNS traffic or slow performance on WebSphere Application Server for z/OS v5.1 and higher - United States

Text:
dns resolver cache localhost slow response TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Following the instructions in the Information Center for setting the Monitoring Ping Interval may not be enough to reduce DNS traffic in IBM WebSphere Application Server for z/OS V5.1 and higher. High DNS traffic is seen even though the Ping Intervals are set higher to reduce the amount of DNS lookups. A TCP/IP Resolver trace shows that the IP address and name for local hosts is being resolved by way of DNS lookup every time. Other symptoms could also include slow response from the admin console or other applications. 

CAUSE
Starting with Javaâ„¢ 1.4.1, the IP address is not cached by default. This can cause delays and performance degradation if the application relies on this caching mechanism, since a lookup is now performed each time. 

 
The WebSphere Application Server runtime code calls the InetAddress.getLocalHost() method in several places which then causes the DNS lookup requests. Applications making outbound calls would also trigger DNS lookup requests.


RESOLVING THE PROBLEM
The solution is to use the following JVM property 

 
com.ibm.cacheLocalHost=true

This will turn on the caching to change the behavior back to what it was prior to Java 1.4.1 so that a full network DNS lookup is not performed every time the method is called.

Java APAR PK19242 (shipped with Java SDK 1.4.2 service refresh SR 5) is required for this to work. 



To reduce network traffic for the local host lookup, code the following JVM property for all servers

com.ibm.cacheLocalHost=true 

You can set the JVM argument via the administrative console as follows: 

Application Servers:
Application Servers > servername > Process Definition > Control > 
JVM Properties > Custom Properties > New

Name: com.ibm.cacheLocalHost
Value: true


Application Servers > servername > Process Definition > Servant > 
JVM Properties > Custom Properties > New

Name: com.ibm.cacheLocalHost
Value: true


Nodeagent:
System administration > Node agents> nodeagent > Java and Process Management > Process Definition > Control > Java Virtual Machine > Custom Properties > New

Name: com.ibm.cacheLocalHost
Value: true

Deployment Manager:
System administration > Deployment Manager > Java and Process Management > Process Definition > Control > Java Virtual Machine > Custom Properties > New

Name: com.ibm.cacheLocalHost
Value: true


System administration > Deployment Manager > Java and Process Management > Process Definition > Servant > Java Virtual Machine > Custom Properties > New

Name: com.ibm.cacheLocalHost
Value: true





The following jython script can be used to automate the addition of this property to all servers in a cell. 
addCacheLocalHost.py [/support/docview.wss?uid=swg21295471&aid=2] [/support/docview.wss?uid=swg21295471&aid=1]


Change history
Last Updated: 17 May 2010 

 * 17 May 2010: Added the python script to automate the addition of the property

RELATED INFORMATION
 Another solution with similar symptoms [http://www.ibm.com/support/docview.wss?uid=swg21170467]