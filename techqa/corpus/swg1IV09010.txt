Title: IBM IV09010: IF DECIMAL=COMMA IS SET TO TRUE FOR DB2 ON Z/OS, THEN WSRR MIGHT FAIL TO START REPORTING SQLCODE=-405. - United States

Text:
  A FIX IS AVAILABLE
WebSphere Service Registry and Repository V7.5.0 Fix Pack 2. [http://www-01.ibm.com/support/docview.wss?uid=swg24031307]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  If decimal=comma is set to true for DB2 on z/OS,
   then WSRR will fail to start reporting the following in the log.
   .
   [9/21/11 11:52:15:925 CEST] 0000002e QueryRunner   E
   com.ibm.athene.query.QueryRunner executeQuery
   com.ibm.websphere.ce.cm.StaleConnectionException: DB2 SQL Error:
   SQLCODE=-405, SQLSTATE=42820,
   SQLERRMC=2551058603464369442,1352489085323873679, DRIVER=3.61.65
   
   
    
   
   

LOCAL FIX
 *  TBD
   
   
    
   
   

PROBLEM SUMMARY
 *  When DB2 for z/OS is configured to use a comma as the decimal
   point, WSRR might fail to start. The exception seen in the
   SystemOut.log contains the following messages and stack:
   
   QueryRunner   E com.ibm.athene.query.QueryRunner executeQuery
   com.ibm.websphere.ce.cm.StaleConnectionException: DB2 SQL Error:
   SQLCODE=-405, SQLSTATE=42820,
   SQLERRMC=2551058603464369442,1352489085323873679, DRIVER=3.61.65
       at
   com.ibm.ws.rsadapter.jdbc.WSJdbcUtil.handleStaleStatement(WSJdbc
   Util.java:849)
       at
   com.ibm.ws.rsadapter.AdapterUtil.mapException(AdapterUtil.java:2
   125)
       at
   com.ibm.ws.rsadapter.jdbc.WSJdbcUtil.mapException(WSJdbcUtil.jav
   a:1034)
       at
   com.ibm.ws.rsadapter.jdbc.WSJdbcPreparedStatement.executeQuery(W
   SJdbcPreparedStatement.java:734)
       at
   com.ibm.athene.query.TranslatedQuery.execute(TranslatedQuery.jav
   a:161)
       at
   com.ibm.athene.query.QueryRunner.executeQuery(QueryRunner.java:1
   24)
       at
   com.ibm.athene.TripleStoreImpl.query(TripleStoreImpl.java:1155)
       at
   com.ibm.athene.owl.impl.OntologyManagerImpl.executeSimpleQuery(O
   ntologyManagerImpl.java:158)
       at
   com.ibm.athene.owl.impl.ReadOnlySession.executeSimpleQuery(ReadO
   nlySession.java:152)
       at
   com.ibm.athene.owl.impl.ReadWriteSession.executeSimpleQuery(Read
   WriteSession.java:434)
       at
   com.ibm.athene.owl.types.OntologyInfo.getDeclaredPropertyIDs(Ont
   ologyInfo.java:698)
       at
   com.ibm.athene.owl.types.OntologyInfo.listKnownPropertyIDs(Ontol
   ogyInfo.java:641)
       at
   com.ibm.athene.owl.types.PropertyInfo.addSuperProperty(PropertyI
   nfo.java:495)
       at
   com.ibm.athene.owl.OwlLoader$ParsedOwl.processSuperProperty(OwlL
   oader.java:1414)
       at
   com.ibm.athene.owl.OwlLoader$ParsedOwl.processSuperProperties(Ow
   lLoader.java:1386)
       at
   com.ibm.athene.owl.OwlLoader$ParsedOwl.access$2(OwlLoader.java:1
   382)
       at com.ibm.athene.owl.OwlLoader.loadOwl(OwlLoader.java:459)
       at
   com.ibm.athene.owl.OwlLoader.loadOrUpdateOwlIfNewer(OwlLoader.ja
   va:886)
       at
   com.ibm.athene.owl.OwlLoader.loadOrUpdateOwlIfNewer(OwlLoader.ja
   va:922)
       at
   com.ibm.sr.athene.persistence.impl.PersistenceManagerImpl.loadCo
   mmonModels(PersistenceManagerImpl.java:1483)
       at
   com.ibm.serviceregistry.ServiceRegistryModelLoaderBean.loadCommo
   nModels(ServiceRegistryModelLoaderBean.java:138)
       at
   com.ibm.serviceregistry.EJSLocalStatelessServiceRegistryModelLoa
   der_d900632f.loadCommonModels(EJSLocalStatelessServiceRegistryMo
   delLoader_d900632f.java:28)
       at
   com.ibm.serviceregistry.ServiceRegistryStartupBeanBean.loadCommo
   nModels(ServiceRegistryStartupBeanBean.java:461)
       at
   com.ibm.serviceregistry.ServiceRegistryStartupBeanBean.start(Ser
   viceRegistryStartupBeanBean.java:194)
   
   followed by:
   
   loadCommonModels
   com.ibm.athene.owl.exception.OntologyProcessingException:
   ATN0616E: An unexpected exception occurred whilst querying for
   the list of owl:[Annotation|Datatype|Object]Property components
   declared within owl:Ontology
   http://www.ibm.com/xmlns/prod/websphere/repository/base [http://www.ibm.com/xmlns/prod/websphere/repository/base]
       at
   com.ibm.athene.owl.types.OntologyInfo.getDeclaredPropertyIDs(Ont
   ologyInfo.java:704)
   ...
   Caused by: com.ibm.athene.exception.TripleStoreException:
   ATN0203E: An Exception occurred whilst executing SQL Query
   representation of Triple Query ...
   ...
   Caused by: com.ibm.websphere.ce.cm.StaleConnectionException: DB2
   SQL Error: SQLCODE=-405, SQLSTATE=42820,
   SQLERRMC=2551058603464369442,1352489085323873679,
   DRIVER=<DB2_JDBC_DRIVER_VERSION>
   
   
    
   
   

PROBLEM CONCLUSION
 *  The WSRR code for translating queries into SQL would append a
   comma without a following space in some situations. This
   resulted in the DB2 errors given when comma is used as the
   decimal point character.
   
   The code has been updated to ensure a comma is always followed
   by a space when generating SQL.
   
   This fix is targeted for inclusion in fix pack 2 for WSRR v7.5.
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IV09010
   
   
 * REPORTED COMPONENT NAME
   SERVICE REGISTR
   
   
 * REPORTED COMPONENT ID
   5724N7200
   
   
 * REPORTED RELEASE
   750
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2011-10-10
   
   
 * CLOSED DATE
   2011-10-27
   
   
 * LAST MODIFIED DATE
   2011-10-27
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   SERVICE REGISTR
   
   
 * FIXED COMPONENT ID
   5724N7200
   
   

APPLICABLE COMPONENT LEVELS
 * R750 PSY
   UP