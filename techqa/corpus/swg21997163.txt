Title: IBM Issues related to upgrading from Sterling Secure Proxy V341x with Certicom toolkit to Sterling Secure Proxy V3420 and above with the IBM JSSE toolkit - United States

Text:
 TECHNOTE (FAQ)

QUESTION
 What are the issues when you upgrade from Sterling Secure Proxy (SSP) V341x to Sterling Secure Proxy V3420 and above? 

ANSWER
Here are the known issues that have been encountered with converting from Certicom to the IBM JSSE/JCS toolkit. 
1a) Private keys created by Certificate Wizard using SHA256 cannot be imported into the SSP CM due to 2 OIDs which are not handled by the IBM JSSE toolkit.
1b) Above private keys from pre-SSP3420 which were there before upgrade fail to load during the SSL handshake.

Fix: None, must use mitigations.

Mitigation: Convert key certificates to PKCS12 format prior to loading into the SSP CM. Can be done with Cert Wizard, OpenSSL, etc.
Mitigation: Before converting to SSP3420 or above, upgrade to SSP3418 iFix 8 Plus Build 107 or higher and run the SspCMCertConvertUtil tool to convert all the existing keys to PKCS12 before upgrading to SSP3420/3430.


2) Trusted certificate files in PKCS8/PEM format must not have any comments or blank lines in them when importing through the SSPCM into the trusted store.

Fix: RTC514315 in SSP3430 iFix 2, SSP3420 iFix 9

Mitigation: Remove blank lines and comment lines before and after BEGIN CERTIFICATE/END CERTIFICATE pairs.

3a) KeyUsage must adhere to the RFC and specify the intended usage.
3b) Server authentication requires the server to offer a certificate that specifies a KeyUsage of "Server" 
3c) Client Authentication requires the client to offer a certificate that specifies a KeyUsage of "Client" 

Fix: RTC519253 in SSP3420 iFix 2, SSP3420 iFix 9

Mitigation: Have clients get new certificates with the correct key usage of "Client" (or specify "Client" and "Server" in the same cert)
Workaround: Place the client's certificate directly in the trust store to establish a direct trust relationship

4) Connect:Direct netmaps updated to SSP3430 iFix 2 or SSP3420 iFix 9 may fail to find TLS security settings

Fix: RTC524219 in SSP3430 iFix 2+ Build 87, SSP3420 iFix 9+ Build 338

Mitigation: Re-save each Connect:Direct netmap which specifies any Security Setting other than "The PNode Host controls SSL protocol". Saving will convert the name from a pre-SSP3420 format.

5) Unable to dynamically turn on SSL tracing.

There is no fix or workaround for this issue. The product startup scripts must be updated to include Java directives and the product must be restarted to turn on the detailed SSL tracing. 

 * For UNIX: 
   Update the <SSP Engine>/bin/startEngine.sh script. On the 2 lines which include "jre/bin/java", add "-Djavax.net.debug=ssl,handshake,data,trustmanager" (without the "") before the "-DvendorFile=vendor.properties" parm. 
 * For Windows, 
   Update the <SSP Engine>\bin\SSPengine$.lax file and add the "-Djavax.net.debug=ssl,handshake,data,trustmanager" as an additional parm on the lax.nl.java.option.additional= line.

Bring the engine down and back up to turn on the tracing.