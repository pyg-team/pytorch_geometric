Title: IBM How to collect java thread dumps for InfoSphere Change Data Capture product - United States

Text:
java thread dumps; hang TECHNOTE (FAQ)

QUESTION
 How to collect java thread dumps for InfoSphere Change Data Capture product ? 

CAUSE
Java thread dumps are very helpful for diagnosing CDC's hanging issues. You will need to collect java threads dumps when the hanging behavior, occurs.

ANSWER
Steps: 

1) When the hang happens, run command ps -ef|grep dmts at CDC source or target side to get the CDC instance PID.
E.g. in my system, the output likes following:
.
[VIPBJ01SP02L32:root:/opt/cdc/cdc102ora]ps -ef|grep dmts
root 5505378 5963834 0 11:14:15 pts/3 0:39 /opt/cdc/cdc102ora/jre64/jre/
bin/dmts64-java -cp lib:lib/ts.jar:lib/activation.jar:lib/mail.jar:lib/pbembedde
d.jar:lib/pbclient.jar:lib/pbtools.jar:lib/cpci.jar:lib/api.jar:lib/commons-cli.
jar:lib/asm-all-3.1.jar:lib/jlog.jar:lib/CIoracle.jar -Xmx1024M -Xms704M -Xmine6
4M -XX:NewRatio=1 -Xgcpolicy:gencon -Xjit:exclude={com/pointbase/collxn/collxnIn
tToIntHashtableEnum.a()V} -Dcom.sun.management.jmxremote -Djava.ext.dirs=lib/use
r:jre64/jre/lib/ext -Dcom.datamirror.ts.instance=ora102 com.datamirror.ts.comman
dlinetools.script.Startup -I ora102
.
2) In <CDC installation dir>,run command kill -QUIT <CDC instance PID> at CDC source or target side.
There is java thread dump file(like 'javacore.*.txt') generated under <CDC installation dir>.
E.g. in my system:
[VIPBJ01SP02L32:root:/opt/cdc/cdc102ora]kill -QUIT 5505378
Java thread dumps file name: javacore.20140128.074106.5505378.0002.txt

For hang issue, we usually need to run kill -QUIT <CDC instance PID> command 10 times, the interval is 30 seconds.

A java thread dump only requires space for the text to display the active threads and information about those threads. This is not a heap dump (dump of the java heap memory) which can be very large. Java thread dumps should be very small - a typical java thread dump will be perhaps 1 MB in size. As far as the impact on the system, a thread dump will temporarily pause all threads to dump their current state. This is no different than what happens when a global garbage collection occurs. But unlike a global garbage collection, it will be very fast because all that needs to be done is to record the thread stack for each thread. 

Note: for Windows installations you will issue Ctrl+Break from the window where the CDC engine is launched. 

RELATED INFORMATION
#A simplified Chinese translation is available [http://www.ibm.com/support/docview.wss?uid=swg21684185]