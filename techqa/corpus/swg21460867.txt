Title: IBM Using Certificates with IBM Mobile Connect & HTTP Access Services - United States

Text:
SSL; certificates; wg_ikeyman; Key Manager TLS encryption security SHA MD5 RSA TECHNOTE (FAQ)

QUESTION
How do I generate a Certificate Signing Request file (.csr) to a Certificate Authority? 

 How do I replace my certificates which are going to expire so that HTTP Access Services will continue running uninterrupted? 

How do I create a Self Signed certificate that I could use to test IBM Mobile Connect for HTTP Access Services?


ANSWER
How to Generate a Certificate Signing Request (CSR) file? 

 

Please Note - You should generate a NEW CSR (Certificate Request) whether this is the first time you are requesting a certificate or you already have an existing certificate which will or has expired and you just need to get a new one. 

1. To generate the certificate signing request for IBM Mobile Connect certificates, you use the included Key Manager program. In Windows, this program can be accessed from the Start / Programs / IBM Lotus Mobile Connect program group. On UNIX based Connection Managers this same Java application can be run by entering wg_ikeyman. 

 

2. Open the http.trusted.kdb key database file which is located for Windows in the C:\Program Files\IBM\Connection Manager directory. On UNIX Connection Managers it is located in /opt/ibm/ConnectionManger Note - AIX= /opt/IBM/ConnectionManager 

 2a. On the Key Database File Menu, choose Open. The following dialogue is shown: 


[/support/docview.wss?uid=swg21460867&aid=1] [/support/docview.wss?uid=swg21460867&aid=1]

Make sure the key Database type is CMS, then Click the Browse button to Navigate to the C:\Program Files\IBM\Connection Manager directory. On UNIX Connection Managers it is located in /opt/ibm/ConnectionManger Note - AIX= /opt/IBM/ConnectionManager . Choose the http.trusted.kdb key database file.

The default password is trusted. 

3. To begin creating a new certificate request click on the Create option on the primary menu and choose 'New Certificate Request'.

4. When generating the Certificate Request you will see the following panel:

[/support/docview.wss?uid=swg21460867&amp;aid=2] 

At a minimum you must fill in the Key Label and Common Name fields. The Common Name will be the hostname which devices would enter to access IBM Mobile Connect. This usually matches up with the SERVICE URL on the Service Tab for an HTTP Access Service. Also be sure to specify the proper key size. The Global Security Kit can handle key sizes up to 4096.

(Note -For advanced configuration certificates which may use wildcards, are stored on multiple servers, or across different servers with the same hostname please contact the CA for specific instructions or if they require the certificate request to be filled out in a specific manner)

5. Once the proceeding form has been filled in and you click the OK button this dialogue will be presented:

[/support/docview.wss?uid=swg21460867&aid=3] [/support/docview.wss?uid=swg21460867&aid=3]

Please note the location of the certreq.arm request file. While this is not a csr suffix file it contains the necessary information for use while you are at a CA's Internet site to request the certificate. We have also found it helpful to note to your Certificate Authority that the certificate is for use with the IBM HTTP Server. This information may not come into play until AFTER the certificate has been created by the CA. There may be instructions asking to identify the type of server the certificate will be used on. If the IBM HTTP Server is shown it also uses the same IBM Key Management system as does IBM Mobile Connect. 

Receiving the certificates and storing into the key database

Note - It is important to use the CSR process to request a certificate from either a third party CA or your own In-House CA. The use of this process will ensure a smooth ADD of any Root / Intermediate Signer certificates into the key database as well as a RECEIVE of the Personal Certificate.

If the CSR Process is not used for some reason and you need to use the IMPORT function of the Key Manager to get the Personal Certificate into the Key database then the certificate MUST be in PKCS12 (.p12) format from the Certificate Authority. It may be necessary to contact your CA before trying to IMPORT the Personal Certificate and request that they supply the certificate in this format. One other way might be also to rename the personal certificate file type to .arm and attempt the receive again.

Again, it will save much hassle if the CSR process is used. Sometimes it is difficult to get the PKSC12 format needed for the IMPORT function. 

1. It may be necessary to modify the file format in which your certificates are received from your CA in order to get them properly accepted into the IBM Key Manager. If certificate files are not in PKCS #12 (.p12) format or if a CSR was not created because the certificate files are already in your possession then you may need to convert the certificates into a format the Key Manager tool will handle.

By using a popular browser like Internet Explorer or Firefox use the Certificate Importation Function to IMPORT the certificate, and then perform an EXPORT on the certificate files in the Base-64 encoded (DER) format. This will then allow the Key Manager to either ADD your root certificates, or to IMPORT your personal certificates. 

1a. If the certificate files are already in PCKS12 format and/or a formal CSR request was made, then you would ADD the root signer(s), and RECEIVE the Personal Certificate file. 

2. Ensure the certificates you just received are marked as the default *. 

3. Close the key database file. 

4. Restart the HTTP Access Services if they are already created using the Gatekeeper 

5. Test your HTTP Access Service to make sure your certificate is working. 

6. If the HTTP Service is not securing incoming connections the wg.log file in /var/adm (Linux/AIX) or in \Program Files\IBM\Connection Manager\logs (Windows) will help in understanding if the issue is certificate related. Please see the following Technote for instructions on properly setting the log levels for capturing the issue and collecting the data - [http://www-01.ibm.com/support/docview.wss?uid=swg21642931]http://www-01.ibm.com/support/docview.wss?uid=swg21642931 [http://www-01.ibm.com/support/docview.wss?uid=swg21642931] 

 

How do I replace my certificates which are going to expire so that HTTP Access Services will continue running uninterrupted? 

 1. The process to replace existing certificates is just like the process to obtain a certificate for the first time. You execute the steps documented above to generate a CSR file and for requesting updated certificates from your chosen CA. 
 2. Once you have successfully Added any new Root / Intermediate signer certificate files and Received the Personal Certificate file you will have two personal certificates displayed in your KDB file. The current certificate being used by IMC is the one with the asterisk character to the left of it *. When you are ready to switch to using the new certificate use the Key Manager to select your new certificate and click on the View/Edit button . There is a check box near the bottom of the dialogue to make that certificate the Default. Make this the default, then close out the KDB file. 
 3. Restart the IBM Mobile Connect service to allow this change to take effect.


How do I create a Self Signed certificate that I could use to test IBM Mobile Connect for HTTP Access Services? 

 1. Open the KDB file used for your HTTP Access Service using the Key Manager (default is http.trusted.kdb stored in the Connection Manager installation directory). The default password is trusted. 
 2. Make sure the view of the Key Manager is showing Personal Certificates and then click the 'New Self Signed' button or the Create menu item and then New Self Signed Request. 
 3. Enter a Key Label. This is what will be displayed to you with the Key Manager. 
 4. Select the Version you wish to use for testing as well as the Key Size and Signature Algorithm used to create the Self Signed certificate. 
 5. The Common Name will be automatically entered into the field. Ensure it is the value you wish devices to use when attempting to establish a secured connection with the IMC Connection Manager. 
    Note -- Even though devices use the proper common name to establish a secured session with IBM Mobile Connect because the certificate is self signed, it will not be trusted by the device and a warning message will be displayed to an end user warning them that the certificate is untrusted. Since this is only testing the warning may be responded to and the connection will proceed. 
 6. All other fields for the Self Signed Certificate are optional. Once you are satisfied with the structure of the certificate click OK and the certificate will be available for use with the Connection Manager if it is the default.

[/support/docview.wss?uid=swg21460867&aid=4] [/support/docview.wss?uid=swg21460867&aid=4]