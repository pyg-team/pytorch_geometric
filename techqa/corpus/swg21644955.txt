Title: IBM MustGather: Sterling OMS Heartbeat related issues for WebSphere Commerce - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 MustGather: Sterling Heartbeat related issues for WebSphere Commerce 

RESOLVING THE PROBLEM


Gathering this MustGather information before calling IBM Support will help familiarize you with the troubleshooting process and save you time. 

 Considerations before collecting data 
Take note of the following before collecting the information described below:

 * Performance  * Runtime tracing may be verbose, and it could impact performance during peak time. If possible, reproduce the problem on a non-production environment to capture tracing.
      
   
    *  If using WebSphere Version 8, there is an option to utilize High Performance Extensible Logging(HPEL) to minimize the impact of logging and tracing. The logs need to be formatted using the logViewer utility [https://www-01.ibm.com/support/knowledgecenter/SSAW57_8.5.5/com.ibm.websphere.nd.doc/ae/rtrb_logviewer.html] before uploading to IBM. For more information on enabling HPEL, refer to WebSphere Knowledge Center Using HPEL to troubleshoot applications [ https://www-01.ibm.com/support/knowledgecenter/SSAW57_8.5.5/com.ibm.websphere.nd.doc/ae/ttrb_usinghpel.html].
   
   

 * Security  * Some trace strings could capture sensitive or personal infomation. Please be sure to sanitize the logs before uploading to IBM. Commerce uses data masking to help mask sensitive data. See Knowledge Center Masking Sensitive data in traces [http://www-01.ibm.com/support/knowledgecenter/SSZLC2_7.0.0/com.ibm.commerce.developer.doc/concepts/csdlogging.htm?lang=en]
   
   


 COLLECTING DATA 



 I. Configure environment 

Follow the instructions below to configure your environment to capture the required diagnostic information: 

 1. Update the size of the trace files to 20MB and the number of historical trace files retained to 20 . If using HPEL, set maximum size to at least 500MB.
 2. Enable the following runtime trace string on the Commerce Server:
    
    *=info:com.ibm.commerce.inventory.*=all:com.ibm.commerce.order.*=all:com.ibm.websphere.commerce.WC_ORDER=all:com.ibm.websphere.commerce.WC_SCHEDULER=all:com.ibm.commerce.foundation.logging.ServiceLogger=finest:com.ibm.websphere.commerce.WC_INVENTORY=all 
 3. Enable the following runtime trace string on the WESB Server:
    
    *=info:  *  - [http://www.ibm.com/i/c.gif]Enabling trace What is this data These trace components increase the amount of diagnostic data logged to the WebSphere server trace file. Why do I need this data This data will capture more detailed diagnostic trace information for the subject component. Where can I find this data Please look at the following Commerce Information Center documentation for more information on enabling Commerce trace components:  1.  Configuring logging in WebSphere Commerce [http://publib.boulder.ibm.com/infocenter/wchelp/v7r0m0/index.jsp?topic=/com.ibm.commerce.admin.doc/tasks/tlslogging.htm] 
       
       
    
    
    






II. Reproduce the problem Note the specific steps used to reproduce the problem and any details that may be relevan




Ill. Validate the issue was captured 
Before sending logs to IBM, ensure that the issue being reported was captured. Recommend to review the following documents to help facilitate proper log collection: Avoiding pitfalls when collecting traces. [http://www-01.ibm.com/support/docview.wss?uid=swg21648137] 




IV. Collect data Include the general information requested in MustGather: General Issues in WebSphere Commerce [https://www-304.ibm.com/support/docview.wss?uid=swg21440709] alongside the component-specific information requested below.


 1. Collect the following files from the system:  * WC_eardir/xml/config/com.ibm.commerce.inventory.external/wc-component-client.xml
     * WC_eardir/xml/config/com.ibm.commerce.order-fep/wc-admin-component.xml
     * WC_eardir/xml/config/com.ibm.commerce.order-ext/wc-admin-component.xml
     * WC_profiledir/logs/server_name/
     * WESB_profiledir/logs/server/
     * Sterling_installDir/logs/
     * Sterling_profileDir/logs/server/
     * WC_eardir/xml/config/wc-server.xml
    
    
 2. Naming conventions can be found here [http://pic.dhe.ibm.com/infocenter/wchelp/v7r0m0/topic/com.ibm.commerce.base.doc/misc/mabhelp.htm].
 3. 
 4. Run the following database queries to collect the necessary information from your database (output results in CSV format): Query Output file name SELECT * FROM SCHCONFIG WHERE SCCPATHINFO='SterlingOMSUpdateSystemState' SCHCONFIG.csv SELECT * FROM SCHSTATUS WHERE SCSJOBNBR IN (SELECT SCCJOBREFNUM FROM SCHCONFIG WHERE SCCPATHINFO ='SterlingOMSUpdateSystemState') SCHSTATUS.csv SELECT * FROM STOREENT STOREENT.csv 




V. Additional data Collect the additional data if requested by support

 * For tracing a specific message, enable the tracing flag for the corresponding component. See Message-specific trace mediation primitives [ http://pic.dhe.ibm.com/infocenter/ssfs/v9r2/index.jsp?topic=%2Fcom.ibm.help.integ.92wcsc.doc%2Fc_enablingtraceinmediationmodule.html]
 * For SIB issues with the JMS engine, enable the following trace on the WESB server  *  *=info:com.ibm.ws.sibx.*=all:com.ibm.wsspi.sibx.*=all:com.ibm.websphere.sibx.*=all:com.ibm.ws.sib.processor.utils.UserTrace=all:SIBTrm=all:WLM*=all:SIBMessageTrace*=all:SIBCommunications=all:SIBProcessor=all:SIBAdmin=all:com.ibm.ws.management.commands.sib.*=all 
   
   
 * For BO issues (XML transformation, serialization and mediation), enable the following trace on the WESB server  *  *=info:SCA.*=all:ArtifactLoader=all:BOCore=all:BOFactory=all:BOXMLSerializer=all:BOXMLDocument=all:BOTypeMetaData=all 
   
   



Collect data  * Collect the following files from the system:  *  WESB_profiledir/config/cells/WESB_celldir/applications/WCToSSFSMediationModuleApp.ear/WCToSSFSMediationModuleApp.jar
    * WESB_profiledir/logs/XCT/
   
   Naming conventions can be found here [http://pic.dhe.ibm.com/infocenter/wchelp/v7r0m0/topic/com.ibm.commerce.base.doc/misc/mabhelp.htm].
   
   
   

SUBMITTING DATA TO IBM SUPPORT
To diagnose or identify a problem, it is sometimes necessary to provide Technical Support with data and information from your system. In addition, Technical Support might also need to provide you with tools or utilities to be used in problem determination. You can submit files using one of following methods to help speed problem diagnosis:

 * IBM Support Assistant (ISA)
 * Service Request (SR)
 * E-Mail
 * FTP to the Enhanced Customer Data Repository (ECuRep)

Exchanging information with IBM Technical Support for problem determination [http://www.ibm.com/software/support/exchangeinfo.html] 





]