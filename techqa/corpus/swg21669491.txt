Title: IBM An error occurred while importing keys from the PKCS12 format file returned when attempting to import a wildcard SSL certificate for Domino - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM
As an administrator you are unable to import a Wildcard certificate into Domino.

SYMPTOM
As part of the actions required to import a Wildcard certificate into Domino, when attempting to import the P12 certificate into iKeyman version 5 an administrator receives the error An error occurred while importing keys from the PKCS12 format file


CAUSE
Unknown at this time as version 5 of the ikeyman tool is no longer supported. A possible theory is that the tool can no longer recognise the format of some newer P12 certificates

DIAGNOSING THE PROBLEM
The latest versions of the iKeyman tool do not allow you to save P12 certificates as a Key Ring File 

Version 5 of the iKeyman tool, while no longer supported allows you to import P12 certificates and save CMS databases as a Key Ring File which can be then edited within the certsev.nsf database on a Domino server to produce the corresponding .sth file. 

Please note officially iKeyman version 5 can only be run on 32 bit Windows XP, more information on this and how to download the tool can be found at http://www-01.ibm.com/support/docview.wss?uid=swg21308138 [http://www-01.ibm.com/support/docview.wss?uid=swg21308138]


RESOLVING THE PROBLEM
In one case the following steps resolved the issue and allowed the Administrator to use the wildcard certificate on their Domino server. Please note it is assumed that you have used a utility such as openSSL to create the PKCS (P12) certificate. 

 

 1.  Download IBM HTTP Server http://www-03.ibm.com/software/products/en/http-servers/ [http://www-03.ibm.com/software/products/en/http-servers/] 
     
     The IBM HTTP server has its own version of ikeyman built in and is started from Start -> IBM HTTP Server -> Start Key Management Utility on Windows.
     
     
 2.  Click on Key Database File -> New
     
     
 3.  Create a CMS database.
     
     
     [/support/docview.wss?uid=swg21669491&aid=1] [/support/docview.wss?uid=swg21669491&aid=1]
     
     
 4.  Set the password for the database.
     
     
 5.  Click Import, change the file type to PKCS12 and select your p.12 certificate. Click OK and enter the password for the certificate. 
     
     
     [/support/docview.wss?uid=swg21669491&aid=2] [/support/docview.wss?uid=swg21669491&aid=2]
     
     
 6.  You will be asked if you wish to change the label, just click OK.
     
     
 7.  Shut down iKeyman.
     
     
 8.  On Windows XP open the command prompt.
     
     
 9.  Navigate to the directory that you have iKeyman version 5 installed and run the program
     
     
 10. Select Key Database File -> Open and navigate to the CMS database that you created in steps 1-7.
     
     
 11. Enter the password for the database.
     
     
     [/support/docview.wss?uid=swg21669491&aid=3] [/support/docview.wss?uid=swg21669491&aid=3]
     
     
 12. Select Key Database File -> Save As and change the 'Key Database Type' to be Keyring file.
     
     
 13. Set a password for the .kyr file and close iKeyman.
     
     
 14. Copy the .kyr file (keyfile.kyr by default) to the C:\ drive of the server hosting Domino where you wish to install the certificate.
     
     
 15. Open the certserv.nsf database on this server via the Administration client.
     
     
 16. Within the certserv.nsf database select View & Edit Key Rings
     
     
 17. Within the View & Edit Key Rings view click on Select Key Ring to Display
     
     
 18. Enter the path to the .kyr file and its name and click ok.
     
     
 19. Click on Change Key Ring Password.
     
     
 20. Enter the path to the file and its password.
     
     
 21. Enter a new password for the file and then confirm the new password. This creates the .sth required for Domino to open the .kyr file
     
     
 22. Copy the .kyr and .sth file from the C:\ drive into the Domino Data directory and set up the server to use this file for SSL