Title: IBM A message flow with external ESQL references in IBM Integration Bus results in "BIP4188E: Failed to call ESQL routine" after deployment - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 A message flow with external ESQL references in IBM Integration Bus (IIB) may result in the error, BIP4188E: Failed to call ESQL routine 'YOUR_PROCEDURE_NAME_HERE' because it has not been deployed. 

CAUSE
Externally referenced ESQL files are not automatically included in Broker Archive (BAR) files that are created with the "compile and in-line resources" setting.


Note: The "compile and in-line resources" setting is for the Toolkit only. This is equivalent to NOT using "-deployAsSource" with the mqsicreatebar command. 


DIAGNOSING THE PROBLEM
The deployed Application may contain a Library that does not have any contents.



RESOLVING THE PROBLEM
There are two possible solutions for this issue, however you may be limited by your current topology: 

1) Build the BAR file with the option to "deploy as source"
- If you are using the Toolkit, unselect the "Compile and In-line resources" option.
- If you are using the mqsicreatebar command, ensure you are using the "-deployAsSource" flag.
Note: Some projects, such as those which use .msgflow files as subflows, cannot be deployed as source. 

Please review "Adding files to a broker archive" for more information. https://www.ibm.com/support/knowledgecenter/en/SSMKHH_9.0.0/com.ibm.etools.mft.doc/af03880_.htm [https://www.ibm.com/support/knowledgecenter/en/SSMKHH_9.0.0/com.ibm.etools.mft.doc/af03880_.htm] 

2) Manually add the externally referenced ESQL to the BAR file.
- If you are using the Toolkit, manually select the ESQL files through the prepare tab.
- If you are using the mqsicreatebar command, specifically reference the ESQL file(s) with the appropriate -p (project), -l (library), and/or -o (object) flags.

Note: Some projects, such as those which use .subflow files as subflows, cannot be compiled, and must be deployed as source.

RELATED INFORMATION
 Deploying an ESQL file [https://www.ibm.com/support/knowledgecenter/en/SSMKHH_9.0.0/com.ibm.etools.mft.doc/bk40720_.htm]
Adding files to a broker archive [https://www.ibm.com/support/knowledgecenter/en/SSMKHH_9.0.0/com.ibm.etools.mft.doc/af03880_.htm]
mqsicreatebar options [https://www.ibm.com/support/knowledgecenter/en/SSMKHH_9.0.0/com.ibm.etools.mft.doc/an19540_.htm]
Things to consider when using -version and -deployAsSou [https://developer.ibm.com/answers/questions/165362/things-to-consider-when-using-version-and-deployas.html]