Title: IBM IV48720: JOBMON MEMORY LEAKS FOR XA JOBS AND RANDOM CRASHES - United States

Text:
  DIRECT LINKS TO FIXES
8.5.1-TIV-TDWC-WINDOWS-X86-64-FP0006 [http://www.ibm.com/support/fixcentral/quickorder?product=ibm%2FTivoli%2FTivoli+Workload+Scheduler&fixids=8.5.1-TIV-TDWC-WINDOWS-X86-64-FP0006&source=SAR]
8.5.1-TIV-TDWC-WINDOWS-FP0006 [http://www.ibm.com/support/fixcentral/quickorder?product=ibm%2FTivoli%2FTivoli+Workload+Scheduler&fixids=8.5.1-TIV-TDWC-WINDOWS-FP0006&source=SAR]
8.5.1-TIV-TDWC-LINUXS390-FP0006 [http://www.ibm.com/support/fixcentral/quickorder?product=ibm%2FTivoli%2FTivoli+Workload+Scheduler&fixids=8.5.1-TIV-TDWC-LINUXS390-FP0006&source=SAR]
8.5.1-TIV-TDWC-LINUX-I386-FP0006 [http://www.ibm.com/support/fixcentral/quickorder?product=ibm%2FTivoli%2FTivoli+Workload+Scheduler&fixids=8.5.1-TIV-TDWC-LINUX-I386-FP0006&source=SAR]
8.5.1-TIV-TDWC-LINUX-X86-64-FP0006 [http://www.ibm.com/support/fixcentral/quickorder?product=ibm%2FTivoli%2FTivoli+Workload+Scheduler&fixids=8.5.1-TIV-TDWC-LINUX-X86-64-FP0006&source=SAR]
8.5.1-TIV-TDWC-LINUXPPC-FP0006 [http://www.ibm.com/support/fixcentral/quickorder?product=ibm%2FTivoli%2FTivoli+Workload+Scheduler&fixids=8.5.1-TIV-TDWC-LINUXPPC-FP0006&source=SAR]
8.5.1-TIV-TDWC-SOLARIS-FP0006 [http://www.ibm.com/support/fixcentral/quickorder?product=ibm%2FTivoli%2FTivoli+Workload+Scheduler&fixids=8.5.1-TIV-TDWC-SOLARIS-FP0006&source=SAR]
8.5.1-TIV-TDWC-AIX-FP0006 [http://www.ibm.com/support/fixcentral/quickorder?product=ibm%2FTivoli%2FTivoli+Workload+Scheduler&fixids=8.5.1-TIV-TDWC-AIX-FP0006&source=SAR]
8.5.1-TIV-TDWC-SOLARIS-I386-FP0006 [http://www.ibm.com/support/fixcentral/quickorder?product=ibm%2FTivoli%2FTivoli+Workload+Scheduler&fixids=8.5.1-TIV-TDWC-SOLARIS-I386-FP0006&source=SAR]
8.5.1-TIV-TDWC-HPUX-FP0006 [http://www.ibm.com/support/fixcentral/quickorder?product=ibm%2FTivoli%2FTivoli+Workload+Scheduler&fixids=8.5.1-TIV-TDWC-HPUX-FP0006&source=SAR]
8.5.1-TIV-TDWC-HPUXIA64-FP0006 [http://www.ibm.com/support/fixcentral/quickorder?product=ibm%2FTivoli%2FTivoli+Workload+Scheduler&fixids=8.5.1-TIV-TDWC-HPUXIA64-FP0006&source=SAR]
8.5.1-TIV-TWS-AIX-FP0006.TAR [http://www.ibm.com/support/fixcentral/quickorder?product=ibm%2FTivoli%2FTivoli+Workload+Scheduler&fixids=8.5.1-TIV-TWS-AIX-FP0006.TAR&source=SAR]
8.5.1-TIV-TWS-HPIA64-FP0006.TAR [http://www.ibm.com/support/fixcentral/quickorder?product=ibm%2FTivoli%2FTivoli+Workload+Scheduler&fixids=8.5.1-TIV-TWS-HPIA64-FP0006.TAR&source=SAR]
8.5.1-TIV-TWS-HPUX-FP0006.TAR [http://www.ibm.com/support/fixcentral/quickorder?product=ibm%2FTivoli%2FTivoli+Workload+Scheduler&fixids=8.5.1-TIV-TWS-HPUX-FP0006.TAR&source=SAR]
8.5.1-TIV-TWS-LINUX_I386-FP0006.TAR [http://www.ibm.com/support/fixcentral/quickorder?product=ibm%2FTivoli%2FTivoli+Workload+Scheduler&fixids=8.5.1-TIV-TWS-LINUX_I386-FP0006.TAR&source=SAR]
8.5.1-TIV-TWS-LINUX_PPC-FP0006.TAR [http://www.ibm.com/support/fixcentral/quickorder?product=ibm%2FTivoli%2FTivoli+Workload+Scheduler&fixids=8.5.1-TIV-TWS-LINUX_PPC-FP0006.TAR&source=SAR]
8.5.1-TIV-TWS-LINUX_S390-FP0006.TAR [http://www.ibm.com/support/fixcentral/quickorder?product=ibm%2FTivoli%2FTivoli+Workload+Scheduler&fixids=8.5.1-TIV-TWS-LINUX_S390-FP0006.TAR&source=SAR]
8.5.1-TIV-TWS-LINUX_X86_64-FP0006.TAR [http://www.ibm.com/support/fixcentral/quickorder?product=ibm%2FTivoli%2FTivoli+Workload+Scheduler&fixids=8.5.1-TIV-TWS-LINUX_X86_64-FP0006.TAR&source=SAR]
8.5.1-TIV-TWS-SOLARIS_I386-FP0006.TAR [http://www.ibm.com/support/fixcentral/quickorder?product=ibm%2FTivoli%2FTivoli+Workload+Scheduler&fixids=8.5.1-TIV-TWS-SOLARIS_I386-FP0006.TAR&source=SAR]
8.5.1-TIV-TWS-SOLARIS-FP0006.TAR [http://www.ibm.com/support/fixcentral/quickorder?product=ibm%2FTivoli%2FTivoli+Workload+Scheduler&fixids=8.5.1-TIV-TWS-SOLARIS-FP0006.TAR&source=SAR]
8.5.1-TIV-TWS-WIN_X86_64-FP0006 [http://www.ibm.com/support/fixcentral/quickorder?product=ibm%2FTivoli%2FTivoli+Workload+Scheduler&fixids=8.5.1-TIV-TWS-WIN_X86_64-FP0006&source=SAR]
8.5.1-TIV-TWS-WIN-FP0006 [http://www.ibm.com/support/fixcentral/quickorder?product=ibm%2FTivoli%2FTivoli+Workload+Scheduler&fixids=8.5.1-TIV-TWS-WIN-FP0006&source=SAR]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  After applyig FP04 on their TWS v8.5.1 FP04 FTA's they face
   problems with JOBMON. They state that it is not releasing
   Handles and causing a Memory leak to the LSASS.exe process.
   This is causing huge memory consumption and performance
   degrade.
   
   Their environment is Windows Server 2003 Enterprise x64 SP2
   TWS v8.5.1 FP04. All jobs use AD Domain User.
   
   This affects extended agent jobs.
   
   In addition you can experience a JOBMON crash within
   environments with high workloads on xa and normal jobs.
   
   
    
   
   

LOCAL FIX
 *  n/a
   
   
    
   
   

PROBLEM SUMMARY
 *  Jobmon.exe has three problems:
   1) it happens when XA jobs are run. In this case and handle leak
   is produced every time a job is run. The leak can be observed
   using tools
   like "Process Explorer", the handle that is not closed is an
   handle to
   the user token running the job.
   2) if jm load user profile is enabled (Load User profile feature
   is used),
   even if it is not used for XA jobs, the user profile is loaded,
   but never unloaded.
   3) when Load User profile feature is used, a memory corruption
   happens when job ends and profiles are unloaded. This
   may lead to Jobmon crashes.
   
   The fix consists in
   1) close the user token after the XA job starts
   2) avoid to load the user profile for XA jobs
   3) unload the profile before setting the job as completed
   
   
    
   
   

PROBLEM CONCLUSION
 *  The APAR will be fixed in TWS 8.5.1 FP06, TWS 8.6.0 FP3 TWS 9.1
   FP1
   
   
    
   
   

TEMPORARY FIX
 *  See local fix
   
   
    
   
   

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IV48720
   
   
 * REPORTED COMPONENT NAME
   TIV WKLD SCHDL
   
   
 * REPORTED COMPONENT ID
   5698WKB85
   
   
 * REPORTED RELEASE
   8T5
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt / Xsystem
   
   
 * SUBMITTED DATE
   2013-09-16
   
   
 * CLOSED DATE
   2013-09-30
   
   
 * LAST MODIFIED DATE
   2013-09-30
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   TIV WKLD SCHDL
   
   
 * FIXED COMPONENT ID
   5698WKB85
   
   

APPLICABLE COMPONENT LEVELS
 * R85T PSY
   UP