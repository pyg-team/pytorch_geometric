Title: IBM Managed node installation failed on Windows Server 2008 R2 - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 When a managed node is being installed on Windows Server 2008 R2, the installation failed because oserv can't start.
oserv uses TAP, but TAP does not work because the 32-bit version of wsettap.exe sets the Tivoli remote access account incorrectly during the managed node installation. 

SYMPTOM
a) When TAP isn't installed on the machine where a managed node is being installed: 

 After managed node installation command finishes and the machine where a managed node is being installed is rebooted, oserv status doesn't change to "Started".

b) When TAP is already installed on the machine where a managed node is being installed:
(Note: The endpoint installation also installs TAP) 

Managed node installation fails during "Distributing architecture specific Client Database" like below:

Distributing architecture specific Binaries --> mn_host
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>(25Mb)
>>>>>>>..... Completed.

Distributing architecture specific Client Database --> mn_host
............................................................................................................................................................................................................
the last few lines of the error log (c:/Tivoli/db/mn_host.db/tmp/install2.cfg.error):
+ set -e
+ [ 0 -eq 0 ]
+ USEROPT=
+ set +x
The Tivoli Object Dispatcher service could not be started.

More help is available by typing NET HELPMSG 3523.

+ echo Managed node creation failed!
+ exit 3

the Object Dispatcher log:
after script failure
Completed (with errors).


Registering installation attributes...Registered.

Finished client install with errors.


CAUSE
oserv uses TAP, but TAP does not work because the 32-bit version of wsettap.exe sets the Tivoli remote access account incorrectly during the managed node installation on the 64-bit environment. 

APAR IV09359 is created for this problem.


RESOLVING THE PROBLEM
Interim Fix: 


The fix for APAR IV09359 will be included in the next 4.3.1 TMF interim fix.

Workaround:

1. Delete TAP on the machine where a managed node is being installed.

1.1. Run the following commands as Administrator:
C:\Windows\System32\drivers\etc\Tivoli\setup_env.cmd
cd %BINDIR%
bin\wlcftap-AMD64.exe -d -r ""
1.2. Rename TivoliAP.dll in C:\Windows\System32 folder.
1.3. Reboot the machine.

2. Uninstall the managed node on TMR.

3. Delete all copied files during managed node installation on the machine where a managed node is being installed.

4. Reboot the machine where a managed node is being installed.

5. Install a managed node.
At the installation, select y to reboot the machine where a managed node is being installed.

...
Would you like to reboot these machines([y]/n)? <<-- Please type y

6. After the machine which is installing a managed node is rebooted, open Services and check if "Tivoli Object Dispatcher" status is "Started".
("Tivoli Object Dispatcher" status should be blank. "blank" means "Stopped".)

7. If the status is not "Started", do the following.

7.1. Run the following commands as Administrator:
C:\Windows\System32\drivers\etc\Tivoli\setup_env.cmd
cd %BINDIR%
bin\wlcftap-AMD64.exe -r <traa user name>
7.2. Enter the password.

8. Open Services and start "Tivoli Object Dispatcher".

9. Check if "Tivoli Object Dispatcher" status is "Started".

10. Check if the managed node is installed and connected.

Run the following command as root/Administrator on TMR:
odadmin odlist