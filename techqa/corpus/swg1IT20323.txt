Title: IBM IT20323: MQOPEN or MQPUT1 fails with reason code 2189, caused by bad content in qm.ini file. Also FDC with probe RM241000 - United States

Text:
 SUBSCRIBE TO THIS APAR
By subscribing, you receive periodic emails alerting you to the status of the APAR, along with a link to the fix after it becomes available. You can track this item individually or track all items by product.

Notify me when this APAR changes.

Notify me when an APAR for this component changes.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  An administrator makes a change to qm.ini, inadvertently adding
   some bad syntax in the CHANNELS or SSL stanzas.
   
   After restarting the queue manager, because of the error in
   qm.ini, the cluster component of the queue manager does not
   initialize its data properly in relation to locally-defined
   cluster channels.  As a result, no CLUSRCVR or locally-defined
   CLUSSDR channels are returned from DISPLAY CLUSQMGR(*) on the
   local queue manager.
   
   Cluster capability of the queue manager mostly ceases to
   function because of the above.  For example, applications
   calling MQOPEN or MQPUT1 for cluster queue names that are not
   yet known on the local queue manager fail with 2189
   MQRC_CLUSTER_RESOLUTION_ERROR.  Also, channels do not start
   outbound from the local queue manager, so messages remain on the
   cluster transmission queue(s).
   
   Non-clustered channels also do not start.
   
   FDC records are written with the following details:
   
   Probe Id :- RM241000
   Component :- rrmUpdateClqMgr
   Major Errorcode :- rrcE_UNEXPECTED_TOKEN
   Probe Description :- AMQ9224: Unexpected .ini file entry.
   MQM Function Stack
   rrmMain
   rrmRepository
   rrmGetMsg
   rfxReconcile
   rfxReconcileCLQMGR
   rrmRecoClqMgr
   rrmUpdateClqMgr
   xcsFFST
   
   Error logs have both of the following entries : AMQ9224,
   AMQ9419.
   
   (Note that the appearance of AMQ9419 in other circumstances will
   be correct, in the case that the user has failed to create the
   correct CLUSRCVR channels with the correct parameters.  In this
   case, though, the user had done this, but the qm.ini mistakes
   caused the queue manager to believe there were no CLUSRCVRs):
   
   AMQ9224: Unexpected .ini file entry.
   EXPLANATION:
   The entry with name '' in stanza '' in .ini file '' is either
   not a valid keyword or has an invalid value.
   ACTION:
   Correct the .ini file and retry the operation.
   
   AMQ9419: No cluster-receiver channels for cluster 'MYQM'
   EXPLANATION:
   The repository manager has received information about a cluster
   for which no cluster-receiver channels are known.
   ACTION:
   Define cluster-receiver channels for the cluster on the local
   queue manager.
   
   The following FDC might also be seen:
   KN051002
   
   
    
   
   

LOCAL FIX
 *  Correct the qm.ini file and restart the queue manager.
   
   
    
   
   

PROBLEM SUMMARY
 *  ****************************************************************
   USERS AFFECTED:
   Users who edit their qm.ini file, and mistakenly save it
   including typos in the CHANNELS or SSL stanzas.
   
   
   Platforms affected:
   MultiPlatform
   
   ****************************************************************
   PROBLEM DESCRIPTION:
   Because of the errors in qm.ini, the cluster component of the
   queue manager did not initialize properly in relation to
   locally-defined cluster channels.
   
   The FDC records are not required to diagnose this problem.
   Instead a better error message was needed from the strmqm
   program, to alert the administrator to the fact that this
   problem is happening, before they allow applications to start,
   and suffer errors such as 2189 MQRC_CLUSTER_RESOLUTION_ERROR.
   
   
    
   
   

PROBLEM CONCLUSION
 *  The strmqm program has been changed so that it checks the syntax
   in the CHANNELS and SSL stanzas early on, before starting the
   queue manager fully.  If an error is found, strmqm now outputs
   an AMQ9224 error message, describing the full details of the
   position of the error in qm.ini.  It also ends immediately
   without starting the queue manager.  This makes it much easier
   to see what is wrong, and correct it quickly.
   
   The text of AMQ9224 is also amended to include the line number
   of the error within qm.ini.
   
   The RM241000 FDC will no longer appear in this particular case.
   
   ---------------------------------------------------------------
   The fix is targeted for delivery in the following PTFs:
   
   Version    Maintenance Level
   v7.5       7.5.0.9
   v8.0       8.0.0.8
   v9.0 CD    9.0.4
   v9.0 LTS   9.0.0.2
   
   The latest available maintenance can be obtained from
   'WebSphere MQ Recommended Fixes'
   http://www-1.ibm.com/support/docview.wss?rs=171&uid=swg27006037 [http://www-1.ibm.com/support/docview.wss?rs=171&uid=swg27006037]
   
   If the maintenance level is not yet available information on
   its planned availability can be found in 'WebSphere MQ
   Planned Maintenance Release Dates'
   http://www-1.ibm.com/support/docview.wss?rs=171&uid=swg27006309 [http://www-1.ibm.com/support/docview.wss?rs=171&uid=swg27006309]
   ---------------------------------------------------------------
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IT20323
   
   
 * REPORTED COMPONENT NAME
   WMQ BASE MULTIP
   
   
 * REPORTED COMPONENT ID
   5724H7241
   
   
 * REPORTED RELEASE
   750
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt / Xsystem
   
   
 * SUBMITTED DATE
   2017-04-22
   
   
 * CLOSED DATE
   2017-08-10
   
   
 * LAST MODIFIED DATE
   2017-08-11
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
    PI85740
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WMQ BASE MULTIP
   
   
 * FIXED COMPONENT ID
   5724H7241
   
   

APPLICABLE COMPONENT LEVELS
 * R750 PSY
   UP