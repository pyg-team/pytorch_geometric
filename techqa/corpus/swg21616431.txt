Title: IBM KNP agent fails to send data - United States

Text:
tema; knp; itm agent TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 This article describes how to run the getPolldata.sh script manually in order to test the configuration settings. 

DIAGNOSING THE PROBLEM
Unix

These instructions assume you have installed the product in the default path in /opt/IBM/ITM. You may need to alter the paths to suit your installation. It also assumes you are using the bash shell.

1) Source the environment set up shell script
source $NCHOME/env.sh

2) Stop the TEMA and change directory to the TEMA bin directory
cd /opt/IBM/ITM/<arch>/np/bin/

3) Set the following environment variables.
export AGENT_BIN_DIR=`pwd`
export KNP_MIGRATION_ROWS=10 


NOTE: if you run the getPolldata.sh a second time, be sure to change the value of KNP_MIGRATION_ROWS to another value (e.g. 9) otherwise data will be deleted from NCPOLLDATA.

export KNP_PASSWORD=<NCPOLLDATA user password> 

This is the user's password you would use if trying to connect to the NCIM database on the command line.

export KNP_DOMAIN=<ITNM DOMAIN NAME>
e.g. export KNP_DOMAIN=NCOMS

export KNP_POLLER_NAME=<poller name or empty for default> 


If you have more than one instance of the poller running, then each instance will have its own TEMA installed. Download and review Chapter 2 "Planning for deployment" in the Tivoli Monitoring for Tivoli Network Manager User's Guide here:
http://publib.boulder.ibm.com/infocenter/tivihelp/v8r1/topic/com.ibm.networkmanagerip.doc_3.8/om_net_agent_knp_38.pdf [http://publib.boulder.ibm.com/infocenter/tivihelp/v8r1/topic/com.ibm.networkmanagerip.doc_3.8/om_net_agent_knp_38.pdf]

4) Run the script
./getPolldata.sh

If data is returned to the command line, then the values you set in step 3 are correct. Make sure they match those set in the TEMA's configuration file. The configuration file is made up of the server's hostname, the string _np_ and the domain name, for example

itnmHost_np_NCOMS.cfg

5) Restart the TEMA. 

 
Windows

These instructions assume that ITM is installed in the default location on the C: drive. You may need to alter the paths to suit your installation.

1. Stop the TEMA and open the windows cmd prompt.

2. Change directory to cd C:\IBM\ITM\TMAITM6
cd C:\IBM\ITM\TMAITM6

3. Run the environment set up batch script
C:\IBM\ITM\TMAITM6>%NCHOME%\env.bat

4. Set the following environment variables in the cmd window.
C:\IBM\ITM\TMAITM6>set AGENT_BIN_DIR=C:\IBM\ITM\TMAITM6
C:\IBM\ITM\TMAITM6>set KNP_MIGRATION_ROWS=10
NOTE: if you run the getPolldata.bat a second time, be sure to change the value of KNP_MIGRATION_ROWS to another value (e.g. 9) otherwise data will be deleted from NCPOLLDATA.

C:\IBM\ITM\TMAITM6>set KNP_PASSWORD=<NCPOLLDATA user password>
e.g. KNP_PASSWORD=netcool

C:\IBM\ITM\TMAITM6>set KNP_DOMAIN=<DOMAIN NAME>
e.g. set KNP_DOMAIN=NCOMS

C:\IBM\ITM\TMAITM6>set KNP_POLLER_NAME=<poller name or empty for default>
e.g. set KNP_POLLER_NAME=

C:\IBM\ITM\TMAITM6>echo %KNP_POLLER_NAME%
%KNP_POLLER_NAME%

5. Run getPolldata.bat

If data is returned to the command line, then the values you set in step 3 are correct. Make sure they match those set in the TEMA's configuration file. The configuration file is made up of the server's hostname, the string _np_ and the domain name, for example

itnmHost_np_NCOMS.cfg

6. Check that this script is populating the history file, which is the data source for the Warehouse proxy agent.
C:\IBM\ITM\TMAITM6\logs\History\KNP\<INSTANCE_NAME>
e.g.
C:\IBM\ITM\TMAITM6\logs\History\KNP\NCOMS

Note: This is a binary file, so just check that it exists and is not zero bytes. You won't be able to open the file to check the data validity. 

7. Restart the TEMA.


 

PRODUCT ALIAS/SYNONYM
 ITM ITNM