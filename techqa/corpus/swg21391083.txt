Title: IBM WebSphere Portal upgrade fails: RMIC command failed on project: wp.scheduler.ejb - United States

Text:
com.ibm.portal.Localized; com.ibm.wps.util.MessageRef; RMIC; ADMA5069E TECHNOTE (TROUBLESHOOTING)

PROBLEM
During the ugrade process, you receive a BUILD FAILED message, and looking in the logs you are presented with an RMIC error, and an overall message that the installation of application wps failed.

SYMPTOM
From the ConfigTrace.log we see:
...... 
Executing final configuration for consolidated config 
[wplc-consolidate-wsadmin] Task parameters: 
[wplc-consolidate-wsadmin] Global attributes: 
true 
[wsadmin] WASX7209I: Connected to process "dmgr" on node 
dmgrNode using SOAP connector; The type of process is:
DeploymentManager 
[wsadmin] AppName wps 
..... 
[wsadmin] Deploying jar wp.scheduler.ejb 
[wsadmin] Generating deployment code 
[wsadmin] /wp.scheduler.ejb: The project was not built since the 
source file 
/wp.scheduler.ejb/ejbModule/com/ibm/wps/datastore/ejb/cleanup/EJSRemoteS
tatelessSchedulerManager_03598d10.java could not be read 
[wsadmin] /wp.scheduler.ejb: The project was not built since the 
source file 
/wp.scheduler.ejb/ejbModule/com/ibm/wps/datastore/ejb/cleanup/EJSRemoteS
tatelessSchedulerManager_03598d10.java could not be read 
[wsadmin] Shutting down workbench. 
[wsadmin] Execution Halted: Compilation Errors Reported 
[wsadmin] 1 Errors, 0 Warnings, 0 Informational Messages 
[wsadmin] ADMA5008E: EJBDeploy failed on 
/opt/IBM/WebSphere/AppServer/profiles/wp_profile/wstemp/wstemp/app_12
1c70b5e03/dpl/dpl_wps.ear: 
com.ibm.etools.ejbdeploy.EJBDeploymentException: Error executing 
EJBDeploy 
[wsadmin] ADMA5011I: The cleanup of the temp directory for application
wps is complete. 
..... 
[wsadmin] ADMA5069E: The installation of application wps failed. This
application was in the middle of a full update and therefore is 
uninstalled from the configuration session. Discard your current 
configuration session immediately to recover the application. Do not 
save changes to the WebSphere Application Server configuration 
repository. The application is not uninstalled from this repository. 
Until the current configuration session is discarded you do not see this
application in the current session. 
[wsadmin] WASX7017E: Exception received while running file 
"/opt/IBM/WebSphere/wp_profile/ConfigEngine/config/work/was/curJaclScrip
t.jacl"; exception information: com.ibm.ws.scripting.ScriptingException:
WASX7418E: Application update for wps failed: see previous messages for 
details. 
.....
[wsadmin] WASX7341W: No "save" was performed before the interactive 
scripting session exited; configuration changes will not be saved. 
/opt/IBM/WebSphere/wp_profile/ConfigEngine/config/includes/apply_PTF.xml
:59: Java returned: 105 
..... 
Target finished: consolidate-create-update-actions-apply-PTF 
Target finished: action-config-6102-ConfigEngine 
Target finished: CONFIG-WP-PTF-6102 
---- Begin dump of properties ---- 
.... 
---- End dump of properties ---- 
uploading registry 

BUILD FAILED 
/opt/IBM/WebSphere/PortalServer/installer/wp.config/config/includes/wp_p
tf_6102.xml:27: The following error occurred while executing this line: 
/opt/IBM/WebSphere/PortalServer/installer/wp.config/config/includes/wp_p
tf_6102.xml:83: The following error occurred while executing this line: 
/opt/IBM/WebSphere/wp_profile/ConfigEngine/config/includes/apply_PTF.xml
:59: 
/opt/IBM/WebSphere/wp_profile/ConfigEngine/config/includes/apply_PTF.xml
:59: Java returned: 105 

Total time: 6 minutes 48 seconds 

And, from the *_WP_PTF_6102_wp.ptf.config_install.log:
.......
2009-06-16T14:22:56-04:00 Result: [wsadmin] Invoking RMIC.
2009-06-16T14:22:56-04:00 Result: [wsadmin] error: Class com.ibm.portal.Localized not found in class com.ibm.wps.datastore.ejb.cleanup.SchedulerException.
2009-06-16T14:22:56-04:00 Result: [wsadmin] error: Class com.ibm.wps.util.MessageRef not found in class com.ibm.wps.datastore.ejb.cleanup.SchedulerException.
2009-06-16T14:22:56-04:00 Result: [wsadmin] 2 errors
.......


CAUSE
In this case, customer had not completed the following task (for example from the 6.1.0.2 readme):

http://www-01.ibm.com/support/docview.wss?rs=688&uid=swg27014974 [http://www-01.ibm.com/support/docview.wss?rs=688&uid=swg27014974] 

Steps for installing Fix Pack 6.1.0.2 (single-cluster 24x7 procedure) 
1. Perform the following steps before upgrading to Version 6.1.0.2: 

iii. Copy the following file from the Primary Node to AppServer/plugins on the deployment manager: 

 * 
 * 
 * 



This could happen for any Portal v6.1.0.x fixpack. All 6.1.0.x fixpack readmes contain the same step of copying the wp.base.jar file. 
RESOLVING THE PROBLEM
To resolve, complete the following: 

1. Perform Step 1 above from the Cluster Upgrade instructions. 

2. Execute the upgrade again; this issue should be resolved.

RELATED INFORMATION
#WP 6.1.0.2 Upgrade - Cluster [http://www.ibm.com/support/docview.wss?rs=688&uid=swg27014974]