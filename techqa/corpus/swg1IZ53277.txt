Title: IBM IZ53277: CT-3686: KILL -HUP CAN'T RESTART THE UNIX LOG PROCESS - United States

Text:
  FIXES ARE AVAILABLE
IBM Tivoli Monitoring 6.2.2 Fix Pack 8 (6.2.2-TIV-ITM-FP0008) [http://www-01.ibm.com/support/docview.wss?uid=swg24031354]
IBM Tivoli Monitoring 6.2.2 Fix Pack 9 (6.2.2-TIV-ITM-FP0009) [http://www-01.ibm.com/support/docview.wss?uid=swg24032067]
IBM Tivoli Monitoring 6.2.2 Fix Pack 6 (6.2.2-TIV-ITM-FP0006) [http://www-01.ibm.com/support/docview.wss?uid=swg24030135]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  Severity:    3
   Approver:   LG
   
   Enter the L2 engineer who did the recreate or "None":
   L2 engineer: None
   Compid:      5724C04LA
   Abstract:    CT-3686: kill -HUP can't restart the unix log
   process
   
   
   Environment:
   
   ITMfOS 6.2 FP2
    SuSE SLES 11.0 64bit AMD64/EM64TProblem
   TEMS/TEPS
    Windows 2003 EE 32bit
   Description:
    Recreation Procedure:
     1. Get the agentPID.
   tivn13:/opt/IBM/ITM/bin # ps -ef|grep ul
   root     20211     1  0 19:34 pts/3    00:00:00
   /opt/IBM/ITM/lx8266/ul/bin/kulagent
   root     20695 18799  0 20:04 pts/3    00:00:00 grep ul
   
   2. modify the $install_dir/config/kul_configfile to make this
   agent not monotor utmp logs
   
   # Linux:  Uses utmp logs.
   #/var/run/utmp                  ;n      ;a
   #/var/log/wtmp                  ;n      ;a
   #
   
   3. Issue the command kill -HUP agentPID to send the monitoring
   agent a refresh signal.
   [root@tiv157 config]# kill -HUP 20211
   
   4. refresh TEP, the utmp logs are not monitored.
   5. the unix log agent process was killed, it not restart. The
   same problem also existed on Suse 11 pSeries.
   6. ITM 6.1 FP7 UA agent on Suse 11 32bit xSeries could get the
   expect result.
   
   Related Files and Output:
   The problem has been reproduced this with a 6.2.1 and a recent
   6.2.2 version on a RHEL4 x86. So this does is not related to the
   Linux version, but rather to the ITM version because 6.1 FP7
   didn't show this problem.
   After a deeper analysis I can conclude that signals management
   code within kul code has not changed since 6.1 FP7. We run
   sigwait() in a separate thread to intercept the SIGHUP signal
   and perform the refresh of the configuration.
   Instead the following behaviour can be observed in the 6.2.*
   agent: attaching the kulagent with gdb and then continuing
   execution, when the SIGHUP is received this is the backtrace:
   (gdb) cont
   Continuing.
   
   Program received signal SIGHUP, Hangup.
   [Switching to Thread 1093780960 (LWP 8977)]
   0x00a897a2 in _dl_sysinfo_int80 () from /lib/ld-linux.so.2
   (gdb) bt
   #0  0x00a897a2 in _dl_sysinfo_int80 () from /lib/ld-linux.so.2
   #1  0x00cf4c26 in pthread_cond_wait@@GLIBC_2.3.2 ()
      from /lib/tls/libpthread.so.0
   #2  0x4006b98c in CallManager ()
      from /opt/IBM/ITM622-d9123/tmaitm6/li6263/lib/libkdc.so
   #3  0x4006bccc in KDCS_AddCallTask ()
      from /opt/IBM/ITM622-d9123/tmaitm6/li6263/lib/libkdc.so
   #4  0x4006f462 in rpc__listen ()
      from /opt/IBM/ITM622-d9123/tmaitm6/li6263/lib/libkdc.so
   #5  0x4063097f in Listen ()
      from /opt/IBM/ITM622-d9123/tmaitm6/li6263/lib/libkra.so
   #6  0x4062fdc7 in kglpsrvr ()
      from /opt/IBM/ITM622-d9123/tmaitm6/li6263/lib/libkra.so
   #7  0x4062f5ec in kramain ()
      from /opt/IBM/ITM622-d9123/tmaitm6/li6263/lib/libkra.so
   #8  0x0805d964 in main ()
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  The Monitoring Agent for UNIX Log crashes when receiving the
   refresh signal kill -HUP
   
   
    
   
   

PROBLEM CONCLUSION
 *  The fix for this APAR is contained in the following maintenance
   packages:
   | fix pack | 6.2.1-TIV-ITM-FP0001
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IZ53277
   
   
 * REPORTED COMPONENT NAME
   ITM AGENT UNIX
   
   
 * REPORTED COMPONENT ID
   5724C04LA
   
   
 * REPORTED RELEASE
   620
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2009-06-19
   
   
 * CLOSED DATE
   2009-09-28
   
   
 * LAST MODIFIED DATE
   2010-09-22
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   ITM AGENT UNIX
   
   
 * FIXED COMPONENT ID
   5724C04LA
   
   

APPLICABLE COMPONENT LEVELS
 * R620 PSY
   UP
   
   
 * R621 PSY
   UP
   
   
 * R622 PSY
   UP