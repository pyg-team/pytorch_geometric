Title: IBM ITCAM Data Collector connection to the Managing Server fails with Connection Refused. - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 The Data Collector (DC) connection may fail with “Connection Refused” if the Managing Server’s(MS) host name can resolve to an IP address that cannot reach the MS. 

CAUSE
The DC obtains the MS kernel’s network address from the MS. If a host name is specified for the kernel, and any of it’s resolved IP addresses cannot reach the MS from the DC, ITCAM’s connection attempt will fail if one of these "invalid” IP’s is used.

RESOLVING THE PROBLEM
Instead of host name, specify a “valid” IP address for the MS in the <MS_HOME>/bin/setenv.sh file, and in ITCAM 6.1, the ms.properties file. This solution usually works except when there is a firewall with Network Address Translation (NAT) enabled. In that case, you must make network changes so that all the resolved IPs can reach the MS. 

Change as directed:

ITCAM 6.0 ( or earlier )
In MS_home/bin/setenv.sh:
KERNEL_HOST01=<ip addr of MS>
KERNEL_HOST02=<ip addr of MS>

ITCAM 6.1
In MS_home/bin/setenv.sh:
KERNEL_HOST01=<ip addr of MS>
am_socket_bindip=<ip addr of MS>
am_socket_exportip=<ip addr of MS>
In MS_HOME/etc/ms.properties, modify “kernel.hosts” specifying MS IP address:
kernel.hosts=<ip addr of MS>CBSPort:RFSPort:RMIPort - usually -
kernel.hosts=<ip addr of MS>9122:9120:9118

Example:
kernel.hosts=9.12.20.220:9122:9120:9118

Example of the error message:
This example is from z/OS, but the problem can occur on any platform.

<PPECONTROLLER, 60014b53-f7e9-db01-4272-2a9f50388c89.511, 
9.12.20.161> Unable to join Kernel WSRT7.pdl.pok.ibm.com:9120 - 
java.net.ConnectException: EDC8128I Connection refused. 
(errno2=0x76630291); nested exception is: 
java.net.ConnectException: EDC8128I Connection refused. 
(errno2=0x76630291) 

To determine IP addresses for a given MS host name [issue on the DC]:
nslookup <MS_host_name> 

To test basic connectivity, for each IP address listed by NSLOOKUP, issue:
ping <ip_address>