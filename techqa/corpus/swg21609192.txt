Title: IBM CICS VT IVP transaction VTMV receives INVREQ on EXEC CICS READ - United States

Text:
ivp; vtmv; glue; xfcreq; xfcreqc; invreq; sqlclode sqlcode904 sqlcode-904 DSNT408I MSGDSNT408I ; 5655Y0100 R200 R201 R202 5655-Y01 5655Y01 FMID HCVT200 JCVT201 JCVT202 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 You are running the CICS VSAM Transparency for z/OS (CICS VT) supplied installation verification procedure (IVP) transaction VTMV. You receive an INVREQ response on the EXEC CICS READ command retrieving record key 245021 from the VIDKSDS file. You also receive SQLCODE=-904 with reason 00E30305. 

SYMPTOM
DSNT408I SQLCODE = -904 [http://publib.boulder.ibm.com/infocenter/dzichelp/v2r2/topic/com.ibm.db2z10.doc.codes/src/tpc/n904.htm], ERROR: UNSUCCESSFUL EXECUTION CAUSED BY AN UNAVAILABLE RESOURCE. REASON 00E30305, TYPE OF RESOURCE 00000801, AND RESOURCE NAME VIDCOLL.VIDKSDS1.18CE7C4F0E3169F2

DSNT418I SQLSTATE = 57011 SQLSTATE RETURN CODE
DSNT415I SQLERRP = DSNXEAAL SQL PROCEDURE DETECTING ERROR
DSNT416I SQLERRD = -150 0 0 -1 0 0 SQL DIAGNOSTIC INFORMATION
DSNT416I SQLERRD = X'FFFFFF6A' X'00000000' X'00000000' X'FFFFFFFF' X'00000000' X'00000000' SQL DIAGNOSTIC INFORMATION


CAUSE
 In this case, product DB2 SAFE was initialized after VIDCINIT and its XFCREQ GLUE received control after CICS VT.

ENVIRONMENT
CICS VT V2.1; CICS TS V3.2; z/OS V1.11; DB2 V9;

DIAGNOSING THE PROBLEM
The CICS auxiliary trace for the problem indicates the CICS VT GLUE and TRUE were being invoked correctly and the correct DB2 SQL call was being issued. The response from DB2 was correct but we found that the RESP code was being set incorrectly and CICS VT interpreted this as a File Not Found condition. The resp code seemed to be set by another FC GLUE running in the same region. This GLUE is for the SAFE product which also uses exits XFCREQ and XFCREQC. 

The difference between the failing and the working CICS environments is the order of the GLUEs in the PLTPI. In the failing environment the CICS VT GLUE was first in the PLTPI before SAFE. In the working environment, the CICS VT GLUE was after the DB2 SAFE PLTPI.

CICS VT already uses the recommended method for sharing the UEPTSTOK when multiple FC GLUEs are running in the same CICS region. See APAR PM55372 [http://www-01.ibm.com/support/docview.wss?uid=swg1PM55372] which describes a sharing method for the UEPTSTOK token.

RESOLVING THE PROBLEM
Ensure the CICS VT PLTPI program VIDCINIT is specified after any other applications that use the XFCREQ GLUE. 

RELATED INFORMATION
#Use of the task token UEPTSTOK [http://pic.dhe.ibm.com/infocenter/cicsts/v5r1/topic/com.ibm.cics.ts.doc/dfha3/topics/uttok.html]
CICS VT IVP [http://pic.dhe.ibm.com/infocenter/cicsts/v4r2/topic/com.ibm.cics.vt.doc/topics/cvtugb0013.html]




PRODUCT ALIAS/SYNONYM
 CICSVT CICS VT