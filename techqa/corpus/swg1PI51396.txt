Title: IBM PI51396: REPLICATION LOGGING IS GENERATED WHEN IT SHOULD NOT BE WHICH CAN CAUSE DUPLICATE KEY ERRORS IN VSAM DATA REPLICATION - United States

Text:
z/os  A FIX IS AVAILABLE
Obtain the fix for this APAR.


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  You are running CICS TS 5.1  and find replication logging is
   generated- that is, log records contain the replication logging
   bit on, when they should not.   Because this bit is on,
   replication logging records are generated when they should not
   be.  This can cause Replication for VSAM to fail with duplicate
   key, data mismatch or key not found problems.
     The problem is seen when an EXEC CICS START command is
   used to start the CFC1 task on CICSA. The logic in DFHFCLJ
   in CICSB sees the original transid in the origin data for
   the CSMI task is set to the tranid of the task that issued
   the START, rather than the CFC1 task itself. This causes
   the logic in DFHFCLJ to incorrectly write out the file
   operations generated by CFC1 to the replication log for
   CICSB.
   Additional Symptom(s) Search Keyword(s): KIXREVEPH
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED: All CICS users                               *
   ****************************************************************
   * PROBLEM DESCRIPTION: Unnecessary replication logging when    *
   *                      file control requests are function      *
   *                      shipped to an FOR.                      *
   ****************************************************************
   * RECOMMENDATION:                                              *
   ****************************************************************
   If CICS is responding to replication log data by applying file
   control changes from the replication log, transaction CFC1
   issues the file control requests. If the target file is remote,
   then these are function shipped to the FOR. DFHFCLJ has code to
   prevent further replication logging for such work, as it is
   being driven as the result of replication logging. It checks
   the transaction is not CFC1 before writing replication log
   data for the file control requests. In the case of function
   shipped requests, the transaction will be CSMI. This means
   DFHFCLJ has to check whether CSMI tasks were initiated from
   CFC1 tasks. It does this by inquiring on the association data
   for the first transid. Normally this would be CFC1; however in
   this case CFC1 was EXEC CICS STARTed by a front end
   listener task. This meant the DFHMNADM call did not return
   CFC1 and so DFHFCLJ did not avoid the logging to the replication
   log.
   KEYWORDS: fclj active standby PM86451 [http://www-01.ibm.com/support/docview.wss?uid=swg1PM86451]
   
   
    
   
   

PROBLEM CONCLUSION
 *  DFHFCLJ has been changed to inquire on the transid from the
   previous hop rather than the first transid in order to determine
   whether CSMI was invoked by CFC1.
   
   
    
   
   

TEMPORARY FIX
 *  FIX AVAILABLE BY PTF ONLY
   
   
    
   
   

COMMENTS
 *  &#215;**** PE16/01/07 FIX IN ERROR. SEE APAR PI54769 [http://www-01.ibm.com/support/docview.wss?uid=swg1PI54769]  FOR DESCRIPTION
   
   
    
   
   

APAR INFORMATION
 * APAR NUMBER
   PI51396
   
   
 * REPORTED COMPONENT NAME
   CICS TS Z/OS V5
   
   
 * REPORTED COMPONENT ID
   5655Y0400
   
   
 * REPORTED RELEASE
   800
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt / Xsystem
   
   
 * SUBMITTED DATE
   2015-10-28
   
   
 * CLOSED DATE
   2015-12-14
   
   
 * LAST MODIFIED DATE
   2016-02-01
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

MODULES/MACROS
 *  DFHFCLJ
   
   
    
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   CICS TS Z/OS V5
   
   
 * FIXED COMPONENT ID
   5655Y0400
   
   

APPLICABLE COMPONENT LEVELS
 * R800 PSY UI33889 [HTTPS://WWW14.SOFTWARE.IBM.COM/WEBAPP/SET2/ORDERMEDIA/SHOPCART?PTFS=UI33889]
   UP16/01/06 P F601
   
   
 * R900 PSY UI33890 [HTTPS://WWW14.SOFTWARE.IBM.COM/WEBAPP/SET2/ORDERMEDIA/SHOPCART?PTFS=UI33890]
   UP16/01/06 P F601
   
   

FIX IS AVAILABLE
 * SELECT THE PTF APPROPRIATE FOR YOUR COMPONENT LEVEL. YOU WILL BE REQUIRED TO SIGN IN. DISTRIBUTION ON PHYSICAL MEDIA IS NOT AVAILABLE IN ALL COUNTRIES.