Title: IBM Modeler job steps restart when run in C&DS on JBoss - United States

Text:
JBoss jobs restart modeler TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Attempts to run a job with Modeler jobs steps from IBM SPSS Collaboration and Deployment Services result in job steps restarting 

SYMPTOM
The job step log may look like this: 

Stream execution started
Executing SQL: DROP TABLE "ZIP_DEMOGRAPHICS"
HY000[54] [Oracle][ODBC][Ora]ORA-00054: resource busy and acquire with NOWAIT specified or timeout expired

Stream execution complete, Elapsed=0.42 sec, CPU=0.08 sec
Execution was interrupted


AEQMJ0100E: Script error (HY000[54] [Oracle][ODBC][Ora]ORA-00054: resource busy and acquire with NOWAIT specified or timeout expired)




CAUSE
Jobs are restarting due to a connection issue. The JBoss JMS Engine is losing connections 
and re-sending the message to run the jobstep a second time (or third time). 




ENVIRONMENT
C&DS 6.0 Fix Pack 1
JBoss 6.1
Oracle
VMWare ESX



DIAGNOSING THE PROBLEM
Review the job step history log for repetition of the job steps and/or a timeout error like this: 
HY000[54] [Oracle][ODBC][Ora]ORA-00054: resource busy and acquire with NOWAIT specified or timeout expired

The following warning message will also be in the cds.log: 


WARN [org.hornetq.core.client] RemotingConnectionImpl (hornetq-failure-check-thread) HQ212037: Connection failure has been detected: HQ119014: Did not receive data from invm:0. It is likely the client has exited or crashed without closing its connection, or the network between the server and client has failed. You also might have configured connection-ttl and client-failure-check-period incorrectly. Please check user manual for more information. The connection will now be closed. [code=CONNECTION_TIMEDOUT] 

It should be noted that this problem has been seen before when JBoss is the application server used in a VM. 

As a debug step the same jobs were tested in a WebSphere/C&DS configuration in the same environment and the same behavior was not seen.


RESOLVING THE PROBLEM
JBoss recommendation is to alter the cds_server.xml file and add the following code under each connection factory:

<connection-ttl>-1</connection-ttl>
<reconnect-attempts>-1</reconnect-attempts>
<call-timeout>600000</call-timeout>

The file can be found in C:\jboss-eap-6.1\standalone\configuration\cds_server.xml 

Example of one stanza that has been updated: 


<jms-connection-factories>
<connection-factory name="InVmConnectionFactory">
<connection-ttl>-1</connection-ttl> 
<reconnect-attempts>-1</reconnect-attempts>
<call-timeout>600000</call-timeout>
<connectors>
<connector-ref connector-name="in-vm"/>
</connectors>
<entries>
<entry name="java:/ConnectionFactory"/>
</entries> 

 

Restart the server after making the changes. 




RELATED INFORMATION
 Need more help? Our C&DS forum is Live! [https://developer.ibm.com/answers/topics/collaboration.html?smartspace=predictive-analytics]