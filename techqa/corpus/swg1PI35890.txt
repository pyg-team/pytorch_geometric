Title: IBM PI35890: CICS JVMSERVER RECEIVING JVMDUMP039I PROCESSING DUMP EVENT "GPF", DETAIL "" AT STARTUP - United States

Text:
z/os  A FIX IS AVAILABLE
Obtain the fix for this APAR.


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  The JVMDUMP039I error occurrs in all regions that the JVMSERVER
   is defined to run.  It only occurrs after the systems get IPL'd
   and when the regions get started AUTO.  After a general
   protection fault (gpf) the issue hangs the CICS regions and
   they have to be cancelled and COLD started in order to get out
   of the issue.The IPL process includes a clean shutdown of CICS
   and then an IPL of z/OS.
   
   The following message is also received:
   
   DFHSJ0005 CICSRGN AN UNEXPECTED ABEND HAS OCCURRED ON THE
   INITIAL PTHREAD TCB FOR JVMSERVER: Servername
   
   This message indicates a catastrophic failure of the JVM,
   meaning any further requests to the JVM will fail.
   
   This APAR will address the undesirable follow-on consequences
   of the Liberty shutdown:
   
   1) gpf in the JVM server
   2) CICS system hang
   
   
   
   Additional Symptom(s) Search Keyword(s): KIXREVSVR
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED: All CICS users.                              *
   ****************************************************************
   * PROBLEM DESCRIPTION: 0C4 abend after Java application issues *
   *                      System.exit().                          *
   ****************************************************************
   * RECOMMENDATION:                                              *
   ****************************************************************
   A Java application issues System.exit() on a regular Java
   (non-CICS) thread.  The JVM begins to terminate and drives an
   exit hook routine in DFHSJCS.  This exit routine attempts to
   issue message DFHSJ0214 and terminate CICS.  The CICS domain
   calls required to perform these actions are not possible on a
   non-CICS TCB and 0C4 abend occurs trying to locate CICS control
   blocks.
   
   The JVM handles the abend and completes termination.  The LE
   enclave used to run the JVM also terminates.  The JVMSERVER
   resource in CICS is unaware of this sudden termination and
   still reports the JVMSERVER as ENABLED.
   
   When the next request to run in the JVM requires a new T8 TCB
   to be created that task will end up stuck waiting for the IPT
   of the JVM to create a new thread.  This will never happen
   because the IPT no longer exists.  While the task is waiting
   it holds the DSITLOCK.  Eventually other tasks in CICS will
   require the DSITLOCK and suspend waiting for it.  One of
   these waiting tasks will also hold the XMLOCK.  This prevents
   all new tasks starting in CICS.
   
   CICS must be cancelled to get out of this situation.
   
   A second problem occurs when the JVM fails to initialise
   within the OSGI_FRAMEWORK_TIMEOUT time.  If this happens then
   the thread performing the initialisation is cancelled.  The
   thread then enters a cleanup routine in DFHSJSC which attempts
   to make some monitoring calls.  These require access to CICS
   control blocks but the thread is not a CICS TCB.  An 0C4 abend
   occurs locating the CICS control blocks.
   
   Additional Keywords:
   ABEND0C4  S0C4  ABENDS0C4  ASJS  SJ0214  msgDFHSJ0214
   
   
    
   
   

PROBLEM CONCLUSION
 *  CICS has been changed to always be able to issue message
   DFHSJ0214, take a system dump and terminate CICS when
   System.exit() is issued regardless of whether it happened on a
   CICS enabled thread or not.
   
   DFHSJSC has been modified to no longer attempt to make
   monitoring calls on the non-CICS thread used to initialise
   the OSGi framework.
   
   
    
   
   

TEMPORARY FIX
 *  FIX AVAILABLE BY PTF ONLY
   
   
    
   
   

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PI35890
   
   
 * REPORTED COMPONENT NAME
   CICS TS Z/OS V5
   
   
 * REPORTED COMPONENT ID
   5655Y0400
   
   
 * REPORTED RELEASE
   800
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   YesSpecatt / Pervasive
   
   
 * SUBMITTED DATE
   2015-02-26
   
   
 * CLOSED DATE
   2015-07-03
   
   
 * LAST MODIFIED DATE
   2015-08-03
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
    UI29120 UI29121 UI29122 UI29123 UI29124 UI29125
   
   

MODULES/MACROS
 *  DFHAMSJ  DFHAPJVM DFHAPLJP DFHAXIS2 DFHCDJNI DFHEIQSY DFHMNXM
   DFHRLRO  DFHSJBD  DFHSJDM  DFHSJDS  DFHSJDUF DFHSJIN  DFHSJIS
   DFHSJIT  DFHSJJS  DFHSJJST DFHSJL   DFHSJPTI DFHSJRL  DFHSJSA
   DFHSJSC  DFHSJST  DFHSJTE  DFHSJTH  DFHSJTRI DFHSJXM  DFHSTP
   DFHXSJNI DFJ@H356 DFJ@H360 DFJ@H386 DFJ@H427 DFJDTCOE DFJOUTRE
   
   
    
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   CICS TS Z/OS V5
   
   
 * FIXED COMPONENT ID
   5655Y0400
   
   

APPLICABLE COMPONENT LEVELS
 * R80D PSY UI29121 [HTTPS://WWW14.SOFTWARE.IBM.COM/WEBAPP/SET2/ORDERMEDIA/SHOPCART?PTFS=UI29121]
   UP15/07/10 P F507
   
   
 * R800 PSY UI29120 [HTTPS://WWW14.SOFTWARE.IBM.COM/WEBAPP/SET2/ORDERMEDIA/SHOPCART?PTFS=UI29120]
   UP15/07/10 P F507
   
   
 * R803 PSY UI29122 [HTTPS://WWW14.SOFTWARE.IBM.COM/WEBAPP/SET2/ORDERMEDIA/SHOPCART?PTFS=UI29122]
   UP15/07/10 P F507
   
   
 * R90D PSY UI29124 [HTTPS://WWW14.SOFTWARE.IBM.COM/WEBAPP/SET2/ORDERMEDIA/SHOPCART?PTFS=UI29124]
   UP15/07/10 P F507
   
   
 * R900 PSY UI29123 [HTTPS://WWW14.SOFTWARE.IBM.COM/WEBAPP/SET2/ORDERMEDIA/SHOPCART?PTFS=UI29123]
   UP15/07/10 P F507
   
   
 * R903 PSY UI29125 [HTTPS://WWW14.SOFTWARE.IBM.COM/WEBAPP/SET2/ORDERMEDIA/SHOPCART?PTFS=UI29125]
   UP15/07/10 P F507
   
   

FIX IS AVAILABLE
 * SELECT THE PTF APPROPRIATE FOR YOUR COMPONENT LEVEL. YOU WILL BE REQUIRED TO SIGN IN. DISTRIBUTION ON PHYSICAL MEDIA IS NOT AVAILABLE IN ALL COUNTRIES.