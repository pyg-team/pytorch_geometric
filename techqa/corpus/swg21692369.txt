Title: IBM Installing and running PSMATCHING3 R Extension command - United States

Text:
 TECHNOTE (FAQ)

QUESTION
 I have downloaded the PSMATCHING3.03 extension command to perform propensity score matching in SPSS. I downloaded the current version from http://sourceforge.net/projects/psmspss/ [http://sourceforge.net/projects/psmspss/] . I have the correct version of R installed and the R Essentials for my SPSS version. I installed the PSMATCHING extension by installing the spd file under 
Utilities->Custom Dialogs as described in the Appendix of Thoemmes' paper, "Propensity Score Matching in SPSS". 
https://www.human.cornell.edu/hd/qml/upload/Thoemmes_2012.pdf [https://www.human.cornell.edu/hd/qml/upload/Thoemmes_2012.pdf]
The PS MATCHING menu option was added to my Analyze menu and I can open and run that dialog. However, when I do run PS Matching, I receive the error message,
"The following is not recognized as an SPSS command" 

ANSWER
Installing the spd file does install the custom dialog but does not install the extension command. 
When you downloaded the file from sourceforge, did it appear as a .spe or .zip file? For some people it downloads with a .zip extension. In this case you should not unzip it, but instead rename the file extension to .spe (e.g. PSMATCHING3.04.spe). Install it as an extension bundle, and not as a custom dialog, from 
Utilities->Extension Bundles->Install Local Extension Bundle. 
(In SPSS versions prior to 22, the menu will be named 
Utilities->Extension Bundles->Install Extension Bundle.) 
Browse to the directory where you saved the .spe file. It should appear in the file list in the "Open an Extension Bundle" dialog. Highlight the file and click Open to begin the installation.

Be sure that you have launched SPSS Statistics in "Run as Administrator" mode when installing the PSMATCHING extension, 

Be sure that your versions of SPSS, R, and the R Programmability Essentials all have the same level of bitness (32-bit or 64-bit).

PSMATCHING3 incorporates several R packages, including Matrix, RITools, lme4 In some cases, it has been necessary to install one or more of these packages manually from R. Be sure to launch R as Administrator. In R, open the Packages menu and choose Install Packages. You will be given a drop-down menu of Cran mirrors. Select a Cran mirror that is relatively close to you. You will then be presented with a drop-down menu of R packages to install,. 

Note that PSMATCHING3 requires that the data set have no missing values, even among variables that are not used in the matching. Cases with missing values must be dropped before the matching begins.

RELATED INFORMATION
 Need more help? Our Statistics forum is Live! [https://developer.ibm.com/answers/topics/statistics.html?smartspace=predictive-analytics]