Title: IBM HOWTO check current limit - United States

Text:
ulimit;limits;db2sysc;core;db2pdcfg;corefile TROUBLESHOOTING

PROBLEM
Check ulimit of a currently running process

SYMPTOM
ulimits -c command shows 0 but db2sysc continues to produce coredumps

CAUSE
Userid used to start DB2 does not have its ulimit changed or db2pdcfg not set

DIAGNOSING THE PROBLEM



[db2inst1@test ~]$ ps -elf|grep db2sysc
4 S db2inst1 13860
 13858 1 80 0 - 413578 futex_ 16:01 pts/1 00:00:00 db2sysc 0

[db2inst1@test ~]$ cd /proc/13860


[db2inst1@test 13860]$ cat limits

Limit Soft Limit Hard Limit Units
Max cpu time unlimited unlimited seconds
Max file size unlimited unlimited bytes
Max data size unlimited unlimited bytes
Max stack size 8388608 unlimited bytes
Max core file size unlimited unlimited bytes


Also check:

[db2inst1@test 13860]$ db2pdcfg

Current PD Control Block Settings:

All error catch flag settings cleared.


db2cos is enabled for engine traps.
PD Bitmap: 0x1000
Sleep Time: 3
Timeout: 300
Current Count: 0
Max Count: 255

Current bitmap value: 0x0


Instance is not in a sleep state

DB2 trap resilience is enabled.
Current threshold setting : 0 ( disabled )
Number of traps sustained : 0


Database Member 0

FODC (First Occurrence Data Capture) options:
Dump directory for large objects (DUMPDIR)= /home/db2inst1/sqllib/db2dump/
Service level (SERVICELEVEL)= AUTOMATIC (Effective: FULL)
Dump Core files (DUMPCORE)= AUTO (Effective: ON)

Current hard core file size limit = Unlimited

Current soft core file size limit = Unlimited

Dump shared memory (DUMPSHM)= OFF

RESOLVING THE PROBLEM
1) Ensure userid used to start DB2 has its ulimit correctly set. Some customer environments source db2profile script then start the instance as another user id

2) Check /etc/security/limits.conf for the DB2 instance owner or user id which executes db2start.

3) db2pcfg [https://www.ibm.com/support/knowledgecenter/en/SSEPGG_11.1.0/com.ibm.db2.luw.admin.cmd.doc/doc/r0023252.html] -fodc dumpcore=<auto |on |off >