Title: IBM PI80153: JAVA OUT-OF-MEMORY ERROR WHEN USING IIB WITH COMPUTE AND WTX NODES BOTH ACCESSING JAVA CODE - United States

Text:
 SUBSCRIBE TO THIS APAR
By subscribing, you receive periodic emails alerting you to the status of the APAR, along with a link to the fix after it becomes available. You can track this item individually or track all items by product.

Notify me when this APAR changes.

Notify me when an APAR for this component changes.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  A Java memory leak (leading to an out-of-memory condition) may
   be detected when using an IBM WebSphere Transformation Extender
   (WTX) / IBM Transformation Extender (ITX) node in IBM
   Integration Broker 9.0.0.6.  This leak has been observed where
   there are calls to Java from within both a Compute Node and from
   within the WTX / ITX map using the JEXIT() function.
   
   
    
   
   

LOCAL FIX
 *  WTXRTC - 59937
   PB / PB
   Circumvention: A Java Compute Node can be inserted in the
   message flow between the Compute Node and the WTX / ITX Node
   
   
    
   
   

PROBLEM SUMMARY
 *  Users Affected:
   IBM Transformation Extender customers who deploy to IIB and use
   ESQL node to call ITX node
   
   Problem Description:
   A map that uses JEXIT may leak the following java objects
   created in JNI layer:
   Java/lang/String
   Char[]
   Java/lang/Class
   The leak happens when the map is part of IIB flow and the node
   calling ITX map is IIB ESQL node. The same map does not cause a
   java heap leak in any other environment. The workaround from IIB
   side is to add dummy JCN (Java compute node) between ESQL and TX
   node.
   If TX node is the only node in IIB environment, there is no
   leak.
   
   Platforms Affected:
   All
   
   
    
   
   

PROBLEM CONCLUSION
 *  ITX node calls PushLocalFrame just before it execute ITX map if
   the thread is already attached to JVM. If ESQL node that uses
   Java calls ITX node, the thread is already attached but the IIB
   code does not call PushLocalFrame before it calls ITX. The fact
   that ITX node calls PushLocalFrame before it calls the map was
   not helping JVM to release local references. The fix was to move
    PushLocalFrame call to the entry function of ITX lil.
   By being higher in the stack, PushLocalFrame indicated correctly
   to JVM that local references can be garbage collected.
   
   Applies to:
   8.4.0.5, 8.4.1.4, 9.0.0.1
   
   Fixed in the next service packs and releases.
   
   To obtain the fix for this APAR:
   
   To see if the next service pack or product release is available,
   check the IBM Transformation Extender Downloads page:
   http://www.ibm.com/support/entry/portal/product/other_software/t [http://www.ibm.com/support/entry/portal/product/other_software/t]
   ransformation_extender
   
   If the service pack or product release is available, download it
   from Fix Central:
   http://www.ibm.com/support/fixcentral/ [http://www.ibm.com/support/fixcentral/]
   
   If the service pack or product release is not available and you
   require the APAR fix immediately, request a Limited Availability
   Interim Fix (LAIF) by opening a PMR:
   http://www.ibm.com/support/servicerequest/Home.action [http://www.ibm.com/support/servicerequest/Home.action]
   
   Prior to version 9.0.0, IBM Transformation Extender was called
   IBM WebSphere Transformation Extender.
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PI80153
   
   
 * REPORTED COMPONENT NAME
   TX INTEG SERVER
   
   
 * REPORTED COMPONENT ID
   5724M4010
   
   
 * REPORTED RELEASE
   841
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt / Xsystem
   
   
 * SUBMITTED DATE
   2017-04-19
   
   
 * CLOSED DATE
   2017-05-31
   
   
 * LAST MODIFIED DATE
   2017-08-25
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   TX INTEG SERVER
   
   
 * FIXED COMPONENT ID
   5724M4010
   
   

APPLICABLE COMPONENT LEVELS
 * R840 PSY
   UP
   
   
 * R841 PSY
   UP
   
   
 * R900 PSY
   UP