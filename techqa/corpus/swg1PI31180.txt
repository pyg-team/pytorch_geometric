Title: IBM PI31180: CICS CKTI TRANSACTION ABENDED ASPQ AFTER MQ-TRIGGERED TRANS ABENDED AZIG - United States

Text:
z/os  A FIX IS AVAILABLE
Obtain the fix for this APAR.


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  You receive the following messages:
   DFHMQ0119D CICS detected an IRC failure.
              Cannot start transaction xxxx.
   
   DFHZN2200  FREE IMPLICIT failed during syncpoint processing for
              session >xyz , remote system xxxxxxxx. Transid CKTI.
              The original abend code was AZIG.
   
   DFHAC2251  Transaction CKTI running program DFHMQTSK term ????
              has failed with abend ASPQ. Syncpoint commit
              processing has failed while communicating with a
              remote system.
   
   DFHDU0206I A transaction dump for dumpcode: AZIG was suppressed
              by the XDUREQ USER EXIT.
   
   DFHAC2236  Transaction xxxx abend AZIG in program xxxxxxxx term
              ????. Updates to local recoverable resources will be
              backed out.
   
   The CKTI task should not be ended by an ASPQ abend, and a
   change is needed to recovery manager to ensure that this is the
   case.
   
   When we do the SYNCPOINT in the CKTI code after an IRC timeout,
   the syncpoint manager program DFHSPP knows we have to backout
   rather than commit, so RM just sees a backout_uow.
   
   This proceeds as expected and encounters the IRC link which
   timed out so it calls DFHCRIU to PERFORM_COMMIT
   UOW_STATUS(BACKWARDS). This calls ZISP which attempts a FREE
   which fails and then a FREE_DETACH which does work. DFHCRIU
   then returns to RM saying RESPONSE(OK) ACCESSIBLE(YES)
   FORGET(YES) PASS(NO) ABEND(YES) - and it's the abend(yes) which
   then provokes RM to return its exception of
   remote_commit_abended and thus culminates in the ASPQ abend.
   
   The link is recovery_status(unnecessary), DFHCRIU manages to
   free_detach it (after a plain free does not work), but tells RM
   abend(yes) - thus the ASPQ.
   
   This APAR will stop DFHCRIU from telling RM abend(yes) in the
   case of recovery_status(unnecessary) and the FREE->FREE_DETACH
   working.
   
   
   Additional Symptom(s) Search Keyword(s): KIXREVCTC
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED: All CICS users                               *
   ****************************************************************
   * PROBLEM DESCRIPTION: CKTI abends ASPQ after a WMQ triggered  *
   *                      task abends AICG                        *
   ****************************************************************
   * RECOMMENDATION:                                              *
   ****************************************************************
   The CKTI task suffers an unhandled SYNCPOINT abend, forced by
   RM, even though the remote link which has timed out is defined
   as recovery_status(unnecessary), and has been free_detached
   successfully. A remote WMQ triggered task abends AICG because
   the remote session has timed out and this leads to the CKTI
   task abending ASPQ.
   
   
    
   
   

PROBLEM CONCLUSION
 *  DFHCRIU has been changed to instruct RM not to force an abend
   in this circumstance.
   
   
    
   
   

TEMPORARY FIX
 *  FIX AVAILABLE BY PTF ONLY
   
   
    
   
   

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PI31180
   
   
 * REPORTED COMPONENT NAME
   CICS TS Z/OS V5
   
   
 * REPORTED COMPONENT ID
   5655Y0400
   
   
 * REPORTED RELEASE
   800
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2014-12-09
   
   
 * CLOSED DATE
   2015-02-11
   
   
 * LAST MODIFIED DATE
   2015-03-03
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
    PI30586 [http://www-01.ibm.com/support/docview.wss?uid=swg1PI30586]
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
    UI25120 UI25121
   
   

MODULES/MACROS
 *  DFHCRIU  DFHMQTSK
   
   
    
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   CICS TS Z/OS V5
   
   
 * FIXED COMPONENT ID
   5655Y0400
   
   

APPLICABLE COMPONENT LEVELS
 * R800 PSY UI25120 [HTTPS://WWW14.SOFTWARE.IBM.COM/WEBAPP/SET2/ORDERMEDIA/SHOPCART?PTFS=UI25120]
   UP15/02/19 P F502
   
   
 * R900 PSY UI25121 [HTTPS://WWW14.SOFTWARE.IBM.COM/WEBAPP/SET2/ORDERMEDIA/SHOPCART?PTFS=UI25121]
   UP15/02/19 P F502
   
   

FIX IS AVAILABLE
 * SELECT THE PTF APPROPRIATE FOR YOUR COMPONENT LEVEL. YOU WILL BE REQUIRED TO SIGN IN. DISTRIBUTION ON PHYSICAL MEDIA IS NOT AVAILABLE IN ALL COUNTRIES.