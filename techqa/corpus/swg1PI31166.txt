Title: IBM PI31166: WMQ Z/OS:WHEN DEFTYPE OF SYSTEM.COMMAND.REPLY.MODEL IS SET TO TEMPDYN, THE JCL CSQUTIL RETURNS TO RC=4 OR 8. - United States

Text:
z/os  A FIX IS AVAILABLE
Obtain the fix for this APAR.


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  The response messages are not being received from the
   remote queue-managers. The reason for this is that CSQUTIL will
   put the command messages to SYSTEM.COMMAND.INPUT using
   MQPER_PERSISTENCE_AS_Q_DEF. For example,when CSQUTIL is
   connected to CSQ1 and is processing commands to CSQ2
   (TGTQMGR(CSQ1)),the queue-manager detects that there is a
   cluster queue-manager object for CSQ2 and therefore the
   persistence for the message is taken from the
   SYSTEM.CLUSTER.TRANSMIT.QUEUE definition, which has
   DEFPSIST(YES). The message is then sent to CSQ2 (actually sent
   via IGQ) and a response message is returned via IGQ. The
   response message is persistent due to the persistence of the
   request, and when IGQ tries to put the message to the temporary
   dynamic queue it fails with MQRC_PERSISTENT_NOT_ALLOWED
   and the message goes to the dead-letter queue (CSQ1.DEAD.QUEUE).
   In this situation it would be expected that the request
   messages put by CSQUTIL are still non-persistent.
   
   
   Additional Symptom(s) Search Keyword(s):
   
   
    
   
   

LOCAL FIX
 *  N/A
   
   
    
   
   

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED: All users of WebSphere MQ for z/OS Version 7 *
   *                 Release 1 Modification 0.                    *
   ****************************************************************
   * PROBLEM DESCRIPTION: The COMMAND function of CSQUTIL fails   *
   *                      with 'CSQU051E Command responses not    *
   *                      received after 30 seconds' and the      *
   *                      CSQUTIL utility returns RC 8 if         *
   *                      SYSTEM.COMMAND.REPLY.MODEL is changed   *
   *                      to DEFTYPE(TEMPDYN).                    *
   ****************************************************************
   * RECOMMENDATION:                                              *
   ****************************************************************
   When putting command messages using the COMMAND function,
   CSQUTIL specifies MQPER_PERSISTENCE_AS_Q_DEF, causing the
   persistence of the command message to be determined by the
   DEFPSIST attribute of SYSTEM.COMMAND.INPUT, or if TGTQMGR is
   used, the DEFPSIST attribute of the resolved transmission queue
   or remote queue definition used to reach the targer queue
   manager.
   After the command is processed, the reply message is put with
   the same persistence as the request message, however if
   SYSTEM.COMMAND.REPLY.MODEL has DEFTYPE(TEMPDYN), the reply
   queue is a temporary dynamic queue and only non-persistent
   messages are allowed.
   If the command message (and consequently the reply message)
   was persistent, the reply message cannot be put to this
   queue, leading to CSQUTIL timing out and reporting CSQU051E.
   
   The failure to put the reply message may also be reported by
   messages in the queue manager joblog including:
   
    CSQM064I xxxx CSQMIGQA Intragroup queueing agent put
    messages to dead-letter queue
   or
    CSQN212E xxxx COMMAND SERVER ERROR PUTTING TO REPLY TO QUEUE
    CSQN203I xxxx <queuename>
    MQCC=2 MQRC=2048
   
   If a dead letter queue is defined the reply messages will be
   put to it with DLH.Reason 2048 (MQRC_PERSISTENT_NOT_ALLOWED)
   
   
    
   
   

PROBLEM CONCLUSION
 *  CSQUTIL is changed to put the command messages with
   MQPER_NOT_PERSISTENT.
   100Y
   CSQUTIL
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PI31166
   
   
 * REPORTED COMPONENT NAME
   WMQ Z/OS V7
   
   
 * REPORTED COMPONENT ID
   5655R3600
   
   
 * REPORTED RELEASE
   100
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2014-12-08
   
   
 * CLOSED DATE
   2015-02-17
   
   
 * LAST MODIFIED DATE
   2015-05-04
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
    PI34379 [http://www-01.ibm.com/support/docview.wss?uid=swg1PI34379] UI25205
   
   

MODULES/MACROS
 *  CSQUTIL
   
   
    
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WMQ Z/OS V7
   
   
 * FIXED COMPONENT ID
   5655R3600
   
   

APPLICABLE COMPONENT LEVELS
 * R100 PSY UI25205 [HTTPS://WWW14.SOFTWARE.IBM.COM/WEBAPP/SET2/ORDERMEDIA/SHOPCART?PTFS=UI25205]
   UP15/04/17 P F504
   
   

FIX IS AVAILABLE
 * SELECT THE PTF APPROPRIATE FOR YOUR COMPONENT LEVEL. YOU WILL BE REQUIRED TO SIGN IN. DISTRIBUTION ON PHYSICAL MEDIA IS NOT AVAILABLE IN ALL COUNTRIES.