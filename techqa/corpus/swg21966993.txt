Title: IBM Unable to Create Data source Connection using Dynamic Query Mode for few Oracle users - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 For few Oracle users, while testing the Oracle data source connectivity in DQM mode getting error XQE-DS-0014 Unable to logon to the data source. An unexpected error from the JDBC driver "oracle.jdbc.driver.OracleDriver" 

CAUSE
Placing multiple versions of ojdbc jar file in multiple locations of the Cognos installation path.

ENVIRONMENT
Windows

DIAGNOSING THE PROBLEM
- Test data source connectivity on Oracle data source using few Oracle users fail in DQM mode. Below error is observed in XQE logs and Cognos portal:


 XQE-DS-0014 Unable to logon to the data source. An unexpected error from the JDBC driver "oracle.jdbc.driver.OracleDriver":"java.lang.RunTimeException:java.lang.
NullPointerException".

-There are few Oracle users with which the data source connectivity test succeeds.
-All the Oracle users discussed here has same roles and privileges.
-Connectivity to Oracle(Using both type of users using which the data source connectivity test succeeds and fails) in JDBC mode succeeds on Cognos machine. Below is the syntax of the command used to test JDBC connectivity from Command prompt of Cognos machine.

Command Syntax used to test the JDBC connectivity:
java -cp "jdbcinfo.jar;<cognos install dir>\webapps\p2pd\WEB-INF\lib\<OJDBC JAR FILE NAME>;<cognos install dir>\webapps\p2pd\WEB-INF\lib\*Adaptor*.jar" com.ibm.cognos.jdbcinfo.App -U "jdbc:oracle:thin:@<Oracle Server IP>:<Port>:SID" -d oracle.jdbc.driver.OracleDriver -u <User Name> -p <Password> driverversion serverversion

eg: 
java -cp "jdbcinfo.jar;C:\Program Files\ibm\cognos\c10\webapps\p2pd\WEB-INF\lib\ojdbc6.jar;C:\Program Files\ibm\cognos\c10\webapps\p2pd\WEB-INF\lib\*Adaptor*.jar" com.ibm.cognos.jdbcinfo.App -U "jdbc:oracle:thin:@<IP>:1521:serviceid01" -d oracle.jdbc.driver.OracleDriver -u username -p password driverversion serverversion

Note: Replace <IP> with Oracle server IP in above example.


RESOLVING THE PROBLEM
Steps to resolve the issue :- 


1. Check the exact version of the Oracle Database server. Confirm for the supported version of Oracle JDBC driver on Oracle website.

2. Identify if the ojdbcX.jar jdbc driver files have been placed at the right location by following the below steps :
2.a) Execute below command in DOS window. Make sure your current working directory is Cognos Install Dir.
<Cognos Install Dir>dir /a-d-h /od /s > cogfilesorted.txt 

The output would be written to cogfilesorted.txt file.
2.b) Search for string ojdbc in the cogfilesorted.txt, in order to figure out the location of the jar files. Any location other then the below mentioned location is considered as incorrect location for jar files.
<Cognos install dir>\webapps\p2pd\WEB-INF\lib 
<Cognos install dir>\v5dataserver\lib 

3. Remove unsupported version or unwanted ojdbc jar files(For example :- If ojdbc6.jar is supported then all other versions of Jar files like ojdbc5.jar, ojdbc7.jar should be removed) from all the unwanted locations.

Also you should not have multiple version of the same jar files at the same location.

4. If the Jar file is missing from any of the location mentioned in point(2.b) then you need to copy the right jar files at the location.

5. Restart Cognos services.

6. Test the datasource connection. It should now be successful.