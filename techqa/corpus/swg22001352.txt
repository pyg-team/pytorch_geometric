Title: IBM MustGather: StoredIQ Issues - United States

Text:
 TECHNOTE (FAQ)

QUESTION
 Ready to submit a PMR to StoredIQ Support for an issue you are seeing? Please see the below first to see what kind of files you can send to help Support analyze what is the root cause of the issue. 

CAUSE
Gathering files and attaching them to the PMR after submission of the issue will greatly expedite the speed at which Support can analyze the root cause of the issue you are seeing as they will likely need the information below to proceed.

ANSWER
Directions:

1) Please find the Category of the issue you are seeing 
2) Follow the steps to gather the necessary deliverables to submit to the PMR - Compress deliverables into a ZIP file (or equivalent compressed file format of your choice) 

3) After the PMR has been opened and deliverables are gathered, please submit them via ECuRep by going to the following link: http://www.ecurep.ibm.com/app/upload [http://www.ecurep.ibm.com/app/upload] 

4) Enter the PMR number 

5) Select 'Other' for 'Upload is for' 

6) Hit Continue, and then upload the deliverables requested

Categories and Steps to Gather: 

 

Failed Mount Attempt 

1) Include what exact version of StoredIQ you are using in the PMR text (example: StoredIQ 7.6.0.11) 

2) Packet capture of the Mount Attempt:

1. Open SSH session to your Dataserver
2. Run this command right before you attempt to mount the CIFS volume:

tcpdump -i eth0 -s0 -w /tmp/storediq_mount_attempt.pcap port not ssh and port not http

3. Attempt to mount the CIFS volume
4. Ctrl+C to stop the packet capture after the mount attempt fails


3) Screenshot of Error in the Volume Options Window on StoredIQ UI 

4) Screenshot showing that you are able to Ping the target server on your Dataserver 

5) Screenshot showing the set permissions for the Service Account being used to mount the volume for the particular Server you are trying to mount 

6) Include in the PMR text, what kind of server you are trying to mount and the FQDN of the server (ex: CIFS volume, windows2012share.storediq.ibm.com) 

7) Bundle up all files into a ZIP file and upload to PMR 

 

Failed Harvest Attempt 

1) Include what exact version of StoredIQ you are using in the PMR text (example: StoredIQ 7.6.0.11) 

2) Go to the DS UI > Audit > View all harvests > Click Volume you harvested > Click the Failed harvest > Take screenshot of this page -- then on the Right Column click links for Skipped/Failed Objects > Click on each link and 'Download list in CSV format' and save the CSV files 

3) Repeat Step 2 for each failed harvest 

4) Gather all relevant logs on the Dataserver: 

1. Open SSH session to your Dataserver 

2. Run this command to gather all logs - provide file named <hostname>_storediq_dataserver<date>.tar.gz from the /tmp directory:

tar --ignore-failed-read -cvzf /tmp/"$(hostname)_storediq_dataserver$(date '+%Y-%m-%d').tar.gz" /deepfs/config/*.out /deepfs/config/*.log /deepfs/config/*.xml /deepfs/config/update/update.log /deepfs/postgres/data/pg_hba.conf /usr/local/iqversion/GLOBALHANDLE


3. The command above only gathers trace logs from 'Today's' date, meaning IF the harvest was ran on a separate day from the date of running this command, or if the harvest ran multiple days, please also gather the relevant trace logs from those dates with the command:

tar --ignore-failed-read -cvzf /tmp/storediq_tracelogs.tar.gz /deepfs/config/trace* 

4. Gather the files generated above from your Dataserver using WinSCP or any other file transfer program. The locations of the files are in the /tmp directory, titled /tmp/storediq_dataserverDATE.tar.gz and /tmp/storediq_tracelogs.tar.gz 

5) Take a screenshot of your Harvester Settings on the DS UI located...DS UI > Configuration > Harvester Settings 

6) Take a screenshot of your Volume settings for the Volume you are harvesting 

7) Bundle up all files into a ZIP file and upload to PMR 

 

Report Generation Pending/Stuck/Failure 

1) Include what exact version of StoredIQ you are using in the PMR text (example: StoredIQ 7.6.0.11) 

2) Take a screenshot of the UI showing what state it shows the report is in 

3) Reports that are in progress/completed are actually stored on your Appstack: 

1. Open SSH session to your Appstack 

2. ll -ltr /tmp 

3. The above command will list all files in the /tmp directory -- Any reports currently in the process of being put together will be in this directory 

4. Take a screenshot of the output 

4) Reports that are complete are stored in the /var/siq/download directory 

1. ll -ltr /var/siq/download 

2. Look to see if the report you requested to be generated exists here and then take a screenshot of the output 

4) Take a screenshot after entering the command below on your Appstack (shows storage levels) 

df -h 

5) Take a screenshot of the Infoset details on your Appstack Workbench UI - we are interested in seeing the Size of the infoset 

6) Bundle up all files into a ZIP file and upload to PMR 

 

Infoset Pending/Stuck

1) Open SSH session to your Gateway
2) Enter the commands below one by one and take a screenshot after each one

psql -U dfuser -d dfdata -c 'select * from application_schema.infoset_debug_view;'
psql -U dfuser -d dfdata -c 'select * from application_schema.infoset_volume_status;'
psql -U dfuser -d dfdata -c 'select * from application_schema.infoset_specification;'


3) Then go to your Appstack UI > Workbench > Select the Infoset that is Pending -- Look on the Address bar (hyperlink) and you will see a long string of Letters and Numbers (ex: 0a9aa08a-83d5-4b8b-85a1-ba60fcaa5ee7) 

This number is the Infoset ID that we are interested in. 

4) Take a screenshot of this number on the address bar on the Appstack UI 

5) Gather logs from Dataserver: 

1. Open SSH session to your Dataserver 

2. Run this command to gather all logs - provide file named <hostname>_storediq_dataserver<date>.tar.gz from the /tmp directory:

tar --ignore-failed-read -cvzf /tmp/"$(hostname)_storediq_dataserver$(date '+%Y-%m-%d').tar.gz" /deepfs/config/*.out /deepfs/config/*.log /deepfs/config/*.xml /deepfs/config/update/update.log /deepfs/postgres/data/pg_hba.conf /usr/local/iqversion/GLOBALHANDLE 

6) Gather logs from Gateway: 

1. Open SSH session to your Gateway 

2. Gateway: provide file named <hostname>_storediq_gateway<date>.tar.gz from the /tmp directory:

tar --ignore-failed-read -cvzf /tmp/"$(hostname)_storediq_gateway$(date '+%Y-%m-%d').tar.gz" /deepfs/config/gateway-mesh.log /deepfs/config/*.out /deepfs/config/*.log /deepfs/config/*.xml /deepfs/config/update/update.log /deepfs/postgres/data/pg_hba.conf /usr/local/iqversion/GLOBALHANDLE 

7) Gather logs from Appstack: 

1. Open SSH session to your Apstack 

2. Appstack: provide file named <hostname>_storediq_appstack<date>.tar.gz from the /tmp directory:

tar --ignore-failed-read -cvzf /tmp/"$(hostname)_storediq_appstack$(date '+%Y-%m-%d').tar.gz" /var/bootstrap/products/appstack/version /var/bootstrap/appstack.log /var/bootstrap/appstack.history /var/siq/log/*.log /etc/siq/local.yaml /etc/siq/gateway.yaml /etc/siq/oauth.conf 

 8) Gather tar.gz files generated in the /tmp directories of each StoredIQ node using WinSCP or any other file transfer program/method 

9) Bundle up all files into a ZIP file and upload to PMR 

10) Include what exact version of StoredIQ you are using in the PMR text (example: StoredIQ 7.6.0.11) 

 

For Other Issues 

1) Include what exact version of StoredIQ you are using in the PMR text (example: StoredIQ 7.6.0.11) 

2) Describe the exact issue are you seeing and take relevant screenshots to attach to PMR 

3) Gather logs from Dataserver: 

1. Open SSH session to your Dataserver 

2. Run this command to gather all logs - provide file named <hostname>_storediq_dataserver<date>.tar.gz from the /tmp directory:

tar --ignore-failed-read -cvzf /tmp/"$(hostname)_storediq_dataserver$(date '+%Y-%m-%d').tar.gz" /deepfs/config/*.out /deepfs/config/*.log /deepfs/config/*.xml /deepfs/config/update/update.log /deepfs/postgres/data/pg_hba.conf /usr/local/iqversion/GLOBALHANDLE 

4) Gather logs from Gateway: 

1. Open SSH session to your Gateway 

2. Gateway: provide file named <hostname>_storediq_gateway<date>.tar.gz from the /tmp directory:

tar --ignore-failed-read -cvzf /tmp/"$(hostname)_storediq_gateway$(date '+%Y-%m-%d').tar.gz" /deepfs/config/gateway-mesh.log /deepfs/config/*.out /deepfs/config/*.log /deepfs/config/*.xml /deepfs/config/update/update.log /deepfs/postgres/data/pg_hba.conf /usr/local/iqversion/GLOBALHANDLE 

5) Gather logs from Appstack: 

1. Open SSH session to your Apstack 

2. Appstack: provide file named <hostname>_storediq_appstack<date>.tar.gz from the /tmp directory:

tar --ignore-failed-read -cvzf /tmp/"$(hostname)_storediq_appstack$(date '+%Y-%m-%d').tar.gz" /var/bootstrap/products/appstack/version /var/bootstrap/appstack.log /var/bootstrap/appstack.history /var/siq/log/*.log /etc/siq/local.yaml /etc/siq/gateway.yaml /etc/siq/oauth.conf 

 6) Gather tar.gz files generated in the /tmp directories of each StoredIQ node using WinSCP or any other file transfer program/method 

7) Bundle up all files into a ZIP file and upload to PMR