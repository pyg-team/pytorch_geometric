Title: IBM Deploying Content Platform Engine (CPE) on WebSphere Application Server V8.5.5 with JDK 1.8 - United States

Text:
 TECHNOTE (FAQ)

QUESTION
 Why does the FileNetEngine application not deploy correctly under WebSphere Application Server V8.5.5 when the application server is configured to use JDK 1.8? 

CAUSE
Due to limitations in WebSphere Application Server V8.5.5, if the node that deploys the FileNetEngine application for the CPE is running at a JDK level of 1.8 at the time the FileNetEngine application is deployed, the deployment appears to be successful when it is not because of issues with the WAS EJBDeploy tool. 
The following WebSphere technical notice details the limitations in the WAS EJBDeploy tool: http://www.ibm.com/support/docview.wss?uid=swg21994741 [http://www-01.ibm.com/support/docview.wss?uid=swg21994741]. 


While the application deployment appears successful, subsequent attempts to login via ACCE result in an error like

"FNRCA0032 The JNDI cannot be accessed. Message was: Some object reference in the name "FileNet/Engine" relative to the context 
"<WebSphere_CELL_NAME>/nodes/<WebSphere_Node_NAME>/servers/<WebSphere_APPLICATION_SERVER_NAME>" is invalid. Some possible causes include a context binding in the name which refers to a destroyed context, or an object binding which contains an invalid EJBHome reference."

Or an error like the following appears in the WebSphere SystemOut.log: 

[8/18/17 9:33:25:549 EDT] 000000cd EJBMDOrchestr E CNTR0075E: The user-provided class "com.filenet.apiimpl.transport.ejbstubs.EJSRemoteStatelessEngine_2e64c374" needed by the EnterpriseBean could not be found or loaded.
[8/18/17 9:33:25:550 EDT] 000000cd SharedEJBRunt E WSVR0068E: Attempt to start EnterpriseBean FileNetEngine#Engine-ejb-ws.jar#Engine failed with exception: com.ibm.ejs.container.EJBConfigurationException: Bean class com.filenet.apiimpl.transport.ejbstubs.EJSRemoteStatelessEngine_2e64c374 could not be found or loaded
at com.ibm.ws.metadata.ejb.EJBMDOrchestrator.loadGeneratedImplementationClasses(EJBMDOrchestrator.java:4919)
at com.ibm.ws.metadata.ejb.EJBMDOrchestrator.finishBMDInitWithReferenceContext(EJBMDOrchestrator.java:1077)
at com.ibm.ws.ejbcontainer.runtime.AbstractEJBRuntime.finishBMDInit(AbstractEJBRuntime.java:1659)
at com.ibm.ws.ejbcontainer.runtime.AbstractEJBRuntime.initializeDeferredEJBImpl(AbstractEJBRuntime.java:1597)
at com.ibm.ws.ejbcontainer.runtime.SharedEJBRuntimeImpl.initializeDeferredEJBImpl(SharedEJBRuntimeImpl.java:547)
at com.ibm.ws.ejbcontainer.runtime.AbstractEJBRuntime$1$1.run(AbstractEJBRuntime.java:1500)
at com.ibm.ws.ejbcontainer.runtime.AbstractEJBRuntime$1$1.run(AbstractEJBRuntime.java:1494) 



ANSWER
Use the following procedure to deploy the Content Platform Engine in a WAS 8.5.5 environment configured to use JDK 1.8. 

Prerequisites 

 * Content Platform Engine 5.2.1.7 or later 
 * WebSphere iFix for PI73197: Enable Java 8 Support for EJBDeploy on WebSphere Application Server: http://www.ibm.com/support/docview.wss?uid=swg24043474 [http://www-01.ibm.com/support/docview.wss?uid=swg24043474]. Install the on any nodes that will be used to deploy the FileNetEngine application. 
   
   The iFix can be found in IBM Fix Central using this URL https://www.ibm.com/support/fixcentral/swg/selectFixes?product=ibm%2FWebSphere%2FWebSphere+Application+Server&fixids=8.5.5.9-WS-WAS-IFPI73197&source=dbluesearch&function=fixId&parent=ibm/WebSphere [https://www-945.ibm.com/support/fixcentral/swg/selectFixes?product=ibm%2FWebSphere%2FWebSphere+Application+Server&fixids=8.5.5.9-WS-WAS-IFPI73197&source=dbluesearch&function=fixId&parent=ibm/WebSphere] 
   
   
 * If you are using WAS 8.5.5.11, contact IBM Support and request the fix for APAR FPI79731. Refer to the following tech note for more information on this APAR: http://www.ibm.com/support/docview.wss?uid=swg1PI79731 [http://www.ibm.com/support/docview.wss?uid=swg1PI79731]. 
 * The JDBC driver files that support JDK level 1.8 with the database you are using with CPE. Refer to the appropriate database vendor documentation for details. Then follow the procedure provided in "Specifying the WebSphere environment variables" in the FileNet Content Manager Knowledge Center to ensure that WebSphere uses the correct JDBC drivers. [https://www.ibm.com/support/knowledgecenter/SSNW2F_5.2.1/com.ibm.p8.planprepare.doc/p8ppi147.htm] 
   
   https://www.ibm.com/support/knowledgecenter/SSNW2F_5.2.1/com.ibm.p8.planprepare.doc/p8ppi147.htm [https://www.ibm.com/support/knowledgecenter/SSNW2F_5.2.1/com.ibm.p8.planprepare.doc/p8ppi147.htm]
   
   


Procedure  * If this is an upgrade and the JDBC provider is already created in WebSphere, ensure the JDBC providers class path for both standard and XA refer to the JDBC driver files that are required by your database vendor to support JDK level 1.8. If this is a fresh install, the Content Platform Engine V5.2.1.7 (and above) Configuration Manager places the proper values in the JDBC provider class path. 
   
    1. If stopped, start the application server instance. 
    2. In the WebSphere Administration Console, expand Resources > JDBC and select JDBC providers. 
    3. On the Resources > JDBC > JDBC providers page, select JDBC provider for the standard entry previously created by the Content Platform Engine Configuration Manager. 
    4. Modify the jar file names in the Class path field as needed to reflect those provided by your database vendor. 
    5. On the Resources > JDBC > JDBC providers page, select JDBC provider for the XA entry previously created by the CPE Configuration Manager. 
    6. Modify the jar file names in the Class path field as needed to reflect those provided by your database vendor.
   
   
 * Save any changes to the master configuration. and then restart the applications server node 
 * Start or restart the application server node that will host the FileNetEngine application 
 * Use the Content Platform Engine Configuration Manager to deploy the FileNetEngine application. Refer to the appropriate topic in the Knowledge Center for details: 
   
   For a new installation: "Deploying Content Platform Engine instances" https://www.ibm.com/support/knowledgecenter/SSNW2F_5.2.1/com.ibm.p8.install.doc/p8pin022.htm [https://www.ibm.com/support/knowledgecenter/SSNW2F_5.2.1/com.ibm.p8.install.doc/p8pin022.htm] 
   
   For an upgrade: "Deploying upgraded Content Platform Engine instances" https://www.ibm.com/support/knowledgecenter/SSNW2F_5.2.1/com.ibm.p8.install.doc/p8pup252.htm [https://www.ibm.com/support/knowledgecenter/SSNW2F_5.2.1/com.ibm.p8.install.doc/p8pup252.htm] 
   
   
 * Complete the installation or upgrade process following the procedures documented in the Knowledge Center. 
 * Once the install or upgrade is complete, confirm the Content Platform Engine is accessible by accessing the the P8CE/Health page: 
    * 
    * 
   
   
   Confirm that the Content Platform Engine version, the JVM version, and the JDBC driver version are correct using the Content Engine ping page:  * 
    * 
   
   
   If this is an upgrade, check the automatic upgrade status for Content Platform Engine data by entering the URL for the automatic upgrade status page into your browser:  * 
    * 
   
   

RELATED INFORMATION
 ACCE error after WAS upgrade [http://www.ibm.com/support/docview.wss?uid=swg22001183]




Cross reference information Segment Product Component Platform Version Edition Enterprise Content Management Case Foundation Enterprise Content Management Content Foundation Enterprise Content Management FileNet Content Manager