Title: IBM Unable to run a stored procedure in Framework Manager: QE-DEF-0179 - United States

Text:
query subject model modeling MSSQL TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 When trying to create a Query Subject from a Microsoft SQL Server Stored Procedure in Framework Manager, an error occurs. The stored procedure runs in Query Analyzer. 

SYMPTOM
QE-DEF-0179 The procedure call <ProcedureName> is unable to return a result set.
or
RQP-DEF-0179 The procedure call <ProcedureName> is unable to return a result set.


RESOLVING THE PROBLEM
Ensure that your stored procedure will return a result set when testing or updating the stored procedure. If the procedure is being tested with input parameters that will not return a result set then the above message will be returned. For example, if the procedure is defined according to: 

CREATE procedure procedure_name @input_val integer as
IF (@input_val = 1)
BEGIN
Select * from TABLE_NAME;ENDGO 

Then the only case where a result set will be returned is when the procedure is evaluated with the input_val parameter set to 1. Any other case will not return a result set to Framework Manager or the query engine running the report. When designing your stored procedure the result of the call should always contain a result set. In the above example if an empty result is desired for any case where input_val is not equal to 1 then the following will allow the procedure to validate successfully when imported into Framework Manager: 

CREATE procedure procedure_name @input_val integer as
IF (@input_val = 1)
BEGIN
Select * from TABLE_NAME;ENDELSEBEGIN
Select * from TABLE_NAME where 1=0;ENDGO 

The ELSE will ensure that there is always a record set returned from the stored procedure while the where clause will ensure that this record set is empty. The 
empty record set will allow the metadata describing the column names and data types to be retrieved from the database and thus create a valid query subject in Framework Manager. Note: In the case where a stored procedure returns multiple result sets, only the first result set will be used by IBM Cognos ReportNet or Cognos 8. For example if the stored procedure uses something like: 

select columnA from TableA;select columnA from TableB; 

This will only return results for TableA when used within Cognos BI. No error will be returned to the consumer. If both result sets are required then these must be merged within the stored procedure to generate a single result. This can often be accomplished with a simple union operation between the two queries as: 

select columnA from TableA union select columnA from 
TableB;