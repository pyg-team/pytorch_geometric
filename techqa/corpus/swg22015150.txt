Title: IBM Optim Designer creates an empty column map for tables in an Oracle database. - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 In Designer, the user can create a column map for a pair of tables in an existing Table Map editor by clicking the "Add Column Map" button. When the column map appears, it is supposed to show the columns of the tables by default. In some cases, however, the column map shows no columns at all.

This can also occur when using the column maps/Convert service that were created from Classic and then upgraded from Designer. 

CAUSE
This occurs when all of the following conditions occur: 

 1. The table being mapped includes either an underscore ('_') or percent ('%') in the name of the table.
    
 2. The data store alias uses an Oracle driver file (ojdbc6.jar) that is for version 11.1.x, and is not greater than 11.2.x.



ENVIRONMENT
In JDBC, wildcards can be used in certain metadata calls that accept names, such as schema names, table names, and column names. The underscore character is a wildcard that represents a single character, and the percent character is a wildcard that represents zero or more characters. 


For example, it is possible to request information about tables whose name that matches the pattern CUST%. Valid tables would include CUST, CUST2, CUSTOMERS, and CUSTODIALMANAGEMENT. For a pattern such as SA_ES, valid tables would include SALES and SAVES.

It is also possible for a name to contain a wildcard character as part of its literal name. For example, a database could contain a table named CUSTOMER_ORDERS.

For names that contain a literal character that is also a wildcard, the code needs to use an escape character to treat the wildcard as a regular character. For example, suppose the escape character is a forward slash ('/'). If we want the table CUSTOMER_ORDERS, but not CUSTOMERSORDERS, then the code needs to request the table using the name CUSTOMER/_ORDERS, where the '/' instructs the call to treat the character that follows it as a literal underscore instead of a wildcard.

The code determines what to use for the escape character by requesting it from the database using the JDBC driver. In the case of the Oracle 11.1 driver, the escape character is incorrectly returned as two characters: "//" We've tested this by replacing the driver with a newer version, which correctly returns '/' as the escape character for the same database.

When the escape character is incorrect, the requested table name is incorrect and is therefore not found. Therefore, Designer does not show column names because the table containing the columns cannot be located.


DIAGNOSING THE PROBLEM
To determine the version of the Oracle driver file (ojdbc6.jar): 

 

 1. Using the command line, navigate to the directory containing ojdbc6.jar. 
 2. Type the following and hit enter:
    java -jar ojdbc6.jar -getversion


Here's the result for a file that causes the problem: 

Oracle 11.1.0.7.0-Production JDBC 4.0 compiled with JDK6 

This version will work correctly: 

Oracle 11.2.0.2.0 JDBC 4.0 compiled with JDK6 on Thu_Aug_26_18:10:24_PDT_2010 
RESOLVING THE PROBLEM
The simplest solution is to use an updated driver for the data store. To update the driver: 

 

 1.  Start Designer 
 2.  Connect to the Optim Directory in the Directory Explorer tree. 
 3.  Expand the Data Store Aliases node. 
 4.  Right click on the Data Store to change. 
 5.  Click Open. You will see a wizard to specify the connection properties. 
 6.  Verify the data on the first page is correct, and click Next. 
 7.  In the list of JAR files, select ojdbc6.jar. 
 8.  Click Replace... to replace the JAR. A file dialog will open. 
 9.  Select the new driver and click Open. The dialog will close. 
 10. Click Test Connection. The connection should succeed. 
 11. Go through the rest of the wizard, and click Finish.


At this point, the driver will be replaced.