Title: IBM ICC web application fails to start after upgrade - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 After upgrading from IBM Content Collector (ICC) V3.0 to V4.0, the ICC web application configured to run with external IBM Websphere Application Server (WAS) fails to start. 

SYMPTOM
The error observed in the ICC log is: 

0000003f ActionServlet E 
org.apache.struts.action.ActionServlet init Unable to initialize Struts 
ActionServlet due to an unexpected exception or error thrown, so marking
the servlet as unavailable. Most likely, this is due to an incorrect or
missing library dependency. 
javax.servlet.ServletException: Failed to do the intial setup of Document Viewer Application 
at 
com.ibm.icm.docviewer.plugins.StartupPlugIn.init(StartupPlugIn.java:121)


CAUSE
A JDBC connection may be configured for the external WAS, which is not recommended.


DIAGNOSING THE PROBLEM
Beginning with ICC version 4.0, if an external WAS is used, there will be 2 WAS instances - one embedded and one external - configured for ICC. 

The embedded WAS (eWAS) is used for the configuration service and configuration database access.
The external WAS is used for viewer and web application. 

The external WAS now communicates with eWAS when it needs configuration data or is asked to run commands which need mail server access (eg. restore). 


RESOLVING THE PROBLEM
These are the steps to resolve this issue: 

 * Ensure the ports are different for the two WAS instances. See below for a sample content of portdef.props that can be used on eWAS. These are the default values for ICC. 
   
   CSIV2_SSL_SERVERAUTH_LISTENER_ADDRESS=9403 
   SIB_ENDPOINT_ADDRESS=7276 
   SIB_MQ_ENDPOINT_SECURE_ADDRESS=5578 
   DCS_UNICAST_ADDRESS=9353 
   SIB_MQ_ENDPOINT_ADDRESS=5558 
   SAS_SSL_SERVERAUTH_LISTENER_ADDRESS=9401 
   ORB_LISTENER_ADDRESS=11100 
   CSIV2_SSL_MUTUALAUTH_LISTENER_ADDRESS=9402 
   SIP_DEFAULTHOST_SECURE=5061 
   SIB_ENDPOINT_SECURE_ADDRESS=7286 
   SIP_DEFAULTHOST=5060 
   WC_adminhost=11060 
   WC_adminhost_secure=11043 
   WC_defaulthost=11080 
   WC_defaulthost_secure=11443 
   BOOTSTRAP_ADDRESS=11809 
   SOAP_CONNECTOR_ADDRESS=11880 
   IPC_CONNECTOR_ADDRESS=11633 
   
   
 * As both WAS instances must use different ports, configure port 9443 for external WAS. 
 * The external WAS is told how to contact the embedded WAS via the bootstrap file.
   In afu.bootstrap.properties on the external WAS, add the below url for eWAS so that links that once were created for preview use the url of external WAS with port 9443: 
   
   configurationService=https://<iccwebappserver>:11443/AFUConfig/Configuration

 * Uninstall, then reinstall eWAS on the ICC server and reconfigure JDBC. 
 * Restart the external WAS.