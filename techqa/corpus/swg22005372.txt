Title: IBM How to create a self-signed SSL Certificate and applied to Puredata System for Analytics Netezza Performance Portal - United States

Text:
 TECHNOTE (FAQ)

QUESTION
 How to create a self-signed SSL Certificate and applied to Puredata System for Analytics Netezza Performance Portal 

ANSWER

1) make sure you Netezza Performance Portal is up and running

log in as root user on the box

[root@netezza ~]# service nzportal status
nzSoapService (pid 2954) is running...
[root@netezza ~]# service nzportal-ihs status
httpd (pid: 3637) is running...


2)create your RSA Private key. for the simplicity, we use 'password' for pass phrase 
openssl genrsa -des3 -out server.key 1024


[root@netezza ~]# openssl genrsa -des3 -out server.key 1024
Generating RSA private key, 1024 bit long modulus
....++++++
..................................++++++
e is 65537 (0x10001)
Enter pass phrase for server.key:
Verifying - Enter pass phrase for server.key:

[root@netezza ~]# ls -ltr server.key
-rw-r--r-- 1 root root 963 Jun 28 13:47 server.key

3) Generate a CSR (Certificate Signing Request) 

This steps will ask a few information, the most important part is the Common Name, please put your active hostname to Common Name. To check hostname, use hostname command 

[root@netezza ~]# hostname
netezza
[root@netezza ~]# openssl req -new -key server.key -out server.csr
Enter pass phrase for server.key:
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter '.', the field will be left blank.
-----
Country Name (2 letter code) [XX]:
State or Province Name (full name) []:
Locality Name (eg, city) [Default City]:
Organization Name (eg, company) [Default Company Ltd]:
Organizational Unit Name (eg, section) []:
Common Name (eg, your name or your server's hostname) []:netezza
Email Address []:

Please enter the following 'extra' attributes
to be sent with your certificate request
A challenge password []:password
An optional company name []:

4) Remove Passphrase from Key 

cp server.key server.key.org
openssl rsa -in server.key.org -out server.key


[root@netezza ~]# cp server.key server.key.org
[root@netezza ~]# openssl rsa -in server.key.org -out server.key
Enter pass phrase for server.key.org:
writing RSA key

5) Generating a Self-Signed Certificate
we wiil generate a certificate valid for 760 days 

openssl x509 -req -days 760 -in server.csr -signkey server.key -out server.crt

[root@netezza ~]# openssl x509 -req -days 760 -in server.csr -signkey server.key -out server.crt
Signature ok
subject=/C=XX/L=Default City/O=Default Company Ltd/CN=netezza
Getting Private key

6) Stop the IBM HTTP server:

[root@netezza ~]# service nzportal-ihs stop
nz: Stopping httpd
[ OK ]
7) Create a new key database for the certificate that was provided by the administrator:

[root@netezza ~]# /usr/local/nzWebAdmin/HTTPServer/bin/gskcmd -keydb -create -db newKeyDb.kdb -pw dbpassword -type cms -expire 760 -stash
[root@netezza ~]# ls newKe*
newKeyDb.kdb newKeyDb.rdb newKeyDb.sth

8)Import your certificate into the database:

[root@netezza ~]# openssl pkcs12 -export -in server.crt -inkey server.key -out cert.pfx -name "portal"
Enter Export Password:
Verifying - Enter Export Password:
[root@netezza ~]# /usr/local/nzWebAdmin/HTTPServer/bin/gskcmd -cert -import -file cert.pfx -pw password -target newKeyDb.kdb -target_pw dbpassword -pfx
[root@netezza ~]# /usr/local/nzWebAdmin/HTTPServer/bin/gskcmd -cert -list -db newKeyDb.kdb -pw dbpassword
Certificates in database /root/newKeyDb.kdb: portal

9) Set the imported certificate as the default one:
/usr/local/nzWebAdmin/HTTPServer/bin/gskcmd -cert -setdefault -db newKeyDb.kdb -label "portal" -pw dbpassword -type cms

10)cp newKeyDb.* /usr/local/nzWebAdmin/HTTPServer/

Edit the /usr/local/nzWebAdmin/HTTPServer/conf/httpd.conf file. Change the following line: 

KeyFile /usr/local/nzWebAdmin/HTTPServer/nzPortalServerKey.kdb

and replace its content with the following:

KeyFile /usr/local/nzWebAdmin/HTTPServer/newKeyDb.kdb


*make sure the both newKeyDb.rdb and newKeyDb.kdb are there otherwise the step 11) will failed

11) Save the file and restart IBM HTTP server:

[root@netezza ~]# service nzportal-ihs restart
nz: Stopping httpd
[FAILED]
nz: Starting httpd
[ OK ]