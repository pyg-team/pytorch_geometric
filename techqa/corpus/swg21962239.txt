Title: IBM Configuration for starting WinEventLog probe as a Windows service using PA - United States

Text:
nco_pad; wineventlog; windows; service; process agent; pa; service TECHNOTE (FAQ)

QUESTION
 How to register WinEventLog probe as service on Windows using Process Agent 

ANSWER
Assumption: The wineventlog probe has been well configured and works fine on Command prompt. 

1. Confirm your wineventlog probe starting fine manually. 

 

%OMNIHOME%\probes\win32\nco_p_wineventlog.bat 

 

2. Configure your Process Agent and confirm it starting fine manually. 

 

2.1 Open Server Editor then create Interface for Process Agent 

 

Select [Start] > [All programs] > [Netcool suites] > [System Utilities] > [Server Editor]
You will see the following Interface for Process Agent as default. 
If you use it, press OK then exit. 

 

Server : NCO_PA 

Name : NCO_PA 

Port : 4200 

HOST : <your hostname> 


Please refer to the following link in details. 

<< Process agent server definition entry >>
http://www-01.ibm.com/support/knowledgecenter/SSSHTQ_8.1.0/com.ibm.netcool_OMNIbus.doc_8.1.0/omnibus/wip/install/concept/omn_con_procagentservdefnentry.html?lang=en [http://www-01.ibm.com/support/knowledgecenter/SSSHTQ_8.1.0/com.ibm.netcool_OMNIbus.doc_8.1.0/omnibus/wip/install/concept/omn_con_procagentservdefnentry.html?lang=en] 

 

2.2. Update the process agent configuration file 


%OMNIHOME%\etc\nco_pa.conf 

 

2.2.1. Add the following process definition 


You should input the actual hostname in "Host". 

Example: 
-----------------------
nco_process 'wineventlog'
{
Command '[CWD=C:\IBM\Tivoli\Netcool\omnibus\probes\win32]%OMNIHOME%/win32/nco_p_nonative.exe $OMNIHOME/probes/win32/nco_p_wineventlog.exe' run as 0
Host = 'kiss'
Managed = True
RestartMsg = '${NAME} running as ${EUID} has been restored on ${HOST}.'
AlertMsg = '${NAME} running as ${EUID} has died on ${HOST}.'
RetryCount = 0
ProcessType = PaPA_AWARE
}
-----------------------


Please refer to the following link about each process definition in details.

http://www-01.ibm.com/support/knowledgecenter/SSSHTQ_8.1.0/com.ibm.netcool_OMNIbus.doc_8.1.0/omnibus/wip/admin/reference/omn_adm_pa_definingprocspaconfigfile.html?lang=en [http://www-01.ibm.com/support/knowledgecenter/SSSHTQ_8.1.0/com.ibm.netcool_OMNIbus.doc_8.1.0/omnibus/wip/admin/reference/omn_adm_pa_definingprocspaconfigfile.html?lang=en] 

 

2.2.2. Update Service 

Example:
-----------------------
nco_service 'Omnibus'
{
ServiceType = Master
ServiceStart = Auto
# process 'ObjectServer' NONE
process 'wineventlog' NONE
}
-----------------------


ServiceStart should be "Auto" for making it start automatically. 

" process 'wineventlog' NONE " should be added for referring to the wineventlog process definition. 

Note that "ObjectServer" line is commented out in the above example because it should not be used. 


Please refer to the following link about each service definition in details.

http://www-01.ibm.com/support/knowledgecenter/SSSHTQ_8.1.0/com.ibm.netcool_OMNIbus.doc_8.1.0/omnibus/wip/admin/reference/omn_adm_pa_definingservpaconfigfile.html?lang=en [http://www-01.ibm.com/support/knowledgecenter/SSSHTQ_8.1.0/com.ibm.netcool_OMNIbus.doc_8.1.0/omnibus/wip/admin/reference/omn_adm_pa_definingservpaconfigfile.html?lang=en] 

 

2.2.3. Update routing host 


Example:
-----------------------
nco_routing
{
host 'kiss' 'NCO_PA' 'username' 'password'
}
-----------------------

Update with your hostname, interface generated for the process agent above, username and its password for starting process. 

Please refer to the following link in details. 


http://www-01.ibm.com/support/knowledgecenter/SSSHTQ_8.1.0/com.ibm.netcool_OMNIbus.doc_8.1.0/omnibus/wip/admin/reference/omn_adm_pa_definingrouthostpaconfigfile.html?lang=en [http://www-01.ibm.com/support/knowledgecenter/SSSHTQ_8.1.0/com.ibm.netcool_OMNIbus.doc_8.1.0/omnibus/wip/admin/reference/omn_adm_pa_definingrouthostpaconfigfile.html?lang=en] 

 

2.3. Start nco_pad manually and check that you can see LISTEN displayed by running netstat command. 

 

Run %OMNIHOME%\bin\nco_pad (-name <name> should be added if default interface for process agent is not used ） 

Run netstat -anb command and check the port number registered in the interface for process agent being LISTEN 

 

3． Register your Process Agent as a service 

 

Referring to the steps below, register your process agent as a service. 


cd %NCHOME%¥omnibus¥bin
nco_pad /install /cmdline 

 

(In case that your interface for the process agent is not default one, 

 nco_pad /install /cmdline "-name <name>" ) 


Please refer to the following link in details.

Example: Installing and running the process agent as a service
http://www-01.ibm.com/support/knowledgecenter/SSSHTQ_8.1.0/com.ibm.netcool_OMNIbus.doc_8.1.0/omnibus/wip/install/reference/omn_con_winexampleservicepa.html?lang=en [http://www-01.ibm.com/support/knowledgecenter/SSSHTQ_8.1.0/com.ibm.netcool_OMNIbus.doc_8.1.0/omnibus/wip/install/reference/omn_con_winexampleservicepa.html?lang=en]

RELATED INFORMATION
 A Japanese translation is available [http://www.ibm.com/support/docview.wss?uid=swg21697432]