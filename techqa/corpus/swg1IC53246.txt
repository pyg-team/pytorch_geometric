Title: IBM IC53246: Exception messages thrown when MQJMS Imports generate WebSphere MQ report messages - United States

Text:
 SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  When using an MQJMS Import with messages which have a
   WebSphere MQ expiry time set, if this time is exceeded while the
   message flow is waiting for a response from the MQJMS Import, an
   exception message is thrown.  This exception is caused by
   spurious WebSphere MQ report options on the request message from
   the MQJMS Import, which is processed by WebSphere MQ on expiry,
   and arrives on the response queue for the MQJMS Import.  This
   message cannot be processed by the MQJMS Import, and is
   manifested as an exception generic in nature, which indicates
   that an unknown problem has occured, of the following form:
   
   ExceptionUtil E   CNTR0020E: EJB threw an unexpected
   (non-declared) exception during invocation of method
   "transactionNotSupportedActivitySessionNotSupported" on bean
   "BeanId(SV062MedApp#SV062MedEJB.jar#Module, null)". Exception
   data:
   com.ibm.wsspi.sibx.mediation.flow.MediationRuntimeException:
   CWSXM1025E: An unexpected exception occurred during flow
   invocation: CWSXM0111E:  Service runtime exception invoking an
   import from mediation component MYMED in module MYMEDMed:
   CWSXM0206E: An unexpected exception occurred.
           at com.ibm.wsspi.sibx.mediation.flow.ejb.MediationFlowBe
   an.invokeRequestFlow(MediationFlowBean.java:221)
           at com.ibm.wsspi.sibx.mediation.flow.ejb.EJSLocalStatele
   ssMediationFlow_f5ad87fe.invokeRequestFlow(Unknown Source)
           at com.ibm.ws.sibx.scax.mediation.component.ejb.EJBMedia
   tionFlowComponentImpl.invokeRequestFlow(EJBMediationFlowComponen
   tImpl.java:201)
      ...
   
   
   You may also see the following message, which gives an
   indication that you may have run into this problem:
   
   Core         W   CWSCA4009I: The JMS response message could not
   be correlated with the system callback mechanism. Received
   correlation id:
   ID:414d5120494d534f4155303120202020466b644b2028b336.
   ServerSession W   WMSG0031E: Exception processing JMS Message
   for MDB _import.MYMEDImportEIS, JMSDestination
   jms/SOME.DEST.MYMED.ESB.RESPONSE : com.ibm.websphere.sca.Service
   RuntimeException: No message is received from callback queue
   with selector=callbackID='CALLBACKMESSAGE_ID:414d5120494d534f415
   5303120202020466b644b2028b336'
           at com.ibm.ws.sca.internal.jms.AbstractJMSAsyncResponseL
   istenerImpl.getCallbackMessage(AbstractJMSAsyncResponseListenerI
   mpl.java:485)
           at com.ibm.ws.sca.internal.jms.AbstractJMSAsyncResponseL
   istenerImpl.handleResponse(AbstractJMSAsyncResponseListenerImpl.
   java:171)
           at com.ibm.ws.sca.internal.jms.AbstractJMSAsyncResponseL
   istenerImpl.onMessage(AbstractJMSAsyncResponseListenerImpl.java:
   151)
      ...
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED: Users of WebSphere Enterprise Service Bus    *
   *                 and WebSphere Process Server v6.0.2 where    *
   *                 a MQJMS Import is being used in conjunction  *
   *                 with expiry times being set on the           *
   *                 WebSphere MQ messages.                       *
   ****************************************************************
   * PROBLEM DESCRIPTION: When the expiry time set in the         *
   *                      WebSphere MQ message is exceeded while  *
   *                      the MQJMS Import is waiting for a       *
   *                      response, the exception messages are    *
   *                      triggered.  This is due to WebSphere    *
   *                      MQ responding with a full report which  *
   *                      contains the orginal request message,   *
   *                      which is not the response message       *
   *                      which the binding was expecting.        *
   ****************************************************************
   * RECOMMENDATION: If you encounter this problem you are        *
   *                 advised to install the fix pack which        *
   *                 contains the code change associated with     *
   *                 this APAR.                                   *
   ****************************************************************
   When a WebSphere MQ message has an expiry time set which is
   exceeded during the lifetime of the message, WebSphere MQ
   responds with a report which contains the full request message
   data.  If this occurs between the point where a MQJMS Import
   has processed a request message and is waiting for the
   corresponding response, this report triggers the response
   processing.  However, as the message is not the expected
   response which results in the runtime exceptions being thrown.
   As part of the attempted processing, the MQJMS Import will
   attempt to access the context store to obtain the correlation
   information which will also fail, resulting in the message:
   
   CWSCA4009I: The JMS response message could not be correlated
   with the system callback mechanism. Received correlation id:...
   
   The code was changed by the fix associated with this APAR such
   that if the the MQJMS Import binding does not set the expiry
   report options on the WebSphere MQ request message, so that
   WebSphere MQ will not generate the spurious report message
   which causes the exceptions seen in the MQJMS Import response
   path.
   
   Note that the native MQ Import binding is not affected by this
   problem, this only occurs with the MQJMS Import binding.
   
   
    
   
   

PROBLEM CONCLUSION
 *  The code fix associated with this APAR is currently targetted
   to be included in v6.0.2 Fix Pack 3 (6.0.2.3).  There are
   currently no known side effects associated with this code
   fix.
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IC53246
   
   
 * REPORTED COMPONENT NAME
   WEB ESB FOR WIN
   
   
 * REPORTED COMPONENT ID
   5724I8200
   
   
 * REPORTED RELEASE
   200
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2007-07-17
   
   
 * CLOSED DATE
   2007-09-13
   
   
 * LAST MODIFIED DATE
   2007-09-13
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WEB ESB FOR WIN
   
   
 * FIXED COMPONENT ID
   5724I8200
   
   

APPLICABLE COMPONENT LEVELS
 * R100 PSN
   UP
   
   
 * R200 PSY
   UP