Title: IBM PureData System for Analytics reports SPA management module critical status but all componets report health as OK - United States

Text:
mm management module fault critical power TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 When checking health of a management module, it may show the status as Critical when all devices show as healthy. 

SYMPTOM
Checking management module health shows something similar to: 

system> health -l 2
system: Critical
mm[1] : OK
mm[2] : Critical
blade[1] : OK
blade[3] : OK
blade[5] : OK
blade[7] : OK
power[1] : OK
power[2] : OK
power[3] : OK
power[4] : OK
blower[1] : OK
blower[2] : OK
switch[1] : OK
switch[2] : OK
switch[3] : OK
switch[4] : OK
fanpack[1] : OK 
fanpack[2] : OK 
fanpack[3] : OK 
fanpack[4] : OK


CAUSE
When the management module records a problem it may not automatically clear the error once the error condition no longer exists. One example of this is when multiple power supplies experience an A/C failure and there is not a recovery event recorded in the log file.

Once the error condition is resolved the management may continue to show that there is a problem.


DIAGNOSING THE PROBLEM
The issue causing the error may be found two ways. 

 1. From the command line - # ssh mm00x health -l a -f 
 2. From the management module service data file.


We will concentrate on the service data file as it gives the most complete check out methods.  

Capturing the management module service data file is the best route to take to investigate this issue. 

The command 

# /nz/kit/bin/adm/ibm_amm --loc=spaX.mm --service_data=/nzscratch/spaX.sdf.tgz 

When ran as the nz user, it will capture the service data file for review. Please note the X should be replaced with the number of the SPA reporting an issue. 

 

Once the service data file is captured and available for review there are several places that can be checked to investigate the critical message. 

In this example the critical issue is power supply messages. 

Within the service data file there are multiple files. The primary_ffdc will almost always be the correct place to look for information. 

 

Once the primary_ffdc file is opened the files of most importance are the service.txt and developer.txt log files. 

 

The service.txt file will show the reason for the critical event and the log showing when the event took place. 


System Health: Critical
System Status Summary
One or more monitored parameters are abnormal.
Critical Events
Power module 2 is off. AC fault
Power module 3 is off. AC fault
Power module 4 is off. AC fault 

 

Looking at the power supplies they appear to be fine, there are no error LEDs on
LED info:

association location state blink_rate color description
Power supply[3] Front panel OFF N/A ORANGE Fan

Looking at the event log we find that the errors with the AC power fault occurred in the past.
There may not be recovery events in the log file.

Power module 2 is off. AC fault
Power module 3 is off. AC fault
Power module 4 is off. AC fault

At this point we know the AC faults no longer exist. We can also determine if the power supplies are actually within tolerance of power by looking at the developer log.

Looking at the POWER MODULE STATISTICS we can look at the ACT_W and the WPD1 fields for all four power supplies.

S1 ACT_W WPD1 WPD2 WPD3 WPD4
1 2980 2980
2 2980 2980
3 2980 2980
4 2980 2980

This shows that all four 2980 watt power supplies are distributing 2980 watts of power per power supply. If WPDx = 0000 then there is no power to that power supply.


RESOLVING THE PROBLEM
Now that we are sure there are no actual power supply issues, we may clear the error. 


To clear the error a management module reset is needed.

# ssh mm00x reset -T system:mm[x]

Once the reset is done and the management module is once again accessible check the health of it again.

# ssh mm00x health -l a -f
system> health -l a -f
OK




Cross reference information Segment Product Component Platform Version Edition Information Management IBM Netezza Analytics