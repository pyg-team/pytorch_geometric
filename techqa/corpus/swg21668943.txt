Title: IBM PLS extension command not working in Version 22 and 23 - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 I'm running SPSS Statistics. I allowed the default installation of Python Essentials, and when I click on Utilities --> Extension Bundles --> View Installed Extension Bundles, I see PLS listed among the installed extensions. However, when I attempt to run it I get errors indicating that all needed components are not installed. How can I get this to work? 

CAUSE
The Python Essentials that is installed by default with SPSS Statistics Versions 22 and 23 installs a private version of Python that is specific to SPSS Statistics. This works fine for most of the extension bundles, but ones like PLS that require the additional functionality of the Numpy (Numeric Python) and Scipy (Scientific Python) program libraries will not work with this default setup.

DIAGNOSING THE PROBLEM
The following message displays in the Output window of SPSS Statistics: 

Extension command PLS could not be loaded. The module or a module that it requires may be missing, or there may be syntax errors in it.


RESOLVING THE PROBLEM
You have to install an additional (external) version of Python 2.7 and Numpy and Scipy libraries within that installation. After completing these steps, you can either change the location of the Python files specified in SPSS Statistics to point to this new installation or copy the files from the newly created Python directory to the Python directory specific to SPSS. 

NOTE: The following technote references third-party installer binaries for Windows. This greatly simplifies the process of installing Numpy and Scipy on the Windows platform. Below are the steps for 64 bit Windows versions (for other operating systems you would need to locate analogous libraries for Numpy and Scipy and select the appropriate version of Python 2.7 in step 1): 

1. Install Python 2.7: Go to https://www.python.org/download/releases/2.7/ [https://www.python.org/download/releases/2.7/] and note that Python 2.7.11 is available. In the Download section, scroll to the binary installer that is appropriate for your platform. For instance :Windows X86-64 MSI Installer is the one needed for this example. Click on that link and save the file to your computer. Then double-click on the saved file to execute the installer. Let it use the default C:\Python27 directory. 

2. Install pip and wheel: If you have installed Python 2.7.9 or later, pip will already be installed, and you can skip to part of this step where you install the 'wheel' package. Otherwise, go to http://www.lfd.uci.edu/~gohlke/pythonlibs/#pip [http://www.lfd.uci.edu/%7Egohlke/pythonlibs/#pip] and download the latest version. For example: pip-8.1.2-py2.py3-none any.whl to the same directory as you have installed Python 2.7 (C:\Python27). 

Open cmd with Administrative rights (Run as Administrator), navigate to the installation folder (cd.. → cd.. → cd C:\Python27) and run the installer ( type in cmd: python.exe pip-8.1.2-py2.py3-none any.whl/pip install pip-8.1.2-py2.py3-none any.whl). 

After pip is successfully installed, you also need to install wheel: you do that by typing the
pip install wheel
command in cmd. 

3. Install the latest Numpy: Go to http://www.lfd.uci.edu/~gohlke/pythonlibs/#numpy [http://www.lfd.uci.edu/%7Egohlke/pythonlibs/#numpy] and click on the link in that section, like numpy-1.11.1+mkl-cp27-cp27m-win_amd64.whl. 

Download numpy-1.11.1+mkl-cp27-cp27m-win_amd64.whl to the Python 2.7 directory (C:\Python27). 

In order to install this library you need to open cmd with Administrative rights (Run as Administrator), navigate to the installation folder (cd.. → cd.. → cd C:\Python27) and run the installer 

type in cmd: pip install numpy-1.11.1+mkl-cp27-cp27m-win_amd64.whl. 

4. Install the latest Scipy: Go to http://www.lfd.uci.edu/~gohlke/pythonlibs/#scipy [http://www.lfd.uci.edu/%7Egohlke/pythonlibs/#scipy] and click on the link like scipy 0.17.1-cp27-cp27m-win_amd64.whl. 

Download scipy 0.17.1-cp27-cp27m-win_amd64.whl to the Python 2.7 directory ( C:\Python27). 

In order to install this library you need to open cmd with Administrative rights (Run as Administrator), navigate to the installation folder (cd.. → cd.. → cd C:\Python27) and run the installer 

 type in cmd: pip installscipy 0.17.1-cp27-cp27m-win_amd64.whl. 


You can check if the libraries are properly installed by running the below syntax in SPSS Statistics Syntax Window (the outcome should be 'numpy ok' and 'scipy ok'): 

begin program.
import numpy
print 'numpy ok'
import scipy
print 'scipy ok'
end program. 

5. Point SPSS Statistics to the external Python installation: Start SPSS Statistics. In the menus, select Edit → Options. Click on the File Locations tab. In the section Python Locations, select Other installation of Python 2.7. For Python home directory, either type in C:\Python27 or click Browse and browse to that directory, double click to go to it, and click the Set button. Click OK. 

You should now be able to run the PLS module.

RELATED INFORMATION
 Need more help? Our Statistics forum is Live! [https://developer.ibm.com/answers/topics/statistics.html?smartspace=predictive-analytics]