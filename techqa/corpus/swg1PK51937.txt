Title: IBM PK51937: FFDC ERRORS OCCUR WHEN STARTING A MONITOR MODEL APPLICATION - United States

Text:
  FIXES ARE AVAILABLE
Java SDK 1.5 SR8 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24020073]
Java SDK 1.5 SR8 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24021203]
Java SDK 1.5 SR10 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24024201]
6.1.0.31: Java SDK 1.5 SR11 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24026453]
6.1.0.33: Java SDK 1.5 SR12 FP1 Cumulative Fix for WebSphere [http://www-01.ibm.com/support/docview.wss?uid=swg24027786]
6.1.0.29: Java SDK 1.5 SR11 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24025191]
6.1.0.35: Java SDK 1.5 SR12 FP2 Cumulative Fix for WebSphere [http://www-01.ibm.com/support/docview.wss?uid=swg24028574]
6.1.0.37: Java SDK 1.5 SR12 FP3 Cumulative Fix for WebSphere [http://www-01.ibm.com/support/docview.wss?uid=swg24029525]
6.1.0.39: Java SDK 1.5 SR12 FP4 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24030426]
6.1.0.41: Java SDK 1.5 SR12 FP5 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24031035]
6.1.0.43: Java SDK 1.5 SR13 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24031963]
6.1.0.45: Java SDK 1.5 SR14 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24033270]
6.1.0.47: WebSphere Application Server V6.1 Fix Pack 47 [http://www-01.ibm.com/support/docview.wss?uid=swg24035508]
6.1.0.47: Java SDK 1.5 SR16 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24035649]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  I was researching some FFDC errors that occur when I started a
   Monitor model application on my server and traced it down to
   this entry (which does not show up in Admin Console).  When I
   removed this entry, the FFDC errors went away (Instance already
   exists errors for the JDBC provider and JMS provider MBeans).
   
   the builtin JDBC provider at the cell scope causes the following
   FFDC errors when we start our Monitor model application:
   
   Stack Dump = javax.management.InstanceAlreadyExistsException:
   WebSphere:name=WebSphere JMS
   Provider,process=server1,platform=dynamicproxy,node=SRMYERSNode0
   2,j2eeType=JMSResource,J2EEServer=server1,Server=server1,version
   =6.1.0.9,type=JMSProvider,mbeanIdentifier=cells/SRMYERSNode04Cel
   l/resources.xml#builtin_jmsprovider,cell=SRMYERSNode04Cell,spec=
   1.0
   
   Stack Dump =
   com.ibm.websphere.management.exception.AdminException:
   ADMN0005E: The service is unable to activate MBean: type
   JMSProvider, collaborator
   com.ibm.ws.runtime.component.collaborator.JMSResourceMBean@3ad03
   ad0, configuration ID
   cells/SRMYERSNode04Cell/resources.xml#builtin_jmsprovider,
   descriptor null.
   
   Stack Dump =
   com.ibm.websphere.management.exception.AdminException:
   ADMN0005E: The service is unable to activate MBean: type
   JDBCProvider, collaborator
   com.ibm.ws.runtime.component.collaborator.JDBCResourceMBean@520a
   520a, configuration ID
   cells/SRMYERSNode04Cell/resources.xml#builtin_jdbcprovider,
   descriptor null.
   
   
   These errors disappear if I manually remove the cell scope
   builtin JDBC provider.  Is there something we are doing
   incorrectly to cause this problem (does not appear to actually
   hurt anything other than the confusion of seeing the FFDC
   errors)?
   
   
    
   
   

LOCAL FIX
 *  Each provider (i.e., resource) has an MBean.  JSR77 requires
   that JDBC resource (provider) MBeans also exist at the beginning
   of the server lifecycle.  The runtime creates mbeans for the
   builtin JDBC and JMS provider types when traverising the
   resource configuration at server startup.  When the application
   is started, the connection manager attempts creates new
   instances of the provider MBeans and activates (registers) them
   with the Admin MBean service.  Note that the code which
   registers and activates the MBean is in the runtime, and it also
   issues the FFDC event whenever the instance already exists.  So,
   I couldn't modify that behavior.
   
   
    
   
   

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED: Users of IBM WebSphere Application Server    *
   *                 version 6.1                                  *
   ****************************************************************
   * PROBLEM DESCRIPTION: An InstanceAlreadyExistsException       *
   *                      appears in the FFDC logs when           *
   *                      restarting a J2E application that uses  *
   *                      a Datasource.                           *
   ****************************************************************
   * RECOMMENDATION:                                              *
   ****************************************************************
   When a J2E application that uses a Datasource is stopped and
   restarted, the FFDC log may contain an
   InstanceAlreadyExistsException like the one shown below:
   
   Stack Dump = javax.management.InstanceAlreadyExistsException:
    WebSphere:name=Derby JDBC Provider (XA),process=
    server1,platform=dynamicproxy,node=ohboyNode03,
    j2eeType=JDBCResource,J2EEServer=server1,Server=
    server1,version=6.1.0.1,type=JDBCProvider,mbeanIdentifier=
    cells/ohboyNode03Cell/applications/J2EApp.ear/deployments/
    J2EApp/resources.xml#builtin_jdbcprovider,
    cell=myNode03Cell,spec=1.0
          at com.sun.jmx.mbeanserver.RepositorySupport.
   addMBean(RepositorySupport.java:470)
          at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.
   
   
   
   internal_addObject(DefaultMBeanServerInterceptor.java:1428)
          at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.
   
   
   
   registerObject(DefaultMBeanServerInterceptor.java:954)
          at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.
   
   
   
   registerMBean(DefaultMBeanServerInterceptor.java:355)
          at com.sun.jmx.mbeanserver.JmxMBeanServer.registerMBean
   (JmxMBeanServer.java:515)
          at com.ibm.ws.management.MBeanFactoryImpl.activateMBean
   (MBeanFactoryImpl.java:494)
          at com.ibm.ws.runtime.component.collaborator.
   J2EEResourceMBean.activate(J2EEResourceMBean.java:66)
          at com.ibm.ws.runtime.component.collaborator.
   J2EEResourceMBean.<init>(J2EEResourceMBean.java:47)
          at com.ibm.ws.runtime.component.collaborator.
   JDBCResourceMBean.<init>(JDBCResourceMBean.java:36)
          at com.ibm.ejs.j2c.RALifeCycleManagerImpl.
   resourceProviderEvent(RALifeCycleManagerImpl.java:791)
          at com.ibm.ws.runtime.component.ResourceMgrImpl.
   installResourceProvider(ResourceMgrImpl.java:1125)
          at com.ibm.ws.runtime.component.ResourceMgrImpl.
   installResource(ResourceMgrImpl.java:1030)
          at com.ibm.ws.runtime.component.ResourceMgrImpl.
   installResources(ResourceMgrImpl.java:970)
          at com.ibm.ws.runtime.component.ResourceMgrImpl.start
   (ResourceMgrImpl.java:1477)
          at com.ibm.ws.runtime.component.ApplicationMgrImpl.
   start(ApplicationMgrImpl.java:1295
          ...
   The server does not deregister the MBeans for Datasources used
   by an application when the application stops.  When the
   application restarts, the server registers the Datasource
   MBean(s) and the exception occurs, because the MBean(s) already
   exists.
   
   
    
   
   

PROBLEM CONCLUSION
 *  The InstanceAlreadyExistsException is benign, but potentially
   distracting.  Apply APAR PK51937 to enable the server to
   deregister MBeans for Datasources used by applications
   whenever the applications are stopped. The exception does not
   occur when the same applications are restarted.
   
   The fix for this APAR is currently targeted for inclusion
   in fixpack 6.1.0.13.
   Please refer to the recommended updates page for delivery
   information:
   http://www.ibm.com/support/docview.wss?rs=180&uid=swg27004980 [http://www.ibm.com/support/docview.wss?rs=180&uid=swg27004980]
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PK51937
   
   
 * REPORTED COMPONENT NAME
   WEBS APP SERV N
   
   
 * REPORTED COMPONENT ID
   5724H8800
   
   
 * REPORTED RELEASE
   61A
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2007-08-29
   
   
 * CLOSED DATE
   2007-10-05
   
   
 * LAST MODIFIED DATE
   2007-10-08
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

MODULES/MACROS
 *  J2C
   
   
    
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WEBS APP SERV N
   
   
 * FIXED COMPONENT ID
   5724H8800
   
   

APPLICABLE COMPONENT LEVELS
 * R61A PSY
   UP
   
   
 * R61H PSY
   UP
   
   
 * R61I PSY
   UP
   
   
 * R61P PSY
   UP
   
   
 * R61S PSY
   UP
   
   
 * R61W PSY
   UP
   
   
 * R61Z PSY
   UP