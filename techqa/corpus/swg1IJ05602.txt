Title: IBM IJ05602: VALUES OF MANY ATTRIBUTES FOR WIM AGENT ON APM DASHBOARD ARE IF002.CT AFTER APPLYING 8.1.4.0-IBM-APM-CORE-FRAMEWORK-APM-IF002 - United States

Text:
  A README IS AVAILABLE
8.1.4.0-IBM-APM-WIM-AGENT-IF0001 [http://www-01.ibm.com/support/docview.wss?uid=isg400003850]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS FIXED IF NEXT.
    
   
   

ERROR DESCRIPTION
 *  APM release number where the problem was found:
   APM 8.1.4 agent with 8.1.4.0-IBM-APM-CORE-FRAMEWORK-APM-IF0002
   
   Environment:
   APM agent : Application Performance Management V8.1.4 on RHEL
   6.4
   x86_64(UTF-8)
   
   Problem Description:
   1.
   There are  many attributes for WIM agent on APM dashboard are
   incorrect
   after applying 8.1.4.0-IBM-APM-CORE-FRAMEWORK-APM-IF0002.
   
   Detailed Recreation Procedure and messages that you see in the
   log
   files:
   1.1
   From the bpmrhel_d0_dmgr_kd0agent_5abc309e-01.log,we can check
   the
   parser error:
   
   (5ABC30A0.0001-C:utilities.cpp,242,"parseNumericString") Invalid
   characters ,72.208 found for metric PID getting numeric value
   from
   9.68.72.208, returning 9.680000
   (5ABC30A0.0002-C:utilities.cpp,242,"parseNumericString") Invalid
   characters DeploymentManager found for metric Port getting
   numeric value
   from DeploymentManager, returning 0.000000
   
   Analysis:
   The issue is due to upgrading the Java Runtime component(java
   upgrade
   from v1.8.0 to v1.8.0_151) has caused some logic in the agent
   code to
   break.
   The WIM agent is an Agent Factory agent with a Java custom data
   collector.The Agent factory code uses reflection to collect the
   data for
   attributes and sends it in a expected sequence. It was the
   upgraded Java
   that was causing the mixing up of attributes. This logic somehow
   breaks
   in the Java Runtime v1.8.0_151 which is IFix02 provided.
   
   We list the different Java version provided between the APM
   8.1.4 and
   APM 8.1.4 IFix02.
   1.
   Agent 8.1.4.0 base version use the java as below:
   java version "1.8.0"
   Java(TM) SE Runtime Environment (build
   pxa6480sr4fp5-20170421_01(SR4
   FP5))
   IBM J9 VM (build 2.8, JRE 1.8.0 Linux amd64-64 Compressed
   References
   20170419_344392 (JIT enabled, AOT enabled)
   J9VM - R28_20170419_1004_B344392
   JIT  - tr.r14.java_20170419_344392
   GC   - R28_20170419_1004_B344392_CMPRSS
   J9CL - 20170419_344392)
   JCL - 20170420_01 based on Oracle jdk8u131-b11
   2.
   Agent 8.1.4.0 with IF02 patch, the Java have updated:
   java version "1.8.0_151"
   Java(TM) SE Runtime Environment (build 8.0.5.5 -
   pxa6480sr5fp5-20171114_01(SR5 FP5))
   IBM J9 VM (build 2.9, JRE 1.8.0 Linux amd64-64 Compressed
   References
   20171102_369060 (JIT enabled, AOT enabled)
   OpenJ9   - 7ade437
   OMR      - 1b656cb
   IBM      - 59c3d96)
   JCL - 20171113_01 based on Oracle jdk8u151-b12
   
   
    
   
   

LOCAL FIX
 *  For work around,you can change the Java Runtime to earlier
   version
   v8.1.0 explicitly, the agent code works efficiently without
   causing any
   issues.
   
   The work around steps is as below:
   1. stop wim agent
   
   2. get the java with 1.8.0 in your env
      you can get the JRE from APM 8.1.4 agent install image
       you can choose another path to install any agent,then you
   can get
   the JRE(1.8.0),for example:
   {YourAnotherAgentInstalled}/JRE/lx8266
   
   3. backup and change the rundmgragent.sh
   location :
   /opt/ibm/apm/agent4/lx8266/d0/bin/rundmgragent.sh
   change the content from:
   export JAVAHOME=$CANDLEHOME/JRE/$ITM_BINARCH
   to
   export JAVAHOME={YourAnotherAgentInstalled}/JRE/lx8266  (which
   path is
   your providerd 1.8.0 JRE)
   
   4. restart the wim agent and check the UI.
   
   
    
   
   

PROBLEM SUMMARY
 *  Fixed
   
   
    
   
   

PROBLEM CONCLUSION

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IJ05602
   
   
 * REPORTED COMPONENT NAME
   MON AGENT WIM
   
   
 * REPORTED COMPONENT ID
   5725U05WM
   
   
 * REPORTED RELEASE
   800
   
   
 * STATUS
   CLOSED FIN
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt / Xsystem
   
   
 * SUBMITTED DATE
   2018-04-16
   
   
 * CLOSED DATE
   2018-06-27
   
   
 * LAST MODIFIED DATE
   2018-06-27
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION

APPLICABLE COMPONENT LEVELS
 * R800 PSY
   UP