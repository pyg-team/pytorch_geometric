Title: IBM MAPI_E_NETWORK_ERROR when IBM Content Collector connects to Microsoft Exchange server. - United States

Text:
icc; outlook; profile; mapi_e_network_error TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 IBM Content Collector (ICC) fails to connect to Microsoft Exchange server with MAPI_E_NETWORK_ERROR, 

SYMPTOM
In the ICC email connector log, MAPI_E_NETWORK_ERROR is reported.


CAUSE
Unable to connect to the Exchange server using the ICC default profile. 

ENVIRONMENT
IBM Content Collector for Email
Microsoft Exchange as source system.

DIAGNOSING THE PROBLEM
MAPI_E_NETWORK_ERROR may be caused by various reasons. 




 * In the Outlook Client on the ICC server, open the mailbox for the user account that is starting the ICC email connector service. 
 * If the user mailbox cannot be opened in Outlook Client, you should contact your Exchange administrator to troubleshoot the issue further. Otherwise, try the steps outlined in the next section. 

RESOLVING THE PROBLEM
ICC automatically creates an Outlook profile before it connects to the Exchange server. Sometimes, the issue can be resolved by manually creating such profile. If the email connector finds there is an existing profile, it will use that profile and will not create a new one. 

Profile Name 

 * 
 * 
 *  
   AFU_<ExchangeServerHostName> 
 * 
 * 
 * ICC Configuration Manager 
 * 
 * Connectors 
 * 
 * Email 
 * 
 * Connection 
 * 
 *  If you are using Manual configuration, the host name configured here will be used in the profile name. If you are using Automatic configuration, then you may need to enable email connector Trace level log to look for the information.  1. In ICC Configuration Manager, Connectors > Email > General tab. Set Log level to "Trace". 
    2. Restart ICC task route service to take effect. 
    3. In the email connector log (e.g. afu_mailconnector_trace_(MAPI)0.log), search for "profile name". 
       For example, the following line shows that the profile name used by ICC is AFU_exchange.ibm.com:
   
   1.  * 2016-03-31T22:08:08.478Z FINEST [161] [C-TRC] created CsxMAPIProfile instance with profile name : 'AFU_EXCHANGE.IBM.COM' [CsxMAPIProfile.cpp:107] [JniInterface logTrace] [pool-2-thread-1 1]
   
   


Creating the Profile  * 
 * 
 *  Log on to Windows on the ICC server using the same user account that you start the ICC Email Connector service. Go to Control Panel > Mail (32-bit) > Show Profiles. Click Add.... and enter the profile name using the above convention. Select Manual setup or additional server types. Click Next. Select Microsoft Exchange Server or compatible service. Click Next. Enter the Exchange server name in Server and the username in User Name. Click Check. 
   If the user is found, the value of the User Name will have an underline. The value may also be changed automatically to another format recognized by the system. Do not select Use Cached Exchange Mode. Click Next. Click Finish and save any changes. 
 * 
 * 
 * 
 * 
 *