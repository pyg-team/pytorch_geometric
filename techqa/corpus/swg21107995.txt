Title: IBM Troubleshooting Script for Domino Access to SAP Business Workflow 1.7 - United States

Text:
 TECHNOTE (FAQ)

QUESTION
What steps or information are needed to troubleshoot issues with the SAP Workflow product?

ANSWER
For any given SAP System, each user should have one profile set up on their mail server that will connect to this system. We will focus on one user at a time, as the setup is the same for each. For more detail on the Workflow setup, see the Online help: 

 * 
 * http://www-12.lotus.com/ldd/doc/SAP/1.7/wfhelp17.nsf


Note: Do not continue to the next step until all previous items it are verified. 

1. Is the Lotus Connector for SAP R/3 version 1.7 installed on both the user's client machine and on the user's mail server? If no, install the connector on both locations. You can roughly determine whether the connector is installed by looking for "*sap.lcx" on the client and server machines. The Lotus Connector Install guide can be found here: 
 * http://www-12.lotus.com/ldd/doc/SAP/1.7/sapdocig17.nsf


2. Does the database "R3admin.nsf" reside on the user's mail server? If not, place a copy there. 

3. Open R3admin.nsf and verify the following: 

For the SAP server that needs to be connected to:  *  Does a profile exist for this user? 
 *  Is the profile set to "Enabled?" 
 *  Has the administrator who set up the profile selected "Save Profile and Email it to User?"


If no to any of these steps, select "Save Profile and Email it to User." There is no harm in sending out a profile twice. 

4. Have the appropriate forms been added to the user's mail file? This can be verified by opening the mail.nsf in Designer and looking for the following forms: 

"User Profile" 
"Workitem" 
"(WFError)" 

If any of these forms are missing, review the documentation on setting up mail templates [http://www-12.lotus.com/ldd/doc/SAP/1.7/wfhelp17.nsf/ed212f3421ad9aa78525676a0064acdb/c64e4c77bc67590685256c4c006b1688?OpenDocument&AutoFramed] . 


5. Once the user has received his profile, did he select "Process New Profile?" If not, have the user select this button. Again, no harm in having it done twice. 

6. Did the user receive any errors when selecting "Process New Profile?" 

Once the user has selected "Process New Profile," a password prompt will appear. At this point, connectivity is being checked to the SAP system. If a valid connection cannot obtained, the user will be prompted a second time for a password. If this fails, the profile is not activated and the user will receive an error message. Please send any errors that have occurred during this process and double-check that the SAP connector is installed on the client machine. 

These are the basic steps. If there is more than one user connecting or having issues connecting, you will need to run through this process for each user. If each user is on a different mail server, you will need to install the MTA on each of these mail servers. Then, follow steps 1-6 above. 

If there is more than one SAP system being connected to, be sure that a profile exists for each server that the user is connecting to, and run through steps 4 and 5 for each unique SAP system being connected to. 

7. Does the workitem fail to launch when you select an action button from within a workitem notification? 
Verify that the SAPGUI is installed on the client machine where the item is being executed. If the SAPGUI is installed, have LotusScript debugging turned on for the client machine and report which line of code fails. 


Frequently Asked Questions: 

Do I need to install the SAP Connector on every mail server with users that connect to SAP Business Workflow? 
Yes, you must install the connector for every client and every mail server that uses SAP Business Workflow. Some customers have found it easiest to move all users who will access SAP Business Workflow to the same mail server. 

When my users try to Process the New profile they get the error: "Error loading use or uselsx module "*LCLSX." What causes this error? 
SAP for Business Workflow uses the SAP Connector with the LCLSX. If the appropriate components to run the LCLSX are not available on the client machine, you may encounter this issue. For Notes 6 clients, these files are installed by default. For Notes 5 clients, these files are only installed if you select a Designer installation with DECS components. The files needed to run SAP Workflow successfully are as follows: 

Notes 5 
- nlcapi.dll 
- nlchtapi.dll 
- nlsxlc.dll 
- ncollexp.lcx 
- nnotes.lcx 
- norder.lcx 

Notes 6 
- ndcapi.dll 
- ndchtapi.dll 
- nlsxlc.dll 
- ncollexp.dcx 
- nnotes.dcx 
- norder.dcx 

These files are in addition to the SAP connector (nsap.lcx) 

Related Documents: 
Troubleshooting Script for Lotus Connector for SAP R/3 1.7 
Document #: 1096050 RELATED INFORMATION
 Troubleshooting Script: Lotus Connector for SAP R/3 1.7 [http://www.ibm.com/support/docview.wss?uid=swg21096050]