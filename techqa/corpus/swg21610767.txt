Title: IBM Why is there a large number of groups listed in mpi_grphead? - United States

Text:
 TECHNOTE (FAQ)

QUESTION
 We have an external LDAP connected to our IBM Initiate MDS instance and we are noticing that after time, a large number of groups have been added to the mpi_grphead table that are not listed within Workbench.

These groups do not match the external.ldap.group.search.filter.pattern.all and have no permissions associated with them. Why are these groups being added, how can we prevent this and what effect does it have? 

ANSWER
When an external user logs in for the first time, there is a process where we first authenticate the user, then determine what groups they are a part of. This process follows the parameters in the com.initiate.server.ldap.cfg file.


 1. Find the matching user account in the Embedded LDAP. If this fails, move on to step 2. 
 2. Find the matching user account in the Internal LDAP. If this fails, move on to step 3. 
 3. Find the user account in the External LDAP based on the external.ldap.user.search.basedn.1 and external.ldap.user.search.filter.pattern parameters. If more than 1 basedn is listed in the configuration, we will look through each one in order. 
 4. Once an account is found, obtain the full DN for the account and attempt to authenticate to the External LDAP via the DN and the provided password. 
 5. Check the dictionary to see if the user already exists in mpi_usrhead. Add the user information to the mpi_usrhead table if it is not present and mark the dictionary as dirty. 
 6. Once authenticated, find all of the user's groups based on the external.ldap.group.search.basedn.1 and external.ldap.group.search.filter.pattern.member parameters. If more than 1 basedn is listed in the configuration, we will look through each one in order. 
 7. Check the dictionary to determine if any of the returned groups are present in the database. If they are not, add them to the database and mark the dictionary as dirty. 
 8. If the dictionary is marked dirty, refresh the copy of the dictionary in memory. 
 9. Check the dictionary for any permissions associated with the user's group. Assuming the user has the appropriate permissions, the login is successful.


To prevent these extraneous groups from being added, you will need to adjust the following parameters to better filter on only the desired groups. 
 * external.ldap.group.search.basedn.1 
 * external.ldap.group.search.filter.pattern.member


By having these extra groups in the dictionary, any time the dictionary is refreshed or loaded into memory, it will take more time and more memory to load and store the extra groups. In addition, when a user logs in, it will take more time to go through all of the user's groups to determine their permission level.