Title: IBM IC69673: DATAPOWER: PERFORMANCE PROBLEM WITH WS-POLICY - United States

Text:
 SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  IBM WebSphere Datapower SOA appliance.
   
   Firmware version: 3.8.0.3
   
   Performance test with WCF (Windows communications foundation)
   clients showed unexpected results.
   
   The WCF client receives the WSDL including the policy of the
   WebService
   Proxy and the STS from a MEX service implemented on DataPower.
   The WCF
   clients running on Intel machines, the Web Service Proxies on
   one
   DataPower XI50, Backend WebService implemented in CICS on z/OS.
   We used a policy which enforces message security (complete
   message
   signed and encrypted). The WebService Proxy on the request does
   the
   policy enforcement (decrypt, verify) , AAA (one LDAP Search),
   Logging
   (File System and Syslog on notice level), removes the security
   header,
   creates a new SAML for the backend and signs it. On the
   response, just
   logging and the policy enforcement (crypt, sign).
   In all our test cases (different message sizes and message
   complexity)
   we had similar round-trip times (about 50ms). Looking at the
   stylesheet
   statistics we saw that decrypt takes about 20ms and verify about
   30ms
   (again independent of the message size and complexity).
   DataPower was
   only able to handle about 100 requests per second until reaching
   90-
   100% CPU load. The strange thing about this result is not the
   number
   itself, but the fact that this load could easily be generated
   from a
   single WCF client running on a dual core Intel machine (about
   30% CPU
   load). Everybody expected DataPower to be much more efficient
   than the
   client. Both sides have to do similar work on request and
   response.
   To have a comparison we also tested an mixed security (transport
   security for payload and signed/encrypted SAML assertion in the
   WS-
   Security header). Here verify and decrypt (just the SAML token,
   not the
   message) only takes about 10ms.
   So policy enforcement seems to be very inefficient from a
   performance
   perspective. We would expect seeing different processing times
   for
   different message sizes. Encrypt and Sign (within document
   crypto map)
   shows execution times of 0 ms.
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  A number of inefficiencies were identified in WS Security Policy
   enforcement.
   
   
    
   
   

PROBLEM CONCLUSION
 *  Improved performance of policy enforcement during WS Security
   Policy verify and decrypt actions.
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IC69673
   
   
 * REPORTED COMPONENT NAME
   DATAPOWER
   
   
 * REPORTED COMPONENT ID
   DP1234567
   
   
 * REPORTED RELEASE
   370
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2010-07-06
   
   
 * CLOSED DATE
   2010-08-09
   
   
 * LAST MODIFIED DATE
   2010-08-09
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   DATAPOWER
   
   
 * FIXED COMPONENT ID
   DP1234567
   
   

APPLICABLE COMPONENT LEVELS
 * R380 PSY
   UP
   
   
 * R381 PSY
   UP