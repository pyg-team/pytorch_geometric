Title: IBM IC65907: DATA AGENT SUDDENLY APPEARS AS NOT LICENSED - United States

Text:
AIX SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS UNREPRODUCIBLE.
    
   
   

ERROR DESCRIPTION
 *  PMR NO:  34326,077,649
   COMPID:  5608TC300          AFFECTED RELEASE(s):  3.3.2, 4.1.x
   ________________________________________________________________
   ABSTRACT:  DATA AGENT SUDDENLY NOT LICENSED
   ..
   DETAIL OF PROBLEM (include example(s) of error(s)):  This
   problem has been seen in customer environments in the past;
   always with no explanation. An example of the scenario:
   The customer can see the agent via the TPC GUI under "Data
   Agents", he can "check" it successfully but cannot "view log".
   The common agent on the affected host is in good working
   condition and the data bundle is active but the data agent's
   logs suddenly indicate the agent is not registered, despite
   what's seen in the TPC GUI.  Previous agent_0000xx.logs indicate
   the agent service started and job logs indicate successful jobs.
   However, the latest agent_000052.log indicates:
     AGT0138W: IBM TPC for Data / IBM TPC
              for Data - Detector Component is not licensed
              on this computer.
     AGT0139E: An initial probe cannot be
              performed.
   ..
   TPC Messages Guide lists the warning:
     AGT0138W: <product name> is not licensed on this computer.
     Explanation
     The specified product is not licensed on this computer.
   There is no "Administrator Response" to this warning.
   Most customers confirm there were no manual actions taken to
   induce the behavior; the agent worked one day and failed the
   next.  Simply re-starting the agent services does not change the
   behavior.  Attempting to re-register the agent via "PROBE_ME"
   file does not change the problem.    The agent is found in both
   tables T_RES_HOST and T_RES_AGENT, but there is no entry in TPC
   for Data/Licensing view for this agent; likewise, the agent's
   entry under TPC for Databases is no longer present. It is
   unclear by the columns in these two database tables how to
   determine otherwise if an agent is "licensed", other than simply
   by the presence of an entry.
   In some customer environments where this problem is seen to
   occur, it is resolved by deleting the agent in TPC GUI Data
   Agents view, and restarting the Data agent.  First, this does
   not always work.  Second, there are problems with this solution:
   (a) Deleting the agent from the TPC GUI deletes the agent's
   collected history and configured jobs; and (b) if connectivity
   through the common agent is good, the Data agent and it's
   directories is removed from the host with this action.  Simply
   restarting the data agent under these circumstances isn't
   possible; the agent (data bundle) must also be reinstalled.
   ..
   It is unreasonable to expect the customer to lose the affected
   data agent's configurations in TPC (batch jobs, etc) and it's
   collected history, and unsatisfactory to expect a customer to
   remove/reinstall the agent.
   ..
   The apar is written for a corrected warning, root cause, and the
   correct, non-intrusive way customers should recover without
   losing their data. TPC needs to be more consistent.
   RECREATE STEPS:
   Why the warning appears is not explained.  We cannot seem to
   duplicate in the lab.
   
   ________________________________________________________________
   DB2 Version used for Server:  n/a
   The defect is against component:  5608TC300
   Server/Manager build/release (TPC):  3.3.2 and 4.1.x
   Agent build/release (TPC): 3.3.2 and 4.1.x
   Server/Manager (OS):   n/a
   Agent (OS):   n/a
   ________________________________________________________________
   Problem as described by customer:  Agent jobs suddenly fail.
   Initial customer impact (low/med/high):  med
   Local Fix:
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED: TPC 3.3.2 and 4.1.x users with Data Agents   *
   ****************************************************************
   * PROBLEM DESCRIPTION: Some Data Agents are not registered     *
   *                      correctly after an upgrade of the TPC   *
   *                      server.  No manual action believed to   *
   *                      be causing this.  This was reported     *
   *                      after a restart of the Data Server.     *
   *                                                              *
   *                      Agent logs (agent_xxx.log) will         *
   *                      contain errors:                         *
   *                                                              *
   *                      AGT0138W: IBM TPC for Data / IBM TPC    *
   *                      for Data - Detector Component is not    *
   *                      licensed on this computer.              *
   *                      AGT0139E: An initial probe cannot be    *
   *                      performed                               *
   ****************************************************************
   * RECOMMENDATION:                                              *
   ****************************************************************
   It is not known what situation caused the behavior
   experienced.  Other agent registration issues have been
   addressed with APARs.  Review available fixes for TPC.
   Collect TPC service data and a copy of the database to submit
   to support for further investigation.  Collect this when you
   experience the problem.
   
   
    
   
   

PROBLEM CONCLUSION

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IC65907
   
   
 * REPORTED COMPONENT NAME
   TPC FOR DATA
   
   
 * REPORTED COMPONENT ID
   5608TC300
   
   
 * REPORTED RELEASE
   33W
   
   
 * STATUS
   CLOSED UR5
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2010-01-27
   
   
 * CLOSED DATE
   2010-04-21
   
   
 * LAST MODIFIED DATE
   2010-04-21
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION

APPLICABLE COMPONENT LEVELS