Title: IBM Virtual IP (VIP) usage for automatic client re-route on DB2 HADR environment having a DB2 instance with more than one database. - United States

Text:
VIP; Virtual IP; hadr; failover; more databases; dependency; db2haicu; TSA; mkrel TECHNOTE (FAQ)

QUESTION
 How many virtual IPs (VIP) need to be defined for an automatic client re-route on DB2 HADR environments having more than one database per DB2 instance?

How does the failover work in this type of environment? 

ANSWER
NOTE: It is recommended to have 1 database per DB2 instance in DB2 HADR environments. 

VIP is defined per HADR resource group created using the db2haicu command. One HADR resource group is needed for each database, hence each database will have its own VIP. 

This means when a failover occurs to 1 database, others in the same 
instance are not affected. 

The failing database will use its own VIP and it won't affect the other databases. 

If the whole DB2 instance fails, then all databases will failover. 

If you would like to failover all databases even if one of them 
fails, then you can setup dependencies between the database to make this happen. 

This can be done using Tivoli System Automation (TSA) command mkrel. 

To get more details on all TSA commands including mkrel along with their options, refer to the following link:

http://publib.boulder.ibm.com/tividd/td/ITSAFL/SC33-8274-01/en_US/PDF/HALBRE01.pdf [http://publib.boulder.ibm.com/tividd/td/ITSAFL/SC33-8274-01/en_US/PDF/HALBRE01.pdf] 
To get details on how to setup VIP using db2haicu, refer to the following link:

https://www-304.ibm.com/support/docview.wss?uid=swg21439218 [https://www-304.ibm.com/support/docview.wss?uid=swg21439218]

RELATED INFORMATION
 HADR setup for DB2 on LUW [http://www.redbooks.ibm.com/redbooks/pdfs/sg247363.pdf]
TSA command reference [http://publib.boulder.ibm.com/tividd/td/ITSAFL/SC33-8274-01/en_US/PDF/HALBRE01.pdf]
TSA command reference 2 [http://publib.boulder.ibm.com/tividd/td/ITSAFL/SC33-8212-02/en_US/PDF/HALBCR02.pdf]
VIP setup using db2haicu [https://www.ibm.com/support/docview.wss?uid=swg21439218]