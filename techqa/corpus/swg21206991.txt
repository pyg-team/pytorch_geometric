Title: IBM Error: Your timezone setting is different from your operating system's current one - United States

Text:
Brazil; Brasila; Brasil; Timezone Error; Your time zone setting is different from your operating system's current one; os; daylight savings time; iIWA; DWA TECHNOTE (TROUBLESHOOTING)

PROBLEM
When you attempt to access your Lotus Domino mail file via Lotus Domino Web Access (DWA), the following error occurs: 

 * 
 * Your timezone setting is different from your operating system's current one. You can change your timezone setting by going to the Calendar section in the Preferences dialog.


You open your Preferences in DWA, and under the Calendar section you verify that the time zone is specified correctly. 
RESOLVING THE PROBLEM
This error can be caused by either of the following:

Your workstation and the Domino Server are both in the same time zone, but there is a mismatch between client and server. Either your workstation or the server does not have the "Automatically Adjust Clock for Daylight Saving Changes" option selected in the Date/Time setting in the Windows Control Panel. The server and workstation operating systems (OS) must both be either observing or not observing Daylight Saving Time (DST).

- OR -

Your workstation and server time zone match and they are both NOT observing DST and DWA opens to the Welcome Page when you launch it. This issue has been reported to Quality Engineering as SPR# FMWI69VTPZ and has been fixed in Domino 6.5.5 and 7.0.1. The solution is detailed below the workaround.


As a workaround you can:

Open the Domino Server's Configuration document, change to the Domino Web Access tab, and under the Start Up View section change the 'When Opening Domino Web Access, Open To' field from "Welcome" to "Mail".

-or-

In DWA 6.x if you have previously saved your Preferences, then open the Preferences dialog again, go to Other and change the 'Display this View when Starting' choice from "Welcome" to "Mail".

In DWA 7.x if you have previously saved your Preferences, then open the Preferences dialog again, go to the Basics tab/Display Options section and change the 'Display this tab when starting' choice from "Welcome" to "Mail".

In one customer's case, the workaround did not work unless the Microsoft Windows server had the Microsoft path KB928388 applied. 

Beginning in DWA 6.5.5 and 7.0.1, two options exist to resolve the issue where DWA's default time zone settings do not correspond to the settings on the server's operating system. In some scenarios it might make sense to use one over the other.

Option 1: Modify the Custom_JS form in DWA mail template (iNotes6.ntf or DWA7.ntf) and Forms file (Forms6.nsf or Forms7.nsf)

The first option involves customizing the API_TimeZones() section in the Custom_JS form of the DWA mail template and the Forms file to include the new or updated time zone information observed by the Operating System. Using the Domino Designer, open the Formsx.nsf database. Open the Custom_JS form and locate the API_TimeZones() section. The additional code entries must be located prior to the line "return (a_Table);"

Once the new time zone settings are added, the HTTP task will need to be restarted for the new settings to become available. 

The following example will provide a new time zone option at the top of the drop-down dialog for DWA users under Preferences > Calendar > Time zone called "(GMT+2:00) Jerusalem (Customized)" which allows for Daylight Saving Time to be observed.

The default DWA option, "(GMT+2:00) Jerusalem, Harare, Pretoria" does NOT observe Daylight Saving Time, and can therefore generate the "Your timezone setting is different from your operating system's current one..." error if used, as well as cause Calendar entries to appear off by an hour during Daylight Saving Time.

EXAMPLE:
a_Table[a_Table.length] = ["Jerusalem Custom", "Jerusalem Custom", "(GMT+02:00) Jerusalem (Customized)", -2, true, "4, 1, 6, 10, 2, 1"];

The first 3 arguments are Labels that may be customized for clarity as needed. Care should be taken in the naming, though, because if a setting by the same name already exists in DWA, the custom setting will override it... which may or may not be desirable.

The remaining arguments indicate the following... 

 *  -2 Offset from GMT true Observe DST "4, 1, 6, 10, 2, 1" start month, start week, start day, end month, end week, end day of DST; ie, DST begins the first Saturday in April, and ends the second Sunday in October.
   
   Note: These values correspond to what would be found in the DSTLAW parameter in a notes.ini 


Option 2: Add iNotes_WA_UseServerTZSettings=1 to the Domino server's notes.ini 

By adding iNotes_WA_UseServerTZSettings=1 to the server's notes.ini, the Timezone settings used by the server operating system will automatically appear at the bottom of the DWA Preferences > Calendar > Time Zone drop-down list. 

Using the above example, this would add the entry, "(GMT+02:00) Israel" directly beneath "(GMT+13:00) Nuku'alofa" in the drop-down. 

Note: The above INI parameter was introduced in Domino 6.5.5 and 7.0 . 

Supporting Information: 

When to use API_TimeZones() versus the iNotes_WA_UseServerTZSettings: 

While both options will allow for customized time zone configurations, it makes more sense to use one over the other, depending on the situation. 

For example, if the start and/or end of Daylight Saving Time changes from one year to the next (as in, it may not always be the first Saturday of April), then it may make more sense to use the iNotes_WA_UseServerTZSettings=1 setting on the server, so that repeated modifications to the Custom_JS form do not have to occur to account for the year to year change. 

Likewise, if numerous geographies are involved with unique TimeZone settings that stay constant from year to year, then it may make more sense to add each of those custom settings to the Custom_JS form, to make each of the custom options available to DWA users at once. 

Notes/Domino 8.0.x and 8.5.x : 

1) Locate the following forms depending on the Domino versions: 

For Domino 8.0.1, open the Forms8.nsf file in Designer. Locate the form "l_JSBase", and then repeat for "l_JSBase_Gecko", "l_JSBase_Safari", and "s_JSBase3" 

For Domino 8.0.2, check all of the forms described above plus the "Custom_JS" 

For Domino 8.5.x, open Form85.nsf file in Designer and locate form "l_JSBase_NoFrameSet", and then repeat for "l_JSBase_NoFrameset_Gecko", "l_JSBase_Noframeset_Safari". Also locate subform "l_JSBase", "l_JSBase_Gecko", "l_JSBase_Safari", and "s_JSBase" 

2) Locate the entry that corresponds to the timezone you are in. Make sure the entry matches the parameter "DSTLAw=" in the Domino and Notes Notes.ini. For example: 

The entry in the forms for Central Standard time on the forms85.nsf is the following: 

["Central", <dwa:string id="L_ZNM_ZW6DST"/>, <dwa:string id="L_SUBZONE_NAME_CENTRAL"/>, 6, true, "3, 2, 1, 11, 1, 1"] 

The notes.ini parameter on the Domino server and Notes client have to match this entry as follows: 

DSTLAW=3,2,1,11,1,1