Title: IBM Unable to start Ping Probe by non-root user on AIX - United States

Text:
Ping probe; non root; start; permissions TECHNOTE (TROUBLESHOOTING)

THIS DOCUMENT APPLIES ONLY TO THE FOLLOWING LANGUAGE VERSION(S):
 English 

PROBLEM(ABSTRACT)
 Ping probe fails to start when the probe is installed and started by non-root user. 

SYMPTOM
The following error is seen in the probe's log: 

Error: E-P_P-002-038: Could not change euid: Operation not permitted
Error: E-P_P-002-017: IPv4 socket failed: specified action does not have access permission of the file
Error: E-P_P-002-037: This program can only be run by root, or it must be setuid root.


CAUSE
Ping probe needs permissions which allow it to run as root and the LIBPATH setting should be changed.


ENVIRONMENT
AIX



RESOLVING THE PROBLEM
To enable non-root user to start the probe, you need to change the owner to root and permissions to setuid. And AIX ignores the LIBPATH setting when program runs as setuid root, so you also need to put either a copy of the required libraries, or a symbolic link to the required libraries in one of the trusted paths like /lib or /usr/lib. 


1. Change the owner to root and permissions to setuid.
e.g
# cd $OMNIHOME/probes/aix5/
# chown root:root nco_p_ping
# chmod +s nco_p_poing

2. Put a symbolic link to the required libraries.
e.g
# cd /usr/lib

# ln -s /opt/IBM/netcool/platform/aix5/lib/libgsk*
# ln -s /opt/IBM/netcool/platform/aix5/lib/libPa_r.so
# ln -s /opt/IBM/netcool/platform/aix5/lib/libnetcool_r.so
# ln -s /opt/IBM/netcool/platform/aix5/lib/libslclient_r.so
# ln -s /opt/IBM/netcool/platform/aix5/lib/libOpl_r.so
# ln -s /opt/IBM/netcool/platform/aix5/lib/libsybct_r.so
# ln -s /opt/IBM/netcool/platform/aix5/lib/libsybcs_r.so
# ln -s /opt/IBM/netcool/platform/aix5/lib/libsybtcl_r.so
# ln -s /opt/IBM/netcool/platform/aix5/lib/libsybcomn_r.so
# ln -s /opt/IBM/netcool/platform/aix5/lib/libtre.a
# ln -s /opt/IBM/netcool/platform/aix5/lib/libsybintl_r.so
# ln -s /opt/IBM/netcool/platform/aix5/lib/libicuuc40.a
# ln -s /opt/IBM/netcool/platform/aix5/lib/libicui18n40.a
# ln -s /opt/IBM/netcool/platform/aix5/lib/libicudata40.a


Note:
The required libraries can be seen by the following command:
# dump -H $NCHOME/omnibus/platform/aix5/nco_p_ping

Note:
If there are newer modules of the required libraries, it's better to create a symbolic link to the newer module.
e.g
Run
# ln -s /opt/IBM/netcool/platform/aix5/lib/libicui18n40.1.a
rather than,
# ln -s /opt/IBM/netcool/platform/aix5/lib/libicui18n40.a

But, please note that it would be better to create the symbolic links again whenever after you apply Fix pack for OMNibus core.




Cross reference information Segment Product Component Platform Version Edition Systems and Asset Management Tivoli Netcool/OMNIbus Ping AIX All Versions