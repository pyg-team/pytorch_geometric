Title: IBM Currency columns in Excel 2007 export files from ShowCase queries have $ instead of the expected currency symbol (for example: euro symbol). - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Currency columns in Excel 2007 export files from ShowCase queries have $ instead of the expected currency symbol (for exampl: euro symbol).
Only Excel files generated by CADS/C&DS (Collaboration and Deployment Services)are affected, not the Excel generated by Query itself 

RESOLVING THE PROBLEM
Current behavior of Query client - 
The Query client application refers to the regional settings while storing edit mask in the DBQ file; if you have regional currency symbol set as Euro and the edit mask contains Euro then Query client saves it as a generic currency symbol represented as the dollar sign; The dollar sign saved in the dbq files serves as a kind of placeholder. While reading/executing the DQB file , when Query encounters a dollar it replaces it with the regional currency symbol. Thus the internal storage as dollar is transparent to the user.
We can conclude the following : A query with Euro edit mask saved on pc with Euro currency regional settings will have "$" as placeholder for currency.

But when the query is run in C&DS, and the C&DS server was started with a user profile with non-euro country/language settings (e.g us English), then the currency picked up from the server will be Dollar, which is the default currency for US English.

To make C&DS behavior consistent with DBQ, we need to setup C&DS instance with the same language setting as the client/PC running query. 
Following are the steps for configuring a C&DS instance for a particular language setting (France_French in the example below). Be aware that this would not work in a multi currency environment.



------- For CADS running on Web sphere (iSeries) -------
1. Configure a user profile to used to run/start a C&DS instance

i. Set country, language and CCSID to desired value as
User profile . . . . . . . . . . . . . . . : <userprofile> 

Language identifier . . . . . . . . . . . : FRA 

Country or region identifier . . . . . . . : FR 

Coded character set identifier . . . . . . : 297 

ii. Set group profile to

Group profile . . . . . . . . . QEJBSVR 

This ensures this new user profile gets all rights of QEJBSVR in order to start C&DS.

2. Running application servers under newly configured user profile.

Follow this IBM info center's step-by-step guide to start CADS instance using a specific user profile.
http://publib.boulder.ibm.com/infocenter/wasinfo/v6r1/index.jsp?topic=/com.ibm.websphere.nd.iseries.doc/info/iseriesnd/ae/trun_run_svr_profiles.html

Following Step 1 and 2 will insure that CADS instantiated by user configured in step 1 runs with the language settings of that user.

Remark:
We use J9 VM to run C&DS, which executes in PASE.
PASE picks up locale files from IFS location "\QROOT\QOpenSys\usr\lib\nls\loc".
Make sure that your system does have the necessary locale files at above mentioned location to support the language settings (eg Language : French, Country : France CCSID 1148). 
Basically you need a system that has the right locale installed. Below link helps you to verify if the locale exist. 
http://publib.boulder.ibm.com/infocenter/iseries/v5r4/index.jsp?topic=/apis/pase_locales.htm 



------------ For Windows platform : -------------
For C&DS running on JBoss (Windows) MS Windows Regional settings will picked up by JBoss.
These settings can be found at : 
Control Panel -> Regional and language options 


Besides of the above you could also apply the following workaround :
1. Prior to starting the Query Application for creating a new DBQ change your Regional currency symbol to Dollar.
2. Apply edit mask with required non-dollar currency and save the query (DBQ file) to the repository.
3. Change you Regional currency to the default again (if changing this to Dollar affects your other applications).

RELATED INFORMATION
 Need more help? Our C&DS forum is Live! [https://developer.ibm.com/answers/topics/collaboration.html?smartspace=predictive-analytics]


 

HISTORICAL NUMBER
 91086