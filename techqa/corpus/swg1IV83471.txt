Title: IBM IV83471: UPDATING MQ CLIENT FROM MQ V7.1.0.6 TO MQ V7.1.0.7 CAUSES TLS/SSL ENCRYPTED CHANNELS TO FAIL. - United States

Text:
 SUBSCRIBE TO THIS APAR
By subscribing, you receive periodic emails alerting you to the status of the APAR, along with a link to the fix after it becomes available. You can track this item individually or track all items by product.

Notify me when this APAR changes.

Notify me when an APAR for this component changes.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  After applying v7.1.0.7 fixpack to existing v7.1.0.6 MQ
   clients, MQ applications which use TLS/SSL encrypted channels
   fail to connect, and start receiving:
   MQCONN ended with reason code 2393.
   
   The installation error log will show:
   
   AMQ9620: Internal error on call to SSL function on channel
   'CHANNEL' to host
   'localhost'.
   
   EXPLANATION:
   An error indicating a software problem was returned from a
   function which is
   used to provide SSL or TLS support. The error code returned was
   '702'. The
   function call was 'gsk_attribute_set_buff -
   GSK_V3_CIPHER_SPECS_EX -
   cciSslSetCipherSpecs'.
   
   
    
   
   

LOCAL FIX
 *  Enable deprecated TLS CipherSpecs within the SSL stanza of the
   qm.ini file as follows:
   
   SSL:
       AllowWeakCipherSpec=Yes
   
   
   
   Alternatively, these CipherSpecs may be re-enabled by setting or
   exporting the following environment variable to any value:
   
   AMQ_SSL_WEAK_CIPHER_ENABLE
   
   The variable should be set/exported within the environment used
   to start the queue manager. Defining this environment variable
   enables the CipherSpecs regardless of the value specified in the
   qm.ini file.
   
   
    
   
   

PROBLEM SUMMARY
 *  ****************************************************************
   USERS AFFECTED:
   All users of WebSphere MQ 7.1.0.7 attempting to connect to a
   queue manager over a secure channel
   
   
   Platforms affected:
   MultiPlatform
   
   ****************************************************************
   PROBLEM DESCRIPTION:
   APAR IV73287 [http://www-01.ibm.com/support/docview.wss?uid=swg1IV73287] removed a number of CipherSpecs from the default MQ
   configuration in order to resolve the security vulnerability
   popularly known as Bar-Mitzvah.
   
   Due to this change when an MQ client initialises the CipherSpecs
   it can use to communicate with the queue manager, an empty
   string is passed to the library which handles secure
   connections.
   
   Queue managers are also susceptible to this problem where SSLv3
   has been enabled (AllowSSLV3), but weak ciphers have not been
   enabled (AllowWeakCipherSpec). Unlike the MQ client, the MQ
   queue manager is not susceptible to this problem with the
   default configuration.
   
   The version of this library shipped in MQ 7.1 rejected the empty
   string as an invalid value. This error is not handled and the
   client fails the connection.
   
   
    
   
   

PROBLEM CONCLUSION
 *  The code was changed to ensure when initialising CipherSpecs an
   empty string is not passed to the library which handles secure
   connections.
   
   A preventative section of this code change is ported forward to
   MQ versions 7.5 and 8, however these versions are not affected
   by the loss of functionality described above.
   
   ---------------------------------------------------------------
   The fix is targeted for delivery in the following PTFs:
   
   Version    Maintenance Level
   v7.1       7.1.0.8
   v7.5       7.5.0.7
   v8.0       8.0.0.5
   
   The latest available maintenance can be obtained from
   'WebSphere MQ Recommended Fixes'
   http://www-1.ibm.com/support/docview.wss?rs=171&uid=swg27006037 [http://www-1.ibm.com/support/docview.wss?rs=171&uid=swg27006037]
   
   If the maintenance level is not yet available information on
   its planned availability can be found in 'WebSphere MQ
   Planned Maintenance Release Dates'
   http://www-1.ibm.com/support/docview.wss?rs=171&uid=swg27006309 [http://www-1.ibm.com/support/docview.wss?rs=171&uid=swg27006309]
   ---------------------------------------------------------------
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IV83471
   
   
 * REPORTED COMPONENT NAME
   WMQ LIN X86 V7
   
   
 * REPORTED COMPONENT ID
   5724H7224
   
   
 * REPORTED RELEASE
   710
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   YesHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt / Xsystem
   
   
 * SUBMITTED DATE
   2016-04-06
   
   
 * CLOSED DATE
   2016-04-29
   
   
 * LAST MODIFIED DATE
   2016-04-29
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WMQ LIN X86 V7
   
   
 * FIXED COMPONENT ID
   5724H7224
   
   

APPLICABLE COMPONENT LEVELS
 * R710 PSY
   UP