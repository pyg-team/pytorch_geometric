Title: IBM Collecting Data:  IBM Connections Portlets for WebSphere Portal - United States

Text:
MustGatherDocument; Must Gather Document; mustgather; mustgather; mustgather; LC; Lotus Connections; Multi-service Portlet install; Lotus Connections Multi-service Portlet installation TECHNOTE (TROUBLESHOOTING)

PROBLEM
This technote describes the information required for initial troubleshooting of issues with the IBM Connections Portlets which can be used to integrate IBM® WebSphere® Portal Server. 

DIAGNOSING THE PROBLEM
Gathering this MustGather information before calling IBM support will help you understand the problem and save time analyzing the data. This information may be requested if you have already contacted Support or need to collect data to determine the nature of a problem for WebSphere Portal regarding Multi-service Portlet, as well as the technote MustGather: Read first for WebSphere Portal [http://www-01.ibm.com/support/docview.wss?uid=swg21672901].


Collecting Portlet specific information


1. Confirm the following information: 

 * Is SSO (Single Sign On) enabled for authentication between the Connections and Portal servers? 
 * Does the issue occur on all servers or only on a particular server? If it is a particular server, what is unique or distinct about this server? 
 * Are all applications in this portlet having the problem or just one particular application? If one particular application, what is error? Are any other portlets experiencing issues? 
 * Did the portlet ever work before? What has changed recently on the server or on the application? 
 * Is this problem reproducible? What are the steps to reproduce the problem? 
 * Are you using SSL on the WebSphere Portal server? You will need to import the IBM Connections server SSL certificate to the portal keys store. 
 * Check to see that the emailPropertyName matches the LDAP email attribute which is required for Blogs and Dogear. Can they login with email as the user name and password to the Lotus Connections server directly? 
 * Confirm that the urls being used in the Configuration of the portlet also work in a web browser to connect to the Connections Server example: dogear.servername.ibm.com/dogear 
 * Ensure the latest version of the Portlets for your Portal server by going to the file:
   MANIFEST.MF 
   located in <PortlRoot>wp_profile\installedApps\<NodeName>\<APP_Name.ear>\snor.pf.portlets.war\META-INF)


2. Environment: 
 1. Are the server nodes clustered? 
 2. Exact version of IBM Connections, and version of operating system. 
 3. Exact version of WebSphere Portal and WebSphere Application Server. 
 4. LDAP server product and version installed, if any (local or remote and on what platform) 
 5. Database product and version installed (local or remote and on what platform) 
 6. Type of security in use:
    

SSO: Are you using one of the following: WebSphere/Domino SSO, Tivoli Access Manager (TAM) or SiteMinder?  1. Sign on to WebSphere Portal. 
 2. Change the URL in the browser to http://ConnectionsServer.FQDN.com/componentname 
 3. Make sure that you are not challenged for authentication


Credential Vault:  1. Configuration, shared settings, and personalize settings. 
 2. Provide screen captures of configure mode and shared settings mode when logged in as an administrator user. 
 3. Provide screen shots of the personalize settings when logged in as a user if the user is authorized to personalize the portlet settings.


Send the diagnostic information to IBM Support: 
Follow instructions to send diagnostic information to IBM Support [http://www.ibm.com/support/docview.wss?rs=688&uid=swg21201571], and be sure to provide all diagnostic information captured above. This requires that a PMR be opened if not already. 

Refer to the detailed instructions in the Technote " Exchanging information with IBM Technical Support for problem determination [http://www.ibm.com/support/docview.wss?rs=688&uid=swg21201571]" to make the information available and to update your problem record. 
RESOLVING THE PROBLEM
Confirm SSO is working by switching the browser URL from:
https://servername:20048/wps/myportal
to:https://connections.com/profiles
Are you automatically logged into Connections? 

What is the error?
Provide fiddler trace from the browser while you reproduce the problem below and obtain the following trace on the Connections Server from below.

Regenerate the LTPA token and import into the Portal Server .
Authenticate with portal then switch to this url.
https://servername.com/profiles/atom/profileService.do?email=useremail.com

Verify that the global proxy configurations are working in an SSO
environment:


 1. To check the proxy configuration for Connections Server:
    Open the URL:
    http://portal.servername.com/wps/proxy/https/connections.acme.com/profiles/profileservice.do?lang=en
    
 2. Enter the user name and password of a Connections user, if you are prompted to save or open a document, then the proxy has been properly configured.
    

 * If you are prompted to enter a user name and password, then the proxy has been properly configured but SSO is not enabled. 
 * If you receive a 403 error in response then the proxy is not properly configured.
   The following settings are required to be configured for the portlet to work.
   http://www-10.lotus.com/ldd/lcwiki.nsf/dx/Configuring_the_Portal_AJAX_proxy_to_support_authentication_ic301 [http://www-10.lotus.com/ldd/lcwiki.nsf/dx/Configuring_the_Portal_AJAX_proxy_to_support_authentication_ic301] 
 * Testing the proxy:http://www-10.lotus.com/ldd/lcwiki.nsf/xpDocViewer.xsp?lookupName=IBM+Portlets+for+Portal+8.5#action=openDocument&res_title=Testing_the_Ajax_proxy_configuration_ip85&content=pdcontent [http://www-10.lotus.com/ldd/lcwiki.nsf/xpDocViewer.xsp?lookupName=IBM+Portlets+for+Portal+8.5#action=openDocument&res_title=Testing_the_Ajax_proxy_configuration_ip85&content=pdcontent] 
 * If you receive a 500 or any other response code, this means the proxy was properly configured but something else is not working.
   


Files to Collect: 
What versions of Portal and Connections you have installed and are trying to configure. 
Also the version of the Connections Portlet you have downloaded and are trying to install? 

Enable logging on both the Connections and the Portal servers and reproduce the problem: 
Logging and Tracing > Cluster_server1 > Diagnostic trace service > Runtime > Change Log Detail Levels 


Portal server: 
*=info:com.ibm.ws.wim.*=all:com.ibm.websphere.wim.*=all: 

Connections Server: 
com.ibm.connections.directory.services.*=all:com.ibm.websphere.wim.*=all:com.ibm.ws.wim.*=all 


More specific Portlet tracing is available for specific Applications on the Connections Wiki: 
http://www-10.lotus.com/ldd/lcwiki.nsf/xpDocViewer.xsp?lookupName=IBM+Portlets+for+Portal+8.5#action=openDocument&res_title=Enabling_logging_for_the_Connections_portlets_ip85&content=pdcontent [http://www-10.lotus.com/ldd/lcwiki.nsf/xpDocViewer.xsp?lookupName=IBM+Portlets+for+Portal+8.5#action=openDocument&res_title=Enabling_logging_for_the_Connections_portlets_ip85&content=pdcontent] 

Logs for runtime/configuration related issues: 
/opt/IBM/WebSphere/wp_profile\logs  * SystemOut.log 
 * trace.log (if trace logging has been enabled for any of the portlets or Directory 


/opt/IBM/WebSphere/wp_profile\ConfigEngine\log\  * ConfigTrace.log 
 * ConfigMessages.log 
 * Services/Sonata Services) 
 * Connections systemout.log and trace.log 


The additional files below are on the Portal server and not Connections.  * directory.services.xml 
 * sonata.services.xml 
 * wkplc.properties 

located in the directory: /opt/IBM/WebSphere/AppServer\profiles\Dmgr01\config\cells\[cell]\ 

From Connections  * LotusConnections_config.xml 

found in /IBM/WebSphere/AppServer\profiles\Dmgr01\config\cells\[cellname]\LotusConnections-config 

Also provide fiddler trace from the browser while you reproduce the problem below and a screen shot of any errors you are seeing. 

Have the user log into connections. Run the fiddler application. Have the user perform the operation that is causing the error. When the action has been completed, save the results in fiddler by choosing “File”->”Save”->”All Sessions”. RELATED INFORMATION
 MustGather: Credential Vault for WebSphere Portal 6.1 [http://www.ibm.com/support/docview.wss?rs=899&uid=swg21313734]