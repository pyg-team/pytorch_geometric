Title: IBM Content Collector upgrade fails at TaskRoutingServiceSetup step - United States

Text:
1722; _E8CF9E93_700E_4E5F_8A8A_02B8B237794F; _F401ADF0_A991_4D7F_A720_9C87CE6F49FB TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Upgrading IBM Content Collector (ICC) fails when attempting to uninstall the TaskRoutingServiceSetup component. 

SYMPTOM
 

The following error occurs: 

Error 1722. There is a problem with this Windows Installer package. A program run as part of the setup did not finish as expected. Contact your support personnel or package vendor. 



"Actions _E8CF9E93_700E_4E5F_8A8A_02B8B237794F"

Or

"_F401ADF0_A991_4D7F_A720_9C87CE6F49FB" 


CAUSE
This can be caused by the soliddb Windows service running during the uninstall phase of the upgrade. Alternatively there can be resource contention caused by the TaskRoutingService properties page during the uninstall phase. 


DIAGNOSING THE PROBLEM
When upgrading ICC to a new version or fix pack, the previously existing version of the TaskRoutingServiceSetup.msi file is not completely removed, therefore the registration of the new TaskRoutingServiceSetup.msi file, bundled with the target version, will fail with the above error. 

Despite this error, the upgrade may appear to complete successfully, however the new version of the ICC TaskRoutingService may fail to start as there is still a reference to the TaskRoutingService of the previous version in the registry.


RESOLVING THE PROBLEM
Manually remove the services that the TaskRoutingServiceSetup sets up during its deployment by running the sc command from the system command line: 

 * sc delete configuration store service 
 * sc delete configuration store management service 
 * sc delete task routing service. 


NOTE: sc delete [id] syntax. All services have a specific ID that can be found on the properties page of the Windows Service. 

When this is complete run the upgrade again.