Title: IBM How to Troubleshoot a TM1 Data Tier Hang - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 If you have encountered a scenerio where your TM1 Data Server is unresponsive and you beleive that it may be hung - the first action that must be taken is to verify if the server is truly hung. This is an important step as there may be a long running process affecting subsequent processes/user actions, or a TM1 Server contention issue. 

To rule out a long running process or a contention issue, use TM1Top or Operations Console to view the Active Threads on the TM1 Server. If you see threads that are active (the run time continues to count up), then the TM1 Server is not truly hung and the investigation needs to start with understanding the specific user interactions occurring at this time.

Otherwise, the steps in this document cover the collection of the details IBM Support will require in order to assist in diagnosing the problem.



RESOLVING THE PROBLEM
In the event of a TM1 Data Tier hang, the following should be collected: 

 1. Basic description of the problem.  * What was it that the users were doing when the perceived hang occurred? 
     * Was it limited to just one user, or all users? 
     * Did the problem resolve after a period of time, or is it still unresponsive?
    
    
 2. The exact version of the TM1 Data Tier  * See: http://www-01.ibm.com/support/docview.wss?uid=swg21654934 [http://www-01.ibm.com/support/docview.wss?uid=swg21654934]
    
    
 3. Screenshots of the tm1sd.exe from Task Manager / Process Explorer  * Collect 3 screenshots, 30 seconds apart. This will allow us to have a quick glance at resources at the time of the Hang. 
     * If more than one tm1sd.exe, use Task Manager / Process Explorer to ensure you are looking at the correct PID for your server.
    
    
 4. Process Explorer Hang DMP of the tm1sd.exe process (Full Dump)  * See: http://www.ibm.com/support/docview.wss?uid=swg22002261 [http://www.ibm.com/support/docview.wss?uid=swg22002261] 
     * If more than one tm1sd.exe, use Task Manager / Process Explorer to ensure you are looking at the correct PID for your server.
    
    
 5. tm1server.log(s)  * Location defined in the affected server's tm1s.cfg file 
     * Must include the time frame the problem occurred
    
    
 6. tm1top.log(s)  * Location defined by TM1Top or OpsConsole 
     * Must include the time frame the problem occurred
    
    
 7. tm1s.cfg  * Typically resides in or near your TM1 Data directory
    
    

 * 

After the above has been collected, the following actions can be taken to better understand the problem that has occurred: 

 * Look at the screenshots/live view of Task Manager / Process Explorer  * Is the offending tm1sd process consuming CPU? 
    * Does the CPU% taken fluctuate up or down, even if only by a percent or two? 
    * Is there any movement in the Memory Usage? 
    * If CPU% or Memory Usage is fluctuating, even if the movement is marginal, the server may not be ‘hung’. 
      
   
   
 * Look at the tm1top.log  * Is there any activity on the server? Perhaps there is a process/chore running, which is preventing subsequent actions/requests/logons from running. 
    * Are any locks/waits found in the tm1top.log? If so, it is very likely that the server has not hung, however appears to be hung as the process/actions running are blocking subsequent actions for the duration of their execution. 
    * If it is not clear why the locks are being created and it has not already been enabled, the following tm1s-log.properties entries will allow further details to be written to the tm1server.log upon the next occurrence of the problem (see Resources for further details):  * log4j.logger.TM1.Lock.Exception=DEBUG
      
      
    * For additional resources regarding Lock Contention see: https://www.ibm.com/developerworks/community/wikis/home?lang=en#!/wiki/Wc8dd794ce663_464f_89d9_5472bde75168/page/Lock%20Contention%20Management [https://www.ibm.com/developerworks/community/wikis/home?lang=en#!/wiki/Wc8dd794ce663_464f_89d9_5472bde75168/page/Lock%20Contention%20Management]
      
   
   
 * Is there anything valuable in the tm1server.log?  * What you would want to look for, is any sort of logging/actions being written to the tm1server.log for the duration of the hang. If anything is being written to the log, it is very unlikely that the TM1 Server had actually been hung, which means we need to better understand the scenario that had led to the problem.