Title: IBM Summarization tables are not updated by SY agent - United States

Text:
KFWITM220E; cannot load product configuration; EXCEPTION: getHistoryConfig request to the TEP Server failed; EXCEPTION: Failed to init history; getHistoryConfig; SQL30082N; failed; userid; password; db2; -30082 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Summarization tables for all attribute groups and agents (_D, _H , _W) are not updated even if the raw data tables are correctly populated with the expected data. 

SYMPTOM
Into the Summarization and Pruning agent (SY) java log file called <hostname>_sy_java_xxxxxxxxx-0n.log you can see error messages like:

== 326903 t=Thread-5 markerUpd1 : UPDATE "ITMUSER"."WAREHOUSEMARKER" SET "MARKERWRITETIME" = ? WHERE "ORIGINNODE" = ? AND "OBJECT" = ? AND "MARKERTMZDIFF" = ? 
== 326904 t=Thread-5 Connecting to the TEP Server at ( 

 http://teps_hostname:1920///cnp/client/ior/CTDataBus::Manager) 


== 326905 t=Thread-5 EXCEPTION: getHistoryConfig request to the TEP Server failed. 

== 326906 t=Thread-5 EXCEPTION: Failed to init history
== 326907 t=Thread-5 EXCEPTION: Failed to setup history config
== 326908 t=Thread-5 Summarization and pruning agent ended with errors
== 326909 t=Thread-5 EXCEPTION: com.tivoli.twh.ksy.core.KSYException: getHistoryConfig to TEPS server teps:1920 failed
at com.tivoli.twh.ksy.core.TEPSRequestMaker.doPBasedRequest(TEPSRequestMaker.java:97) 

Also, if you try to modify Historical Collection Configuration from TEP client, an Error is returned:
"Cannot load product configuration Data. KFWITM220E Request failed during Execution"


CAUSE
Wrong configuration


DIAGNOSING THE PROBLEM
The error messages reported indicate that SY agent is failing to get warehouse information from TEPS.
SY agent needs to get some information from TEPS about the processed attribute groups.
Considering that you cannot update Historical Collection Configuration either, it is possible that the
problem is on TEPS.
Looking into the TEPS log file called <hostname>_cq_KfwServices_xxxxxxxxxx-0x.log you can find error messages like:

(511A1551.0007-E:ctsqlconnectionodbc.cpp,148,"CTSQLEvalODBC::Connection::sqlErrorCheckMsg") [IBM][CLI Driver] SQL30082N Security processing failed with reason "24" ("USERNAME AND/OR PASSWORD INVALID"). SQLSTATE=08001, GENERIC SQLSTATE: 08001, ERR: -30082
+511A1551.0007 SQLDriverConnect rc=-1: SQL_ERROR
(511A1551.0008-E:ctsqlconnectionodbc.cpp,543,"CTSQLEvalODBC::Connection::establishConnection") Unknown SQL Exception: dsn = WAREHOUS
(511A1551.0009-E:ctsqlconnectionodbc.cpp,544,"CTSQLEvalODBC::Connection::establishConnection") EXCEPTION: Unknown exception
(511A1551.000A-E:ctsqlconnectionodbc.cpp,1037,"CTSQLEvalODBC::Connection::describeDataSource") ERROR: unable to establish database connection to 'WAREHOUS'

This indicates a TEPS problem in accessing the warehouse database (WAREHOUS).
As you can see it also shows the reason of the error: 

SQL30082N Security processing failed with reason "24" ("USERNAME AND/OR PASSWORD INVALID"). SQLSTATE=08001, GENERIC SQLSTATE: 08001, ERR: -30082

that is indeed a DB2 error message advising about a wrong USERID/PASSWORD combination.


RESOLVING THE PROBLEM
Reconfigure TEPS and provide the correct combination for USERID and PASSWORD needed to connect to the warehouse database.
After a TEPS restart, you will be able to access the Historical Collection Configuration panel from TEP and also the Summarization and Pruning agent problem will be fixed.

 

PRODUCT ALIAS/SYNONYM
 IBM Tivoli Monitoring V6.x Summarization and Pruning Agent