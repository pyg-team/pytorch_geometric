Title: IBM PM21094: XPATH QUERY NOT BUILT CORRECTLY CAUSES SQL EXCEPTIONS - United States

Text:
  A FIX IS AVAILABLE
6.1.0.6 Download: WebSphere Portal and WCM V6.1.0 fix pack 6 [http://www-01.ibm.com/support/docview.wss?uid=swg24030970]



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  You are seeing the following error in the logs after clicking a
   link to a WCM content item:
   
   com.ibm.db2.jcc.c.SqlException: DB2 SQL error: SQLCODE: -302,
   SQLSTATE:
   22001, SQLERRMC: null
   com.ibm.db2.jcc.c.SqlException:
   DB2 SQL
   error: SQLCODE: -302, SQLSTATE: 22001, SQLERRMC: null
   at com.ibm.db2.jcc.c.kh.c(kh.java:1660)
   at com.ibm.db2.jcc.c.kh.a(kh.java:1224)
   at com.ibm.db2.jcc.b.db.n(db.java:737)
   
   This error is caused by an invalid xpath query being generated
   by WCM.  The query should be built like this:
   
   //element(*, icm:documentLibrary)[@icm:categories =
   '_6QR_003C7EBR5B0S1M9U_2R3' and @icm:label='LibraryName']
   
   However, the query leading to the exception is built like this:
   
   //element(*, icm:documentLibrary)[@icm:categories =
   '_6QR_003C7EBR5B0S1M9U_2R3' and
   @icm:label='LibraryName/Site/SiteArea/SiteArea/Content']
   
   
   It should be noted, that there was no function loss, the
   content still rendered as expected, but this exception was
   thrown.
   
   
    
   
   

LOCAL FIX
 *  NA
   
   
    
   
   

PROBLEM SUMMARY
 *  SQL Exception in the logs when clicking on a link in
   WCM local rendering portlet.
   
   
    
   
   

PROBLEM CONCLUSION
 *  You are seeing the following error in the logs after clicking a
   link to a WCM content item:
   
   com.ibm.db2.jcc.c.SqlException: DB2 SQL error: SQLCODE: -302,
   SQLSTATE:
   22001, SQLERRMC: null
   com.ibm.db2.jcc.c.SqlException:
   DB2 SQL
   error: SQLCODE: -302, SQLSTATE: 22001, SQLERRMC: null
   at com.ibm.db2.jcc.c.kh.c(kh.java:1660)
   at com.ibm.db2.jcc.c.kh.a(kh.java:1224)
   at com.ibm.db2.jcc.b.db.n(db.java:737)
   
   This error is caused by an invalid xpath query being generated
   by WCM. The query should be built like this:
   
   //element(*, icm:documentLibrary)[@icm:categories =
   '_6QR_003C7EBR5B0S1M9U_2R3' and @icm:label='LibraryName']
   
   However, the query leading to the exception is built like this:
   
   //element(*, icm:documentLibrary)[@icm:categories =
   '_6QR_003C7EBR5B0S1M9U_2R3' and
   @icm:label='LibraryName/Site/SiteArea/SiteArea/Content']
   
   
   It should be noted, that there was no function loss, the
   content still rendered as expected, but this exception was
   thrown.
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PM21094
   
   
 * REPORTED COMPONENT NAME
   LOTUS WEB CONT
   
   
 * REPORTED COMPONENT ID
   5724I2900
   
   
 * REPORTED RELEASE
   610
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2010-08-24
   
   
 * CLOSED DATE
   2010-09-01
   
   
 * LAST MODIFIED DATE
   2010-09-01
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   LOTUS WEB CONT
   
   
 * FIXED COMPONENT ID
   5724I2900
   
   

APPLICABLE COMPONENT LEVELS
 * R615 PSY
   UP
   
   
 * R61A PSY
   UP