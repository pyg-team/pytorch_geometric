Title: IBM nzstart error: user nz is not allowed to execute '/nz/kit.n.n.n.n/bin/adm/nz_update_ssh_config -D /nz/data.1.0'Â as root - United States

Text:
netezza pda puredata analytics pure data upgrade nzupgrade TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 When reverting to the previous version after a failed upgrade, nzstart fails with the error above. 

CAUSE
The NPS upgrade process edits the /etc/sudoers file to put in the exact path of various executable that user nz needs to run as root (using sudo). These paths include the actual kit.version.point.release directory. 

DIAGNOSING THE PROBLEM
For example, after a failed upgrade from 7.1.0.3-P1 to 7.2.0.3-P1, I attempted to restart NPS. 

/nz/kit points to kit.7.1.0.3-P1, but /nz/kit/bin/nzstart hangs on this line: 

 sudo /nz/kit.7.1.0.3-P1/bin/adm/nz_update_ssh_config -D /nz/data.1.0 


Looking in /etc/sudoers I see these lines:


# NPS setup -- do not edit below this line -- initarp
Defaults:nz !secure_path
Defaults:nz !requiretty
nz ALL = NOPASSWD: /usr/local/sbin/nzinitarp
nz ALL = NOPASSWD: /nzlocal/scripts/rpc/spapwr.sh
nz ALL = NOPASSWD: /nz/kit.7.2.0.3-P1/bin/adm/nzauth
nz ALL = NOPASSWD: /nz/kit.7.2.0.3-P1/bin/adm/nz_update_ssh_config
nz ALL = NOPASSWD: /sbin/clustat
{more similar lines}
# NPS setup -- do not edit above this line -- initarp



RESOLVING THE PROBLEM
Edit /etc/sudoers and change all the kit.7.2.0.3-P1 to point to the executables for the version you are trying to start up under. In my case that was kit.7.1.0.3-P1



HISTORICAL NUMBER
 94679
49R
000