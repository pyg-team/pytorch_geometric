Title: IBM JR46774: MULTIPLE JAVASCRIPTRUNNER EXCEPTIONS IN LOGS CAUSING TIMING ISSUES - United States

Text:
  FIXES ARE AVAILABLE
Version 8.0.1 Fix Pack 2 for the IBM Business Process Manager products [http://www-01.ibm.com/support/docview.wss?uid=swg24035701]
Version 8.5.0 Fix Pack 1 for the IBM Business Process Manager products [http://www-01.ibm.com/support/docview.wss?uid=swg24035702]
Version 7.5.1 Fix Pack 2 for the IBM Business Process Manager products [http://www-01.ibm.com/support/docview.wss?uid=swg24036462]
Version 8.5 Refresh Pack 5 for the IBM Business Process Manager products [http://www-01.ibm.com/support/docview.wss?uid=swg24037683]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  Large numbers of JavaScriptRunner exceptions are appearing in
   trace and system.out logs.
   These are having a negative on processes with timing-sensitive
   operations.
   Reproduction steps:
      1. Start a process instance of a BPD
          (it doesn't matter how the BPD looks, the problem occurs
   always)
      2. Execute a REST API call like this
   http://<host>:<port>/rest/bpm/wle/v1/process/<processInstanceID>
   ?federationMode=true [http://<host>:<port>/rest/bpm/wle/v1/process/<processInstanceID>?federationMode=true]
   Example stack trace:
   [5/7/13 13:07:10:748 CEST] 0000011f wle           W
   CWLLG0399W:
   JavaScriptRunner(...) nesting depth > 10 depth=28
   [5/7/13 13:07:10:749 CEST] 0000011f wle           W
   CWLLG0400W: Frame
   ''0'' was created by java.lang.Throwable
    at
    com.lombardisoftware.core.script.js.JavaScriptRunner$JavaScript
   RunnerFr
   ame.<init>(JavaScriptRunner.java:581)
    at
    com.lombardisoftware.core.script.js.JavaScriptRunner.<init>(Jav
   aScriptR
   unner.java:142)
    at
    com.lombardisoftware.bpd.runtime.engine.BPDExecutionContext.get
   JSScript
   Runner(BPDExecutionContext.java:331)
    at
    com.lombardisoftware.bpd.runtime.engine.BPDExecutionTreeNode.ge
   tJSScrip
   tRunner(BPDExecutionTreeNode.java:581)
    at
    com.lombardisoftware.bpd.runtime.engine.BPDExecutionTreeNode.ev
   aluateEx
   pression(BPDExecutionTreeNode.java:685)
    at
    com.lombardisoftware.bpd.runtime.engine.BPDExecutionTreeNode.ev
   aluateEx
   pression(BPDExecutionTreeNode.java:655)
    at
    com.ibm.bpm.rest.jaxb.mapping.BPDMappingUtils$1.doExecuteDuring
   Lock(BPD
   MappingUtils.java:1345)
    at
    com.lombardisoftware.bpd.runtime.engine.util.LockBPDInstanceCom
   mand$1.d
   oInTransaction(LockBPDInstanceCommand.java:62)
    at
   com.lombardisoftware.server.core.TXCommand$2.call(TXCommand.java
   :85)
    at
    com.lombardisoftware.utility.spring.ProgrammaticTransactionSupp
   ort$1.do
   InTransaction(ProgrammaticTransactionSupport.java:427)
    at
    org.springframework.transaction.jta.WebSphereUowTransactionMana
   ger$UOWA
   ctionAdapter.run(WebSphereUowTransactionManager.java:306)
    at
    com.ibm.ws.uow.embeddable.EmbeddableUOWManagerImpl.runUnderNewU
   OW(Embed
   dableUOWManagerImpl.java:791)
    at
    com.ibm.ws.uow.embeddable.EmbeddableUOWManagerImpl.runUnderUOW(
   Embeddab
   leUOWManagerImpl.java:370)
    at
    org.springframework.transaction.jta.WebSphereUowTransactionMana
   ger.exec
   ute(WebSphereUowTransactionManager.java:252)
    at
    com.lombardisoftware.utility.spring.ProgrammaticTransactionSupp
   ort.exec
   uteInNewTransaction(ProgrammaticTransactionSupport.java:422)
    at
    com.lombardisoftware.utility.spring.ProgrammaticTransactionSupp
   ort.exec
   ute(ProgrammaticTransactionSupport.java:291)
    at
    com.lombardisoftware.server.core.TXCommand.executeInDeadlockRet
   ryLoop(T
   XCommand.java:83)
    at
    com.lombardisoftware.bpd.runtime.engine.util.LockBPDInstanceCom
   mand.exe
   cute(LockBPDInstanceCommand.java:74)
    at
    com.ibm.bpm.rest.jaxb.mapping.BPDMappingUtils.evaluateExpressio
   n(BPDMap
   pingUtils.java:1354)
    at
    com.ibm.bpm.rest.jaxb.mapping.BPDMappingUtils.describeBPDInstan
   ce(BPDMa
   ppingUtils.java:324)
    at
    com.ibm.bpm.rest.jaxb.mapping.BPDMappingUtils.describeBPDInstan
   ce(BPDMa
   ppingUtils.java:181)
    at
    com.ibm.bpm.rest.impl.process.StartActionHandler.handleAction(S
   tartActi
   onHandler.java:142)
    at
    com.ibm.bpm.rest.impl.process.BusinessProcessDefinitionResource
   .postPro
   cessActions(BusinessProcessDefinitionResource.java:590)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at
    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccesso
   rImpl.ja
   va:60)
    at
    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMetho
   dAccesso
   rImpl.java:37)
    at java.lang.reflect.Method.invoke(Method.java:611)
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED:  Applications calling the REST Process       *
   *                  Instance API.                               *
   ****************************************************************
   * PROBLEM DESCRIPTION: Intermittently JavaScriptRunner         *
   *                      exceptions are seen in the logs.        *
   ****************************************************************
   * RECOMMENDATION:                                              *
   ****************************************************************
   When running REST API Process Instance calls, it may
   potentially generate JavaScriptRunner exceptions in the logs.
   These warnings are harmless however may fill up system logs.
   The exception messages are caused by timing issues which
   explains why this happens intermittently.  The following stack
   may be seen from the system logs:
   CWLLG0400W: Frame
   ''0'' was created by java.lang.Throwable
   at
   com.lombardisoftware.core.script.js.JavaScriptRunner$JavaScriptR
   unnerFrame.<init>(JavaScriptRunner.java:581)
   at
   com.lombardisoftware.core.script.js.JavaScriptRunner.<init>(Java
   ScriptRunner.java:142)
   at
   com.lombardisoftware.bpd.runtime.engine.BPDExecutionContext.getJ
   SScriptRunner(BPDExecutionContext.java:331)
   
   
    
   
   

PROBLEM CONCLUSION
 *  Code changes have been made to properly dispose of the
   JavaScriptRunners to prevent the warning messages from
   appearing. An interim fix is available on v7.5.1.0. The fix
   will be integrated into the next release.
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   JR46774
   
   
 * REPORTED COMPONENT NAME
   BPM ADVANCED
   
   
 * REPORTED COMPONENT ID
   5725C9400
   
   
 * REPORTED RELEASE
   751
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2013-05-29
   
   
 * CLOSED DATE
   2013-07-31
   
   
 * LAST MODIFIED DATE
   2013-07-31
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   BPM ADVANCED
   
   
 * FIXED COMPONENT ID
   5725C9400
   
   

APPLICABLE COMPONENT LEVELS
 * R750 PSY
   UP