Title: IBM How to use VBA macro across projects? - United States

Text:
 TECHNOTE (FAQ)

QUESTION
 How to use VBA macro across projects? 

ANSWER


Inorder to use VBA macro across projects you can either use the GUI settings or the Properties file.

Please find below both the methods explained step wise. 

For both the methods, creating an exe of the macro function is essential and is explained below

I. Creating an EXE
1. Open standard exe project in Visual Basic 6.0
2. Double click the form and place the following code

'This function changes the 'Default' package name to project name
Private Sub Form_Load()
Set appProj = GetObject(, "Rhapsody.Application")
Set RhapsodyProject = appProj.activeProject
Form1.Hide

Set DefaultPackage = RhapsodyProject.findNestedElement("Default", "Package")
If Not DefaultPackage Is Nothing Then
DefaultPackage.Name = RhapsodyProject.Name
End If
End
End Sub

Compile and Make the exe (MyProj.exe). 
II. Creating Helpers and distributing across projects

Method 1:

Open the Helpers dialog box in Rhapsody by clicking on 
Tools ->Customize 
In the Helpers dialog box, select the 'New' icon, 
In ' Command' field select the exe created in step I.3 (MyProj.exe). 
Select External program as the helper type. 
Click OK to apply and close the dialog box. 
To run the macros in another project

Ã˜ Open a project
Ã˜ Select the shortcut from the Tools menu

Method 2:

1. Create usershelpers.hep file with the following content:

[Helpers]

numberOfElements=1
name1= Change Default PackageName
command1=C:\Program Files\Telelogic\Rhapsody 7.2\MyHelperExes\MyProj.exe
arguments1=
initialDir1=
isVisible1=1
isMacro1=0
applicableTo1= Project

2. Create a folder named 'MyHelperExes' under Rhapsody installation 'C:\Program Files\Telelogic\Rhapsody 7.2' and place the exe 'MyProj.exe' created in step I.3

3. Create a folder named 'MyHelperProfile' under 'C:\Program Files\Telelogic\Rhapsody 7.2\Share\Profiles' folder and place the file 'Usershelpers.hep'

4. Edit the site.prp file (C:\Program Files\Telelogic\Rhapsody 7.2\Share\Properties) to include the following

Content of site.prp:

Subject General
Metaclass Model
Property HelpersFile String "C:\\Program Files\\Telelogic\\Rhapsody 7.2\\Share\\Profiles\\MyHelperProfile\\UsersHelpers.hep"

end
end

end

To run the macros in another project

Ã˜ Open a new project

Ã˜ Right-click on the project element and select "Change Default PackageName" from context menu (make sure only one copy of rhapsody is running).

Attached MacroAcrossProj.zip contains MyProj.exe, UsersHelpers.hep and site.prp for your reference.


7.1 MR1,7.1 MR2,7.1 MR3AnswerProduct versionPartner ContentInternal ContentCategoryReference IDAuthor 40227_fMacroAcrossProj.zip [/support/docview.wss?uid=swg21324339&aid=2] - 40227_fMacroAcrossProj.zip [/support/docview.wss?uid=swg21324339&aid=1]

HISTORICAL NUMBER
 40227