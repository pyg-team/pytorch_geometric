Title: IBM HPDIA0200W occurs during Trust Association Interceptor initialization - United States

Text:
TAM; TAI; certificate; authentication; expire; HPDIA0200W; PDContext; login; expire; invalid TECHNOTE (TROUBLESHOOTING)

PROBLEM
Trust Association Interceptor (TAI) unable to create PDContext due to authentication failure during TAI initialization.

SYMPTOM
Users logging into WebSphere Portal via Tivoli Access Manager WebSEAL are unable to access protected content. 


SystemOut.log shows:

[timestamp] 00000000 SystemOut O com.tivoli.pd.as.jacc.cfg.TAMConfigService initialize() About to initialize PDAdmin with the value /usr/IBM/WebSphere/AppServer/java/jre
[timestamp] 00000000 TrustAssociat A SECJ0121I: Trust Association Init class com.ibm.ws.security.web.TAMTrustAssociationInterceptorPlus loaded successfully
[timestamp] 00000000 TAMTrustAssoc I com.ibm.ws.security.web.TAMTrustAssociationInterceptorPlusinitialize(Properties) AWXRB0002E An error occurred while creating the Tivoli Access Manager authorization context. The details are: 
[java.lang.IllegalStateException: 
[
HPDIA0200W Authentication failed. You have used an invalid user name, password or client certificate.
]
at com.tivoli.pd.jutil.ob.a(ob.java:37)
....

CAUSE
Invalid certificate



ENVIRONMENT
WebSphere Portal with Trust Association Interceptor configured in WebSphere Application Server security to allow Tivoli Access Manager to handle external authentication.



DIAGNOSING THE PROBLEM
Validate the existing pdadmin credentials by doing the following: 

1. Log in to pdadmin directly on the Tivoli Access Manager to confirm the username (sec_master) and password work as expected. 

2. Run the following task on Portal to verify the connection and authentication credentials between WebSphere Portal and the Tivoli Access Manager policy server: 

./ConfigEngine.sh validate-pdadmin-connection -DWasPassword=password -Dwp.ac.impl.PDAdminPwd=password from the wp_profile_root/ConfigEngine directory 

You may observe that the task returns the identical error as observed in the SystemOut.log: 

validate-pdadmin-connection:

Sat Mar 23 09:35:34 PDT 2013
[checkpdadmin] ##################################
[checkpdadmin] ##
[checkpdadmin] ## adminUser: sec_master
[checkpdadmin] ## adminPw: ******
[checkpdadmin] ## url: file:/usr/IBM/WebSphere/AppServer/java/jre/PdPerm.properties
[checkpdadmin] ##--------------------------------------------

BUILD FAILED
/usr/IBM/WebSphere/PortalServer/base/wp.ac.impl/config/includes/wp.ac.impl_cfg.xml:278: Error initializing PDContext:
[
HPDIA0200W Authentication failed. You have used an invalid user name, password or client certificate.
] 

As the user name and password should be correct, the certificate must be invalid.


RESOLVING THE PROBLEM
Replace the certificate in the application server's keystore file (PdPerm.ks) using the following command: 

java com.tivoli.pd.jcfg.SvrSslCfg -action replcert -admin_id admin_user_ID -admin_pwd admin_password -appsvr_id application_server_name -cfg_file path_to_PdPerm.properties 

Restart the WebSphere Portal application server to take effect.


RELATED INFORMATION
#-action replcert description [http://pic.dhe.ibm.com/infocenter/tivihelp/v2r1/index.jsp?topic=%2Fcom.ibm.itame.doc_6.1%2Fam61_authJ_devref69.htm]




 * 
 *