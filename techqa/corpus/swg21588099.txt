Title: IBM Portal can not be restarted without doing a full server reboot - United States

Text:
ulimit; startserver; websphere_portal; restart; DB2 TECHNOTE (TROUBLESHOOTING)

PROBLEM
Attempts to restart Portal via the command line results in Portal saying it started but in fact does not respond on http.

SYMPTOM
The following errors are seen in the SystemOut.log: 

====================== 

[3/11/12 21:21:55:372 PDT] 00000011 SystemOut O 

java.io.FileNotFoundException: 

/opt/IBM/WebSphere/AppServer/properties/version/websphere.dtd (Too many 

open files) 

[3/11/12 21:21:55:373 PDT] 00000011 SystemOut O at 

java.io.FileInputStream.open(Native Method) 

[3/11/12 21:21:55:373 PDT] 00000011 SystemOut O at 

java.io.FileInputStream.<init>(FileInputStream.java:123) 

[3/11/12 21:21:55:373 PDT] 00000011 SystemOut O at 

java.io.FileInputStream.<init>(FileInputStream.java:83) 

====================== 

and: 

====================== 

[3/11/12 21:29:49:084 PDT] 00000011 Ffdc I 

com.ibm.ffdc.impl.Ffdc setFailsafeProvider FFDC1001I: FFDC provider 

aborted with exception {0} 

java.security.PrivilegedActionException: java.io.IOException: Too many 

open files 

 at 

java.security.AccessController.doPrivileged(AccessController.java:255) 

 at 

com.ibm.ws.ffdc.impl.FfdcProvider.logIncident(FfdcProvider.java:178) 

======================


CAUSE
In *nix operating system, ulimit is used to manage system resources. Having this value set too low or too high can cause adverse effects to your programs or system.


RESOLVING THE PROBLEM
There are a couple of ways to address this issue: 

1. Execute the following command; 

ulimit -n 20000 

then in the same terminal window, start Portal. 

2. Edit startServer.sh and add ulimit -n 20000 to the top of the file 

so it's called every time the server is started. 

3. Configure the user so that when the user logs in to the OS, ulimit 

-n is automatically set to 20000. This can be done by editing the 

.profile for the user, or the bash file for the user, depending on the 

shell.