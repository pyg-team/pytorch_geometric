Title: IBM Portal Upgrades:  Best Practices for 8.5 - United States

Text:
 TECHNOTE (FAQ)

QUESTION
 This document is meant to provide a basic set of what to do and what not to do when performing Portal upgrades.

Failure to observe these points, particularly in the 'What NOT to do' section can result in an unusable system and often results in complete reinstalls. 

ANSWER
What to do: 

 * Ensure you have a working backup of your environment. This includes a full file structure backup, which should specifically also include the IIM data directory, AND a full database backup. Having only one or the other is no better than having no backup at all. 
   
   Customers using DB2 on z/OS: When taking the database backup it is sufficient to only take a backup of the data but not the DB2 catalog as separate SQL files are provided to revert changes applied to the database schema during Combined Cumulative Fix installation.
   
   
 * Ensure file permissions are set correctly for UNIX environments. If you are using a non-root user, ensure that the user owns the AppServer directory, the PortalServer directory and the profile directory. 
 * Ensure you have followed all of the 'Before You Begin' steps from the upgrade instructions. 
 * If needed, upgrade all WebSphere Application Server (WAS) environments and ensure Portal still functions before starting the Portal upgrades. For example, if you have a two node cluster, update the Deployment Manager, WAS on the primary node, and WAS on the secondary node first. Then verify your Portal cluster still works on the higher level of WAS. Then you can begin the Portal upgrades. 
 * Also, IBM recommends the WebSphere Application Server (WAS) and Java Development Kit (JDK), all be updated simultaneously to receive the latest code and security fixes. NOTE: WAS 8.5.5.X only upgrades Java 1.6, but Portal 8.5 CF updates support Java 7 and 8. The JDK is a separate download from the WAS fixpack, so it may be necessary to download and install the latest JDK used in the Portal environment to ensure you have the most up-to-date code. 
 * If passwords are preserved during Combined Cumulative Fix installation and you want to manually delete the passwords, open the wkplc.properties file and include the following line in the file: PWordDelete=true. Then run the following task from the <wp_profile_root>/ConfigEngine/ directory to delete the passwords  * Windows: ConfigEngine.bat action-delete-passwords-fixpack 
    * Unix/Linux: ./ConfigEngine.sh action-delete-passwords-fixpack 
    * IBM i: ConfigEngine.sh action-delete-passwords-fixpack 
   
   
 * For a cluster, all nodes in the cluster must have the same apar/CF levels. 
 * If you are using Microsoft Internet Protocol (IP) Version 6 and you have specified the WpsHostName property as an Internet Protocol address, normalize the Internet Protocol address by placing square brackets around the IP address as follows: WpsHostName=[my.IPV6.IP.address]. 
 * Upgrade all profiles associated with the Portal binary directory. It is not supported to upgrade only some of the profiles and run a profile that was not upgraded with the upgraded Portal binaries.



What NOT to do:  * If upgrading a clustered environment, upgrade the primary node first. DO NOT upgrade a secondary first. 
 * If an upgrade fails, DO NOT attempt to apply a different Combined Cumulative Fix on top of a Combined Cumulative Fix failure. This is the most common action that results in a complete reinstall. 
 * Windows and UNIX only: Do NOT upgrade a node that is federated but not clustered. Create a cluster first, even if it is just one node. 
 * If an upgrade fails, DO NOT attempt to further configure the Portal server (reconfigure security, transfer the database, etc) until you have resolved the upgrade failure. 
 * When restoring a backup, DO NOT simply overwrite the existing WebSphere directory with a backed up one. You run the risk of corrupting the environment since overwriting the directory might not remove new files that had been laid down by the failed upgrade.