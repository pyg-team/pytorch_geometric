Title: IBM About automounting and ClearCase - United States

Text:
automount; autofs; automounter; amd; 1126109 TECHNOTE (FAQ)

QUESTION
 What are the recommendations regarding the use of UNIX® and Linux® automounting as it relates to IBM® Rational® ClearCase®? 

ANSWER
 

The use of automounting can be configured as you see fit in your ClearCase environment with two notable exceptions: 

 1. VOB tag directories (mount points) must not be automounted.
    
    
 2. The /view directories must not be automounted.


Below is a list of known problems, troubleshooting tips and FAQs related to automounting and its impact on ClearCase: 




[http://www.ibm.com/i/v16/icons/d.gif] [/target/url/]How to verify the automounter is loaded on UNIX and Linux [http://www.ibm.com/i/v16/icons/d.gif] [/target/url/] [/support/docview.wss?rs=0&uid=swg2B3EA2290143409AE85256D8F0010DA90#About%20the%20Lock%20Manager%20prior%20to%207&loc=en_US] Symptoms of automounter not running [http://www.ibm.com/i/v16/icons/d.gif] [/target/url/]Why automounting of VOB tags is not supported [http://www.ibm.com/i/v16/icons/d.gif] [/target/url/] [/support/docview.wss?rs=0&uid=swg2B3EA2290143409AE85256D8F0010DA90#About%20the%20Lock%20Manager%20prior%20to%207&loc=en_US] How to specify a non-standard mount directory used by the automounter [http://www.ibm.com/i/v16/icons/d.gif] [/target/url/] [/support/docview.wss?rs=0&uid=swg2B3EA2290143409AE85256D8F0010DA90#About%20the%20Lock%20Manager%20prior%20to%207&loc=en_US] ClearCase installation hangs when starting ClearCase#About%20%2Fetc%2Fauto_master%20and%20its%20af [/support/docview.wss?rs=0&uid=swg2B3EA2290143409AE85256D8F0010DA90#7.0&loc=en_US] 


How to verify the automounter is loaded on UNIX and Linux  1. Open a command prompt and run
    
    ps -ef | grep auto
    
    Output should show autofs as a running process.
    Note: Sometimes AMD is used for automount on Linux.
    
    ps -ef | grep amd
    
    
 2. Look in rc2.d for either 'amd' or 'autofs'.
    Note: ls should show autofs at something like S74.


[http://www.ibm.com/i/v16/icons/u_bold.gif] [/target/url/]Back to top 


Symptoms of automounter not running  1. ClearCase complains that a path is not valid in /net
    
    
 2. Change directories to /net and run ls results in no output.
    
    
 3. ClearCase startup script hangs
    
    Resolution:
    * Verify that autofs or AMD is installed on the machine
    * Add autofs or AMD to the startup sequence in the appropriate init.d, rc#.d file.


[http://www.ibm.com/i/v16/icons/u_bold.gif] [/target/url/]Back to top 


Why automounting of VOB tags is not supported  1. If a VOB tag is mounted in an automount directory hierarchy, the automounter (on some systems) will try to unmount the VOBs after an idle period of time expires. In such cases, the VOB will not be remounted when the host is accessed again, since the automounter doesn't know about it, thus it will be necessary to remount the VOB each time.
    
    So, a summary of what happens is:  * Mount the VOB tag on /automounted/pathname/subdir/VOBtag. 
     * The automounter times out, unmounts the VOBtag and /automounted/pathname 
     * User looks in /automounted/pathname/subdir/VOBtag 
     * Automounter remounts all exported FSs from the host in question 
     * VOB tag is not mounted -- user sees an empty directory and gets confused
       
       
    
    
 2. Long-term MVFS cache efficiency will drop as VOBs are mounted and unmounted. When a VOB is unmounted, the entire MVFS name cache is flushed. In addition, if a VOB is unmounted and remounted, any file versions which haven't changed and would have been cached will have to be refetched next time they are accessed.
    
    
 3. On systems which use /tmp_mnt/... style names, the mounted-on directory is different from what the VOB tag in the registry says, and that may cause problems. For example, the absolute symlinks used by the automounter from /net/hostname -> /tmp_mnt/net/hostname will lose context when trying to evaluate a view-extended pathname like /view/viewtag/vob/vobtag. This is particularly bad for non-ClearCase access hosts.
    
    
 4. Storage pathname of public VOBs could prepend with "mvfs=".
    
    Example:
    Good VOB storage path: "/vobs/dir1/test.vbs"
    Bad VOB storage path: "mvfs=/vobs/dir1/test.vbs"
    
    The prepended mvfs= causes problems with file access when read attempts are made:
    
    cleartext lookup view=testView vob=/vobs/test
    dbid=0x36 - No such file or directory
    cleartext pname= mvfs=/Disk/284/test.vbs/c/cdft/3c/ce7c83b46ca211d1aa7b004qwe: 
    No such device or address


[http://www.ibm.com/i/v16/icons/u_bold.gif] [/target/url/]Back to top 


How to specify a non-standard mount directory used by the automounter By default, automount mounts directories under /tmp_mnt and makes them visible under /net. If a ClearCase server uses another location for a host's automatic mounts (for example, you use automount -M), you must specify it in the file /var/adm/atria/config/automount_prefix. For example, if your automatic mounts take place within directory /autom instead of /net, create an automount_prefix file containing this line: /autom 


You must stop and restart ClearCase in order for this to take effect. This only affects mkvob, mkview and mktag commands that occur after the file is set up. The user must manually update global paths for any existing VOBs or views.




[http://www.ibm.com/i/v16/icons/u_bold.gif] [/target/url/]Back to top 


ClearCase installation hangs when starting ClearCase 

A ClearCase install on a UNIX proceeds normally and then hangs when trying to start processes. 

End of output from install: 
********************************************************** 
>> Begin component pre-startup customizations 
********************************************************** 
********************************************************** 
>> Starting ClearCase Product Family software 
********************************************************** 

...HANGS HERE... 

Note: De-installing and re-installing ClearCase yields the same results. 

This can be caused by an automount daemon not running on the system which ClearCase needs to mount the VOB's in /net. 

Ensure an automount daemon is installed and if so make sure the automount daemon is started and running. Then proceed with the installation. 

[http://www.ibm.com/i/v16/icons/u_bold.gif] [/target/url/]Back to top