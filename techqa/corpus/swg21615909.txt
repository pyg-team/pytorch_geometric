Title: IBM Content Search Services error IQQP9002E encountered while searching against IBM Content Collector emails using a wide date range - United States

Text:
icc search; IQQP9002E; css exception TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 IBM Content Search Services error IQQP9002E encountered while searching against IBM Content Collector emails using a wide date range 

SYMPTOM
Searching against a body of emails ingested to IBM FileNet P8 Content Engine (CE) using IBM Content Collector (ICC) using IBM Content Services (CSS) may result in an exception referencing "IQQP9002E The specified wildcard query cannot be processed because the query exceeded the maximum number of permitted BooleanQuery clauses.", for example : 

ERROR method name: callSearch principal name: P8Admin Global Transaction: false User
Transaction: false Exception Info: An IBM Content Search Services server could not run a full-text search. See the p8_server_error.log file for the error message stack that includes this error for more information on the specific cause of the error. For information about the location of this log, see "Viewing the IBM FileNet P8 log files" in the IBM FileNet P8 information center. If you cannot determine the cause of the error, restart the server. If the error continues to occur, contact IBM Software Support.
...
Caused by: com.filenet.api.exception.EngineRuntimeException: FNRCB0041E: CBR_TS_QUERY_FAILED_EXCEPTION: An IBM Content Search Services server could not run a full-text search. 
...
Caused by: com.ibm.ecmts.client.api.GeneralClientException: IQQP9002E The specified wildcard query cannot be processed because the query exceeded the maximum number of permitted BooleanQuery clauses.


CAUSE
ICC ingested emails contain a field labeled cemp_partition_date which contains the date in format YYYYMMDDHH which is indexed by CSS when collection partitioning by date is configured. When a CBR query is initiated against a CBR query against an object store with date partitioning configured the CBR query against a large date range, for example : 

query:(@xmlxp:'//icc_subject[.contains("""Test Subject""")]') AND cemp_partition_date:[1970091004 TO 2012091403]

the exception referenced above is encountered.

Internally the CSS query is expanded to contain all the possible YYYYMMDDHH values that exist in the collection being searched. For example one of the collections searched spans 1 year and it contains emails created at each minute of every hour then there could be a total of 8760 normalized YYYYMMDDHH possible values ( 365 days x 24 hours) for a typical year. As a result, the expanded CSS query contains more than the default of 1024 boolean conditions. 


RESOLVING THE PROBLEM
In order to allow such queries to complete, edit the CSS Server config.xml and increase the configuration value for queryExpansionLimit beyond 1024 while considering the possible number of normalized YYYYMMDDHH values in the collections being searched, for example : 


<queryExpansionLimit>8760</queryExpansionLimit>

Restart the CSS server for the change to take effect and monitor for memory usage on the CSS server.