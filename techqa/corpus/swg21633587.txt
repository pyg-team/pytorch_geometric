Title: IBM Instructions to install component firmware on an Integration Blade XI50B - United States

Text:
xi50b datapower upgrade component UEFI IMM DSA TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 You want to upgrade component firmware on your DataPower Integration Blade XI50B without sending it to IBM. This component firmware includes the Unified Extensible Firmware Interface (UEFI), Integrated Management Module (IMM), and Dynamic System Analysis (DSA). 

SYMPTOM
Firmware that is not at the latest level can cause several problems: 

 * Some Integration Blade XI50B appliances cannot maintain the correct power on or off state. 
 * Some appliances cannot boot into Dynamic System Analysis (DSA). 
 * When you press function key 2 (F2) at boot splash, the appliance hangs.


ENVIRONMENT
The following table shows the current versions of the Integration Blade XI50B component firmware and the upgrade versions. 

 

Component Current firmware version Upgrade firmware version UEFI FSE147AUS-1.00 P9E158A-1.19 IMM YUOO72F (1.13) YUOOE9E-1.37 DSA DSYT55B DSYTA7I-9.27 
These instructions use the existing DataPower firmware upgrade infrastructure. 

The following files are required for this upgrade:  * reltool_eswUpdater_dsa_dsyta7i-9.27_backup_xi.scrypt2 
 * reltool_eswUpdater_dsa_dsyta7i-9.27_primary_xi.scrypt2 
 * reltool_eswUpdater_imm_yuooe9e-1.37_backup_xi.scrypt2 
 * reltool_eswUpdater_imm_yuooe9e-1.37_primary_xi.scrypt2 
 * reltool_eswUpdater_uefi_p9e158a-1.19_both_xi.scrypt2


These files contain IMM, UEFI, and DSA upgrade packages only. You can use the boot image command or the WebGUI to start the upgrade for the component firmware. All messages are written to the system log. 

The DataPower appliance uses the scrypt2 file format to distribute both firmware upgrades and tools. For tools, always use the boot image command. If you use other commands (such as reinitialize or boot reflash), the appliance might log confusing error messages or not restart automatically as required. 

The tool for component upgrades can run only in appliance firmware versions 5.0.0 and 6.0.0. 

In addition to enabling local upgrades, these tools correct the issues in the Symptoms section:  * Corrects a problem that can occur at boot time when you press the function key 2 <PF2> to load the diagnostics (DSA). 
 * Prevents some blades from issuing incorrect reports of "voltage under threshold" errors on the expansion module. 
 * Prevents some blades from failing to stay powered-down when you request a power-down.

RESOLVING THE PROBLEM
Prepare the system 

 *  Download the tools for Fix Central.  * To download directly, click Tools-XI50B-June-2013-Component-Firmware [http://www-933.ibm.com/support/fixcentral/swg/downloadFixes?parent=ibm~WebSphere&product=ibm/WebSphere/WebSphere+DataPower+SOA+Appliances&release=6.0.0&platform=All&function=fixId&fixids=Tools-XI50B-June-2013-Component-Firmware&includeRequisites=0&includeSupersedes=0&downloadMethod=ddp] 
    * To download manually, go to the Fix Central [http://www.ibm.com/support/fixcentral/]. The identifier is Tools-XI50B-June-2013-Component-Firmware. If you are new to Fix Central, see Fix download method for WebSphere DataPower SOA Appliances [http://www.ibm.com/support/docview.wss?uid=swg21376557].
   
   In the WebGUI, specify the following Network Settings properties:  1. In the search field, enter Network. 
    2. From the search results, click Network Settings. 
    3. Set Relaxed Interface Isolation and Never Enforce Interface Isolation to On. 
    4. Click Apply.
   
   Confirm that the Integration Blade XI50B is running. Check for any administrative preconditions for an upgrade; such as, disabling certain network settings for time outs. 
 * 
 * 


Upgrade procedure  * 
 * 
 * 
 * 
 * 
 * 
 * Step 1
 * 
 * reltool_eswUpdater_imm_yuooe9e-1.37_primary_xi.scrypt2
 * 
 * 
 * 
 * Step 2
 * 
 * reltool_eswUpdater_imm_yuooe9e-1.37_backup_xi.scrypt2
 * 
 * 
 * 
 * Step 3
 * 
 * reltool_eswUpdater_uefi_p9e158a-1.19_both_xi.scrypt2
 * 
 * 
 * 
 *  
   ATTENTION: There is a potential security exposure when the UEFI upgrade begins. An attacker might modify key components on the Integration Blade XI50B. When you perform the upgrade, ensure that the blade is sufficiently isolated from potential attack. Restart the blade as soon as possible after each upgrade. The security exposure ends when the blade restarts. 
 * 
 * Step 4
 * 
 * reltool_eswUpdater_dsa_dsyta7i-9.27_primary_xi.scrypt2
 * 
 * 
 * 
 * Step 5
 * 
 * reltool_eswUpdater_dsa_dsyta7i-9.27_backup_xi.scrypt2
 * 
 * 
 * 
 * Step 6
 * 
 *  Using the command line, issue the service show component-firmware command. Observe that the IMM and BMC firmware version values correspond to the correct component values for the upgrade. Using the BladeCenter Advanced Management Module (AMM), select the firmware Vital Product Data (VPD) monitor. Check that the firmware BIOS, Blade System Management Processor IMM values, and the Diagnostics pDSA have the correct component values for the upgrade. The Diagnostics version is provided only by the AMM firmware VPD monitor. 
   

Considerations  * 
 * service show component-firmware
 * 
 *  The IMM version might not be show the upgrade until the requisite 15-minute wait period is over and the appliance is restarted. The UEFI version does not show the upgrade until the appliance is restarted. No DataPower commands display the DSA information. DSA information can be accessed with the BladeCenter AMM on the Firmware VPD page (the Diagnostics VPD). 
 * 
 * 
 * 
 * 
 * 
 *  For the IMM and the DSA, you can perform the upgrade to the primary and backup flash partitions separately. For the UEFI, there is no flash partition choice because the two flash partitions are kept in sync for this firmware.