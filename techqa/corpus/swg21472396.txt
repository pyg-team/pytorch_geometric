Title: IBM Operation Failed when exporting to Excel or PDF from TM1 Web - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 In TM1 Web, with some particular websheets only, when performing Slice to Excel, Snapshot to Excel, or Export to PDF, the following generic error is displayed on user interface :
----------------
Operation Failed 
System has encountered a problem while handling your request.
Please try again.
If you keep having trouble, please contact your system administrator for assistance.
----------------
On the server where TM1Web is installed, the file TM1Web.log (under \inetpub\wwwroot\TM1Web\log) does contain more informations :
ERROR Applix.TM1.Web.WebControls.Websheet.FormulaParser.PtgRef - failed to get last row number
ERROR Applix.TM1.Web.WebControls.Websheet.TM1WebFormula - An unexpected error occurred while evaluating TM1WebFormula: "=......" in named range <Name> in book "Applix.TM1.Web.WebControls.Websheet.TM1WebBook" in sheet "Applix.TM1.Web.WebControls.Websheet.TM1WebSheet"
System.NullReferenceException: Object reference not set to an instance of an object. 

CAUSE
This indicates there is a name defined in Excel that is not found (#REF error).

RESOLVING THE PROBLEM
- Open the original XLS or XLSX file in Perspectives and connect to TM1 server
- For Excel 2003 : go to menu Insert -> Name -> Define...
- For Excel 2007 : go to 'Formulas' tab in the ribbon, select the 'Name Manager'
- Determine which names are not valid anymore. This is easier with Excel 2007 since there is a column named "Value" that evaluates the formulas. The incorrect references are flagged by a "#REF!" in this column.