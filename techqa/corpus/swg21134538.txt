Title: IBM How can I get the 'Task ID' for a Windows application using IBM Rational Robot? - United States

Text:
task id; windows task id; getting the task id of a window; shell command; 1134538 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Is there a way to obtain the 'Task ID' for a Windows application via Robot? 

RESOLVING THE PROBLEM
There are two methods to obtain a 'Task ID' using Robot:

1. Return the result from opening the application using the shell command:
dim result as integer
result = shell("notepad.exe")

Result will store the applications task id 

2. You can also use a windows api call to get the task id. The following script demonstrates this:

Declare Function GetWindowThreadProcessId Lib "user32" (ByVal hwnd As Long, lpdwProcessId As Long) As Long

'$include "sqautil.sbh"

Sub Main

Dim Result As Integer 
Dim l As Long
Dim lProc As Long
Dim procid as string

startapplication("c:\winnt\notepad.exe") 'Comment shell command above and uncomment here to use start application

Result = SQAGetProperty("\;Caption=Untitled - Notepad","hWnd", l) 'this is the window caption for the application that you want capture the task id

l = GetWindowThreadProcessId(l, lProc) 'Use windows api call to get the task id (Stored in lProc) 

End Sub

Here lProc will contain the task id for the application.

 

HISTORICAL NUMBER
 21092