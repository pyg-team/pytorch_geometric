Title: IBM IT04330: INCORRECT STATUS RETURN CODE SENT FROM "BACKUP/RESTORE VM" - United States

Text:
AIX  FIXES ARE AVAILABLE
IBM Tivoli Storage Manager (TSM) client 7.1.1.x interim fix downloads [http://www-01.ibm.com/support/docview.wss?uid=swg24038694]
TSM Client 7.1.2 Downloads and READMEs [http://www-01.ibm.com/support/docview.wss?uid=swg24039740]
TSM Client 6.4.3 Downloads and READMEs [http://www-01.ibm.com/support/docview.wss?uid=swg24040185]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  'BACKUP VM' or 'RESTORE VM' commands can provide a successful
   completion of RC=0 to the Tivoli Storage Manager Server when
   they should return a return code other than zero.
   
   During the BACKUP VM in case of failure the Tivoli Storage
   Manager Client sets for every VM a value different from 0
   depending on the nature of the failure.
   
   The VM backup status code is not passed correctly to the Tivoli
   Storage Manager Server so it  remains as RC=0, reporting it in
   the completion status of single VM backup in extended summary
   table of Tivoli Storage Manager Server database even if not all
   VMs may have been backed up correctly.
   
   Example :
   
   Backup VM command started.  Total number of virtual machines to
   process: 1
   Accessing as node: NODENAME
   ANS9499W VMware tools on virtual machine 'VMNAME' need to be
   updated. IBM Tivoli
   Storage Manager application protection will not be used.
   Starting Full VM backup of VMware Virtual Machine 'VMNAME'
           mode:                        'Incremental Forever -
           Incremental'
           target node name:            'NODENAME'
           data mover node name:        'PROXY'
           application protection type: 'VMware'
           application(s) protected:    'n/a'
   
   Creating snapshot for virtual machine 'VMNAME'
   Backing up Full VM configuration information for 'VMNAME'
            XX,XXX VM Configuration [Sent]
   Processing snapshot
           disk:         [DATASTORE] VMNAME/FILE.vmdk (Hard Disk 1)
           Capacity:     XX,XXX,XXX,XXX
           Data to Send: XX,XXX,XXX
           Transport:     (nbdssl)[sending]
   Volume --> XX,XXX,XXX,XXX [DATASTORE] VMNAME/FILE.vmdk (Hard
   Disk 1) [Sent]
   
   Successful Full VM backup of VMware Virtual Machine 'NODENAME'
           mode:                 'Incremental Forever -
           Incremental'
           target node name:     'NODENAME'
           data mover node name: 'PROXY'
   
   Statistics for Virtual Machine 'NODENAME'.
   
   Total number of objects inspected:            1
   Total number of objects backed up:            1
   Total number of objects updated:              0
   Total number of objects rebound:              0
   Total number of objects deleted:              0
   Total number of objects expired:              0
   Total number of objects failed:               0
   Total objects deduplicated:                   1
   Total number of bytes inspected:          XX.XX GB
   Total number of bytes processed:          XX.XX MB
   Total bytes before deduplication:         XX.XX MB
   Total bytes after deduplication:          XX.XX MB
   Total number of bytes transferred:        XX.XX MB
   Data transfer time:                         X.XX sec
   Network data transfer rate:            X,XXX.XX KB/sec
   
   In the example above the warning message "ANS9499W VMware tools
   on virtual machine 'VMNAME' need to be updated. IBM Tivoli
   Storage Manager application protection will not be used."
   changes the VM backup status code to 8, but the value passed to
   the Tivoli Storage Manager Server remains as 0, thus updating
   wrongly the extended summary table of Tivoli Storage Manager
   Server.
   
   Tivoli Storage Manager Versions Affected:
   Tivoli Storage Manager Client 7.1.x on all supported platforms.
   
   Initial Impact:
   Medium
   
   Additional Keywords:
   vm backup successful status schedule completed IC98858 [http://www-01.ibm.com/support/docview.wss?uid=swg1IC98858] zz71
   
   
    
   
   

LOCAL FIX
 *  A possible workaround can be to add the
   'testflag  SHOWALLCONSISTENTRC'
   to the client options file as this would print out these missing
   messages when you use dsmc interactively or in a script :
   
   ANS1900I Return code is 12.
   ANS1901I Highest return code was 12.
   
   
    
   
   

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED: Backup-archive client versions  6.4 and      *
   *                 7.1 on Microsoft Windows and Linux x86       *
   *                 platforms.                                   *
   ****************************************************************
   * PROBLEM DESCRIPTION: See ERROR DESCRIPTION                   *
   ****************************************************************
   * RECOMMENDATION: Apply fixing level when available. This      *
   *                 problem is currently projected to be fixed   *
   *                 in levels 6.4.3 and 7.1.2.                   *
   *                 Note that this is subject to change at the   *
   *                 discretion of IBM.                           *
   ****************************************************************
   *
   
   
    
   
   

PROBLEM CONCLUSION
 *  Return code for each backup vm operation is now correctly sent
   to server and can be seen in actlog and extended summary table.
   
   
    
   
   

TEMPORARY FIX
 *  A fix for this problem is currently targeted for interim fix
   package 7.1.1.1.
   Until the interim fix is actually available this information
   is subject to change at the discretion of IBM
   
   
    
   
   

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IT04330
   
   
 * REPORTED COMPONENT NAME
   TSM CLIENT
   
   
 * REPORTED COMPONENT ID
   5698ISMCL
   
   
 * REPORTED RELEASE
   71W
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2014-09-15
   
   
 * CLOSED DATE
   2014-10-09
   
   
 * LAST MODIFIED DATE
   2014-10-09
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

MODULES/MACROS
 *  DSMAGENT
   
   
    
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   TSM CLIENT
   
   
 * FIXED COMPONENT ID
   5698ISMCL
   
   

APPLICABLE COMPONENT LEVELS
 * R64L PSY
   UP
   
   
 * R64W PSY
   UP
   
   
 * R71L PSY
   UP
   
   
 * R71W PSY
   UP