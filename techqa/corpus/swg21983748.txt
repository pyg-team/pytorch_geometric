Title: IBM FileNet P8 Content Engine 5.2.1 CONTENT_ASA_FILE_WRITE_FAILED error for Advanced Storage Area Replication - United States

Text:
Advanced Storage Area Replication FNRCC0250E CONTENT_ASA_FILE_WRITE_FAILED TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Using the Advanced Storage Area Replication functionality in P8 CPE 5.2.1 and trying to create two sites with the primary storage area as synchronous and the secondary storage area as asynchronous, the CONTENT_ASA_FILE_WRITE_FAILED error is returned when the secondary asynchronous storage area is taken off line. 

SYMPTOM
The following error is repeated in the p8 log file: 

 * 
 * 2016-03-24T09:01:03.038 AD0929E3 ENG FNRCC0243E - ERROR method name: createContent principal name: p8user Global Transaction: false User Transaction: false Exception Info: Not enough replicas were written to satisfy the synchronous upload requirement, written 0, required 1. Area Id: [{aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa}]; Device Id: [{00000000-0000-0000-0000-000000000000}]; Content Id: [{bbbbbbbb-bbbb-bbbb-bbbb-bbbbbbbbbbbb}]; HashSeq: [359,312,052,224]; Successful replicas: []; Failed replicas: [{cccccccc-cccc-cccc-cccc-cccccccccccc} : com.filenet.api.exception.EngineRuntimeException: FNRCC0250E: CONTENT_ASA_FILE_WRITE_FAILED: The target file cannot be written for storage device {cccccccc-cccc-cccc-cccc-cccccccccccc}, file path \\async-storage\Imaging01\OS1\content\86\13\bbbbbbbb-bbbb-bbbb-bbbb-bbbbbbbbbbbb. Message was: The specified network name is no longer available.]
   com.filenet.api.exception.EngineRuntimeException: FNRCC0243E: CONTENT_ASA_NOT_ENOUGH_REPLICAS_WRITTEN: Not enough replicas were written to satisfy the synchronous upload requirement, written 0, required 1. Area Id: [{aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa}]; Device Id: [{00000000-0000-0000-0000-000000000000}]; Content Id: [{bbbbbbbb-bbbb-bbbb-bbbb-bbbbbbbbbbbb}]; HashSeq: [359,312,052,224]; Successful replicas: []; Failed replicas: [{cccccccc-cccc-cccc-cccc-cccccccccccc} : com.filenet.api.exception.EngineRuntimeException: FNRCC0250E: CONTENT_ASA_FILE_WRITE_FAILED: The target file cannot be written for storage device {cccccccc-cccc-cccc-cccc-cccccccccccc}, file path \\async-storage\Imaging01\OS1\content\86\13\bbbbbbbb-bbbb-bbbb-bbbb-bbbbbbbbbbbb. Message was: The specified network name is no longer available.]
 * 


CAUSE
Incorrect configuration for Advanced Storage Area Replication.

ENVIRONMENT
P8 CPE 5.2.1



RESOLVING THE PROBLEM
In order to configure the Advanced Storage Area Replication so that the storage area for the local site is written to synchronously and the remote site is written to asynchronously, do the following: 

 

 * Create a single Advanced Storage Area. For example, if there are two sites with a storage device at each site, creating Advanced Storage Areas for each site is unnecessary and can cause issues.
   Create the Storage Devices for each site. 
 * Do not use the Synch Type of "Asynchronous". For each Device Replica, set the Synch type to Synchronous and the Replica Synch Type for the alternate site to Secondary synchronous. 
 * Set both the Maximum synchronous devices and Required synchronous devices to 1.


By using these settings, the content will always get written to the local storage device synchronously and to the remote storage device asynchronously - unless the local device is unavailable, in which case it will write synchronously to the remote device and will write synchronously to the local device when it comes back on line. Also, if the remote device is temporarily unavailable, the content upload will still succeed (because the local device is available and can be written to synchronously) and the remote device will be written to asynchronously when it comes back online. In this configuration, the system will have the correct behavior no matter what site the server instance that handles the content upload request is in.