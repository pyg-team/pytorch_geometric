Title: IBM Configuring a JDBC provider and datasource for federated repositories - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

THIS DOCUMENT APPLIES ONLY TO THE FOLLOWING LANGUAGE VERSION(S):
 English 

PROBLEM(ABSTRACT)
 In the initial offering of IBM® Websphere® Application Server Version 6.1, only the IBM DB2® legacy CLI-based type2 Java™ database connectivity (JDBC) driver was supported for DB2. The driver is described in the Defining a DB2 legacy CLI-based type2 JDBC driver (XA) [http://publib.boulder.ibm.com/infocenter/wasinfo/v6r1/topic/com.ibm.websphere.wim.doc.en/definedb2jdbcdriver.html] topic within the Information Center for WebSphere Application Server. In Websphere Application Server V6.1.0.13, support is provided for the DB2 JCC type4 JDBC driver.

This article documents the steps needed to configure the type4 JDBC provider for DB2 as well as various DB types. 

RESOLVING THE PROBLEM
Add the following libraries to the class path for the server Java virtual machine (JVM).


Library type File name DB2 ${DB2_JDBC_DRIVER_PATH}/
db2jcc.jar
${DB2_JDBC_DRIVER_PATH}/
db2jcc_license_cu.jar
${DB2_JDBC_DRIVER_PATH}/
db2jcc_license_cisuz.jar Derby ${WAS_APP_SERVER_ROOT}/
derby/lib/derby.jar Informix® Dynamic Server ifxjdbc.jar
ifxjdbcx.jar Oracle Enterprise Edition ojdbc14.jar SQL Server Enterprise sqlserver.jar
base.jar and
util.jar  1. Configure a JDBC provider using the information in the https://www.ibm.com/support/knowledgecenter/SSAW57_8.5.5/com.ibm.websphere.nd.multiplatform.doc/ae/tdat_ccrtprov.html [https://www.ibm.com/support/knowledgecenter/SSAW57_8.5.5/com.ibm.websphere.nd.multiplatform.doc/ae/tdat_ccrtprov.html] topic and the information in the following table.
    
    The providers in the following table have an XA data source implementation type.
    Type JDBC Provider DB2 DB2 Universal JDBC Driver Provider Derby Derby JDBC Provider Informix Dynamic Server Informix JDBC Provider Oracle Enterprise Edition Oracle JDBC Provider SQL Server Enterprise IBM WebSphere embedded ConnectJDBC Provider for MS SQL Server 
 2. Create a data source using the JDBC provider information in the previous table and the information in the [https://www.ibm.com/support/knowledgecenter/SSAW57_8.5.5/com.ibm.websphere.nd.multiplatform.doc/ae/twim_fedmap_datasconf.html]https://www.ibm.com/support/knowledgecenter/SSAW57_8.5.5/com.ibm.websphere.nd.multiplatform.doc/ae/twim_fedmap_datasconf.html [https://www.ibm.com/support/knowledgecenter/SSAW57_8.5.5/com.ibm.websphere.nd.multiplatform.doc/ae/twim_fedmap_datasconf.html] topic. 
 3. Set the following custom property on the newly created data source:
    webSphereDefaultIsolationLevel = 2
    
    For more information, see the https://www.ibm.com/support/knowledgecenter/SSAW57_8.5.5/com.ibm.websphere.nd.multiplatform.doc/ae/twim_fedmap_datasconf.html [https://www.ibm.com/support/knowledgecenter/SSAW57_8.5.5/com.ibm.websphere.nd.multiplatform.doc/ae/twim_fedmap_datasconf.html] topic. 
 4. Restart the Application Server. 
 5. Complete one of the following steps:  1. If you do not have any existing database repositories, then use the driver suitable to your DB type to configure new database repositories.
        
        For details on how to create tables for a database repository, see the https://www.ibm.com/support/knowledgecenter/SSAW57_8.5.5/com.ibm.websphere.nd.multiplatform.doc/ae/twim_fedmap_wsadmin.html [https://www.ibm.com/support/knowledgecenter/SSAW57_8.5.5/com.ibm.websphere.nd.multiplatform.doc/ae/twim_fedmap_wsadmin.html] topic.
        
        The following commands are used to configure database repositories. For details on how to use these commands, see the https://www.ibm.com/support/knowledgecenter/SSAW57_8.5.5/com.ibm.websphere.nd.multiplatform.doc/ae/rxml_atidmgrrepositoryconfig.html [https://www.ibm.com/support/knowledgecenter/SSAW57_8.5.5/com.ibm.websphere.nd.multiplatform.doc/ae/rxml_atidmgrrepositoryconfig.html] topic.
        Action type Command Database repositories createIdMgrDBRepository Property extension repository setIdMgrPropertyExtensionRepository Federated repository setIdMgrEntryMappingRepository 
     2. If you already have existing database repositories based on the DB2 legacy CLI-based type2 driver, then update the repositories to use the type4 driver as follows.
        Action type Command Database repositories wsadmin> $AdminTask updateIdMgrDBRepository
        {-id database_ID
        -dbURL database_URL
        -JDBCDriverClass com.ibm.db2.jcc.DB2Driver} Property extension repositories wsadmin> $AdminTask setIdMgrPropertyExtensionRepository {-dbURL database_URL
        -JDBCDriverClass com.ibm.db2.jcc.DB2Driver
        -databaseType database_typ
        -dataSourceName data_source_nam
        -dbAdminId database_administrator_ID
        -dbAdminPassword database_administrator_password} Federated repositories wsadmin> $AdminTask setIdMgrEntryMappingRepository 
        {-dbURL database_URL
        -JDBCDriverClass com.ibm.db2.jcc.DB2Driver
        -databaseType database_type
        -dataSourceName data_source_name
        -dbAdminId database_admin_ID
        -dbAdminPassword database_administrator_password} 
    
    
 6. Restart the Application Server. Federated repositories should now use the new driver.


Notes  * In step 1, either copy the JDBC driver files to the WebSphere Application Server lib directory or include the location of the JDBC driver files in the server JVM class path 
 * In a WebSphere Application Server Network Deployment configuration, perform the changes on the deployment manager and restart all the managed nodes.

RELATED INFORMATION
 Setting up an entry mapping repository [http://www14.software.ibm.com/webapp/wsbroker/redirect?version=pix&product=was-base-dist&topic=twim_fedmap_wsadmin]




Cross reference information Segment Product Component Platform Version Edition Application Servers WebSphere Application Server for z/OS Security z/OS 6.1