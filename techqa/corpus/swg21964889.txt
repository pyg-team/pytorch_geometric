Title: IBM Windows agent fails to return performance data - United States

Text:
5724C040W TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Windows agent has no performance data being returned. The files in ...\logs\History\KNT are not being created for the WIndows data. The khdexp.cfg log gets created but looks empty and no other files. WMI seems ok based on winmgmt /verifyrepository shows repository is good. 

SYMPTOM
The agent logs <HOSTNAME>_nt_kntcma_<TIMESTAMP>-01.log (under $CANDLEHOME/TMAITM6_x64/logs) show errors similar to: 

*****
(55CE4D7C.0042-114:knt05agt.cpp,227,"TakeSample") Error retrieving performance data from the Processor performance object: <80070005> 
(55CE4D7C.0043-114:knt74agt.cpp,248,"TakeSample") Error retrieving performance data from the Memory performance object: <80070005> 
(55CE4D7C.0044-114:knt74agt.cpp,248,"TakeSample") Error retrieving performance data from the Memory performance object: <80070005> 
(55CE4D7C.0045-114:knt06agt.cpp,306,"TakeSample") KNT06001E Error getting physical disk information: <80070005> 
(55CE4D7C.0046-114:knt06agt.cpp,604,"TakeSample") Error retrieving performance data from the LogicalDisk performance object: <80070005> 
(55CE4D7C.0047-114:knt06agt.cpp,306,"TakeSample") KNT06001E Error getting physical disk information: <80070005> 
(55CE4D7C.0048-114:knt06agt.cpp,604,"TakeSample") Error retrieving performance data from the LogicalDisk performance object: <80070005> 
(55CE4D7C.0049-114:knt04agt.cpp,134,"TakeSample") Error retrieving performance data from the Paging File performance object: <80070005> 
(55CE4D7C.004A-114:knt76agt.cpp,259,"TakeSample") Error retrieving performance data from the Network Interface performance object: <80070005> 
(55CE4D8B.0000-114:knt62agt.cpp,134,"TakeSample") Error retrieving performance data from the Server performance object: <80070005> 

*****


CAUSE
These errors point to real-time data not being collected. This in turn does not collect historical data either.


ENVIRONMENT
ITM NT OS agent: 6.23 or higher



DIAGNOSING THE PROBLEM
1) There will be no historical data unless we collect relevant real time data. 


2) Check the performance counters on the server in question. 
The performance counters to retrieve information for several attributes: 
https://ibm.biz/Bd4L3r [https://ibm.biz/Bd4L3r]

So make sure these are actually returning valid data. If they are not, it is important they need to be fixed for the NT agent to pull the data. 

3) To check the counters click Start > In the search field enter perfmon 

[$362F48D6BD62D171.jpg] [/support/docview.wss?uid=swg21964889&amp;aid=1] 
4) Hit the "+" sign to add counters [$20C348A01ABF203A.jpg] [/support/docview.wss?uid=swg21964889&aid=2] [/support/docview.wss?uid=swg21964889&aid=2] 
NOTE: I have added %Processor Time (Processor group) and %Disk Time (Logical Disk group). 5) Make sure you are able to add the valid counters. If you cannot add counters or get message like “No valid counters” that indicates the counters are corrupted. 
RESOLVING THE PROBLEM
Run lodctr /R in command prompt. If this does not fix the issue, work with Microsoft to fix the counters. Once the counters are available and working Windows OS agent will be able to pull in the required data. 

Here is a Microsoft link which helps you fix counters manually on a Windows 2008 server.
https://support.microsoft.com/en-us/kb/2554336 [https://support.microsoft.com/en-us/kb/2554336]

 


Cross reference information Segment Product Component Platform Version Edition Systems and Asset Management IBM Monitoring