Title: IBM PJ33456: ALL THE IDM OC CLIENT STATIONS CAN NOT VIEWING PDF DOCS AFTER AP PLING THE IDM 4.0 SP2 - United States

Text:
 SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  ***PLEASE PROVIDE THE FOLLOWING INFORMATION
   THIS FIELD IS REQUIRED.***
   Description of Problem (full details)
   All the IDM OC client stations can not open PDF docs after
   appling the IDM 4.0 SP2.
   Before they apply SP2, there is no problem open the PDF docs.
   We suppose this is a problem that comes with changing the
   ASP.NET 1.1 to ASP.NET 2.0.
   Server: Windows 2003 SP1/SQL 2005/CS 5.5
   Web Server: Windows 2003 server SP1 R2 standard edition/IDM
   WS/OC 4.0.2
   Client: Windows XP SP2/IE/Adobe Reader 7.0.8
   When the client station disable the "view in browser" in
   Adobe preferrence, some of the client stations can download
   the PDF and view it but some still can not.
   Regarding the error they received while opening Pdf is not a
   static one..
   sometime they don't even get any error or will get something
   like cannot open pdf.
   The errors in event logs from the IDM WS/OC server are as
   follows:
   Event Type: Warning
   Event Source: ASP.NET 2.0.50727.0
   Event Category: Web Event
   Event ID: 1309
   Date:  16/01/2008
   Time:  1:22:52 PM
   User:  N/A
   Computer: ADELN050
   Description:
   Event code: 3005  Event message: An unhandled exception has
   occurred.  Event time: 16/01/2008 1:22:52 PM  Event time (UTC):
   16/01/2008 2:52:52 AM  Event ID:
   4011a1f812a44f1581f9dba6b5ee007d  Event sequence: 2793 Event
   occurrence: 118  Event detail code: 0  Application
   information:   Application domain:
   /LM/W3SVC/1/ROOT/DMSOC-3-128449113685657086  Trust level:
   Full   Application Virtual Path: /DMSOC Application
   Path: d:\apps\FileNet\IDM\Web\FNOpenClient\  Machine name:
   ADELN050    Process information:      Process ID: 820
   Process name: w3wp.exe     Account name: NT AUTHORITY\SYSTEM
    Exception information:      Exception type:
   HttpUnhandledException     Exception message: Exception of
   type 'System.Web.HttpUnhandledException' was thrown. Request
   information:   Request URL:
   http://dmsweb.originenergy.com.au/dmsoc/FnDocContent.aspx?Libra
   ry=DMSPCS2^ENEKINGN86&Id=003671605&ObjType=2&Op=Open [http://dmsweb.originenergy.com.au/dmsoc/FnDocContent.aspx?Library=DMSPCS2^ENEKINGN86&Id=003671605&ObjType=2&Op=Open]
   Request path: /dmsoc/FnDocContent.aspx     User host address:
   10.132.113.71    User: ORIGINENERGY\ClarkS1    Is
   authenticated: True  Authentication Type: Negotiate
   Thread account name: NT AUTHORITY\SYSTEM    Thread information:
        Thread ID: 1      Thread account name: NT AUTHORITY\SYSTEM
        Is impersonating: True  Stack trace:  at
   System.Web.UI.Page.HandleError(Exception e)
      at System.Web.UI.Page.ProcessRequestMain(Boolean
   includeStagesBeforeAsyncPoint, Boolean
   includeStagesAfterAsyncPoint)
      at System.Web.UI.Page.ProcessRequest(Boolean
   includeStagesBeforeAsyncPoint, Boolean
   includeStagesAfterAsyncPoint)
      at System.Web.UI.Page.ProcessRequest()
      at
   System.Web.Util.AspCompatApplicationStep.System.Web.HttpApplica
   tion.IExecutionStep.Execute()
      at System.Web.HttpApplication.ExecuteStep(IExecutionStep
   step, Boolean& completedSynchronously)
       Custom event details:
   For more information, see Help and Support Center at
   http://go.microsoft.com/fwlink/events.asp. [http://go.microsoft.com/fwlink/events.asp.]
   Event Type: Error
   Event Source: IdmWSXLog
   Event Category: None
   Event ID: 0
   Date:  16/01/2008
   Time:  1:37:00 PM
   User:  N/A
   Computer: ADELN050
   Description:
   Url /dmsoc/FnDocContent.aspx Error: System.Web.HttpException:
   Exception of type 'System.Web.HttpException' was thrown. --->
   System.Web.HttpUnhandledException: Exception of type
   'System.Web.HttpUnhandledException' was thrown. --->
   System.IO.FileNotFoundException: Could not find file
   'd:\apps\FileNet\IDM\Web\FNOpenClient\Microsoft.Win32.SafeHandl
   es.SafeFileHandle'.
   File name:
   'd:\apps\FileNet\IDM\Web\FNOpenClient\Microsoft.Win32.SafeHandl
   es.SafeFileHandle'
      at System.IO.__Error.WinIOError(Int32 errorCode, String
   maybeFullPath)
      at System.IO.FileStream.Init(String path, FileMode mode,
   FileAccess access, Int32 rights, Boolean useRights,
   FileShare share, Int32 bufferSize, FileOptions options,
   SECURITY_ATTRIBUTES secAttrs, String msgPath, Boolean
   bFromProxy)
      at System.IO.FileStream..ctor(String path, FileMode mode,
   FileAccess access, FileShare share)
      at System.Web.HttpResponse.ValidateFileRange(String
   filename, Int64 offset, Int64 length)
      at System.Web.HttpResponse.WriteFile(String filename, Int64
   offset, Int64 size)
      at IdmWSX.FnDocContent.Page_Load(Object sender, EventArgs
   e)
      at System.Web.UI.Control.OnLoad(EventArgs e)
      at System.Web.UI.Control.LoadRecursive()
      at System.Web.UI.Page.ProcessRequestMain(Boolean
   includeStagesBeforeAsyncPoint, Boolean
   includeStagesAfterAsyncPoint)
      --- End of inner exception stack trace ---
      at System.Web.UI.Page.HandleError(Exception e)
      at System.Web.UI.Page.ProcessRequestMain(Boolean
   includeStagesBeforeAsyncPoint, Boolean
   includeStagesAfterAsyncPoint)
      at System.Web.UI.Page.ProcessRequest(Boolean
   includeStagesBeforeAsyncPoint, Boolean
   includeStagesAfterAsyncPoint)
      at System.Web.UI.Page.ProcessRequest()
      at
   System.Web.Util.AspCompatApplicationStep.System.Web.HttpApplica
   tion.IExecutionStep.Execute()
      at System.Web.HttpApplication.ExecuteStep(IExecutionStep
   step, Boolean& completedSynchronously)
      --- End of inner exception stack trace ---
      at System.Web.HttpAsyncResult.End()
      at
   System.Web.UI.Page.AspCompatEndProcessRequest(IAsyncResult
   result)
      at ASP.fndoccontent_aspx.EndProcessRequest(IAsyncResult ar)
      at
   System.Web.HttpApplication.CallHandlerExecutionStep.OnAsyncHand
   lerCompletion(IAsyncResult ar)
   For more information, see Help and Support Center at
   http://go.microsoft.com/fwlink/events.asp. [http://go.microsoft.com/fwlink/events.asp.]
   
   How long has the problem been occurring (recent changes)? :
   After apply SP2 of IDM 4.0.
   Does this occur on more than one station / server? :
   All the stations from the same server.
   Is there a workaround? :
   Yes, but not for all the client stations. Disable the "view
   in browser" in Adobe preferrence, some of the client stations
   can download the PDF and view it but some still can not.
   What is the impact to the customer/system? :
   Some client can not dwonload and view the PDF docs while the
   other who can dwonload but feel not convenient to directly open
   and view them.
   Can the problem be replicated on an internal system?  Y or N
   By Who (L3, Support, etc..)
   Y. Not all the stations can open and view the PDF. By Support.
   Steps to Reproduce:
   1 Apply SP2 and configured IDM WS/OC as reqired.
   2 Log on CS thru OC client station
   3 click directly on a PDF doc to open it
   Actual Results:
   Some stations can not open, some stations can.
   Expected Results:
   All the stations can open and view the PDF by directly click on
   the PDF doc on the web page.
   Are there any similar or related Defects? If Y provide ECMDB #s
   N
   What logs were collected and where are they located?
   Event logs. No wal logs generated.
   Configuration/Environment :
   Server OS :Windows 2003 server SP1 R2 standard edition
   Client OS :Windows XP SP2
   Database :SQL 2005
   Network:TCP/IP
   App Server :
   Browser :IE
   Note if non US Language:
   Other Product Component Versions:
   Non Web Environment  Y or N
   Y
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  After applying OpenClient-4.0.2ALL THE IDM OC CLIENT STATIONS CA
   
   
    
   
   

PROBLEM CONCLUSION
 *  OpenClient-4.0.2-002 will contain the fix.
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PJ33456
   
   
 * REPORTED COMPONENT NAME
   WEB SERVICES
   
   
 * REPORTED COMPONENT ID
   5724S0300
   
   
 * REPORTED RELEASE
   402
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2008-04-22
   
   
 * CLOSED DATE
   2009-01-23
   
   
 * LAST MODIFIED DATE
   2009-01-23
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WEB SERVICES
   
   
 * FIXED COMPONENT ID
   5724S0300
   
   

APPLICABLE COMPONENT LEVELS
 * R402 PSY
   UP