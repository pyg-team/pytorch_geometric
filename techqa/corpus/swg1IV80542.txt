Title: IBM IV80542: LINUX OS AGENT MAY CRASH WHILE COLLECTING METRICS FOR THE DISK GROUP. - United States

Text:
  FIXES ARE AVAILABLE
IBM Tivoli Monitoring: Linux(R) OS Agent 6.2.3.4-TIV-ITM_LINUX-IF0001 [http://www-01.ibm.com/support/docview.wss?uid=swg24041682]
IBM Tivoli Monitoring: Linux(R) OS Agent 6.3.0.5-TIV-ITM_LINUX-IF0003 [http://www-01.ibm.com/support/docview.wss?uid=swg24041924]
IBM Tivoli Monitoring: Linux(R) OS Agent 6.3.0.6-TIV-ITM_LINUX-IF0001 [http://www-01.ibm.com/support/docview.wss?uid=swg24042075]
IBM Tivoli Monitoring: Linux(R) OS Agent 6.2.3.3-TIV-ITM_LINUX-IF0007 [http://www-01.ibm.com/support/docview.wss?uid=swg24042858]
IBM Tivoli Monitoring 6.3.0 Fix Pack 7 (6.3.0-TIV-ITM-FP0007) [http://www-01.ibm.com/support/docview.wss?uid=swg24041633]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  Random crashes may occur in the Linux OS Agent while collecting
   metrics
   Affected Platforms / Versions:
    This issue affects all the LINUX OS agent versions since 6.23
   FP1 and
    it does not depend on the Linux version or architecture.
   
   Diagnostics:
    RAS1 logs at ERROR level show a sequence like this before
   ending:
   
   filestats.cpp,314,"executeStatfsInSeparateThread")
     WARNING: The statfs timeout expired!
   filestats.cpp,315,"executeStatfsInSeparateThread")
     WARNING: The mounted file system "/example/file/system is
   probably unreachable
   filestats.cpp,123,"GetFileStats") statfs64 timed out for
   /example/file/system
   .
   With more detailed RAS1 logging enabled, RAS logs will end with
   the thread
   for "exec_statfs":
   filestats.cpp,180,"exec_statfs") statfs64 executed successfully
   for "/example/file/system"
   filestats.cpp,204,"exec_statfs") Exit: 0x0
   .
   The traceback of the coring thread is variable as this issue is
   the result of
   memory corruption when the call to statfs64() returns and the
   "exec_statfs"
   thread exits, where the calling thread has previously timed out.
   .
   Initial Impact:
    High - monitoring agent crashes.
   .
   Additional Keywords:
    KLZDISK
    core
    dump
    sigsegv
    klzagent
   
   Local Fix:
    Increase KBB_NFS_TIMEOUT to prevent timeout of statfs64
   
   
    
   
   

LOCAL FIX
 *  Increase KBB_NFS_TIMEOUT setting to larger value than the
   statfs64 call takes to return.  Set in lz.ini and value is
   specified in seconds.
   
   
    
   
   

PROBLEM SUMMARY
 *  Monitoring Agent for Linux OS core dumps while monitoring disks.
   
   
   The Monitoring Agent for Linux OS can randomly crash during Disk
   attribute group data collection.  This is due to a memory
   corruption caused by a timing condition between two agent
   internal threads.  This condition may occur when one or more
   filesystems do not respond within the 2 seconds default timeout
   for the statfs64 system call.
   
   
    
   
   

PROBLEM CONCLUSION
 *  Code was updated to avoid the memory corruption.
   
   The fix for this APAR will be contained in the following
   maintenance packages:
   
   | FixPack    | 6.3.0-TIV-ITM-FP0007
   | InterimFix | 6.2.3.4-TIV-ITM_LINUX-IF0001
   | InterimFix | 6.3.0.5-TIV-ITM_LINUX-IF0003
   | interimFix | 6.3.0.6-TIV-ITM_LINUX-IF0001
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IV80542
   
   
 * REPORTED COMPONENT NAME
   ITM AGENT LINUX
   
   
 * REPORTED COMPONENT ID
   5724C04LN
   
   
 * REPORTED RELEASE
   623
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt / Xsystem
   
   
 * SUBMITTED DATE
   2016-01-19
   
   
 * CLOSED DATE
   2016-02-15
   
   
 * LAST MODIFIED DATE
   2017-01-06
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
    IV80830 [http://www-01.ibm.com/support/docview.wss?uid=swg1IV80830]
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   ITM AGENT LINUX
   
   
 * FIXED COMPONENT ID
   5724C04LN
   
   

APPLICABLE COMPONENT LEVELS
 * R623 PSY
   UP
   
   
 * R630 PSY
   UP
   
   
 * R610 PSN
   UP
   
   
 * R620 PSN
   UP
   
   
 * R621 PSN
   UP
   
   
 * R622 PSN
   UP