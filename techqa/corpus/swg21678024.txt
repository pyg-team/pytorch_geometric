Title: IBM Update of an Oracle table fails with OCIStmtExecute errcode=12899 - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 When executing an insert or update operation on a table in a Unicode Oracle instance containing a 'CHAR' column with IBM WebSphere Transformation Extender (WTX), the following error may be observed:



Error returned by OCIStmtExecute, errcode=12899

ORA-12899: value too large for column "SUPPORT"."TEST6"."COL2" (actual: 4, maximum: 1) 

SYMPTOM
The insert or update operation fails. The following error will be seen in an adapter trace:

Error returned by OCIStmtExecute, errcode=12899
ORA-12899: value too large for column "SUPPORT"."TEST6"."COL2" (actual: 4, maximum: 1)


CAUSE
This issue is due to the way the WTX database adapter handles the update of 'CHAR' columns. By default, the 'CHAR' columns are padded with spaces to their exact byte size. For Oracle databases with a native encoding, this does not pose any issues.

However, for Oracle databases that store data in a multi-byte UTF8 encoding (e.g. NLS_CHARACTERSET = AL32UTF8), a 'CHAR' column will have multiple bytes for each character defined. So the WTX database adapter would fill any remaining bytes with a pad (normally a space, ' ') character. 

When using a type tree encoding of UTF8-32, then all bytes are filled automatically, which in turn prevents any further padding. However, when using a native type tree encoding, not all the bytes are filled, which in turn triggers the WTX database adapter to pad the 'CHAR' column with spaces, which in turn triggers the Oracle error message of too many characters being provided for the column (e.g. Error returned by OCIStmtExecute, errcode=12899 ORA-12899: value too large for column).

To disable this padding functionality, the following environment variable can be set:

TX_DB_PAD_CHAR=0

ENVIRONMENT
All WTX execution environments accessing an Oracle instance with NLS_CHARACTERSET = AL32UTF8

DIAGNOSING THE PROBLEM
Activate the database trace with the additional adapter command -T, and view the adapter trace, which will contain:

Error returned by OCIStmtExecute, errcode=12899
ORA-12899: value too large for column "SUPPORT"."TEST6"."COL2" (actual: 4, maximum: 1)

RESOLVING THE PROBLEM
To disable the WTX default column padding functionality, the following environment variable can be set:

TX_DB_PAD_CHAR=0