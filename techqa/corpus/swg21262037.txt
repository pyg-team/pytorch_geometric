Title: IBM Users cannot find records when querying the Description field. - United States

Text:
qbe; list screen; text indexes; oracle text; TPAEORACLE TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Users cannot find records when they query on words in the description. They can find the records when they query using fields other than Description. This document applies to Oracle databases only. 

RESOLVING THE PROBLEM
Maximo creates Oracle Text indexes on each table's DESCRIPTION column so that users can quickly and efficiently search for records containing specific words in the description. When records are created or updated, Oracle Text indexes are not automatically updated by the database. Instead, a process must be run to update the indexes for each table. The Maximo installation program (MAXINST) creates a stored procedure named MAXIMO_TS_JOB to perform this update on all tables. It also creates a second stored procedure named MAXIMO_TS_JOB_CALL that submits MAXIMO_TS_JOB as an Oracle batch job to run every five minutes.
Note: If you are running Maximo 6.0.3 or higher on Oracle 10g, there has been a change to use DBMS_SCHEDULER instead of DBMS_JOB to control the execution of the index synchronization procedure. The Maximo schema must be given the CREATE JOB privilege in order to use DBMS_SCHEDULE. This is explained in the Maximo 6.0.3 Release Notes. 

 

If users are complaining that they cannot find records when they query with values in the description field of an application, check the following: 

 

 1. Ensure that the users are not using punctuation marks in their query strings. Oracle Text indexes do not index punctuation. 
 2. Ask them to check again after waiting five minutes, or ask them to query using a key value such as the Asset or Workorder number instead of the description. If the records are found when querying on a description, then the Oracle Text index update is working normally. It takes around five minutes for the Oracle Text indexes to get updated. Shortening this interval is not advisable as it would increase the load on the database. Ask the users to be patient, or to query using key values it they need to go back to a record that they just created. 
 3. If the records are not found when querying on a description, but can be found when querying on a key value, then the synchronization job may not be running. If the above does not seem to be working, run the following select from SQLPLUS logged in as MAXIMO:  *  
       select object_name from user_objects where object_type = 'PROCEDURE';
       
       OBJECT_NAME
       --------------------------------------------------------------------------------
       MAXIMO_GATHER_TABLE_STATS
       MAXIMO_TS_JOB
       MAXIMO_TS_JOB_CALL
       
    
    

(MAXIMO_GATHER_TABLE_STATS is the procedure that is executed to update statistics on tables and indexes from the Database Configure application.)  

If you do not see the MAXIMO_TS_JOB procedure, you should run the following script to create it: 

 

 *   * 
    * 
    * 
    * 
    * 
    * 
    * 
    * 
    * 
    * 
    * 
    * 
    * 
    * 
    * 
    * 
    * 
   
   

If you do not see the MAXIMO_TS_JOB_CALL procedure, you should run one of the following scripts to recreate it:  

On Oracle 9i: 

 *   * 
    * 
    * 
    * 
    * 
    * 
    * 
    * 
    * 
    * 
    * 
    * 
    * 
    * 
   
   


On Oracle 10:  *   * 
    * CREATE OR REPLACE PROCEDURE maximo_ts_job_call AS
    * 
    * BEGIN 
    * 
    * dbms_scheduler.create_job( 
    * 
    * job_name => 'MAXIMOTSSYNC', 
    * 
    * job_type => 'STORED_PROCEDURE', 
    * 
    * job_action => 'maximo_ts_job', 
    * 
    * start_date => SYSDATE, 
    * 
    * repeat_interval => 'SYSDATE + 5/1440', 
    * 
    * enabled => TRUE); 
    * 
    * END;
    * 
    * / 
   
   



Run the following to submit the job to run every five minutes (as indicated by the SYSDATE + 5/1440 above): 

 *   * 
   
   

Then test after a five minute wait by creating a new record with a unique value in the description and searching for it. If it still does not work there may not be any job queues defined. You can check this by logging in as SYSTEM in SQLPLUS and executing: 

 

 *   * 
   
   

If the result is a value of 0, then run the following to create a couple of job queue processes: 

 

 *   * 
    * 
   
   

Then connect as MAXIMO again and resubmit the batch job:  

 *   * 
   
   

 




 



Cross reference information Segment Product Component Platform Version Edition Systems and Asset Management Tivoli Asset Management for IT All Systems and Asset Management Maximo Asset Management Essentials All 
HISTORICAL NUMBER
 M04648 

PRODUCT ALIAS/SYNONYM
 MAXIMO