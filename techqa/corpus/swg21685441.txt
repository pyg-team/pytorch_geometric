Title: IBM No data visible in Web Sites workspace for ITCAM for IIS (Q7) Agent - United States

Text:
5724C0FWATR; 5742C0FWA; 5724B97ISTR; 5724B97IS TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 After successfully installing and configuring the ITCAM agent for Microsoft IIS (q7), no data appears for IIS websites and no alerts occur when the web server is stopped. Similar issue may also occur for ITCAM agent for Microsoft .NET Framework (qf). 

SYMPTOM
ITCAM agent for IIS agent 

 Agent shows no data for Web Sites running on the IIS Server in TEP.

ITCAM agent for .NET (qf)
Following symptoms may occur:
1) The Windows Application event log shows following event, and some data :
Faulting application name: kqfclient.exe, version: 0.0.0.0, time stamp: 0x52ce696f 
Faulting module name: kqfclient.exe, version: 0.0.0.0, time stamp: 0x52ce696f 
...
Faulting application path: C:\PROGRA~2\ibm\ITM\TMAITM~1\kqfclient.exe 

2) No data is displayed in some workspaces, such as Web Sites view of Web Server workspace.


CAUSE
The required IIS role services and the IIS v6.0 Management Compatibility pack are not installed. 


RESOLVING THE PROBLEM
To resolve this problem, install IIS 6.0 management compatibility pack on your Windows Server. 


Note the following:
1) The symptom, cause and the remedial action mentioned in this technote applies to both .NET Framework agent and the ITCAM for IIS agent.
2) Even if you have IIS 7.0 - you should install the IIS 6.0 Management Compatibility Pack. This is not a part of IIS 6.0, but instead is a compatibility pack that is needed for higher IIS versions (IIS 7, 7.5, 8, 8.5). This option is found under the role services for IIS Web server.

Detailed instructions are as follows:

(i) Ensure the following IIS Role Services are installed:
-------------------------------------------------------------------------------
IIS 6 Management Compatibility
IIS 6 Metabase Compatibility
IIS 6 WMI Compatibility
IIS 6 Scripting Tools
IIS 6 Management Console

[/support/docview.wss?uid=swg21685441&aid=1] [/support/docview.wss?uid=swg21685441&aid=1]

(ii) Ensure the IIS v6.0 Management Compatibility pack is installed:
---------------------------------------------------------------------------------------------------
1. On the Master or Replica host, open the Server Manager and select the Roles option. 
Click the Add Roles button.
The first page of the Add Roles Wizard appears.

2. Click Next. The Select Server Roles window appears.

3. Select the Web Server (IIS) check box, and then click Next.
A pop-up message appears, asking you whether to add features required for Web Server (IIS).

4. Click Add Required Features.
The Select Server Roles window appears.

5. Click Next.
The Web Server (IIS) window appears.

6. Click Next.
The Select Role Service window appears.

7. On the Role Services list, select the IIS 6 Management Capability check box.

8. Click Next, and follow the Wizard instructions until the completion of the installation.

Restart the agent.