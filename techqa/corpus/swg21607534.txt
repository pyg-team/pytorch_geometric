Title: IBM Use of AMQICLEN with WebSphere MQ on IBM i - United States

Text:
mqminfo mq400l2 amqiclen 5724H7206 5724H726 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 How and when to use AMQICLEN for WebSphere MQ on IBM i. 


RESOLVING THE PROBLEM
 

When the queue manager ends abnormally, there are some rare cases when residual IPC resources will prevent queue manager restart. The AMQICLEN utility may be used to clean up these resources when ENDMQM MQMNAME(*ALL) OPTION(*IMMED) ENDCCTJOB(*YES) RCDMQMIMG(*NO) TIMEOUT(15) does not.

This utility must be run by a user with *ALLOBJ or QMQMADM group authority.

Usage: CALL QMQM/AMQICLEN {-c | -x} -c = check -x = destroy 

[-m <qmgr>] -m = queue manager 
[-p <prefix>] qmgrs directory Prefix (/qibm/userdata/mqm) 
[-q] queue manager subpool 
[-i] IPCC subpool 
[-o] persistent queue manager subpool 
[-t] trace control 
[-s] subpools lock 
[-c] check only 
[-F] Force (deleted active segments) 
[-v] verbose 
[-h] headings 
[-d] display remaining resources


The options in detail are:

-c: Check IPC only, do not remove 

-x: Remove IPC. Only IPC owned by qmqm is removed. 

-m QMGR_NAME: Check/Remove IPC on queue manager QMGR_NAME 

-s: Check/Remove IPC in the system subpool (.../qmgrs/&SYSTEM) 

-p prefix: Search for queue manager data in directory prefix (qibm/userdata/mqm) 

-q: Check/Remove IPC in qmgr subpool only ( .../qmgrs/QMGR_NAME) 

-i: Check/Remove IPC in IPCC subpool only ( .../qmgrs/QMGR_NAME/&ipcc) 

-o: Check/Remove IPC in qmpersist subpool only (.../qmgrs/QMGR_NAME/&qmpersist)

-t: Trace control shm/sem, from /qibm/userdata/mqm/sockets 

-F: Force removal. Normal operation is not to remove IPC which is in use. This is determined by checking the processes using a semaphore, or the number of processes attached to a shared memory segment. This flag bypasses these checks 

-v: Where appropriate, print output showing the progress of the utility 

-h: Print headings in the output 

-d: Run the commands ipcs -m and ipcs -s 


Note: 
1. The -c | -x options are mutually exclusive; one or the other must be selected.

2. If a queue manager name is not explicitly specified, all queue managers will
be checked or cleared.


Examples:

CALL PGM(QMQM/AMQICLEN) PARM('-v' '-x' '-F')

CALL PGM(QMQM/AMQICLEN) PARM('-v' '-x' '-F' '-m COMMON')


 

PRODUCT ALIAS/SYNONYM
 WMQ MQ