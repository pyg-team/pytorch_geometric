Title: IBM LO54472: WHY DOES NOTESDATETIME REPRESENT THE DIFFERENT FORMAT BETWEEN NOTES CLIENT R5 AND R7? - United States

Text:
 SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS FIXED IF NEXT.
    
   
   

ERROR DESCRIPTION
 *  Why does NotesDateTime represent the different format between
   Notes Client R5 and R7?
   
   This occurs on Windows XP zh_CN and zh_TW version.
   
   Sub Click(Source As Button)
   
    Dim dateTime As New NotesDateTime("")
    Call dateTime .SetNow()
    Msgbox(dateTime.zoneTime)
   
   End Sub
   
   This script creates a new NotesDateTime object with the default
   date, and then resets it to the current date and time. For
   example, if the SetNow method executes at 10:21:04 AM on August
   31, 2010, then dateTime represents 2010/08/31 10:21:04 AM ZE8 in
   Notes R5. The dateTime represents 2010/08/31 ?? 10:21:04 ZE8
   in Notes R7 and R8. This change causes our application running
   with error, "Type mismatch in method CoerStrToNum: STRING found,
   DOUBLE expected"
   
   Sub Click(Source As Button)
   
    Dim s As New NotesSession
    Dim dateTime As New NotesDateTime("")
    Dim time1 As NotesDateTime, time2 As NotesDateTime
    Dim freeTimes() As String, dispTimes() As String
    Dim zPos As Integer, zLen As Integer
    Dim zoneAbbrev As String
    Dim Intl As NotesInternational
    Set Intl = s.International
    Set time1 = s.CreateDateTime("")
    Set time2 = s.CreateDateTime("")
    Call dateTime .SetNow()
    Msgbox(dateTime.zoneTime)
    zPos = Instr(1,dateTime.ZoneTime, Intl.PMString)
    If zPos = 0 Then zPos = Instr(1,dateTime.ZoneTime,
   Intl.PMString)
    zLen = Len(dateTime.ZoneTime)
    zoneAbbrev = Trim(Right(dateTime.ZoneTime, ((zLen - zPos) -
   1)))
          'tmpString = source.FieldGetText("$TimesDisp" & i)
    tmpString ="?? 9:00 - ?? 5:00"
   '-----------------------------tmpString ????? ?????? &#65524;. &#65508;w&#65462;u&#65441;&#65517;&#65436;
    j = 0
    Redim Preserve freeTimes(j)
    Redim Preserve dispTimes(j)
    freeTimes(j) = TmpString
    If Instr(1, freeTimes(j), "-") > 0 Then
     time1.localTime = Left(freeTimes(j), (Instr(freeTimes(j), "-")
   - 1))
     time2.localTime = Right(freeTimes(j), (Instr(freeTimes(j),
   "-") - 1))
     dispTimes(j) = Format(Cdat(time1.TimeOnly), "hh:mm AMPM")  & "
   - " &  Format(Cdat(time2.TimeOnly), "hh:mm AMPM")
    '---?? type mis match
    End If
    Msgbox(zoneAbbrev)
   
   End Sub
   
   
    
   
   

LOCAL FIX
 *  No
   
   
    
   
   

PROBLEM SUMMARY

PROBLEM CONCLUSION

TEMPORARY FIX

COMMENTS
 *  This APAR is associated with SPR# ACHG88W68Q.
   This issue was raised against the 7x codestream. There are no
    more planned maintenance releases or fixpacks for 7x.  If this
    issue still occurs in 8.5.2, please raise for triage in that
    release.
   
   
    
   
   

APAR INFORMATION
 * APAR NUMBER
   LO54472
   
   
 * REPORTED COMPONENT NAME
   NOTES CLIENT
   
   
 * REPORTED COMPONENT ID
   5724E6255
   
   
 * REPORTED RELEASE
   703
   
   
 * STATUS
   CLOSED FIN
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2010-09-01
   
   
 * CLOSED DATE
   2010-10-01
   
   
 * LAST MODIFIED DATE
   2010-10-06
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION

APPLICABLE COMPONENT LEVELS
 * R703 PSN
   UP