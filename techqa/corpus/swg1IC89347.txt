Title: IBM IC89347: WEBSPHERE MQ JMS CLIENT IN ASF MODE THROWS MQRC_NOT_AUTHORIZED (2035) WHEN HANDLING POISON MESSAGE FOR MANAGED QUEUE - United States

Text:
  A FIX IS AVAILABLE
Fix Pack 7.1.0.3 for WebSphere MQ V7.1 [http://www-01.ibm.com/support/docview.wss?uid=swg24035405]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  An IBM WebSphere MQ JMS client in ASF mode encounters the
   following exception when attempting to handle a poison message
   from a managed queue:
   
   [9/27/12 16:33:37:341 BST] 00000024 SibMessage    W   [:]
   CWSJY0003W: JMSCC0110: An exception '
   Message :
   com.ibm.msg.client.jms.DetailedJMSSecurityException: JMSWMQ0030:
   'MQOPEN' failed for destination
   'SYSTEM.MANAGED.DURABLE.1234567890' when handling a poison
   message.
   When requeuing a poison message, 'MQOPEN' failed when called for
   the destination 'SYSTEM.MANAGED.DURABLE.1234567890'.
   Please see the linked exception for more information on the
   failures and/or warnings.
   Class : class
   com.ibm.msg.client.jms.DetailedJMSSecurityException
   Stack :
   com.ibm.msg.client.wmq.common.internal.Reason.reasonToException(
   Reason.java:516)
   :
   com.ibm.msg.client.wmq.common.internal.Reason.createException(Re
   ason.java:216)
   :
   com.ibm.msg.client.wmq.internal.WMQPoison.checkJmqiCallSuccess(W
   MQPoison.java:1372)
   :
   com.ibm.msg.client.wmq.internal.WMQPoison.access$2400(WMQPoison.
   java:79)
   :
   com.ibm.msg.client.wmq.internal.WMQPoison$DestinationAttrs.<init
   >(WMQPoison.java:1460)
   :
   com.ibm.msg.client.wmq.internal.WMQPoison$DestinationAttrs.<init
   >(WMQPoison.java:1424)
   :
   com.ibm.msg.client.wmq.internal.WMQPoison$DestinationAttrs.<init
   >(WMQPoison.java:1416)
   :
   com.ibm.msg.client.wmq.internal.WMQPoison.<init>(WMQPoison.java:
   174)
   :
   com.ibm.msg.client.wmq.internal.WMQConsumerShadow.initialisePois
   on(WMQConsumerShadow.java:1315)
   :
   com.ibm.msg.client.wmq.internal.WMQConsumerShadow.getMsg(WMQCons
   umerShadow.java:1462)
   :
   com.ibm.msg.client.wmq.internal.WMQConsumerShadow.getMsg(WMQCons
   umerShadow.java:1354)
   :
   com.ibm.msg.client.wmq.internal.WMQSyncConsumerShadow.receive(WM
   QSyncConsumerShadow.java:360)
   :
   com.ibm.msg.client.wmq.internal.WMQSession.loadMessageReference(
   WMQSession.java:1277)
   :
   com.ibm.msg.client.jms.internal.JmsSessionImpl.consume(JmsSessio
   nImpl.java:3098)
   :
   com.ibm.msg.client.jms.internal.JmsSessionImpl.run(JmsSessionImp
   l.java:2739)
   :
   com.ibm.mq.jms.MQSession.run(MQSession.java:950)
   :
   com.ibm.mq.connector.inbound.ASFWorkImpl.doDelivery(ASFWorkImpl.
   java:88)
   :
   com.ibm.mq.connector.inbound.AbstractWorkImpl.run(AbstractWorkIm
   pl.java:216)
   :
   com.ibm.ejs.j2c.work.WorkProxy.run(WorkProxy.java:399)
   :
   com.ibm.ws.util.ThreadPool$Worker.run(ThreadPool.java:1646)
   Caused by [1] --> Message : com.ibm.mq.MQException:
   JMSCMQ0001: WebSphere MQ call failed with compcode '2'
   ('MQCC_FAILED') reason '2035' ('MQRC_NOT_AUTHORIZED').
   Class : class com.ibm.mq.MQException
   Stack :
   com.ibm.msg.client.wmq.common.internal.Reason.createException(Re
   ason.java:204)
   :
   com.ibm.msg.client.wmq.internal.WMQPoison.checkJmqiCallSuccess(W
   MQPoison.java:1372)
   :
   com.ibm.msg.client.wmq.internal.WMQPoison.access$2400(WMQPoison.
   java:79)
   :
   com.ibm.msg.client.wmq.internal.WMQPoison$DestinationAttrs.<init
   >(WMQPoison.java:1460)
   :
   com.ibm.msg.client.wmq.internal.WMQPoison$DestinationAttrs.<init
   >(WMQPoison.java:1424)
   :
   com.ibm.msg.client.wmq.internal.WMQPoison$DestinationAttrs.<init
   >(WMQPoison.java:1416)
   :
   com.ibm.msg.client.wmq.internal.WMQPoison.<init>(WMQPoison.java:
   174)
   :
   com.ibm.msg.client.wmq.internal.WMQConsumerShadow.initialisePois
   on(WMQConsumerShadow.java:1315)
   :
   com.ibm.msg.client.wmq.internal.WMQConsumerShadow.getMsg(WMQCons
   umerShadow.java:1462)
   :
   com.ibm.msg.client.wmq.internal.WMQConsumerShadow.getMsg(WMQCons
   umerShadow.java:1354)
   :
   com.ibm.msg.client.wmq.internal.WMQSyncConsumerShadow.receive(WM
   QSyncConsumerShadow.java:360)
   :
   com.ibm.msg.client.wmq.internal.WMQSession.loadMessageReference(
   WMQSession.java:1277)
   :
   com.ibm.msg.client.jms.internal.JmsSessionImpl.consume(JmsSessio
   nImpl.java:3098)
   :
   com.ibm.msg.client.jms.internal.JmsSessionImpl.run(JmsSessionImp
   l.java:2739)
   :
   com.ibm.mq.jms.MQSession.run(MQSession.java:950)
   :
   com.ibm.mq.connector.inbound.ASFWorkImpl.doDelivery(ASFWorkImpl.
   java:88)
   :
   com.ibm.mq.connector.inbound.AbstractWorkImpl.run(AbstractWorkIm
   pl.java:216)
   :
   com.ibm.ejs.j2c.work.WorkProxy.run(WorkProxy.java:399)
   :
   com.ibm.ws.util.ThreadPool$Worker.run(ThreadPool.java:1646)
   ' was caught while processing a message for delivery to a
   message driven bean.
   
   
    
   
   

LOCAL FIX
 *  To work around this issue the 'INQ' authority must be granted to
   the user attempting to access the reported queue, in this
   example it would be SYSTEM.MANAGED.DURABLE.1234567890.
   
   
    
   
   

PROBLEM SUMMARY
 *  ****************************************************************
   USERS AFFECTED:
   All users of the v7.1 or v7.5 WebSphere MQ classes for JMS
   client in ASF mode who create durable subscriptions with managed
   queues.
   
   Platforms affected:
   All Distributed (iSeries, all Unix and Windows) +Java
   ****************************************************************
   PROBLEM SUMMARY:
   Because the durable subscription was backed by a managed queue,
   the internal representation within the WebSphere MQ classes for
   JMS client was as a queue. As a result of this an MQOPEN was
   attempted against the managed queue during poison message
   handling with the INQ option. This should not occur for
   subscriptions.
   
   
    
   
   

PROBLEM CONCLUSION
 *  The code has been altered to ensure that a managed queue is not
   treated as a local queue when handling poison messages, instead
   the durable subscription is still treated as a subscription.
   
   ---------------------------------------------------------------
   The fix is targeted for delivery in the following PTFs:
   
                      v7.1
   Platform           Fix Pack 7.1.0.3
   --------           --------------------
   Windows            7.1.0.3
   AIX                7.1.0.3
   HP-UX (Itanium)    7.1.0.3
   Solaris (SPARC)    7.1.0.3
   Solaris (x86-64)   7.1.0.3
   iSeries            7.1.0.3
   Linux (x86)        7.1.0.3
   Linux (x86-64)     7.1.0.3
   Linux (zSeries)    7.1.0.3
   Linux (Power)      7.1.0.3
   
   Platform           v7.5
   --------           --------------------
   Multiplatforms     7.5.0.1
   
   The latest available maintenance can be obtained from
   'WebSphere MQ Recommended Fixes'
   http://www-1.ibm.com/support/docview.wss?rs=171&uid=swg27006037 [http://www-1.ibm.com/support/docview.wss?rs=171&uid=swg27006037]
   
   If the maintenance level is not yet available information on
   its planned availability can be found in 'WebSphere MQ
   Planned Maintenance Release Dates'
   http://www-1.ibm.com/support/docview.wss?rs=171&uid=swg27006309 [http://www-1.ibm.com/support/docview.wss?rs=171&uid=swg27006309]
   ---------------------------------------------------------------
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IC89347
   
   
 * REPORTED COMPONENT NAME
   WMQ WINDOWS V7
   
   
 * REPORTED COMPONENT ID
   5724H7220
   
   
 * REPORTED RELEASE
   710
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2013-01-03
   
   
 * CLOSED DATE
   2013-01-07
   
   
 * LAST MODIFIED DATE
   2013-01-07
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WMQ WINDOWS V7
   
   
 * FIXED COMPONENT ID
   5724H7220
   
   

APPLICABLE COMPONENT LEVELS
 * R710 PSY
   UP