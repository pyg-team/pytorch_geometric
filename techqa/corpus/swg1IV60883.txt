Title: IBM IV60883: LONG WORKLOG QUERIES WITH RELATED RECORDS, WORKLOG QUERIES FOR INCIDENTS TAKE UP TO 2 MINUTES TO COMPLETE - United States

Text:
 
APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  Issue with Long Worklog Queries with Related Records
   
   
   There are several instances where Worklog queries for Incidents
   take up to 2 minutes to complete.  This appears to be because
   of a large amount of related records, a large data set from
   Work logs, and especially from a very long SQL statemernt used
   to grab the records.
   
   Please see attached file 'LongWorklogQueries.log'.
   
   UI delays of 2 minutes are unacceptable to our end users.
   
   Global Incident IM1023929 has 4,799 child Incidents (Related to
   Global).  Simply opening IM1023929 for the first time can take
   several minutes.
   
   
   Details as per client :
   
   As promised, attached are two examples of generated SQL which
   may be candidates for refactoring.
   
   IM1023929 is a Global Incident with 4,799 child Incidents
   (Related to Global).
   
   The SQL is nearly 500,000 characters long, significantly slows
   down the UI (it takes a significant amount of time to open
   IM1023929), and takes over 2 minutes to execute.
   
   The attached file LongWorklogQueriesIM1023929.txt shows over
   9,500 SQL fragments joined by OR with 4,800 of these fragments
   being the repeated fragment [recordkey= 'IM1023929'  and class=
   'INCIDENT'].
   
   To the best of my knowledge, this SQL is OOTB.
   
   I have seen more complex examples like the above running against
   RELATEDRECORDS (which could also benefit from refactoring), but
   I figured this was a good place to start.
   
   You will find similar SQL for IM1031356, which has 2,232 Child
   Incidents.
   
   
    
   
   

LOCAL FIX
 *  n/a
   
   
    
   
   

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED:                                              *
   * All users affected                                           *
   ****************************************************************
   * PROBLEM DESCRIPTION:                                         *
   * Customer is facing performance issue when have a lot of      *
   * tickets related between them. When you have a lot of tickets *
   * related between them the maximo will try to bring all the    *
   * worklogs from each related record, this causes the           *
   * performance issue.                                           *
   ****************************************************************
   * RECOMMENDATION:                                              *
   * Apply the fixpack                                            *
   ****************************************************************
   
   
    
   
   

PROBLEM CONCLUSION
 *  This needs to be fixed at code level. The fix consist on giving
   a way to the user to configure a relationship to show the
   worklogs they want. Two properties were created one for ticket
   and one for workorder
   
   psdi.worklog.ticket.useTKrelationship
   psdi.worklog.workorder.useWOrelationship
   
   The Default value for the both is 0, with that the system will
   continue to behave exaclty how it does today. But seting this to
   1. The system will bring the worklog based on the relationship.
   One relationship were created for each object (WorkOrder and
   Ticket)
   
   CUSTOMTKWORKLOG
   CUSTOMWOWORKLOG
   
   Both controls the query done by the system to bring the worklog.
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IV60883
   
   
 * REPORTED COMPONENT NAME
   WORK & MTRL APP
   
   
 * REPORTED COMPONENT ID
   TIVOWRKMM
   
   
 * REPORTED RELEASE
   750
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt / Xsystem
   
   
 * SUBMITTED DATE
   2014-05-23
   
   
 * CLOSED DATE
   2016-02-12
   
   
 * LAST MODIFIED DATE
   2016-02-12
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

MODULES/MACROS
 *  MAXIMO
   
   
    
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WORK & MTRL APP
   
   
 * FIXED COMPONENT ID
   TIVOWRKMM
   
   

APPLICABLE COMPONENT LEVELS
 * R750 PSY
   UP