Title: IBM JazzSM upgrade to 1.1.1 fails - United States

Text:
CTGFI3007E JazzSM installation upgrade IM Installation Manager JAVA_HOME setenv.sh TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 When trying to upgrade from JazzSM 1.1.0.3 to JazzSM 1.1.1, the installer fails with error message:

CTGFI3007E: Failed in configuring Registry Services Database. 

SYMPTOM
The problem has been observed in a scenario where JazzSM is bundled with Tivoli Storage Manager, but it may occur with any product that makes use of JazzSM in case the product upgrade also changes Installation Manager version from v1.6 to v1.8. 

Error scenario.

-- Install IBM Tivoli Monitoring for Tivoli Storage Manager 7.0 
This will install Installation Manager 1.6, DB2 10.5, ITM 6.3.0.2 
and the TSM Agent 6.3.0.2 

-- Install JazzSM 1.1.0.3

-- Upgrade Tivoli Monitoring for Tivoli Storage Manager 7.1.3 
This will install Installation Manager 1.8, DB2 10.5.5, ITM 6.3.0.3 
and the TSM Agent 6.3.0.3 

-- Upgrade JazzSM to 1.1.1 

This last step will fail with the following error messages:

A problem occurred during the execution of the 
/opt/IBM/JazzSM/install/fsconfig.xml file. 
ERROR: The following error occurred while executing this line: 
/opt/IBM/JazzSM/install/frs/frs_config.xml:199: The following error 
occurred while executing this line: 
/opt/IBM/JazzSM/install/frs/frs_config.xml:243: The following error 
occurred while executing this line: 
/opt/IBM/JazzSM/install/frs/frs_config.xml:255: The following error 
occurred while executing this line: 
/opt/IBM/JazzSM/install/frs/frs_db_config.xml:110: The following error 
occurred while executing this line: 
/opt/IBM/JazzSM/install/frs/frs_db_config.xml:115: CTGFI3007E: Failed 
in configuring Registry Services Database. Check 
/opt/IBM/JazzSM/registry/logs directory for more information. 
[/opt/IBM/JazzSM/install/fsconfig.xml:200] 
A package has an issue that cannot be resolved by Installation Manager. 
Identify the package that has the issue by looking at the installation 
history. In Installation Manager, click File > Installation History. In 
console mode, enter S: View Installation History. Contact IBM customer 
support.


DIAGNOSING THE PROBLEM
JazzSM upgrade will source in this script:

/opt/IBM/JazzSM/registry/bin/setenv.sh 

It will set several environment variables, including JAVA_HOME.

JAVA_HOME=/opt/IBM/InstallationManager/eclipse/jre_6.0.0.sr9_20110208_03/jre
FRS_JDBC_CLASSPATH=/opt/IBM/JazzSM/lib/db2/db2jcc.jar:/opt/IBM/JazzSM/
lib/db2/db2jcc_license_cu.jar 
if grep -q 8.5.0.2 '/opt/IBM/WebSphere/AppServer/properties/version/WAS.product' 
; then ASM_JAR_FILE=''; else 
ASM_JAR_FILE='/opt/IBM/WebSphere/AppServer/plugins/ 
com.ibm.ws.prereq.asm.jar:'; fi 
FRS_CLASSPATH=$ASM_JAR_FILE/opt/IBM/WebSphere/AppServer/runtimes/com. 
ibm.ws.admin.client_8.5.0.jar:/opt/IBM/WebSphere/AppServer/plugins/com.ibm.ws.security.crypto.jar 

Problem occurs because JAVA_HOME is wrongly set by setenv.sh. 

Actually, the setenv.sh was right, up to the point that IM was upgraded from 1.6 to 1.8 and the Java was upgraded as well when IM was upgraded.


RESOLVING THE PROBLEM
This is a known issue with JazzSM installer, going to be fixed in the release 1.1.2 of JazzSM. 

For what concern current release, in case you experience this problem when upgrading to JazzSM 1.1.1, you can leverage on the following work around:

cd /opt/IBM/JazzSM/registry/bin
vi setenv.sh

Modify the JAVA_HOME=/opt/IBM/InstallationManager/eclipse/jre_6.0.0.sr9_20110208_03/jre

to be

JAVA_HOME=/opt/IBM/InstallationManager/eclipse/jre_7.0.0.sr6_20131213_1238/jre

Save and exit from vi, then run the upgrade again.

 

PRODUCT ALIAS/SYNONYM
 JazzSM 1.1.1