Title: IBM How to find details of Corrupted Object from the entries in db2diag.log? - United States

Text:
 TECHNOTE (FAQ)

QUESTION
 How to find details of Corrupted Object from the entries in db2diag.log? 

ANSWER
When we have corruption in the database we may received following kind of entries in db2diag.log 
These also notify object where we t where we have detected corruption in the Database.

Sample db2diag.log entry for Corruption.

2016-05-04-03.13.05.261082-360 I3442A358 LEVEL: Error 
PID : 393470 TID : 1 PROC : db2pfchr 0 
INSTANCE: db2inst1 NODE : 000 
FUNCTION: DB2 UDB, buffer pool services, sqlbReadAndReleaseBuffers,probe:13 
RETCODE : ZRC=0x86020001=-2046689279=SQLB_BADP "page is bad" 
DIA8400C A bad page was encountered. 

2016-05-04-03.13.05.264301-360 I3801A437 LEVEL: Error 
PID : 393470 TID : 1 PROC : db2pfchr 0 
INSTANCE: db2inst1 NODE : 000 
FUNCTION: DB2 UDB, buffer pool services, sqlbReadAndReleaseBuffers, 
probe:13 
DATA #1 : String, 158 bytes 
Obj={pool:3;obj:21;type:0} State=x27 Parent={3;21}, EM=1120, PP0=1152 
Page=51235 Cont=17 Offset=2848 BlkSize=15 
sqlbReadAndReleaseBuffers error: num-pages=16


Based on this information dumped in db2diag.log entry we can Identify {pool:3;obj:21;type:0} is the Object is corrupted.

e.g. Obj={pool:3;obj:21;type:0}

Pool = Tablespace ID
Obj = Object ID
Type = Type of the Object

If Type is 0 its Table Object ,If its 1 then its Index. 

We can find the Name of the Object using following query, to further backup the Definition for future reference.

db2 "select char(tabname,20), char(tabschema,20) from syscat.tables where tableid=<ObjectID> and tbspaceid=<Tablepace id>"

Obj={pool:3;obj:21;type:0}
db2 "select char(tabname,20), char(tabschema,20) from syscat.tables where tableid=21 and tbspaceid=3"

RELATED INFORMATION
 SYSCAT.TABLES catalog view [http://www.ibm.com/support/knowledgecenter/SSEPGG_10.1.0/com.ibm.db2.luw.sql.ref.doc/doc/r0001063.html?lang=en]