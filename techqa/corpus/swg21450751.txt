Title: IBM Upgrading an existing Citrix environment using an 'out of the box' Notes multi-user configuration setup - United States

Text:
Citrix; Notes multi-user; upgrade to Notes multi-user; pseudo multi-user; manually configured multi-user installation; Lotus\Notes\data TECHNOTE (TROUBLESHOOTING)

PROBLEM
You can upgrade Notes clients that have been set up in the Citrix environment as a manually configured multi-user installation to Notes 8.5.1 (or later) using a workaround to the "Lotus\Notes\data" path appended to the configured base folder. This enables you to have a data folder structure that is compatible with the previous Citrix environment. 

For example, you want to upgrade your existing Notes version on Citrix and designate a customized data path, and run the following silent install command line:

setup.exe /v"SETMULTIUSER=1 CITRIX=1 MULTIUSERBASEDIR=h:\ MULTIUSERCOMMONDIR=C:\notes" 

The "MULTIUSERBASEDIR=h:\" option is used to install the data directory in the root of drive H:\ but Notes installs the data directory as H:\Lotus\Notes\Data and not in the root of drive. By design, Notes appends the "Lotus\Notes\Data" folder path to the value specified for the MULTIUSERBASEDIR option and there is no way to disable this.


ENVIRONMENT
This scenario assumes that Notes clients have been set up in the Citrix environment as a manually configured multi-user environment using the instructions described in technote #1265898 [http://www.ibm.com/support/docview.wss?uid=swg21265898] --" Steps for installing Lotus Notes 8.0.x and 8.5 (only) on a Citrix Presentation Server (XenApp)".


RESOLVING THE PROBLEM
This addresses customers that have already been using Citrix and have their data stored in the previously configured folder, for example H:\username, and who wish to maintain this folder structure for both existing users and new users. 


1. Run an install using the configurable data option. Use command line parameters to install the Notes client with a configured data directory folder; for example H:\username, as follows:

"SETMULTIUSER=1 CITRIX=1 MULTIUSERBASEDIR=h:\!USER NAME! MULTIUSERCOMMONDIR=C:\notes" 

This causes the Notes shared files (templates, help files, icons) to be installed under C:\notes\Lotus\Notes\Data and each new user's data to be stored under H:\username\Lotus\Notes\Data. 

The Notes Binaries are installed under C:\Program Files (x86)\IBM\Lotus\Notes.


2. Create a registry key to point to the user's existing or newly created stub NOTES.INI file as follows:

HKCU\Software\Lotus\Notes\8.0\NotesIniPath = H:\username\notes.ini

This instructs the Notes setup code to use this file when setting up the Notes client for the first time. If the user already exists, Notes will use all the current data files for this user. For new users, you must create a new stub NOTES.INI with the following contents:

[Notes]
Directory=h:\newusername

Result: The existing user's data directories will be intact and new users will have the same structure under their username.

3. [Standard Installs Only]: To update the path of the .\data\workspace directory, open the C:\Program Files\IBM\Lotus\Notes\framework\rcp\rcplauncher.properties. Modify the path to the \workspace directory by updating the rcp.data parameter. 

Example: 
rcp.data=H\:/<username>

Related information
-- Technote 1447060 -- Using MULTIUSERBASEDIR with network drive destination requires an existing directory [http://www-01.ibm.com/support/docview.wss?uid=swg21447060] 
-- Technote 1422525 -- MultiUserBaseDir appends 'Lotus\Notes\Data' to customized path specified for Notes multi-user data directory [http://www-01.ibm.com/support/docview.wss?uid=swg21422525]

RELATED INFORMATION
 Wiki - Notes and Domino community posts and related doc [http://www-10.lotus.com/ldd/dominowiki.nsf/]
Information Center - Notes and Domino product documenta [http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp]