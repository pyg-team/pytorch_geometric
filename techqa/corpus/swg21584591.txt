Title: IBM EJPSB0107E: Exception occurred while retrieving the identity of the domain admin user/admingroup - United States

Text:
realm; default; EJPSB0107E; domain admin; DomainAdministratorNotFoundException TECHNOTE (TROUBLESHOOTING)

PROBLEM
WebSphere Portal fails to start because it cannot find the administrative user in the realm.

SYMPTOM
WebSphere Portal fails to start. SystemOut.log contains: 

Servlet E com.ibm.wps.engine.Servlet init EJPFD0016E: Initialization of service failed. com.ibm.wps.ac.DomainAdministratorNotFoundException: EJPSB0107E: Exception occurred while retrieving the identity of the domain admin user/admingroup uid=wpsadmin,dc=ibm,dc=com.


CAUSE
The base portal is associated with a realm that has been removed from Virtual Member Manager's (VMM) configuration. Though VMM can find the administrative user in the repository (LDAP, generally), WebSphere Portal does not consider it within the base portal's realm.


DIAGNOSING THE PROBLEM
Enable the extended tracing from the PUMA MustGather. Restart WebSphere Portal. Check to see if trace.log contains messages like: 

PumaLocatorIm > com.ibm.wps.um.PumaLocatorImpl findUserByIdentifier ENTRY uid=wpsadmin,dc=ibm,dc=com
...
RealmManager < com.ibm.wps.um.RealmManager getCurrentRealmName RETURN defaultWIMFileBasedRealm
...
ServiceProvid < com.ibm.websphere.wim.ServiceProvider WIM_API get RETURN ...
<wim:entities xsi:type="wim:PersonAccount">
<wim:identifier externalName="uid=wpsadmin,dc=ibm,dc=com"
...
RealmManager > com.ibm.wps.um.RealmManager isValidForRealm ENTRY uid=wpsadmin,dc=ibm,dc=com defaultWIMFileBasedRealm
...
RealmManager < com.ibm.wps.um.RealmManager isValidForRealm RETURN false
...
Servlet E com.ibm.wps.engine.Servlet init EJPFD0016E: Initialization of service failed. com.ibm.wps.ac.DomainAdministratorNotFoundException: EJPSB0107E: Exception occurred while retrieving the identity of the domain admin user/admingroup uid=wpsadmin,dc=ibm,dc=com.
...
Caused by: com.ibm.portal.puma.MemberNotFoundException: EJPSG0002E: Requested Member does not exist.uid=wpsadmin,dc=ibm,dc=com
...
Caused by: com.ibm.wps.um.exceptions.impl.MemberNotFoundExceptionImpl: com.ibm.portal.puma.MemberNotFoundException: EJPSG0002E: Requested Member does not exist.uid=wpsadmin,dc=ibm,dc=com/null
...
at com.ibm.wps.um.PumaLocatorImpl.findUserByIdentifier(PumaLocatorImpl.java:129)

Compare the realm in these messages with those defined in VMM's wimconfig.xml. If the realm name in the messages is not defined in VMM, apply the solution below.


RESOLVING THE PROBLEM
Ensure the administrative user is within VMM's default realm, which may necessitate a change of the defaultRealm value in VMM to match the value returned by getCurrentRealmName() in the trace. 


From wimconfig.xml: <config:realmConfiguration defaultRealm="...

Then associate the base portal with this default realm. Log into the base portal as the administrator and navigate to Virtual Portal Manager portlet. Edit the base virtual portal (named "WebSphere Portal *") and change the "User realm" value. Select the blank entry from the list of realms. Restart WebSphere Portal.

RELATED INFORMATION
 PUMA MustGather [https://www.ibm.com/support/docview.wss?uid=swg21592792]