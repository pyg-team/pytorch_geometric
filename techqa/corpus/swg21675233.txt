Title: IBM StackOverflowError When Running di-preprocess Utility - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 When running the di-preprocess utility for Solr in WebSphere Commerce it may fail with a StackOverFlowError 

CAUSE
This is caused by cyclical references in your catalog

DIAGNOSING THE PROBLEM
Review the wc-dataimport-preprocess.log and you will the following error:

0 Jun 2, 2014 4:02:20 PM com.ibm.commerce.foundation.dataimport.preprocess.DataImportPreProcessorMain handleExecutionException 

SEVERE: Exception message: CWFDIH0001: Data Import encountered a generic error. The error is null. , stack trace: com.ibm.commerce.foundation.dataimport.exception.DataImportSystemException: CWFDIH0001: Data Import encountered a generic error. The error is null. 
at com.ibm.commerce.foundation.dataimport.preprocess.DataImportPreProcessorMain.processDataConfig(DataImportPreProcessorMain.java:949)
at com.ibm.commerce.foundation.dataimport.preprocess.DataImportPreProcessorMain.execute(DataImportPreProcessorMain.java:794)
at com.ibm.commerce.foundation.dataimport.preprocess.DataImportPreProcessorMain.main(DataImportPreProcessorMain.java:289)
Caused by: java.lang.StackOverflowError
at java.text.SimpleDateFormat.initializeDefaultCentury(SimpleDateFormat.java:832)
at java.text.SimpleDateFormat.initialize(SimpleDateFormat.java:600)
at java.text.SimpleDateFormat.<init>(SimpleDateFormat.java:581)
at java.text.DateFormat.get(DateFormat.java:718)
at java.text.DateFormat.getDateInstance(DateFormat.java:493)
at java.text.MessageFormat.makeFormat(MessageFormat.java:1401)
at java.text.MessageFormat.applyPattern(MessageFormat.java:469)
at java.text.MessageFormat.<init>(MessageFormat.java:361)
at java.text.MessageFormat.format(MessageFormat.java:822)
at java.util.logging.SimpleFormatter.format(SimpleFormatter.java:46)
at java.util.logging.StreamHandler.publish(StreamHandler.java:315)
at java.util.logging.ConsoleHandler.publish(ConsoleHandler.java:77)
at java.util.logging.Logger.log(Logger.java:1131)
at java.util.logging.Logger.entering(Logger.java:803)
at com.ibm.commerce.foundation.dataimport.preprocess.CategoryParentChainDataPreProcessor$Chainer.getParentChain(CategoryParentChainDataPreProcessor.java:111)
at com.ibm.commerce.foundation.dataimport.preprocess.CategoryParentChainDataPreProcessor$Chainer.getParentChain(CategoryParentChainDataPreProcessor.java:117)
at com.ibm.commerce.foundation.dataimport.preprocess.CategoryParentChainDataPreProcessor$Chainer.getParentChain(CategoryParentChainDataPreProcessor.java:117)




RESOLVING THE PROBLEM
Finding the cyclical reference in the wc-dataimport-preprocess.log is difficult. The easiest way will be to query the database directly using the following SQL 


select * from catgrprel where catgroup_id_child=catgroup_id_parent;

Any results returned should be considered invalid and need to be removed.