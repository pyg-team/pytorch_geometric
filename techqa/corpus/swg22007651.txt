Title: IBM Resolving communication issues with Brocade Network Advisor - United States

Text:
 TECHNOTE (FAQ)

QUESTION
 How can I resolve communication errors when using Network Advisor as a CIMOM Agent with IBM Spectrum Control? 

ANSWER
Any of the following actions can fail if there are communication issues between Spectrum Control and the Network Advisor SMI Agent: 

 * Add Switch or Add Fabric 
 * Test Connection (for a previously added switch or fabric) 
 * Run Fabric Probe 
 * Performance monitoring data collection


The error messages presented in Spectrum Control depend on the specific action, but in all cases they give an indication that a connection could not be established or that no agent is available. Below are some examples of those errors. 

Errors during test connection or when adding a switch or fabric: 
BPCUI0197E A connection was not established. Make sure that the protocol, SMI-S provider host name or IP address, and port are specified correctly. 

HWN021529E An SMI-S provider has reported unexpected values: https: https://<ip_address>:5989 

Errors during fabric probe: 
HWN021537E Could not create connection to CIMOM https://<IP>:<port>.

BTAFM4306E Could not create connection to SMI-S provider https://<ip_address>:<port#> [https://10.1.115.129:5989/]. Reason: REFUSED.

BTAFM5002E The SMI agents https://<ip_address>:<port#> returned an error or can no longer contact the switches.

BTADS0102E The data can't be collected by the probe because the data collector or the storage resource that is being probed isn't available. The run ID for the probe is x, the job ID is x, the status of the process is 4, and the return code is 1 . 

All of the Network Advisor references apply to Brocade, IBM, or any other vendor who provides the software. This is a set of items to check to help you do some basic troubleshooting to identify and resolve the most common errors that occur. It does not address all scenarios where communication with Network Advisor might fail. It is assumed that you have entered the correct host name or IP address, user name, and password in Spectrum Control. 
 1. Is the Network Advisor CIMOM Server running? Start it if it is not.
    [/support/docview.wss?uid=swg22007651&aid=1] [/support/docview.wss?uid=swg22007651&aid=1]
    
 2. Does the SSL configuration for the Brocade CIMOM match what you're specifying in Spectrum Control for http/https and the port number? Make sure these are correctly specified between the applications.
    
    Brocade Network Advisor 
    [/support/docview.wss?uid=swg22007651&aid=2] [/support/docview.wss?uid=swg22007651&aid=2]
    Note: You can specify any available port number. The default port # for https is 5989 and for http it is 5988.
    
    Spectrum Control
    [/support/docview.wss?uid=swg22007651&aid=3] [/support/docview.wss?uid=swg22007651&aid=3]
    
 3. If you've enabled SSL and are using https to connect, is mutual authentication disabled in the Authentication tab?
    - Make sure the option for Enable Client Mutual Authentication is not checked and enabled.
    - Make sure the option for Enable Indication Mutual Authentication is not checked and enabled.
    
    [/support/docview.wss?uid=swg22007651&aid=4] [/support/docview.wss?uid=swg22007651&aid=4]
    Note: The CIMOM Server Authentication can be set to either value.
    
    If mutual authentication is enabled for either, the connection will fail with an SSL certificate error. 
    BPCUI0224E Cannot connect to a resource because of an SSL certificate error
    
    This might point you to a technote a to replace MD5-signed certificates [https://www-01.ibm.com/support/docview.wss?uid=swg21976237], but if you are using Network Advisor 14.0.1 or later, the certificates do not need to be replaced.
    
 4. Can you connect between the Spectrum Control server and Brocade Network Advisor server with other applications? 
    - If not, this would be a general network connectivity issue to investigate.
    
 5. Can you telnet to the Network Advisor server and port and show that the port is listening?
    telnet <ip_address> <port#>
    - If listening, it should go to a blank screen and then come back to a prompt after pressing Enter several times.
    - If the connection fails, an error like the following is seen:
    Connecting To <ip_address>...Could not open connection to the host, on port <port#> : Connect failed
    
    When failing to connect, you might also see the following error in dmSvcTrace.log:
    HWN099993E Exception (WBEMException: CIM_ERR_FAILED (Unable to connect)) during CIM call enumerateInstanceNames([interop:CIM_RegisteredProfile]) to CIMOM https://<ip_address>:5989 [https://10.1.115.129:5989/]
    
    If you can connect to the host but not to the port to see if it is listening, check the Bind Network Address in the SMIA Configuration Tool for Network Advisor. If a host name is specified there, change it to a numeric IP address and restart the Brocade Network Advisor services.
    
    [/support/docview.wss?uid=swg22007651&aid=5] [/support/docview.wss?uid=swg22007651&aid=5]
    
 6. If you are running Network Advisor on a VM, make sure you have dedicated resources for it according to the Network Advisor documentation.
    
 7. If you've checked the items above and still can't connect, you might be hitting one of a couple known defects with the Network Advisor SMI Agent. These issues are addressed with upgrades to Network Advisor.
    
    Below are examples of the underlying exceptions that are logged in Spectrum Control, typically in dmSvcTrace.log or msgTPCDevice.log. 
    WBEMException APAR Fixed in
    Network Advisor CIM_ERR_FAILED (Operation failed. Additional information: "Could not initialize class com.brocade.dcm.smia.client.provider.jms.SMIAJmsDispatcherHandler$SingletonHolder".) IT22095 [http://www.ibm.com/support/docview.wss?uid=swg1IT22095] 14.2.2 
    14.3.1 
    14.4.x CIM_ERR_ACCESS_DENIED (HTTP 401 - Unauthorized) IT22103 [http://www.ibm.com/support/docview.wss?uid=swg1IT22103] 14.2.2 +patch 
    14.4.x 


If the troubleshooting steps here haven't helped you resolve the issue, review the APAR Fix List - 5.2.x [https://www-01.ibm.com/support/docview.wss?&uid=swg21661527] and consider an upgrade to the latest Spectrum Control level (5.2.15 or higher) to address APARs for special cases or contact IBM Support for further investigation. 

Note: You can get a quick view of the SMIA configuration settings by going to the Summary tab. Provide a screenshot of this tab when contacting IBM Support about problems connecting to Network Advisor with Spectrum Control. 

[/support/docview.wss?uid=swg22007651&aid=6] [/support/docview.wss?uid=swg22007651&aid=6] 


Cross reference information Segment Product Component Platform Version Edition Storage Management IBM Spectrum Control Advanced Edition