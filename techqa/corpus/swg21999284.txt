Title: IBM FileNet Content Platform Engine 5.2.1 Database schema upgrade not processing a few of the object stores. - United States

Text:
upgrade; migration TECHNOTE (TROUBLESHOOTING)

THIS DOCUMENT APPLIES ONLY TO THE FOLLOWING LANGUAGE VERSION(S):
 English 

PROBLEM(ABSTRACT)
 FileNet Content Platform Engine 5.2.1 Database schema upgrade not processing a few of the object stores during migration upgrade from older Content Engine version. Content Engine Automatic Upgrade Status page showing the object stores as In Progress status.


SYMPTOM
 

 * Content Engine (CE) Automatic Upgrade status page showing the objectstore as In Progress status. 
 * P8_server_error.log logged warning message:
   
   201#-02-17T08:58:05.077 3F5CF3FF MCHE FNRCE0078W - WARN Exception occurred checking schema revision for objectStoreId: {9FA73ACF-7C21-46B0-8B34-425F9D1587A1}. Continuing...
   com.filenet.api.exception.EngineRuntimeException: FNRCE0078E: E_UPGRADE_REQUIRED: Object store "NameOS" has an incompatible schema revision in the database - expected="19.1.40", actual="17.1.24". This object store will be upgraded or an upgrade is already in progress.


CAUSE
Data source wasn't created same as the pre-upgrade system on the newly migrated/ upgraded system.

DIAGNOSING THE PROBLEM
Enable CE tracing for Engine, Error, Database and Asynchronous processing and seeing below messages in the P8_server_trace.log: 


201#-02-22T10:26:51.227 7A8BB69F ENG FNRCE0000D - DEBUG ObjectStoreUpgrade(NameOS) Received exception waiting for locked instance: The server cannot get the data source NameOSDSXS.

201#-02-22T10:26:51.227 3D20A184 ENG FNRCE0000D - DEBUG
ObjectStoreUpgrade(NamesOS) Upgrader task is terminating due to table lock timeout. maxUpgraderTasks=5


See below technote for instruction to enable CE tracing: http://www-01.ibm.com/support/docview.wss?rs=0&uid=swg21308282 [http://www-01.ibm.com/support/docview.wss?rs=0&uid=swg21308282]



RESOLVING THE PROBLEM
The name of the datasource was different from the pre-upgrade system. Change the name of datasources on the newly migrated upgraded system to match the name on the pre-upgrade system.

RELATED INFORMATION
 Enabling IBM FileNet Content Engine server tracing [http://www-01.ibm.com/support/docview.wss?rs=0&uid=swg21308282]