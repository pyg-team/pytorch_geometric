Title: IBM IV64051: THE OPEN FILE HANDLES OF TNSPING GROW CAUSING FALSE INACTIVE LISTERNER ALERT - United States

Text:
  FIXES ARE AVAILABLE
ITCAM Extended Agent for Oracle Database: 6.3.1.2-TIV-ITM_KRZ-IF0003 [http://www-01.ibm.com/support/docview.wss?uid=swg24042039]
ITCAM Extended Agent for Oracle Database: 6.3.1.2-TIV-ITM_KRZ-IF0004 [http://www-01.ibm.com/support/docview.wss?uid=swg24043445]
ITCAM Extended Agent for Oracle Database: 6.3.1.2-TIV-ITM_KRZ-IF0005 [http://www-01.ibm.com/support/docview.wss?uid=swg24044064]
ITCAM Extended Agent for Oracle Database: 6.3.1.2-TIV-ITM_KRZ-IF0006 [http://www-01.ibm.com/support/docview.wss?uid=swg24044606]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  Severity:   3
   
   
   Approver: Hua Ming Zhong/China/IBM
   
   Compid:   5724V09OR
   
   Release:  Extended Oracle Database agent 6.31 FP2
   
   Abstract: The open file handles of '$ORACLE_HOME/bin/tnsping'
   grow for Extended Oracle Database agent 6.31 FP2 collector
   process on Linux/Unix, which results in false alert of inactive
   listener and miss monitoring alert log.
   
   Environment: Extended Oracle Database agent 6.31 FP2
   OS: Linux & Unix
   
   Problem Description:
   When KRZ_ORACLE_HOME is conifgured, Extended Oracle Database
   agent will check whether '$ORACLE_HOME/bin/tnsping' file can be
   opened and executed for listener checking function by 5 minutes
   interval. The agent does not close the file after opening it, so
   the open file handles of '$ORACLE_HOME/bin/tnsping' for the
   agent collector process krzclient/krzstart grow until the
   configured O/S limit is reached. And the agent does not use
   '$ORACLE_HOME/bin/tnsping' file to check listener status even it
   can be opened and executed.
   
   Detailed Recreation Procedure:
   1) Configure Extended Oracle Database agent 6.31 FP2 with
   KRZ_ORACLE_HOME as value $ORACLE_HOME
   2) Start the agent, make sure user who starts the agent has
   execution access to '$ORACLE_HOME/bin/tnsping' file.
   3) The open file handles of '$ORACLE_HOME/bin/tnsping' for the
   agent collector process krzclient/krzstart grow until the
   configured O/S limit is reached.
   4) Check 'Net Service Connection' workspace 'Listeners'
   workspace view, the 'Connection Status' is inactive, 'Connection
   Error Code' is 12545.
   The agent reports false alert of inactive listener.
   5) It also affects alert log monitoring, alert log monitoring
   returns no data because the agent not able to open alert log
   file.
   
   Related Files and Output:
   Check krzclient/krzstart log file, it includes warning messages
   as the following:
   
   (krzoranet.cpp,993,"checkListenersThreadFunc") Oracle TNSPING
   File ($ORACLE_HOME/bin/tnsping) does not exist or cannot
   execute.
   (krzprop.cpp,411,"CPropFile::save") Save file
   '$CANDLEHOME/config/<hostname>_rz_<agentInstance>_runtime.proper
   ties' failed: 24 Too many open files.
   (krzlog.cpp,392,"CAlertLog::search_init") Search file
   alert_<OracleSID>.log initializaition failed, errno 24:Too many
   open files
   
   
    
   
   

LOCAL FIX
 *  na
   
   
    
   
   

PROBLEM SUMMARY
 *  When the agent instance is configured with Oracle Home, the open
   file handles of '$ORACLE_HOME/bin/tnsping' increase for the
   agent collector process on Linux/Unix. Then, it reaches the 'max
   open file' limitation. This problem occurs in Oracle Database
   Extended agent version 6.31 Fix pack2. The problem causes false
   alerts of inactive listener and inactive net service connection
   to occur. Also, it causes other issues, for example, missing
   monitoring alert log. You receive 'Too many open files' error
   messages from the collector process log file.
   
   
    
   
   

PROBLEM CONCLUSION
 *  6.3.1.2-TIV-ITM_KRZ-IF0002 includes fix of IV64051. Apply
   6.3.1.2-TIV-ITM_KRZ-IF0002 or later to resolve the problem.
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IV64051
   
   
 * REPORTED COMPONENT NAME
   ITCAM EXT AGNT
   
   
 * REPORTED COMPONENT ID
   5724V09OR
   
   
 * REPORTED RELEASE
   631
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt / Xsystem
   
   
 * SUBMITTED DATE
   2014-08-27
   
   
 * CLOSED DATE
   2014-12-25
   
   
 * LAST MODIFIED DATE
   2016-06-14
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   ITCAM EXT AGNT
   
   
 * FIXED COMPONENT ID
   5724V09OR
   
   

APPLICABLE COMPONENT LEVELS
 * R631 PSY
   UP