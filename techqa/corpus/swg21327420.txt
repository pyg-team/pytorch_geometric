Title: IBM Debugging WebSphere DataPower network connectivity with backend servers - United States

Text:
 TECHNOTE (FAQ)

QUESTION
 How do I troubleshoot DataPower SOA Appliances connectivity issues with backend servers? 

ANSWER
When troubleshooting an IBM WebSphere DataPower SOA Appliance to determine why it is not able to connect or is having intermittent connection failure with the backend, the listed firmware provides a few CLI and WebGUI commands to help in the debug process. 

Below are some of the common troubleshooting examples. These examples are using an XS40; however, the commands are valid for all models of DataPower SOA Appliances.


 1. 
 2. Start with ping from CLI  * xs40(config)# ping backenddb.domain.com
     * 
     * xs40(config)# ping 10.1.0.121
    
    
    In the above example, you can first ping by hostname and then by IP address. This helps determine if your device is able to resolve the name if entered. If ping by name fails but IP works, you may need to check DNS settings or routing to DNS server(s).
    
    If ping for both IP and name fails, ping the default gateway to ensure you can reach the gateway:
     * xs40(config)# ping 10.1.0.1 
     * 
    
    
    If this action fails, check the cables, netmask or possible the ethernet port.
    
    
 3. Test connection on a service port. 
    This is useful when you can ping the IP but the connection still fails. Below is CLI command example:
     * xs40(config)# test tcp-connection 10.1.0.121 389
    
    
    In the above example, we are trying to reach an LDAP port. If the command does NOT return a "TCP connection successful" message, it's likely that either LDAP is not running, running on a port other than 389, or a network/system firewall is blocking traffic on port 389.
    
    
 4. Confirm the best route. You may find delayed response from the client or backend, intermittent network failure etc. It is possible the device has a conflicting routing configuration. The traceroute command shows how the routing is being determined.
     * xs40(config)# show route 
     * 
     * xs40(config)# traceroute 10.1.0.121
    
    
    Observe the "rtt" value and the routers/gateway. A network administrator should be consulted if any issue is found in the result. Also, see Configuring Default Gateway on DataPower device [http://www.ibm.com/support/docview.wss?uid=swg21320815] to avoid conflicting routing conflicts. 
    
    
 5. Depending on the nature of the behavior, if it looks like a packet trace will be needed to help diagnose the problem, disable the:
    Network>Network settings> TCP Segmentation off-load 
    feature on the device. Then see if the problem remains and collect the packet trace.
    
    If the network problem is still unresolved, more advanced troubleshooting like Packet Capture can be helpful. See MustGather: Collecting data on IBM WebSphere DataPower SOA Appliance for networking and connectivity problems [http://www-01.ibm.com/support/docview.wss?rs=2362&uid=swg21407324]