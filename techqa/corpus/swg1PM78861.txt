Title: IBM PM78861: XML LOCK CONTENTION MAY REDUCE WEB SERVICES PERFORMANCE - United States

Text:
  FIXES ARE AVAILABLE
8.5.0.2: WebSphere Application Server V8.5 Fix Pack 2 [http://www-01.ibm.com/support/docview.wss?uid=swg24034672]
8.0.0.6: WebSphere Application Server V8.0 Fix Pack 6 [http://www-01.ibm.com/support/docview.wss?uid=swg24034673]
8.0.0.7: WebSphere Application Server V8.0 Fix Pack 7 [http://www-01.ibm.com/support/docview.wss?uid=swg24035457]
8.0.0.8: WebSphere Application Server V8.0 Fix Pack 8 [http://www-01.ibm.com/support/docview.wss?uid=swg24036729]
7.0.0.33: WebSphere Application Server V7.0 Fix Pack 33 [http://www-01.ibm.com/support/docview.wss?uid=swg24037573]
8.0.0.9: WebSphere Application Server V8.0 Fix Pack 9 [http://www-01.ibm.com/support/docview.wss?uid=swg24037574]
7.0.0.35: WebSphere Application Server V7.0 Fix Pack 35 [http://www-01.ibm.com/support/docview.wss?uid=swg24038310]
8.0.0.10: WebSphere Application Server V8.0 Fix Pack 10 [http://www-01.ibm.com/support/docview.wss?uid=swg24039242]
7.0.0.37: WebSphere Application Server V7.0 Fix Pack 37 [http://www-01.ibm.com/support/docview.wss?uid=swg24039338]
8.0.0.11: WebSphere Application Server V8.0 Fix Pack 11 [http://www-01.ibm.com/support/docview.wss?uid=swg24040425]
7.0.0.39: WebSphere Application Server V7.0 Fix Pack 39 [http://www-01.ibm.com/support/docview.wss?uid=swg24041013]
8.0.0.12: WebSphere Application Server V8.0 Fix Pack 12 [http://www-01.ibm.com/support/docview.wss?uid=swg24041590]
7.0.0.41: WebSphere Application Server V7.0 Fix Pack 41 [http://www-01.ibm.com/support/docview.wss?uid=swg24041931]
8.0.0.13: WebSphere Application Server V8.0 Fix Pack 13 [http://www-01.ibm.com/support/docview.wss?uid=swg24042746]
7.0.0.43: WebSphere Application Server V7.0 Fix Pack 43 [http://www-01.ibm.com/support/docview.wss?uid=swg24043400]
8.0.0.14: WebSphere Application Server V8.0 Fix Pack 14 [http://www-01.ibm.com/support/docview.wss?uid=swg24044096]
7.0.0.45: WebSphere Application Server V7.0 Fix Pack 45 [http://www-01.ibm.com/support/docview.wss?uid=swg24044551]
8.0.0.15: WebSphere Application Server V8.0 Fix Pack 15 [http://www-01.ibm.com/support/docview.wss?uid=swg24044734]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  The XML parser used by the JAX-WS web services engine has a
   shared data structure called a symbol table that it updates
   when new XML names are processed. A write lock is sometimes
   acquired for mutating this data structure when no updates are
   required. A race condition exists which allows the XML parser
   to get into a state where it would perpetually lock,
   potentially degrading web services performance.
   
   Here is a sample stack trace collected during a period where
   locking is occurring:
   
   at sun/misc/Unsafe.park(Native Method)
   at
   java/util/concurrent/locks/LockSupport.park(LockSupport.java:197
   (Compiled Code))
   at
   java/util/concurrent/locks/AbstractQueuedSynchronizer.parkAndChe
   ckInterrupt(AbstractQueuedSynchronizer.java:845(Compiled Code))
   at
   java/util/concurrent/locks/AbstractQueuedSynchronizer.acquireQue
   ued(AbstractQueuedSynchronizer.java:878(Compiled Code))
   at
   java/util/concurrent/locks/AbstractQueuedSynchronizer.acquire(Ab
   stractQueuedSynchronizer.java:1208(Compiled Code))
   at
   java/util/concurrent/locks/ReentrantReadWriteLock$WriteLock.lock
   (ReentrantReadWriteLock.java:956(Compiled Code))
   at
   com/ibm/xml/xlxp2/scan/util/SymbolMap.resetMap(SymbolMap.java:27
   0(Compiled Code))
   at
   com/ibm/xml/xlxp2/scan/util/SymbolTable.reset(SymbolTable.java:4
   4(Compiled Code))
   at
   com/ibm/xml/xlxp2/api/stax/XMLStreamReaderImpl.reset(XMLStreamRe
   aderImpl.java:356(Compiled Code))
   at
   com/ibm/xml/xlxp2/api/jaxb/JAXBXMLStreamReader.reset(JAXBXMLStre
   amReader.java:357(Compiled Code))
   at
   com/ibm/xml/xlxp2/api/stax/XMLStreamReaderImpl.close(XMLStreamRe
   aderImpl.java:749(Compiled Code))
   at
   com/ibm/xml/xlxp2/api/wssec/WSSXMLStreamReader.close(WSSXMLStrea
   mReader.java:122(Compiled Code))
   at
   com/ibm/xml/xlxp2/api/stax/XMLInputFactoryImpl$XMLStreamReaderPr
   oxyImpl.next(XMLInputFactoryImpl.java:193(Compiled Code))
   at
   com/ibm/xml/xlxp2/api/wssec/WSSXMLInputFactory$WSSStreamReaderPr
   oxy.next(WSSXMLInputFactory.java:55(Compiled Code))
   at
   org/apache/axiom/util/stax/wrapper/XMLStreamReaderWrapper.next(X
   MLStreamReaderWrapper.java:225(Compiled Code))
   at
   org/apache/axiom/util/stax/dialect/DisallowDoctypeDeclStreamRead
   erWrapper.next(DisallowDoctypeDeclStreamReaderWrapper.java:34(Co
   mpiled Code))
   at
   org/apache/axiom/om/impl/builder/StAXOMBuilder.parserNext(StAXOM
   Builder.java:672(Compiled Code))
   at
   org/apache/axiom/om/impl/builder/StAXOMBuilder.next(StAXOMBuilde
   r.java:214(Compiled Code))
   ...
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED:  All IBM WebSphere Application Server users  *
   *                  of JAX-WS and JAXB.                         *
   ****************************************************************
   * PROBLEM DESCRIPTION: XML lock contention may reduce web      *
   *                      services performance.                   *
   ****************************************************************
   * RECOMMENDATION:  Install a fix pack that contains this       *
   *                  APAR.                                       *
   ****************************************************************
   The XML parser used by the JAX-WS web services engine has a
   shared data structure called a symbol table that it updates
   when new XML names are processed. A write lock is sometimes
   acquired for mutating this data structure when no updates are
   required. A race condition exists which allows the XML parser
   to get into a state where it would perpetually lock,
   potentially degrading web services performance.
   Here is a sample stack trace collected during a period where
   locking is occurring:
   at sun/misc/Unsafe.park(Native Method)
   at
   java/util/concurrent/locks/LockSupport.park(LockSupport.java:197
   (Compiled Code))
   at
   java/util/concurrent/locks/AbstractQueuedSynchronizer.parkAndChe
   ckInterrupt(AbstractQueuedSynchronizer.java:845(Compiled Code))
   at
   java/util/concurrent/locks/AbstractQueuedSynchronizer.acquireQue
   ued(AbstractQueuedSynchronizer.java:878(Compiled Code))
   at
   java/util/concurrent/locks/AbstractQueuedSynchronizer.acquire(Ab
   stractQueuedSynchronizer.java:1208(Compiled Code))
   at
   java/util/concurrent/locks/ReentrantReadWriteLock$WriteLock.lock
   (ReentrantReadWriteLock.java:956(Compiled Code))
   at
   com/ibm/xml/xlxp2/scan/util/SymbolMap.resetMap(SymbolMap.java:27
   0(Compiled Code))
   at
   com/ibm/xml/xlxp2/scan/util/SymbolTable.reset(SymbolTable.java:4
   4(Compiled Code))
   at
   com/ibm/xml/xlxp2/api/stax/XMLStreamReaderImpl.reset(XMLStreamRe
   aderImpl.java:356(Compiled Code))
   at
   com/ibm/xml/xlxp2/api/jaxb/JAXBXMLStreamReader.reset(JAXBXMLStre
   amReader.java:357(Compiled Code))
   at
   com/ibm/xml/xlxp2/api/stax/XMLStreamReaderImpl.close(XMLStreamRe
   aderImpl.java:749(Compiled Code))
   at
   com/ibm/xml/xlxp2/api/wssec/WSSXMLStreamReader.close(WSSXMLStrea
   mReader.java:122(Compiled Code))
   at
   com/ibm/xml/xlxp2/api/stax/XMLInputFactoryImpl$XMLStreamReaderPr
   oxyImpl.next(XMLInputFactoryImpl.java:193(Compiled Code))
   at
   com/ibm/xml/xlxp2/api/wssec/WSSXMLInputFactory$WSSStreamReaderPr
   oxy.next(WSSXMLInputFactory.java:55(Compiled Code))
   at
   org/apache/axiom/util/stax/wrapper/XMLStreamReaderWrapper.next(X
   MLStreamReaderWrapper.java:225(Compiled Code))
   at
   org/apache/axiom/util/stax/dialect/DisallowDoctypeDeclStreamRead
   erWrapper.next(DisallowDoctypeDeclStreamReaderWrapper.java:34(Co
   mpiled Code))
   at
   org/apache/axiom/om/impl/builder/StAXOMBuilder.parserNext(StAXOM
   Builder.java:672(Compiled Code))
   at
   org/apache/axiom/om/impl/builder/StAXOMBuilder.next(StAXOMBuilde
   r.java:214(Compiled Code))
   ...
   
   
    
   
   

PROBLEM CONCLUSION
 *  The issue was resolved by adding an additional guard in the
   XML parser's symbol table which prevents the perpetual locking
   condition from occurring.
   
   The fix for this APAR is currently targeted for inclusion in
   fix packs 7.0.0.33, 8.0.0.6 and 8.5.0.2. Please refer to
   the Recommended Updates page for delivery information:
   http://www.ibm.com/support/docview.wss?rs=180&uid=swg27004980 [http://www.ibm.com/support/docview.wss?rs=180&uid=swg27004980]
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PM78861
   
   
 * REPORTED COMPONENT NAME
   WEBSPHERE APP S
   
   
 * REPORTED COMPONENT ID
   5724J0800
   
   
 * REPORTED RELEASE
   800
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2012-12-10
   
   
 * CLOSED DATE
   2012-12-17
   
   
 * LAST MODIFIED DATE
   2013-12-09
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WEBSPHERE APP S
   
   
 * FIXED COMPONENT ID
   5724J0800
   
   

APPLICABLE COMPONENT LEVELS
 * R800 PSY
   UP
   
   
 * R850 PSY
   UP