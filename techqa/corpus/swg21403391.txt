Title: IBM Installing or updating Rational Team Concert on Linux platforms results in "Too many open files" error - United States

Text:
too; many; open; files; suse; redhat; im; installation; manager; update; upgrade; ZipException; RTC TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Attempts to install or upgrade IBM Rational Team Concert products on Linux platforms using IBM Installation Manager result in the error "Too many open files". 

SYMPTOM
In many cases when this failure occurs, the Installation Manager will report that the install/update was successful, however checking the Installation Manager logs will reveal an error with stack traces as shown below. 

The Rational Team Concert Eclipse Client does not start successfully after install or update. 

The splash-screen shows but is immediately followed by an error dialog. 

 

The following error message can be found in the IBM Installation Manager log: 

java.util.zip.ZipException: Too many open files /opt/IBM/IBMIMShared/plugins/org.eclipse.equinox.p2.updatesite_1.0.1.R34x_v20080808-1156.jar
at java.util.zip.ZipFile.open(Native Method)
at java.util.zip.ZipFile.<init>(ZipFile.java:238)
at java.util.zip.ZipFile.<init>(ZipFile.java:268)
(...)

CAUSE
Refer to jazz.net work item 87837 [https://jazz.net/jazz/resource/itemName/com.ibm.team.workitem.WorkItem/87837] for details.



ENVIRONMENT
Installing or updating the Rational Team Concert Eclipse Client version 2.0 or later with non-English language packs on Linux.



DIAGNOSING THE PROBLEM
To see the current limits on the number of open files, run this command in a shell logged in as the user who performs product installation: 


ulimit -n 


The typical default is 1024. 


The recommended limit is 65536 or higher.



RESOLVING THE PROBLEM
To resolve this problem the limit of open files needs to be increased on Linux before installing or updating Rational Team Concert products.


There are two ways to configure the Linux system limits to avoid this problem. 


 * If you have system administrator privileges (root account), the file /etc/security/limits.conf can be modified to include these lines: 
   
   * hard nofile 65536 
   
   * soft nofile 65536 
   
   Restart the linux system after the limits.conf file is modified. 
   
 * An individual user can increase the limits within a running shell with the following command: 
   
   ulimit -n 65536 
   
   Note: If this solution is used, the Rational Team Concert launchpad or IBM Installation Manager must be started from the same shell to inherit the modified limits. 



If Rational Team Concert is running on IBM WebSphere, the WebSphere startup script may need to be edited to include this configuration.  1. Navigate to the ../etc/init.d/was startup script
    
 2. Add ulimit -n 65536 to the startup script
    


Special instructions for Ubuntu As found in work item 153531 [https://jazz.net/jazz/resource/itemName/com.ibm.team.workitem.WorkItem/153531], Ubuntu sounds like not respecting the wildcard in /etc/security/limits.conf for the root user:


 * Change the above instructions for /etc/security/limits.conf to:
   root soft nofile 65536
   root hard nofile 65536
   
 * You can check the actual running process settings using: cat /proc/<pid>/limits
   
 * If you run as root, check the ulimit using: /bin/bash -c "ulimit -n"






If Rational Team Concert is running on IBM WebSphere, the WebSphere startup script may need to be edited to include this configuration.  1. Navigate to the ../etc/init.d/was startup script
    
    
 2. Add ulimit -n 65536 to the startup script
    
    
 3. Ensure that the Interscope Wily Agent is not running on WebSphere. 
    There is a known defect with IBM Java 6 JVM (found in WebSphere 7.0.0.17) when using the Interscope Agent. This defect is fixed by APAR IZ99243, but it is advised to turn off the Interscope Agent.






Note: Once these new settings have been applied, please proceed with a server re-index so as to fix possibly corrupted server indexes: 

 *  Rational Team Concert 2.x: <RTC_install_dir>/server/repotools -reindex Rational Team Concert 3.x: <RTC_install_dir>/server/repotools-jts -reindex 
 * 

Leverage the Jazz Community Jazz and Rational Team Concert have an active community that can provide you with additional resources. Browse and contribute to the User forums, contribute to the Team Blog and review the Team wiki.
Refer to technote 1319600 [http://ibm.com/support/docview.wss?uid=swg21319600] for details and links.



RELATED INFORMATION
#jazz.net work item 87837 [https://jazz.net/jazz/resource/itemName/com.ibm.team.workitem.WorkItem/87837]
jazz.net work item 139705 [https://jazz.net/jazz/resource/itemName/com.ibm.team.workitem.WorkItem/139705]
Ubuntu - jazz.net work item 153531 [https://jazz.net/jazz/resource/itemName/com.ibm.team.workitem.WorkItem/153531]
A Korean translation is available [http://www.ibm.com/support/docview.wss?uid=swg21595834]