Title: IBM LO68498: ISSUE INSTALLING NOTES 8.5.3 IN A NON INTERACTIVE SESSION - United States

Text:
 SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS RETURNED (APAR CANNOT BE RESOLVED WITHOUT ADDITIONAL INFO FROM IBM OR CUSTOMER.)
    
   
   

ERROR DESCRIPTION
 *  The customer finds that when they try use a scripted install of
   notes 8.5.3 in a non-interactive session, the install seems to
   start correctly, unzipping file etc, and it runs for a while but
   then they get an "Interactive Services Detection" popup /
   prompt.
   They noticed looking at task manager that the notes2.exe process
   hangs, it never completes. They end up killing the notes2.exe
   processes, and that gets rid of the popup message but the
   install doesn't complete.
   
   They do not have any options available to select in the
   "Interactive Services Detection" popup to select, apart from
   viewing the message and that just brings them to the session 0
   and it does not show anything running in that session, just
   displays a black screen with a "return now" button to return to
   the windows desktop their only option.
   ==>So it seems as if the installer is trying to open interactive
   windows in a non interactive session, the customer feels that
   this shouldnt appear. it should be non-interactive, and the
   user should not be aware of the install. No user is on the
   system at the time as this is a remote installation as part of
   server deployment.
   
   - The "Interactive Services Detection" pop up appears on the
   administrators session on that server at the time the
   installation is running, normal users will not be notified of
   the stuck window or the hung install.
   - The issue is occurring on a fresh install.
   - If they run the MSI as a normal interactive session the
   installation completes successfully, but as the user will not be
   at the machine this is not a solution.
   - If they run the command above as a batch file on the machine
   the installation completes successfully.
   - The command works fine on the command line, it only fails with
   a script job.
   - customer can install other software this way without issue
   (they also previously used this method to install notes 8.5.2),
   but is only having this issue with installing notes 8.5.3 in
   this manner.
   
   
   Currently they must use manual installation, which is
   not practical as they are trying to roll out Notes 8.5.3.
   
   
   Customers Setup:
   They were using a power shell script to run a non-interactive
   install and using scheduled tasks to run the script, as an
   administrator on another machine.
   - power shell scrip runs with the highest privelages
   
   They use the following command in a batch file:
   
   (Using the format recommended in TN:1447614
   http://www-01.ibm.com/support/docview.wss?uid=swg21447614) [http://www-01.ibm.com/support/docview.wss?uid=swg21447614)]
   
    "msiexec /i "c:\8.5.3\Lotus Notes 8.5.3.msi" /qb
    SETMULTIUSER=1
    MULTIUSERBASEDIR="!userprofile!\appdata\Local"
    MULTIUSERCOMMONDIR="C:\ProgramData" CITRIX=1 /l*v
    c:\windows\lotus-notes-install.log
   
   and run this batch file as a scheduled task in server 2008 R2.
   The batch file is not signed and the user running the script is
   a local administrator.
   
   The customers batch file and the shell script were sent in.
   
   ==========================
   How to run a batch file as a scheduled task:
   (a)go to start, then go to control panel, -> system and security
   -> administrative tools -> task scheduler.
   (b) clieck action -> then click "create basic task".
   (c) type a name for the task and select next
   (d) Select how often you would like the task to run "When do you
   want the task to start"=> "one time", click next
   (e) Select a schedule based on a specific date/ time e.g today
   at 18:26, then select next.
   (f) You need to select what action you want to perform select
   "start a program" in order for the batch file to run, click next
   (g) Click browse and find the batch file, then click next
   (h) The sumary window appears and there is a chekbox at the end
   "Open the properties dialog for this task when I click finish",
   click that.
   (i) Click finish.
   ===> here you can select the user account or group to run the
   action on.
   - the customer uses the option "Run whether the user is logged
   in or not"
   (j) click ok.
   =========================
   
   Env:
   This customer was trying a single user install of standard
   louts notes 8.5.3 on XenApp 6 which they host on  64 bit server
   2008 r2
   ===> citrix users are using published desktop to access the
   start menu and all other applications.
   
   The customer believes that the issue is not cirtix dependant as
   they also had the issue with windows 7 - 64 bit.
   
   ====================
   
   Addional information:
   L2 could not reproduce the issue using 64 bit Windows 2008 SP2,
   but was advised that  Windows 2008 R2 is different
   ====================
   
   The customer also tried disabling the "Interactive Services
   Detection" to see if that made any difference but they found
   that they no longer get the pop up / prompt the installation
   still hangs.
   
   In ther install log i could see a lot of message where files
   can't be found etc and issues with the provisionling that would
   explain why the notes2.exe is still running it is trying to
   complete the provisioning.
     10/12/2011 20:27:48 2011-10-12T08:27:48.48-00:00 MSI ERROR:
     "UpgradeUtils/StreamlineCmdLine (Line 2444): Error -
     'GetPropertyFromMSI' for 'MULTIUSERBASEDIR' failed with return
   code
     '234' - More data is available.
     :
     :
   
   I asked the user if any of the notes files are created on the
   machine?
   ===> he advised that most of the files seem to be created, the
   install  seemed to be nearly complete when they get the
   "interactive session" message, most of the provisioning seems
   to have occurred.
   
   It is not caused  by a registry access issue all users will have
   access to the registries
    =====================
   
   
    
   
   

LOCAL FIX
 *  Possible Workaround:
   I found that if I set up to run the scheduled task as "system"
   rather than "admin" by scheduling a cmd.exe window and then
   runnig the command on windows 2008 and the installer
   successfully ran.
   
   
   ==> customer tested this and found that it did seem to work but
   the desktop icons didnt appear.
   
   
    
   
   

PROBLEM SUMMARY

PROBLEM CONCLUSION

TEMPORARY FIX

COMMENTS
 *  This APAR is associated with SPR# NKEY8SYF5B.
   The record was returned to the person who created it for more
    information.
   
   
    
   
   

APAR INFORMATION
 * APAR NUMBER
   LO68498
   
   
 * REPORTED COMPONENT NAME
   NOTES CLIENT
   
   
 * REPORTED COMPONENT ID
   5724E6255
   
   
 * REPORTED RELEASE
   853
   
   
 * STATUS
   CLOSED RET
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2012-04-02
   
   
 * CLOSED DATE
   2013-12-06
   
   
 * LAST MODIFIED DATE
   2013-12-06
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
    LO71985
   
   

FIX INFORMATION

APPLICABLE COMPONENT LEVELS