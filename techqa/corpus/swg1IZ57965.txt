Title: IBM IZ57965: FDCS CREATED WITH PROBE ID C0052000 BAD_DATA_RECEIVED WHEN DATAPOWER CLIENT SENDS LARGE MESSAGES TO MQSERVER USING OPENSSL. - United States

Text:
  FIXES ARE AVAILABLE
WebSphere MQ V7.0 Fix Pack 7.0.1.1 [http://www-01.ibm.com/support/docview.wss?uid=swg24024528]
WebSphere MQ V7.0.1 for i5/OS Fix Pack 7.0.1.1 [http://www-01.ibm.com/support/docview.wss?uid=swg24025627]
WebSphere MQ V7.0 Fix Pack 7.0.1.2 [http://www-01.ibm.com/support/docview.wss?uid=swg24026518]
WebSphere MQ V7.0.1 for i5/OS Fix Pack 7.0.1.2 [http://www-01.ibm.com/support/docview.wss?uid=swg24026566]
WebSphere MQ V6, Fix Pack 6.0.2.9 [http://www-01.ibm.com/support/docview.wss?uid=swg24025669]
WebSphere MQ V6.0 for iSeries Fix Pack 6.0.2.9 [http://www-01.ibm.com/support/docview.wss?uid=swg24025670]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  When a DataPower client sends a large message to a MQ Server,
   the message is split into transmissions of 0x7ffe bytes (in
   other words TSH's  of 0x7ffe bytes). SSL then adds 19 bytes of
   header data.
   
   In the case of the GSKit client then each individual MQ packet
   appears to be wrapped in some number of SSL packets. However,
   in the case of the OpenSSL client it appears that multiple MQ
   packets can first be combined, and then some number of SSL
   headers used to send multiple MQ packets. The result of this is
   that after a complete MQ TSH has been received there can still
   be any number of bytes remaining in the GSKit receive buffer.
   
   If the number of bytes remaining is less than 8 then when MQ
   receives the remaining subset of bytes then FDC with Probe ID
   CO052000 will be raised incorrectly.
   
   
    
   
   

LOCAL FIX
 *  No workaround required - business not currently impacted
   
   
    
   
   

PROBLEM SUMMARY
 *  ****************************************************************
   USERS AFFECTED:
   Customers using the DataPower-provided MQ client with SSL.
   
   Platforms affected:
   All Distributed (iSeries, all Unix and Windows)
   ****************************************************************
   PROBLEM SUMMARY:
   The client application was sending a large message, which is
   then split into multiple TSH's for transmission to the server.
   The TSH's are sent to the server using the OpenSSL stack, and
   this appears to have resulted in the TSH's being reassembled
   and then split on different boundaries when transmitted over
   the network.
   
   This resulted in only the first two bytes of an MQ TSH being
   delivered to the server.
   
   The MQ SSL receive code was not able to handle a transmission
   that did not include at least the first eight bytes of any TSH
   and this resulted in the flow being detected as invalid and
   being rejected.
   
   
    
   
   

PROBLEM CONCLUSION
 *  WebSphere MQ has been modified so that if the MQ SSL receive
   function receives less than 8 bytes then it performs some simple
   validation of the bytes that have been received, and if this
   data appears valid then the receive function tries to receive
   further bytes of the same segment.
   
   ---------------------------------------------------------------
   The fix is targeted for delivery in the following PTFs:
   
                      v6.0
   Platform           Fix Pack 6.0.2.9
   --------           --------------------
   Windows            U200313
   AIX                U828012
   HP-UX (PA-RISC)    U827381
   HP-UX (Itanium)    U827383
   Solaris (SPARC)    U827693
   Solaris (x86-64)   U828055
   iSeries            tbc_p600_0_2_9
   Linux (x86)        U827380
   Linux (x86-64)     U827694
   Linux (zSeries)    U827590
   Linux (Power)      U827382
   Linux (s390x)      U827695
   
                      v7.0
   Platform           Fix Pack 7.0.1.1
   --------           --------------------
   Windows            U200310
   AIX                U827232
   HP-UX (PA-RISC)    U826485
   HP-UX (Itanium)    U826884
   Solaris (SPARC)    U827125
   Solaris (x86-64)   U827374
   iSeries            tbc_p700_0_1_1
   Linux (x86)        U826321
   Linux (x86-64)     U827231
   Linux (zSeries)    U827105
   Linux (Power)      U826779
   
                      v7.0
   Currently any fixes planned for v7.0 will be fixed in 7.0.1.*
   and not in 7.0.0.*
   
   The latest available maintenance can be obtained from
   'WebSphere MQ Recommended Fixes'
   http://www-1.ibm.com/support/docview.wss?rs=171&uid=swg27006037 [http://www-1.ibm.com/support/docview.wss?rs=171&uid=swg27006037]
   
   If the maintenance level is not yet available, information on
   its planned availability can be found in 'WebSphere MQ
   Planned Maintenance Release Dates'
   http://www-1.ibm.com/support/docview.wss?rs=171&uid=swg27006309 [http://www-1.ibm.com/support/docview.wss?rs=171&uid=swg27006309]
   ---------------------------------------------------------------
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IZ57965
   
   
 * REPORTED COMPONENT NAME
   WMQ SOL SPARC
   
   
 * REPORTED COMPONENT ID
   5724H7203
   
   
 * REPORTED RELEASE
   602
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2009-08-12
   
   
 * CLOSED DATE
   2009-09-16
   
   
 * LAST MODIFIED DATE
   2009-09-16
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WMQ SOL SPARC
   
   
 * FIXED COMPONENT ID
   5724H7203
   
   

APPLICABLE COMPONENT LEVELS
 * R602 PSY
   UP