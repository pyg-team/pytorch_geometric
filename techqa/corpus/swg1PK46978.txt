Title: IBM PK46978: SUPPORT ORACLE CONNECTION CACHING THROUGH WEBSPHERE APPLICATION SERVER RESOURCE ADAPTER FOR ORACLE - United States

Text:
  FIXES ARE AVAILABLE
Java SDK 1.5 SR8 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24020073]
Java SDK 1.5 SR8 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24021203]
Java SDK 1.5 SR10 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24024201]
6.1.0.31: Java SDK 1.5 SR11 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24026453]
6.1.0.33: Java SDK 1.5 SR12 FP1 Cumulative Fix for WebSphere [http://www-01.ibm.com/support/docview.wss?uid=swg24027786]
6.1.0.29: Java SDK 1.5 SR11 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24025191]
6.1.0.35: Java SDK 1.5 SR12 FP2 Cumulative Fix for WebSphere [http://www-01.ibm.com/support/docview.wss?uid=swg24028574]
6.1.0.37: Java SDK 1.5 SR12 FP3 Cumulative Fix for WebSphere [http://www-01.ibm.com/support/docview.wss?uid=swg24029525]
6.1.0.39: Java SDK 1.5 SR12 FP4 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24030426]
6.1.0.41: Java SDK 1.5 SR12 FP5 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24031035]
6.1.0.43: Java SDK 1.5 SR13 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24031963]
6.1.0.45: Java SDK 1.5 SR14 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24033270]
6.1.0.47: WebSphere Application Server V6.1 Fix Pack 47 [http://www-01.ibm.com/support/docview.wss?uid=swg24035508]
6.1.0.47: Java SDK 1.5 SR16 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24035649]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  Application runs in WebSphere Application Server connecting to
   Oracle database. Currently in order for the application to
   enable Oracle FCF (Fast Connection Failover) it needs to use
   Oracle connection caching mechanism. Please note that Oracle RAC
   (Real Application Cluster) doesn't require FCF to be enabled in
   order to get failover and/or loadbalancing support.
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED: IBM WebSphere Application Server users of    *
   *                 JDBC and with Oracle pooling enabled.        *
   ****************************************************************
   * PROBLEM DESCRIPTION: When Oracle Pooling is enabled the      *
   *                      resource adapter was not enabled to     *
   *                      use the Oracle fast connection          *
   *                      failover.                               *
   ****************************************************************
   * RECOMMENDATION:                                              *
   ****************************************************************
   Fast connection failover was not occurring with the Oracle
   Pooling enabled.
   
   The resource adpater code was not using the Oracle Pooling to
   allow the connection failover to occur.
   
   
    
   
   

PROBLEM CONCLUSION
 *  The resource adapter fix added additional configuration
   options to allow for Oracle pooling and connection failover.
   
   Additional information for Support Oracle Fast Connection
   Failover
   
   Oracle pooling can be enabled in WebSphere Application Server
   but OracleDataSource must be used (as opposed to the
   OracleConnectionPool datasource). Application Server doesn't
   certify with OracleDataSource but does support it (support
   falls under other configuration part of our support statement).
   To enable Oracle pooling in Application Server do the
   following:
   
   1) create a user defined provider.  Use the following
   configuration:
   
       Implementation class: oracle.jdbc.pool.OracleDataSource
       helper:
   com.ibm.websphere.rsadapter.Oracle10gDataStoreHelper
   
   2) create a datasource under the new provider created in 1
   with the following custom properties:
   disableWASConnectionPooling = true
   connectionCachingEnabled=true
   connectionCacheName=<your cache name>
   removeExistingOracleConnectionPoolIfExists = true
   URL = <Oracle URL>
   
   Note that you will need the
   removeExistingOracleConnectionPoolIfExists  be set to have
   Application Server remove any existing Oracle poolings.
   Otherwise, Oracle will fail getConnection.
   
   
   Limitation of the Oraclepooling:
   1) doesn't support XA
   2) order of who the DS custom properties  get set is
   important.  This could become an issue as Application Server
   passes the properties as a collection and hence the order is
   not guaranteed.  If you hit this issue, you need to contact
   Oracle and reference TAR:6499673.994
   3) oracle will not display a message if the pool creation
   fails, instead a normal connection is returned. Thus, you need
   to watch for that.  You can confirm that pool is created by
   running your application and then trying to issue a
   testConnection. Test connection should fail with an exception
   that the oracle pool name is already used. Note however, that
   the testConnection must be executed in the save JVM (that is,
   server level) thus, you will need to create your datasource
   and provider in the server scope.
   
   The fix for this APAR is currently targeted for inclusion
   in fixpack for 6.1.0.15
   Please refer to the recommended updates page for delivery
   information:
   http://www.ibm.com/support/docview.wss?rs=180&uid=swg27004980 [http://www.ibm.com/support/docview.wss?rs=180&uid=swg27004980]
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PK46978
   
   
 * REPORTED COMPONENT NAME
   WEBS APP SERV N
   
   
 * REPORTED COMPONENT ID
   5724H8800
   
   
 * REPORTED RELEASE
   60A
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2007-06-12
   
   
 * CLOSED DATE
   2007-10-05
   
   
 * LAST MODIFIED DATE
   2010-12-28
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

MODULES/MACROS
 *  ADAPTER
   
   
    
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WEBS APP SERV N
   
   
 * FIXED COMPONENT ID
   5724H8800
   
   

APPLICABLE COMPONENT LEVELS
 * R61A PSY
   UP
   
   
 * R61H PSY
   UP
   
   
 * R61I PSY
   UP
   
   
 * R61P PSY
   UP
   
   
 * R61S PSY
   UP
   
   
 * R61W PSY
   UP
   
   
 * R61Z PSY
   UP