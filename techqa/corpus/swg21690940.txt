Title: IBM FileNet Content Engine - content not clearing from staging areas of a Fixed Content Device - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Millions of documents are in the inbound folder of a staging area for an offline Fixed Content Device (FCD) Storage Area and are not being cleared by the abandoned content cleanup process. 

SYMPTOM
 

 * Allocated space staging area is full. 
 * Count of documents in inbound folder do not go down. 
 * Associated records for the content do not exist in the ContentQueue table of the object store. 
 * The storage area property of the documents still point to the original location of the document. 
 * Errors and warnings related to ContentQueueDirectoryCleanup process, such as the one below, are seen in the P8 error and trace logs.
   
   YYYY-07-10T14:48:00.988Z D7902F9C CSTG FNRCE0000W - WARN ContentQueueDirectoryCleanUp.acquireLock: received unexected exception trying to acquire lock to cleanup inbound directory. Skipping cleanup for this interval. java.io.IOException: There is not enough space on the disk. 
   
   


CAUSE
Custom application uses FileNet MoveContent method to move content from one storage area to another. In this case the destination storage area is offline. The MoveContent fails but does store a copy of the content into the destination storage area's inbound staging area until the staging area runs out of space. The orphaned content does not get cleaned up by the ContentQueueDirectoryCleanup process because it does not have enough space to get a lock on the inbound folder in order to delete the files.

DIAGNOSING THE PROBLEM
Enable Content Storage trace logging on the Content Engine and monitor for the ContentQueueDirectoryCleanup process being launched in the P8 trace logs.



RESOLVING THE PROBLEM
 

 1. Make additional space available to the staging area so a lock can be established and the orphaned documents can be deleted. 
 2. Lower the Abandoned Content Cleanup Interval so the clean up process occur more frequently. This setting is in FEM - P8 Domain level properties - Properties tab - Subsystems Configuration property - Content Configuration option.
    
    Note this setting requires a restart of Content Engine to take affect.