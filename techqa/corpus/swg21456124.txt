Title: IBM How to verify Rapid Spanning Tree is deployed properly for DataPower Virtual MAC Takeover Standby Control - United States

Text:
HSRP Data Power Rapid Spanning Tree Portfast duplicate MAC standby control active passive TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 How to verify Rapid Spanning Tree is deployed on the network properly for IBM WebSphere DataPower SOA Appliance Standby Control. 

SYMPTOM
Reporting problems with Standby Control Failover, Takeover, or seeing duplicate HSRP Virtual MAC Addresses on the network.


CAUSE
If Rapid Spanning Tree is not deployed correctly on the network, then the Standby Control Appliances may not be able to communicate properly.

ENVIRONMENT
IBM WebSphere DataPower SOA Appliances set up for Standby Control

DIAGNOSING THE PROBLEM
If you are running into Standby Control Problems, review MustGather: Standby Control not working correctly on IBM WebSphere DataPower SOA Appliance. [http://www-01.ibm.com/support/docview.wss?uid=swg21420179]

One of the recommendations in this MustGather document is to verify that Rapid Spanning Tree is properly deployed. The following information will describe a way to complete this task.

RESOLVING THE PROBLEM
The following information describes how to verify that Rapid Spanning Tree is deployed on the network properly for DataPower Standby Control. The first several steps describe how to prepare the environment for the test.





1) Record the current Standby Control configuration settings, disable Standby Control on both Appliances, and then save the updated configuration.


Using the WebGUI: 

a) Navigate to Network -> Interface -> Ethernet Interface -> eth<number> 
b) Click the Standby Control tab to view and record the settings
c) Click the X next to the Standby Control configuration entry to remove the Standby Control configuration 
d) Click Apply -> Save Config

[/support/docview.wss?uid=swg21456124&amp;aid=1]



Using the CLI: 

#show standby
#co
#int eth<number>
#no standby
#exit
#write memory
#y 


2) Reboot both Appliances.

3) Once the Appliances have completed the reboot, check that both have their original MAC addresses.

NOTE: This should not be the HSRP Virtual MAC Address: 00:00:0c:07:ac:<groupnumber>.


Using the WebGUI:

Navigate to Status -> IP-Network -> Ethernet Interfaces to view the MAC addresses.



Using the CLI:

#show int mode 

 

Be sure to record the original MAC Addresses for later use.

The next several steps describe how to measure the spanning tree convergence time. 

4) Start a continuous ping to one of the DataPower interfaces from some other remote host on the network and verify that they are successful.


Using UNIX:

ping <DataPower IP>



Using the Windows command prompt: 

ping -t <DataPower IP>


5) Change the MAC address on that Appliance interface to any MAC Address currently not in use on your network. 

This should cause the continuous pings from the remote host to start failing.


Using the WebGUI:

Navigate to Network -> Interface -> Ethernet Interface -> eth<number> 
Update the MAC Address Field and click Apply

[/support/docview.wss?uid=swg21456124&amp;aid=2]



Using the CLI:

#co
#int eth<number>
#mac-address <mac-address>
#exit 

 

6) From the Appliance, ping a remote address. 

Using the WebGUI:

Navigate to Control Panel -> Troubleshooting -> Ping Remote

[/support/docview.wss?uid=swg21456124&amp;aid=3]



Using the CLI:

#ping <ip-address> 



7) Immediately time how long it takes for the continuous pings to become successful again from the remote host.


Note: 

If the network has correctly deployed Rapid Spanning Tree, the ping will resume successfully within 6 seconds. 

If the convergence time was more than 6 seconds, the network has not successfully deployed rapid spanning tree and your network admin should be contacted.

8) Return the MAC Address to the original MAC Address recorded from step 3.

9) Add the Standby Control configuration back once Rapid Spanning Tree has been deployed properly.