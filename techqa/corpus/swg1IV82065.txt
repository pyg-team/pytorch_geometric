Title: IBM IV82065: CANNOT SEND E-MAIL DUE TO STRINGINDEXOUTOFBOUNDSEXCEPTION. - United States

Text:
 SUBSCRIBE TO THIS APAR
By subscribing, you receive periodic emails alerting you to the status of the APAR, along with a link to the fix after it becomes available. You can track this item individually or track all items by product.

Notify me when this APAR changes.

Notify me when an APAR for this component changes.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  Cannot send an e-mail due to StringIndexOutOfBoundsException.
   I am able to recreate the problem in my MAM 7.5.0.9 test
   environment.
   
   PERFORMANCE ISSUE:
   No
   
   STEPS TO REPRODUCE:
   1) From Communication Templates application,
   create a new communication template with the following
   values.
   
   Template        : PMR79243
   Applies To      : WORKORDER
   Accessible from : ALL
   Comm Log Entry? : checked
   Send To         : wilson@localdomain
   Send From       : maxadmin@localdomain
   Subject         : PMR79243
   Message         : :description_longdescription
   
   Then activate the communication template.
   
   2) From Workflow Designer, create a new Workflow with the
   following values.
   
   Process : PMR79243
   Object  : WORKORDER
   
   3) Put a task node on canvas and specify the follwing
   values for the properties.
   
   Title                  : TASK3
   Applications           : WOTRACK
   Role ID for assignment : WILSON
   Communication Template for Notifications : PMR79243
   
   4) Enable and activate the process. Then add the application
   support to WOTRACK.
   
   5) From Application Designer, open WOTRACK and
   add a new multiline text box on Work Order tab.
   
   6) Specify the followinwg value for the properties
   of the multiline text box.
   
   Attribute : description_longdescription
   
   7) From WOTRACK, create a new WO and specify the following
   value in the newly added multiline textbox.
   
   <x =
   
   8) Click Route the Workflow and specify the workflow PMR79243.
   
   9) Open SystemOut.log and verify the following error.
   
   [16/01/27 0:51:29:882 JST] 00000046 SystemOut     O 27 1 2016
   00:51:29:882 [ERROR] [MXServer] [] Failed to send messages.
   java.lang.StringIndexOutOfBoundsException
    at java.lang.String.substring(String.java:1093)
    at psdi.util.HTML.cleanHtml(HTML.java:1503)
    at psdi.util.HTML.cleanHtml(HTML.java:1305)
    at psdi.util.HTML.cleanHtml(HTML.java:1295)
    at psdi.util.HTML.cleanValue(HTML.java:309)
    at psdi.util.RichText.cleanValue(RichText.java:50)
    at psdi.common.commlog.CommLog.sendMessage(CommLog.java:213)
   
   CURRENT ERRONEOUS RESULT:
   Cannot send the e-mail with StringIndexOutOfBoundsException.
   
   EXPECTED RESULT:
   The e-mail should be sent without any exception.
   
   CUSTOMER'S ENVIRONMENT:
   Product information: SCCD
   Product version: 7.5.1.1
   Application within Product: Coomunication Template
   OS: Linux2.6
   DB: DB2 9.7
   Application Server: WebSphere Application Server 7.0.0.37
   
   L2 TEST ENVIRONMENT:
   Product information: MAM
   Product version: 7.5.0.9
   Application within Product: Communication Template
   OS: Win2k8
   DB: DB2 9.7
   Application Server: WebSphere Application Server 7.0.0.15
   
   
    
   
   

LOCAL FIX
 *  Do not use multiline text box for description_longdescription.
   
   
    
   
   

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED:                                              *
   * All Maximo Users                                             *
   ****************************************************************
   * PROBLEM DESCRIPTION:                                         *
   * Cannot send an e-mail due to                                 *
   * StringIndexOutOfBoundsException.                             *
   ****************************************************************
   * RECOMMENDATION:                                              *
   * Upgrade to latest release                                    *
   ****************************************************************
   STEPS TO REPRODUCE:
   1) From Communication Templates application, create a new
   communication template with the following values.
   Template        : PMR79243
   Applies To      : WORKORDER
   Accessible from : ALL
   Comm Log Entry? : checked
   Send To         : wilson@localdomain
   Send From       : maxadmin@localdomain
   Subject         : PMR79243
   Message         : :description_longdescription
   
   Then activate the communication template.
   
   2) From Workflow Designer, create a new Workflow with the
   following values.
   Process : PMR79243
   Object  : WORKORDER
   
   3) Put a task node on canvas and specify the follwing values for
   the properties.
   Title                  : TASK3
   Applications           : WOTRACK
   Role ID for assignment : WILSON
   Communication Template for Notifications : PMR79243
   
   4) Enable and activate the process. Then add the application
   support to WOTRACK.
   
   5) From Application Designer, open WOTRACK and add a new
   multiline text box on Work Order tab.
   
   6) Specify the followinwg value for the properties of the
   multiline text box.
   Attribute : description_longdescription
   
   7) From WOTRACK, create a new WO and specify the following value
   in the newly added multiline textbox.
   <x =
   
   8) Click Route the Workflow and specify the workflow PMR79243.
   
   9) Open SystemOut.log and verify the following error.
   
   [16/01/27 0:51:29:882 JST] 00000046 SystemOut     O 27 1 2016
   00:51:29:882 [ERROR] [MXServer] [] Failed to send messages.
   java.lang.StringIndexOutOfBoundsException
    at java.lang.String.substring(String.java:1093)
    at psdi.util.HTML.cleanHtml(HTML.java:1503)
    at psdi.util.HTML.cleanHtml(HTML.java:1305)
    at psdi.util.HTML.cleanHtml(HTML.java:1295)
    at psdi.util.HTML.cleanValue(HTML.java:309)
    at psdi.util.RichText.cleanValue(RichText.java:50)
    at psdi.common.commlog.CommLog.sendMessage(CommLog.java:213)
   
   CURRENT ERRONEOUS RESULT:
   Cannot send the e-mail with StringIndexOutOfBoundsException.
   
   EXPECTED RESULT:
   The e-mail should be sent without any exception.
   
   
    
   
   

PROBLEM CONCLUSION
 *  The e-mail is sent without any exception.
   
   The fix for this APAR is contained in the following maintenance
   package:
   	 | release\fix pack | Fix Pack Release 7.5.0.10 TPAE
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IV82065
   
   
 * REPORTED COMPONENT NAME
   ADMINISTRATION
   
   
 * REPORTED COMPONENT ID
   5724R46A1
   
   
 * REPORTED RELEASE
   750
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt / Xsystem
   
   
 * SUBMITTED DATE
   2016-03-02
   
   
 * CLOSED DATE
   2016-03-18
   
   
 * LAST MODIFIED DATE
   2016-03-18
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

MODULES/MACROS
 *  MAXIMO
   
   
    
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   ADMINISTRATION
   
   
 * FIXED COMPONENT ID
   5724R46A1
   
   

APPLICABLE COMPONENT LEVELS
 * R750 PSY
   UP