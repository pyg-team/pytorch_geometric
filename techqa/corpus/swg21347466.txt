Title: IBM Error 'A file needed by the Controller Link add-in could not be...' when launching Excel link - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 User launches Controller from a shortcut directly to the file CCR.EXE. )For example, they have logged on directly to the application server and launching a shortcut to "C:\Program Files\cognos\c8\webcontent\ccr\CCR.exe"). This works OK. 

However, then the user launches Excel by clicking on the 'Excel link' icon in Controller (available from Controller 8.2 or later). User receives error message. 

SYMPTOM
IBM Cognos 8 Controller Link 

A file needed by the Controller Link add-in could not be found. Either the file is missing or you have no connection with the server.

Please contact your system administrator.

Original error descr:
Could not load file or assembly 'http://servername/cognos8/controllerbin/ControllerXLConverter.dll or one of its dependencies.
[OK]

TIP: Depending on the exact nature of the cause, there may be an extra sentence 'The system cannot find the file specified' at the end of the above error.

CAUSE
The client device's Excel link cannot successfully contact the Controller server's relevant website, to download the required client component (in this case the file 'ControllerXLConverter.dll '). 

 
There are several potential scenarios to explain why the Excel link cannot retrieve the file from the website: 

 * Scenario #1 - The IIS website's virtual folder 'Controllerbin' (located on the Controller application server) has been configured with incorrect permission/security settings.  * There should only be 'READ' and 'RUN SCRIPTS (such as ASP)' ticked. 
    * 'Execute permissions' should not be configured as 'Scripts and executables'. Instead, it should be 'scripts' only. 
    * All users will be affected, in this scenario
   
   
 * Scenario #2 - Proxy server blocking client access to the webserver  * Typically perhaps only some users affected 
    * 'Bad' users have a proxy server enabled in their Internet Explorer
   
   
 * Scenario #3 - IIS website SSL certificate problem  * See separate IBM Technote #1371411.
   
   

RESOLVING THE PROBLEM
Scenario #1 

 
Either: 

 * modify the properties of the 'controllerbin' virtual folder 
 * or simple delete it and recreate it correctly from scratch.


Steps to modify the existing folder:  1. Logon to the Controller application server 
 2. Click 'Start - Control Panel - Administrative tools - Internet information services manager' 
 3. Expand the 'Default Web Site' 
 4. Expand the 'cognos8' folder 
 5. Right click on the 'controllerbin' folder and select 'properties' 
 6. Check that under local path, only 'READ' is ticked/checked 
 7. Change Execute permissions to read: Scripts only. (TIP: if it says Scripts and executables it will give the error) 
 8. Click 'OK' 
 9. Test. 

TIP: Remember that if you change the properties on Cognos8 in IIS - that change may reflect down to the underlaying sub-folders, and therefore this would give errors in Cognos Controller. 

Scenario #2 

Reconfigure Internet Explorer so it does not use a proxy server to communicate to the Controller website (for example http://controllersvr [http://controllersvr] or http://controllersvr.domain.com [http://controllersvr.domain.com]) 

TIP:  * For full details on how to disable the proxy, see separate IBM Technote #1655498. 
 * Also, different environments will require different settings to be enabled/disabled. For example, at one customer site the problem was solved by modifying IE7 so that the proxy server was manually specified (by name), rather than using the 'autodetect' setting (which caused the problem)

RELATED INFORMATION
#1655498 - How to disable the use of a proxy server when [http://www.ibm.com/support/docview.wss?uid=swg21655498]




HISTORICAL NUMBER
 1037006