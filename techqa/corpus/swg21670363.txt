Title: IBM kqiagent using high CPU - United States

Text:
kqiagent cpu multiinstance TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 kqiagent process uses high CPU due to the fact that it calls mqsilist to gather the broker status. 

CAUSE
Bad tuning of the Message Broker agent and missing KQI agent improvements (given in an interim fix) for multi-instance broker.

RESOLVING THE PROBLEM
Here are the steps to avoid problems with high CPU usage by kqiagent process:

1. Upgrade to V701 FP2 IF1.
This fix contains improvements for KQI agent in case of monitoring of multi-instance brokers.
For details, please refer to
http://www-01.ibm.com/support/docview.wss?uid=swg24033954 [http://www-01.ibm.com/support/docview.wss?uid=swg24033954]

2. Check if there is no space left in directory /tmp.
If this is the case, free up some space in that directory.

3. The discoveryInterval attribute determines the interval (in seconds) at which the agent attempts to discover new brokers that are created on the system. 


If you plan not to create and so to discover new brokers for some time, set the discoveryInterval parameter to a high value, for example, 7776000 seconds (90 days). 

If you plan to create and so to discover new brokers every now and then, set it to a value according to the possible interval to create new brokers, for example, 86400 seconds (24 hours). 

This attribute is set in the agent configuration xml file (kqi.xml).

4. The defaultStatisticInterval attribute determines the interval (in seconds) at which agent discovers the new status and information of the monitored brokers. If the status and configuration of brokers does not
change very frequently, you can set defaultStatisticInterval to an higher value than 60 (default), for example, 600. 

This attribute is set in the agent configuration xml file also (kqi.xml).

5. For every multi-instance broker, the mqsilist command is called once every discoveryInterval value and once every defaultStatisticInterval value respectively. So increase the values of discoveryInterval and defaultStatisticInterval if it is possible, which will improve agent performances.

Restart the KQI agent after having performed the steps above.