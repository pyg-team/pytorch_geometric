Title: IBM MustGather: Documentation for ITCAM SOA and WebSphere DataPower problem determination - United States

Text:
MustGatherDocument TECHNOTE (FAQ)

QUESTION
 Service Management data flows from DataPower to the Tivoli Enterprise Portal (TEP) in four steps listed in the Cause section below and also described in this webcast:

IBM Webcast replay: Monitoring DataPower with ITCAM for SOA ... 
http://www-01.ibm.com/support/docview.wss?uid=swg27024421 [http://www-01.ibm.com/support/docview.wss?uid=swg27024421]

If the DataPower service metrics expected are not available in TEP, please review these four steps to determine where the point of failure lies. 

If review of the Cause section below does not provide an answer on the source of the problem, 
collect the following MustGather information for IBM Technical Support to use in troubleshooting problems with the IBM Tivoli Composite Application Manager (ITCAM) SOA for WebSphere DataPower. 

CAUSE
Service management data flows from DataPower to ITCAM for SOA in four steps: 

 1. DataPower creates service metadata records in the DataPower WSM buffer and designates records as Complete when they are ready to collect. Check the buffer status as described in WebSphere DataPower Web Services Management (WSM) Agent Status http://www-01.ibm.com/support/docview.wss?uid=swg21474592 [http://www-01.ibm.com/support/docview.wss?uid=swg21474592] 
 2. The ITCAM for SOA data collector contacts DataPower to collect Complete Records from the WSM buffer. Check the connection between ITCAM SOA and DataPower as described in 
 3. The ITCAM for SOA data collector stores the collected data in metric logs. The ITCAM for SOA Agent moves the metric logs to a KD4CACHE directory. 
 4. The information from the KD4CACHE metric logs is displayed in TEP.


If metric data is not displayed in TEP as expected, the Tivoli administrator can look for the metric logs in step 3 and review the data collector logs associated with step 2. The Tivoli administrator will need to work with the DataPower administrator to look for other issues at step 2 and step 1. 
ANSWER
 


Section 1. Resolving or Collecting information on this problem.


 1. On the target WebSphere DataPower SOA Appliance where the traffic is not passed to ITCAM SOA, capture a transaction which should be counted by ITCAM SOA.  1. Turn on debug level of tracing in the Control Panel of the DataPower Appliance. 
     2. Control Panel > Troubleshooting ICON 
     3. Under Logging, set Log Level to debug in the pull down and press the Set log level button 
     4. Confirm and watch for Successful message 
    
    
 2. Access the DataPower system logs to find an intranet address that should be counted by ITCAM SOA.  1. From the domain or default domain, Status >Logging, System Logs 
     2. Look for an IP address from the intranet and timestamp. The IP address is in the client column 
     3. Write down the timestamp and IP address of the transaction that should be captured. 
    
    
 3. When the traffic is found, capture and save an error report  1. From the Control Panel, Troubleshooting ICON. 
     2. Under Reporting, Generate Error Report, select the Include Internal State radio button. 
     3. Click on Generate Error Report. 
     4. Click on Confirm and Close. 
     5. Click on View Error Report, and from your browser, use the File > Save As option to save the file to your computer.
    
    
 4. Obtain the following screen captures:  * Status > Web Service > WSM Agent Status 
     * Status > Web Service > WSM Agent Subscriber 
     * Services > Miscellaneous > Web Services Agent
    
    
 5.  Export the appliance configuration.  1. On the Control Panel, select the Export Configuration icon 
     2. Select the Create a backup of the entire system. Note: This action does not export the userids or certificates 
     3. Select Next and for the comment, enter 67758999000 
     4. Follow the prompts to download the file to your computer
    
    
 6. Gather ITCAM SOA log data.  1. Activate the ITCAM4SOA data collector trace by using the updateTracing_610 TakeAction or by setting the "8.DP.trace" property to "on" in the <ITM_home>/<interp>/KD4/config/KD4.dc.properties file. The data collector will react to this change within 20 seconds of saving the file. It is not necessary to restart the data collector. 
     2. Run the relevant traffic 
     3. Stop the data collector or de-activate the trace. In other words, reverse of step 6a. 
     4. Submit the log files ( <ITM_home>/<interp>/KD4/logs/KD4.8....DataPower.trace*.log.)
    
    
 7. Collect all the files into one zip file and attach to an email. See Section 2 in this document.



Section 2. Preparing to contact IBM Support 
 1. Obtain the serial number of the appliance which experienced the problem. This is need for IBM entitlement processing, before a PMR can be created. Use the WebGUI, select Status > System > Version Information, locate tag on the case of the appliance, or from the CLI use Show System 
 2. Locate the firmware version of the appliance. Use the WebGUI, select Status > System > Version Information or from the CLI use Show Version 
 3. Have your IBM customer number ready. 
 4. Determine the severity of your problem based on the Severity Levels table found in the following technote: "WebSphere DataPower Extended Maintenance and Support Services". [http://www.ibm.com/support/docview.wss?rs=2362&uid=swg21254180#severity.] 
 5. Prepare to describe how the problem affects your business operations. 
 6. Determine which telephone number IBM should use to contact you concerning this problem report.



Section 3. Contacting IBM Support and sending your MustGather information to IBM support 
 1. Reference our technote for information on Contacting IBM WebSphere DataPower SOA Appliance Support [http://www.ibm.com/support/docview.wss?rs=2362&uid=swg21236322]. 
 2. After you have contacted IBM Support, a PMR number will be assigned. Create a zip file of the MustGather information:  * A text file which contains: the questions and answers to any of the MustGather steps, elaboration on the problem, list of steps to recreate, notation on specific errors, and description external events noted at the time of the error. 
     * WebGui Screen Captures 
     * CLI command output results 
     * An error report at the time of the error, from either the WebGui [http://www.ibm.com/support/docview.wss?rs=2362&uid=swg21235587] or CLI [http://www.ibm.com/support/docview.wss?rs=2362&uid=swg21242396]. 
    
    
 3. Rename the zip file and send to IBM as noted in Exchanging information with IBM WebSphere DataPower Technical Support for problem determination [http://www-1.ibm.com/support/docview.wss?rs=2362&uid=swg21267385]. 
 4. Do not send any proprietary or confidential information from your company.






Cross reference information Segment Product Component Platform Version Edition Business Integration WebSphere DataPower Integration Appliance XI50 Not Applicable Business Integration WebSphere DataPower XML Security Gateway XS40 Not Applicable Business Integration WebSphere DataPower XML Accelerator XA35 Not Applicable Business Integration WebSphere DataPower Integration Appliance XI52