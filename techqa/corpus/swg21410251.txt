Title: IBM CPU Spikes in the z/OS  OMEGAMON XE for Messaging Agent - United States

Text:
HIGH CPU SPIKES RETAINHIST SAMPINT TECHNOTE (FAQ)

QUESTION
 About once a minute, we are seeing CPU spike at 80-95% for the OMEGAMON XE for Messaging agent started task. I do not see any messages in the log that correlates to the spikes. What can cause the spike in CPU? 

ANSWER
The OMEGAMON XE for WebSphere MQ monitoring agent has a combination of sampled data and on-demand data. For sampled data, the agent will collect a sample of this data every SAMPINT. For example, if you defined a sampling interval (SAMPINT) of 60 seconds, this means that every minute our monitor will collect sample information for all specified queues, channels, and applications. This is for our Queue Statistics, Channels Statistics, Application Statistics data as well as some other system level attribute groups such as Buffer Manager, and Pageset Statistics. So it is expected that there will be a spike in CPU use every sample interval. If the CPU use is too high, then you can consider making some configuration changes to reduce the amount of processing needed for each sample interval. Some options are: 

1)Insure that RETAINHIST has a value to 15 or 60. This will ensure that there is not a build-up of storage related to temporary dynamic queues. The RETAINHIST value is specified in SET GROUP or SET MANAGER statements in KMQUSER or KMQSTART members of RKANCMD dataset. These members are generated by values specified in ICAT, but you can just edit member if necessary. 

2) Modify SET APPLICATION to specify STATISTICS(NOQDATA) This option would not provide application statistics at the queue level. 

3)Modify SET APPLICATION to specify STATISTICS(NODYNAMQ) This option would not provide application statistics data for dynamic queues. 

4)Modify SET QUEUE statements to monitor fewer queues. 

5)Modify SET CHANNEL statements to monitor fewer channels.