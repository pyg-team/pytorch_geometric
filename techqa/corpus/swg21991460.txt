Title: IBM How to solve "Too many open files" error in ISIM Virtual Appliance - United States

Text:
isim va isim7 performance open files ulimit TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 ISIM 7 VA can fail with error "Too many open files" in the logs. This can be caused by system admin who changes ISIM configuration looking for better performance. 

SYMPTOM
ISIM 7 VA fails with error "Too many open files" in the log files.
Then the server goes down and it becomes unresponsive.
Error example:
Caused by: java.io.FileNotFoundException:
/opt/ibm/WebSphere/AppServer/plugins/org.apache.tuscany.sdo.sca.core.
model/geronimo-tuscany-implementation-web-1.5.1-SNAPSHOT.jar (Too many
open files)


CAUSE
The error is caused by the Operating System that actually has too many open files for the current user.
The root caused can be the ISIM administrator trying to improve performance.
One of the first things an admin tries to do is to increase LDAP and DB connection pools sizes.
But every available connection of the pool is a socket, and in UNIX systems a socket is a file.
So if the administrator sets a very high value it will cause the Operating System to have less "space" to open other files.

ENVIRONMENT
IBM Security Identity Server 7 Virtual Appliance

DIAGNOSING THE PROBLEM
Look for "Too many open files" errors in log files.
You should see a lot of entries with such error.
Usually the error occurs while establishing DB2 connection, LDAP connection, connection to TDI, accessing the WAS JAR files.

RESOLVING THE PROBLEM
To solve the problem the ISIM administrator should check the enRole.properties settings in ISIM Appliance Dashboard.
A classic example is the "enrole.connectionpool.maxpoolsize" property that controls the LDAP connections pool size.
Often it is set to 500 but the value of 200 is enough to perform ISIM LDAP-related operations. Because of this the OS will create less available connections, so less sockets, so (in UNIX systems such as the Virtual Appliance) less files.