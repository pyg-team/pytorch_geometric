Title: IBM IC87209: ADMIN_CMD LOOPS IF MORE THAN 32767 MSG IN SQLLIB/TMP, AND/OR ADMIN_REMOVE_MSGS FAILS WITH SQL20193N RC=10. - United States

Text:
z/os  FIXES ARE AVAILABLE
DB2 Version 9.7 Fix Pack 8 for Linux, UNIX, and Windows [http://www-01.ibm.com/support/docview.wss?uid=swg24034634]
DB2 Version 9.7 Fix Pack 9 for Linux, UNIX, and Windows [http://www-01.ibm.com/support/docview.wss?uid=swg24036646]
DB2 Version 9.7 Fix Pack 9a for Linux, UNIX, and Windows [http://www-01.ibm.com/support/docview.wss?uid=swg24037559]
DB2 Version 9.7 Fix Pack 10 for Linux, UNIX, and Windows [http://www-01.ibm.com/support/docview.wss?uid=swg24038641]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  The ADMIN_CMD manages the message files on server by unique
   operation ids, and corresponding unique message names.
   
   The random_number in operation id (<random_number>_<userid>)
   would be values in the range of 0-32767 on AIX and Windows
   system.
   This lack of variety on the operation id can cause the following
   issues.
   
   a) Infinite loop in admcmdCreateNewMsgFile()
   
   Once utility message path (sqllib/tmp by default) is filled by
   32767 number of message files, the function keeps looping to
   look for unique id (but never find).
   In this case, admin_cmd(EXPORT, IMPORT or LOAD) never returns to
   caller, and db2fmp consumes high CPU time.
   
   b) Duplicate operation id.
   
   DB2 intends to use unique operation id, but concurrent execution
   of the ADMIN_CMD()s can exploit a timing hole to use duplicate
   operation id. And Subsequent ADMIN_REMOVE_MSGS() will fail with
   SQL20193N rc=10 due to the duplicate operation id.
   
   This defect will fix these issues by using more wide variety of
   and non-duplicate operation id.
   
   
    
   
   

LOCAL FIX
 *  Please remove message files in the utility file path (sqllib/tmp
   or specified by DB2_UTIL_MSGPATH).
   
   
    
   
   

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED:                                              *
   * Users who use EXPORT, IMPORT or LOAD via ADMIN_CMD on AIX.   *
   ****************************************************************
   * PROBLEM DESCRIPTION:                                         *
   * See Error Description                                        *
   ****************************************************************
   * RECOMMENDATION:                                              *
   * Please upgrade to V9.7 FixPack 8 or later.                   *
   ****************************************************************
   
   
    
   
   

PROBLEM CONCLUSION
 *  This problem was first fixed in DB2 V9.7 FixPack 8.
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IC87209
   
   
 * REPORTED COMPONENT NAME
   DB2 FOR LUW
   
   
 * REPORTED COMPONENT ID
   DB2FORLUW
   
   
 * REPORTED RELEASE
   970
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2012-10-15
   
   
 * CLOSED DATE
   2013-04-08
   
   
 * LAST MODIFIED DATE
   2014-05-21
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
    IC91740 [http://www-01.ibm.com/support/docview.wss?uid=swg1IC91740]
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   DB2 FOR LUW
   
   
 * FIXED COMPONENT ID
   DB2FORLUW
   
   

APPLICABLE COMPONENT LEVELS
 * R970 PSN
   UP