Title: IBM PM72328: CWSIK0022E ERRORS AFTER FAILBACK OF WEBSPHERE APPLICATION SERVER SERVICE INTEGRATION BUS MESSAGING ENGINE - United States

Text:
  FIXES ARE AVAILABLE
8.5.0.2: WebSphere Application Server V8.5 Fix Pack 2 [http://www-01.ibm.com/support/docview.wss?uid=swg24034672]
8.0.0.6: WebSphere Application Server V8.0 Fix Pack 6 [http://www-01.ibm.com/support/docview.wss?uid=swg24034673]
7.0.0.29: WebSphere Application Server V7.0 Fix Pack 29 [http://www-01.ibm.com/support/docview.wss?uid=swg24034966]
8.0.0.7: WebSphere Application Server V8.0 Fix Pack 7 [http://www-01.ibm.com/support/docview.wss?uid=swg24035457]
8.0.0.8: WebSphere Application Server V8.0 Fix Pack 8 [http://www-01.ibm.com/support/docview.wss?uid=swg24036729]
7.0.0.31: WebSphere Application Server V7.0 Fix Pack 31 [http://www-01.ibm.com/support/docview.wss?uid=swg24036768]
7.0.0.33: WebSphere Application Server V7.0 Fix Pack 33 [http://www-01.ibm.com/support/docview.wss?uid=swg24037573]
8.0.0.9: WebSphere Application Server V8.0 Fix Pack 9 [http://www-01.ibm.com/support/docview.wss?uid=swg24037574]
7.0.0.35: WebSphere Application Server V7.0 Fix Pack 35 [http://www-01.ibm.com/support/docview.wss?uid=swg24038310]
8.0.0.10: WebSphere Application Server V8.0 Fix Pack 10 [http://www-01.ibm.com/support/docview.wss?uid=swg24039242]
7.0.0.37: WebSphere Application Server V7.0 Fix Pack 37 [http://www-01.ibm.com/support/docview.wss?uid=swg24039338]
8.0.0.11: WebSphere Application Server V8.0 Fix Pack 11 [http://www-01.ibm.com/support/docview.wss?uid=swg24040425]
7.0.0.39: WebSphere Application Server V7.0 Fix Pack 39 [http://www-01.ibm.com/support/docview.wss?uid=swg24041013]
8.0.0.12: WebSphere Application Server V8.0 Fix Pack 12 [http://www-01.ibm.com/support/docview.wss?uid=swg24041590]
7.0.0.41: WebSphere Application Server V7.0 Fix Pack 41 [http://www-01.ibm.com/support/docview.wss?uid=swg24041931]
8.0.0.13: WebSphere Application Server V8.0 Fix Pack 13 [http://www-01.ibm.com/support/docview.wss?uid=swg24042746]
7.0.0.43: WebSphere Application Server V7.0 Fix Pack 43 [http://www-01.ibm.com/support/docview.wss?uid=swg24043400]
8.0.0.14: WebSphere Application Server V8.0 Fix Pack 14 [http://www-01.ibm.com/support/docview.wss?uid=swg24044096]
7.0.0.45: WebSphere Application Server V7.0 Fix Pack 45 [http://www-01.ibm.com/support/docview.wss?uid=swg24044551]
8.0.0.15: WebSphere Application Server V8.0 Fix Pack 15 [http://www-01.ibm.com/support/docview.wss?uid=swg24044734]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  In WebSphere Application Server two node cluster Bus member
   the messaging engine successfully starts up on member1. After
   shutting down member1, the messaging engine successfully
   fails over to member2, but later when the messaging engine
   is failed back to member1 the JMS application fails to
   reconnect to the messaging engine and the following errors
   are logged in the SystemOut.log:
   
   On the JVM hosting the JMS application:
   CWSJR1067E:The following JCA Connection error has occurred
   when trying to get the connection. The retrieving of the
   connection will be retried. The exception is com.ibm.wsspi.
   sib.core.exception.SIConnectionUnavailableException:CWSIC8007E:
   An exception was caught from the remote server with Probe Id
   3-006-0002. Exception: CWSIK0022E: The connection is closed
   to messaging engine XXX and cannot be used...
   CWSIA0067E: An exception was received during the call to the
   method JmsMsgProducerImpl.<constructor>:com.ibm.wsspi.sib.
   core.exception.SIConnectionUnavailableException:CWSIC8007E:
   An exception was caught from the remote server with Probe
   Id 3-008-0001. Exception: CWSIK0022E: The connection is
   closed to messaging engine XXX and cannot be used...
   
   On the JVM hosting the failedback messaging engine:
   CWSIK0022E: The connection is closed to messaging engine
   XXX and cannot be used.
   
   
   FFDCS are produced with the following stack:
   
   com.ibm.ws.sib.processor.exceptions.SIMPConnectionUnavailable
   Exception SourceId:com.ibm.ws.sib.comms.server.clientsupport.
   StaticCATConnection.rcvCloneConnection ProbeId:3-006-0002
   com.ibm.ws.sib.processor.exceptions.SIMPConnection
   UnavailableException: CWSIK0022E: The connection is closed to
   messaging engine XXX and cannot be used.
   at com.ibm.ws.sib.processor.impl.ConnectionImpl.checkNotClosed
     (ConnectionImpl.java:324)
   at com.ibm.ws.sib.processor.impl.ConnectionImpl.clone
     Connection(ConnectionImpl.java:3863)
   at com.ibm.ws.sib.comms.server.clientsupport.StaticCAT
     Connection._cloneConnection(StaticCATConnection.java:451)
   at com.ibm.ws.sib.comms.server.clientsupport.StaticCAT
     Connection.rcvCloneConnection(StaticCATConnection.java:383)
   at com.ibm.ws.sib.comms.server.clientsupport.ServerTransport
     ReceiveListener.dataReceived(ServerTransportReceiveListener.
     java:400)
   at com.ibm.ws.sib.jfapchannel.impl.rldispatcher.Conversation
     ReceiveListenerDataReceivedInvocation.invoke(Conversation
     ReceiveListenerDataReceivedInvocation.java:195)
   at com.ibm.ws.sib.jfapchannel.impl.rldispatcher.Receive
     ListenerDispatchQueue.run(ReceiveListenerDispatchQueue.
     java:542)
   at com.ibm.ws.util.ThreadPool$Worker.run(ThreadPool.
     java:1613)
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED:  Users of the default messaging provider     *
   *                  for IBM WebSphere Application Server V7.0,  *
   *                  V8.0 and V8.5                               *
   ****************************************************************
   * PROBLEM DESCRIPTION: CWSIK0022E exceptions seen in the log   *
   *                      after messaging engine has failed       *
   *                      back to the preferred server.           *
   ****************************************************************
   * RECOMMENDATION:                                              *
   ****************************************************************
   Under a WebSphere Application Server cluster a bus member
   topology is configured with a high availability policy. If a
   preferred server is selected then the messaging engine starts
   up on the preferred server . When the preferred server is
   stopped, the messaging engine fails over to another member of
   the cluster. Once the preferred server is restarted, the
   messaging engines would move back to the preferred server
   again. In this case when the connection to the Messaging
   Engine that was running on a non-preffered server and during
   the usage of the connection,  if the Messaging Engine fails
   back to the preferred server then connections from JMS
   applications to the Messaging Engine can result in the
   following exception in the logs:
   CWSIK0022E: The connection is closed to messaging engine XXX
   and cannot be used.
   
   
    
   
   

PROBLEM CONCLUSION
 *  This APAR solves the problem by sending the messaging engine
   stop events to the connection pool during the fail back
   event. This would mark the connection as a stale connection
   and would prevent it from going into an exception state.
   
   The fix for this APAR is currently targeted for inclusion in
   fix packs 7.0.0.29, 8.0.0.6 and 8.5.0.2. Please refer to the
   Recommended Updates page for delivery information:
   http://www.ibm.com/support/docview.wss?rs=180&uid=swg27004980 [http://www.ibm.com/support/docview.wss?rs=180&uid=swg27004980]
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PM72328
   
   
 * REPORTED COMPONENT NAME
   WAS SIB & SIBWS
   
   
 * REPORTED COMPONENT ID
   620800101
   
   
 * REPORTED RELEASE
   300
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2012-09-06
   
   
 * CLOSED DATE
   2012-12-05
   
   
 * LAST MODIFIED DATE
   2012-12-05
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WAS SIB & SIBWS
   
   
 * FIXED COMPONENT ID
   620800101
   
   

APPLICABLE COMPONENT LEVELS
 * R800 PSY
   UP