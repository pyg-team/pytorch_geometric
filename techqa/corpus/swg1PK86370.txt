Title: IBM PK86370: ITCAMFWAS TEMA AGENT STOPS SENDING DATA TO THE TEP. ISSUE WITH NO. OF REQUESTS BEING SENT TO THE TEMA CAUSES OUT OF MEMORY - United States

Text:
  FIXES ARE AVAILABLE
ITCAM for WebSphere V6.2 TEMA - 6.2.0.5-TIV-ITCAM_WAS_TEMA-IF009 [http://www-01.ibm.com/support/docview.wss?uid=swg24026337]
ITCAM for WebSphere V6.2 TEMA - 6.2.0.5-TIV-ITCAM_WAS_TEMA-IF014 [http://www-01.ibm.com/support/docview.wss?uid=swg24028525]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  Environment
   ===========
   ITCAM for WAS 6.1. FP04 DC (monitoring
    Portal servers v6.0.2.27 32bit Net deployment
    App servers v6.1.0.11 64bit Net deployment)
   ITCAM for WAS 6.1. FP04 TEMA
   
   
   Problem Description
   ===================
   After a number of hours the ITCAM for WAS TEMA agent stops
   sending data to the TEP server and the workspaces appear blank.
   Investigation of the TEMA logs shows
   .
   Increasing the heap size allows the TEMA to run for longer but
   does not prevent this issue occurring
   .
   When the problem is seen, the TEP workspace is blank (greyed
   out) and if the mouse is clicked on any of the workspaces the
   hourglass appears and eventually times out
   .
   If a netstat -an is run on the machine running the TEMA there
   are many connections on port 63335 (listening port for the TEMA
   agent) in CLOSE_WAIT status
   .
   This issue seems to happen more frequently when there is a high
   number of requests being sent to the TEMA agent (e.g. from a WAS
   Portal Server)
   
   
    
   
   

LOCAL FIX
 *  N/A
   
   
    
   
   

PROBLEM SUMMARY
 *  If customer application generating a lot of unique requests then
   in result DC/TEMA Agent may crashes
   with out of memory exception. It happening because TEMA Agent
   stores all generated requests and if they count always
   increasing then in result may be used all allocated memory for
   the process. In result in TEP in workspace
   RequestAnalysis may be shown a thousands of requests.
   
   
    
   
   

PROBLEM CONCLUSION
 *  The problem may be resolved with limitation on count of
   collected requests.
   Here is a 2 settings in TEMA Agent property file
   (kynwb.properties) which control it:
   1) -Dkwj.ra.req.limit.per.thread=256 (default value)
   2) -Dkwj.ra.snapshot.req.limit=256 (default value)
   
   The first item managing with count of unique requests which may
   be collected on each client thread.
   In case if during work a request collection will be filled then
   a new request will pushe out an elder
   one from this collection and this elder one will be aggregated
   only with his request type (like Servlet, EJB etc.)
   Aggregated requests by his type will be represent in result, so
   no one requests will be lost.
   
   The second item managing with count of unique requests in
   resulting snapshot from toolkit to TEMA. It's touches
   worspaces like RequestAnalysis, Selected Requests, Datasources,
   JMS Summary and Request Times And Rates.
   And in all of them a count of raw in tables will no more then
   value set in configuratio for this setting.
   
   For turning off and collect all requests without limitation you
   need to set 0 (Zero) value for this 2 settings.
   
   The fix for this APAR is contained in the following maintenance
   package:
   
   | interim fix | 6.2.0.5-TIV-ITCAM_WAS_TEMA-IF007
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PK86370
   
   
 * REPORTED COMPONENT NAME
   ITCAM WAS DIST
   
   
 * REPORTED COMPONENT ID
   5724L6200
   
   
 * REPORTED RELEASE
   610
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2009-05-12
   
   
 * CLOSED DATE
   2009-11-06
   
   
 * LAST MODIFIED DATE
   2009-11-06
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   ITCAM WAS DIST
   
   
 * FIXED COMPONENT ID
   5724L6200
   
   

APPLICABLE COMPONENT LEVELS
 * R610 PSY
   UP