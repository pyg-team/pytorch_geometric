Title: IBM Small index CI size - United States

Text:
RCAA0800D4; RCAB0800D4; RCAC0800D4; AA; AB; AC; CNVSZ; 512; p; msgiec161i; rc34o TECHNOTE (FAQ)

QUESTION
 When a KSDS is defined through IDCAMS, and users do not specify an INDEX CONTROLINTERVALSIZE (CISIZE) VSAM will determine a default size. 
The default CISIZE may result in some of the following conditions. 

ANSWER
Description:
When a KSDS is defined through IDCAMS, and users do not specify an INDEX CONTROLINTERVALSIZE (allowing the INDEX CISIZE to default), VSAM will calculate this INDEX CISIZE. The default CISIZE may result in some of the following conditions. An explicitly coded CISIZE that is too small has the same exposure:

1. VSAM may select an INDEX CISIZE that is not large enough to allow an entire data CONTROL area (CA) to be utilized (i.e. the associated INDEX record is filled before all data CI's are utilized). Users may see unexpected FREESPACE, too many extents being used, or extra CI/CA splits in the KSDS components. For large data sets, small INDEX CISIZE can cause excessive CA split activity in the higher level INDEX records as these records run out of space to hold the high key of the associated lower level (sequence set) INDEX records. These low settings might cause one of the following messages during file processing:

MSGIEC070i MSGIEC161i MSGIEC251i
RC34 - Data set reached maximum number of extents
RC104 - No more volumes are available on which to allocate space.

2. For clusters defined with LSR/GSR (local or global shared resources) and the new N*512 (Nx512) CI sizes, the VSAM generated CISIZE may be incompatible with the BLDVRP buffer sizes specified. This can cause errors in IMS, CICS, etc. MSGDFS0730i or MSGIEC161i RC120 RSN53 - indicating the ACB specifies LSR/GSR and the CISIZE of the data set exceeds size of the largest buffer specified in the BLDVRP.

NOTE: 'N*512' basically means that the number must resolve to a value that is evenly divisible by decimal 512. ie; 

512 1024 1536 2048 2560 3072 3584 4096 4608 5120 5632 6144 6656 7168 8192. 
N*512 is not applicable for old VSAM catalogs
. 
These new CI sizes apply to VSAM type data sets defined in an ICFCAT (ICFCATALOG) environment only.

3. User might receive one of the following RPL feedback errors when VSAM tries to extend the data set; (a condition exists during CA split processing that may prevent the splitting of an INDEX record):

RPL FEEDBACK WORD / RPLFDBWD
AA0800D4 AB0800D4 AC0800D4
RC x'AA' x'AB' x'AC' x'D4' RC08 RSND4
RC170 RC171 RC172 RC212 RCD4 RC37 RC132 RC108

4. A DFDSS or IDCAMS print of the KSDS could show large amounts of unused space in the DATA CAs


Resolution:


z/OS DFSMS Using Data Sets:
Optimizing VSAM Performance , [http://publibz.boulder.ibm.com/cgi-bin/bookmgr_OS390/BOOKS/DGT2D450/2.5.1.3?SHELF=DGT2BK60&DT=20060524093000] INDEX CONTROL INTERVAL SIZE describes how the user can estimate his INDEX CI size: 

To make a general estimate of the INDEX CONTROL INTERVAL SIZE you can multiply one half the key length by the number of DATA CI/CA

(KEYLEN/2) x DATA CI/CA =OR< INDEX CISIZE

EXAMPLE: D/T3390 DATA (KEYLEN=21 CISIZE(4096) CI/CA=180)
21/2 = 10.5 (Round up to whole integer) = 11
11 x 180 = 1980
INDEX CISIZE should be greater than or equal to
1980. setting 1980 will be resolved to 2048

NOTE: When changing to new DASD which increases DASD track capacities (which changes the number of CI/CA CONTROLINTERVALS per CONTROL AREA), VSAM users may need to change their INDEX or DATA CI sizes per the above tuning considerations. An INDEX CISIZE = 4096 is usually a safe, starting value to use to initially avoid these errors. 

Additional symptoms: MSGDFS0844i ABENDU0844 database full
IMS 566540801 IMBED volume extent
DSBREAKER unpredictable results
SHOWCB available space (AVSPAC)
RPLFDBWD RC08 RSN1C

For further information see:

DFSMS: Access Method Services for ICF:
CONTROL INTERVAL SIZE


DFSMS: Macro Instructions for Data Sets: 
BLDVRP

DFSMS: Managing Catalogs
Set Catalog Control Interval and Control Area SIze 


RELATED INFORMATION
 z/OS V1R11 DFSMS Using Data Sets [http://publibz.boulder.ibm.com/cgi-bin/bookmgr_OS390/BOOKS/dgt2d480/2.5.1.3?ACTION=MATCHES&REQUEST=index+CI+Size&TYPE=FUZZY&SHELF=DGT2BK90&DT=20090522090215&CASE=&searchTopic=TOPIC&searchText=TEXT&searchIndex=INDEX&rank=RANK&ScrollTOP=FIRSTHIT#FIRSTHIT]
z/OS V1R11.0 DFSMS AMS for Catalogs CONTROLINTERVALSZE [http://publibz.boulder.ibm.com/cgi-bin/bookmgr_OS390/BOOKS/dgt2i280/14.1.2?ACTION=MATCHES&REQUEST=controlintervalsize&TYPE=FUZZY&SHELF=DGT2BK90&DT=20090603090124&CASE=&searchTopic=TOPIC&searchText=TEXT&searchIndex=INDEX&rank=RANK&ScrollTOP=FIRSTHIT#FIRST]
z/OS V1R11.0 DFSMS Macro Instructions for Data Sets [http://publibz.boulder.ibm.com/cgi-bin/bookmgr_OS390/BOOKS/dgt2d560/1.2.5?ACTION=MATCHES&REQUEST=bldvrp&TYPE=FUZZY&SHELF=DGT2BK90&DT=20090603114149&CASE=&searchTopic=TOPIC&searchText=TEXT&searchIndex=INDEX&rank=RANK&ScrollTOP=FIRSTHIT#FIRSTHIT]
z/OS V1R11.0 DFSMS Managing Catalogs Setting the Cat [http://publibz.boulder.ibm.com/cgi-bin/bookmgr_OS390/BOOKS/DGT2C170/CCONTENTS?SHELF=DGT2BK90&DN=SC26-7409-07&DT=20090520115420]




HISTORICAL NUMBER
 5022244