Title: IBM Error: DB connect failed: connectDBStart() -- connect() failed: Permission denied - United States

Text:
nzhost; permission; connectDBStart; connect() TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Permission denied for some nz commands after upgrade because of missing NZ_HOST environment variable 

SYMPTOM
[nonnzuser@nzhost ~]$ nzsession
Error: DB connect failed: connectDBStart() -- connect() failed:
Permission denied
Is the postmaster running locally
and accepting connections on Unix socket '/tmp/.s.PGSQL.5480'?.
[nonnzuser@nzhost~]$


CAUSE
NZ_HOST not set as an environment variable

ENVIRONMENT
[nonnzuser@nzhost~]$ nzrev
Release 7.2.1.2-P1 [Build 48187]
[nonnzuser@nzhost~]$

DIAGNOSING THE PROBLEM
Check environment variables


[nonnzuser@nzhost ~]$ env| grep NZ
NZ_PASSWORD=password
NZ_USER=admin
NZ_DATABASE=system

Confirm file mentioned in error message is owned by nz and has appropriate permissions:[nonnzuser@nzhost ~]$ ls -lah /tmp/.s.P*
srwx------ 1 nz nz 0 Jul 13 14:15 /tmp/.s.PGSQL.5480
-rw------- 1 nz nz 19 Jul 13 14:15 /tmp/.s.PGSQL.5480.lock
NZ_HOST variable did not need to be set on NPS 7.2.0.5-P2 but it is needed on NPS 7.2.1.2-P1



RESOLVING THE PROBLEM
A. Use -host option and specify <nzhost> with affected nz commands 

[nonnzuser@nzhost ~]$ nzsession -host nzhost
ID Type User Start Time PID Database Schema State Priority...
-------------------------------------------------------------------------------- 
115388 sql-odbc user 20-Jul-16, 05:56:41 EDT 12836 system admin idle normal ...
115425 sql-odbc user 20-Jul-16, 05:57:25 EDT 15186 system admin idle normal ... 

B. Export NZ_HOST for current session 

export NZ_HOST=<nzhost> 

C. Add export to .bashrc file in affected user's home directory 

1. - cd ~ 

2. - vi .bashrc 

3. - Add export NZ_HOST=<nzhost> using system hostname