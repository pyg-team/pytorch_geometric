Title: IBM Receive the message, "ERROR: Product maintenance level does not match profile" when running the Portal Health Check utility before applying CF15 - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM
While preparing to install CF15 on your existing Portal 8.0.0.1 CF09 you run the Portal Health Check utility and receive the following message:

>>> Test: Profile maintenance level
ERROR: Product maintenance level does not match profile.
Portal product = CF09 and profile = CF08
Portal product files and profile must be at the same maintenance
level before a new fix can be applied.

CAUSE
The previous CF upgrade was only a partial upgrade and only upgraded the binaries.

ENVIRONMENT
Portal 8001 

Linux


DIAGNOSING THE PROBLEM
Review of the IIM logs show that during the previous CF upgrade that IIM could 

not find the Portal profile and therefore only performed a binary
install of CF09...the Portal profile was never upgraded to CF09:

84 INFO 00:02.36 Appears to be a binary install. Checking
wps.properties.
85 INFO 00:02.36 No Portal profile found.
86 WARNING 00:02.36 A WebSphere Portal profile was not
detected. If you performed a binary installation and created a
WebSphere Portal profile later or if your profile was migrated from a
previous version, ensure that the
/opt/WebSphere/PortalServer80/wps.properties
file correctly references the profile. The Portal
update procedure uses the wps.properties file to determine which
profile is the primary profile to update. Failure to complete this step
could result in an inoperable Portal server after the update completes.
To update a profile, edit the wps.properties file in a
text editor and add the following two properties if they do not already
exist:
ProfileName=, for example: wp_profile
ProfileDirectory=, for example:
/opt/IBM/WebSphere/wp_profile.

To continue without updating a profile, click Next.


RESOLVING THE PROBLEM
Edit the /opt/WebSphere/PortalServer80/wps.properties 

like mentioned in the Error Message above and add the following:

ProfileName=<profile name>
ProfileDirectory=<profile directory>

Then follow the instructions below to upgrade the Portal profile to
CF09:

1) Ensure the WebSphere_Portal server is stopped on the profile you
intend to upgrade.

2) Execute the following ConfigEngine command to clear the ConfigEngine
registry:

Unix/Linux: <profile_root>/ConfigEngine/ConfigEngine.sh -uninstall
-offeringList PortalServer -unregisterOnly

3) Execute the following ConfigEngine command to repopulate the
ConfigEngine registry:

Unix/Linux: <profile_root>/ConfigEngine/ConfigEngine.sh -install
-offeringRoot portal_install_root -installPath portal_install_root
-expandBinaries false

where portal_install_root is your actual Portal Installation
root, for example /opt/IBM/WebSphere/PortalServer. Please Note: Do not
add a trailing '/' at the end of the path variable, portal_install_root.
Adding a '/' at the end will cause a misconfiguration that will
impact future Portal operations. Please use the syntax as shown in the
example provided.

4) Then execute the following ConfigEngine command to upgrade the
profile:

Unix/Linux: <profile_root>/ConfigEngine/ConfigEngine.sh
CONFIG-WP-PTF-CF -DPortalAdminPwd=<password> -DWasPassword=<password>


Important: if the CONFIG-WP-PTF-CF command fails for any reason, ensure
you stop the WebSphere_Portal server again before re-running


Once the Portal profile has been upgraded to CF09 then please attempt
to run the Health Checker again.