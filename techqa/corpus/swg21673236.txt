Title: IBM ITCAM Extended Agent for Oracle Database Versoin 6.3.1 FP2 and below version fails to start with ITM v6.3 on zLinux - United States

Text:
5724V09ORTR TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 ITCAM Extended Agent for Oracle Database (RZ) Versoin 6.3.1 FP2 and below version fails to start with ITM v6.3 on zLinux. 

SYMPTOM
krzagent fails to load GSKit v7 libraries. Error message: 

<install_dir>/ls3246/rz/bin/krzagent: error while loading shared libraries: libgsk7iccs_64.so: cannot open shared object file: No such file or directory.


CAUSE
ITM v6.3 introduces GSKit v8. RZ agent and ITM v6.3 installs different TEMA on zLinux - RZ agent uses TEMA ls3246 which is in old version and loads GSKit v7, while ITM v6.3 uses TEMA ls3266 which is in new version and loads GSKit v8. 

When ITM v6.3 is installed, it installs TEMA ls3266 in new version, and also installs GSKit v8 / or upgrade existing GSKit from v7 to v8. TEMA ls3246, which RZ agent uses, will not be upgraded by ITM v6.3, and krzagent will fail to start because TEMA ls3246 fails to find GSKit v7.

APAR IV59887 opened for this problem. 
http://eclient.lenexa.ibm.com:9082/search?fetch=source/APAR/IV59887 [http://eclient.lenexa.ibm.com:9082/search?fetch=source/APAR/IV59887]

The product inventory of LZ agent 06.30.02 + RZ agent 06.31.02:
----------------------------------------------
ax IBM Tivoli Monitoring Shared Libraries
ls3246 Version: 06.22.02.00
ls3266 Version: 06.30.02.00

gs IBM GSKit Security Interface
ls3263 Version: 08.00.50.01
ls3266 Version: 08.00.50.05

jr Tivoli Enterprise-supplied JRE
ls3246 Version: 05.12.01.00
ls3266 Version: 07.04.02.00

lz Monitoring Agent for Linux OS
ls3266 Version: 06.30.02.00

rz Monitoring Agent for Oracle Database Extended
ls3246 Version: 06.31.02.00

ui Tivoli Enterprise Services User Interface
ls3246 Version: 06.22.02.00
ls3266 Version: 06.30.02.00
----------------------------------------------


RESOLVING THE PROBLEM
ITM v6.3 does not provide TEMA ls3246 any more. In order to work with ITM 6.3, RZ agent need to be built & packaged with ls3266 instead of ls3246. The formal fix can only be included in the next fix pack or new release. 


Before formal fix being released, the workaround is forcing RZ agent use TEMA ls3266:

1) Change to /opt/IBM/ITM/tmaitm6/links/lnxzx6-l22-g32 directory
Modify lib link from
lib -> <install_dir>/tmaitm6/ls3246/lib
to
lib -> <install_dir>/tmaitm6/ls3266/lib

2) Add <install_dir>/tmaitm6/ls3266/lib at the beginning of LD_LIBRARY_PATH and LD_LIBRARY_PATH_64 in <install_dir>/config/rz.ini and <install_dir>/config/rz_<instance>.cfg

Take rz.ini as example:
LD_LIBRARY_PATH=<install_dir>/tmaitm6/ls3266/lib:$ICCRTE_DIR$/$GSKLIB$:$CANDLEHOME$/$BINARCH$/$PRODUCTCODE$/lib:$CANDLEHOME$/$ARCHITECTURE$/lib
LD_LIBRARY_PATH_64=<install_dir>/tmaitm6/ls3266/lib:$CANDLEHOME$/$BINARCH$/$PRODUCTCODE$/lib:$CANDLEHOME$/$ARCHITECTURE$/lib:$ICCRTE_DIR$/lib64

3) Start RZ agent.