Title: IBM Fixing Duplicate Files in QUSRSYS - United States

Text:
ADD; DIR; MSGMCH1803; MSGCPF5147; QAOK TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 This document describes basic steps used to clean up duplicate files or files with extensions in QUSRSYS or any other library. This process may not work for all files and is a general practice. 

RESOLVING THE PROBLEM
The following is a list of things to do to fix or clean up duplicate files without restoring QUSRSYS. It is recommended to have a good backup of QUSRSYS before starting cleanup. It is possible that restricted state may be needed to ensure there are no locks on the files in QUSRSYS when removing duplicate files. 

Note: This issue is user induced when someone has performed a RSTLIB with ALWOBJDIF(*ALL) specified. The user must determine the best method for cleaning up the duplicate files. Involving IBM in this requires a consulting or customized service agreement. For more information about having this work done under a customized service agreement, refer to the following document:

N1021786: IBMi Customized Services [http://www-01.ibm.com/support/docview.wss?uid=nas8N1021786]
http://www.ibm.com/support/docview.wss?uid=nas8N1021786 [http://www.ibm.com/support/docview.wss?uid=nas8N1021786]

The WRKF command can be used to display and manipulate the needed files.

You should do the following: 

1. Make a list of the logical files and what physical files they point to. 2. Look at the physical files and determine which ones have data. Make a note of those files. 3. If you have a good logical file pointing to a good physical file, there is no need to do anything. 4. If you have a good logical file pointing to a wrong physical file, you should do the following: 

o If the wrong physical file contains the data, delete the correct named file, and rename the wrong file to the correct file name (the logical file will follow the rename).

o If the correct physical contains the data, type CLRPFM on the wrong file. Then copy the file of the correct physical file to the wrong physical file with the CPYF command. Delete the correct physical file, and rename the wrong physical file to the correct physical file name. 5. If you have a wrong logical file pointing to a good physical file, make a backup of a good logical file, delete the correctly named logical file, rename the wrong logical file to the correct name, and correct the description. 6. If you have a wrong logical file pointing to a wrong physical file, delete both files. This takes time because you must chart out what the problems are. 

You can use the DSPDBR command on a physical file to see what logical file is attached to it. 

Notes: 
1. If there are duplicates of QAOK* files in QUSRSYS, refer to technote N1018142, QMSF Jobs Fail with a CPI9A9C Errors with QAOK* Files [http://www-01.ibm.com/support/docview.wss?uid=nas8N1018142]. 
2. N1021786: IBMi Customized Services [http://www-01.ibm.com/support/docview.wss?uid=nas8N1021786] 
This document provides information on how to request IBM i customized service, for assistance with items outside the scope of the SWMA agreement. 


Cross reference information Segment Product Component Platform Version Edition Operating System IBM i 7.2 Operating System IBM i 7.1 Operating System IBM i 6.1 Operating System IBM i 7.3 
HISTORICAL NUMBER
 25785844