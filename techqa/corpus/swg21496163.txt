Title: IBM ITDS 6.2 Fix Pack 3 - install instructions for TNPMW 9.2 and TNPM 1.2.1 / 1.3 / 1.3.1 - United States

Text:
TNPMW TNPM TDS DB2 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Installation instructions for ITDS 6.2 Fix Pack 3. 
This is valid for TNPMW 9.2 and TNPM 1.2.1 / 1.3 / 1.3.1 . 

RESOLVING THE PROBLEM
 

Problem Description: [/support/docview.wss?uid=swg21496163&amp;aid=1] TNPMW 9.2 and TNPM 1.2.1 bundle IBM TivoliÂ® Directory Server (ITDS) 6.2. 

TNPM (Wireless Component) 1.3.1 links to ITDS 6.2 Fix Pack 1 IF 4. 

It is recommended for customers on TNPM (Wireless Component) 9.2, 1.2.1, 1.3, 1.3.1 to upgrade to ITDS 6.2 Fix Pack 3. 

Note this Fix Pack 3 cannot be installed on a new system. It is only suitable as an upgrade installation on the base version 6.2. Install Instructions: ITDS 6.2 Fix Pack 3 install instructions for TNPM (Wireless Component) Before you start this installation, if you are installing on a global zone on Solaris see additional instructions in Appendix A below. 1. Download the fixpack from the following location: ITDS 6.3 Fix Pack 3 [https://www-304.ibm.com/support/docview.wss?uid=swg24028924] . Select the relevant for download package. Copy the file onto the TNPM server. 

2. Export the LDAP data to a file. This will be required if the fixpack needs to be uninstalled. Run the following command as root: 

 

/opt/IBM/ldap/V6.2/sbin/idsdb2ldif -o <path>/export.ldif -s <ldaproot> <path>is the directory where the export file will be generated and <ldaproot> is the root of the LDAP directory. The value of <ldaproot>can be checked by running the following command as virtuo: 

 

conf_read ldap default | grep java.naming.provider.url | awk -F"/" '{ print $NF }' 3. Stop all PMW processes as user virtuo: 

sap stop 4. Shutdown TDS as root 

On SOLARIS 

svcadm disable tds-na On Linux service tdsna stop 5. Check that TDS has been disabled as root: 

On SOLARIS 

svcs tds-na On Linux service tdsna status 6. Install the 6.2 Fix Pack 3 patch using the install directions included in the patch README. 

 

7. Restart TDS as root: 

On SOLARIS 

svcadm enable tds-na On Linux service tdsna start 8. Check that TDS starts correctly as root: 

On SOLARIS 

svcs tds-na On Linux service tdsna status Startup and status check of virtuo services : 8. Start the PMW applications as virtuo: sap start 9. Check the status of the TNPMW applications as virtuo: 

sap disp Uninstalling the fixpack Uninstalling the fix uninstalls IBM Tivoli Directory Server 6.2 along with the fix. You must then reinstall IBM Tivoli Directory Server 6.2 to return to the previous level. Your configuration files and instances are left intact. 

[/support/docview.wss?uid=swg21496163&amp;aid=1] 1. Stop all the applications as virtuo:  

sap stop 2. Shutdown TDS as root 

On SOLARIS 

svcadm disable tds-na On Linux service tdsna stop 3. Check that TDS has been disabled as root: 

On SOLARIS 

svcs tds-na On Linux service tdsna status 4. Uninstall TDS/DB2 using the tds_install script as root: 

 

/var/install/sbin/tds_install -base /appl -product virtuo -remove 5. Re-install TDS/DB2 using the tds_install script as root: 

 

/var/install/sbin/tds_install -base /appl -product virtuo -version 6.2 6. When prompted, provide the location of the TDS, DB2 and Gskit distributions, and the password for the idsinst user. 

7. Re-create the directory server schema by running the create_ds_schema command as virtuo: 

 

$WMCROOT/admin/ds/bin/create_ds_schema Respond to the prompts as requested. 

8. Import the Directory Server data which was exported prior to installing the fixpack. 

a. As the root user, edit the exported .ldif file and remove the cn=crypto entry from the start of the file. This entry looks like the following: 

 

dn: cn=crypto,cn=localhost cn: crypto 

objectclass: ibm-cryptoConfig 

objectclass: ibm-slapdConfigEntry 

objectclass: top 

ibm-slapdCryptoSync: DEL/CWHBvUluHXP+ 

ibm-slapdCryptoSalt: fwPL)3"ts:0D 

ibm-entryuuid: 0930b640-a362-102e-95bc-8139eb7c4647

Remove all of these lines from the file. 

b. As root, ensure the virtuo user has read permissions on the file: 

 

chmod 644 <export_file> c. Then import the modified file as virtuo: 

 

ldapmodify -c -a -k -D "cn=Directory Manager" -w <password> -p 1389 -h <hostname> -i <export_file> - <password> is the password for the LDAP "Directory Manager" user 

- <hostname> is the hostname of the TNPMW server 

- <export_file> is the path to the LDAP data export file. 

9. Start the PMW applications as virtuo: 

 

sap start 10. Check the status of the TNPMW applications as virtuo: 

 

sap disp See the Fix Pack 3 patch README section "Uninstalling the fix" for further details. 


Appendix A Installing on a global zone on Solaris Before you start this installation, please follow the additional instructions below if you are installing on a global zone on Solaris.
When installing the default ITDS Fix Pack IF 4 on a global zone on Solaris, you will get the following error:

Error - Failed to install pkg=./images/idsldap.webadmin62.pkg 
Error - At least one package failed to install! 

To avoid this error when installing on a global zone, follow the patch install steps as described until the idsinstall command. Before running the idsinstall command (Install Step 5), do the following steps.

1. Backup the idsinstall script.
cp idsinstall idsinstall.backup

2. Run the following command to update the pkgadd command in the script.

sed "s%pkgadd -n%pkgadd -n -G%g" idsinstall > idsinstall.new

3. Diff the new and original files to check that the correct updates have been made.

diff idsinstall idsinstall.new

The output should be similar to the following:

287c287
< echo "Installing using command: pkgadd -n -a ${EXISTMODEADMINFILE} -d ${pf_installpkg} " \
---
> echo "Installing using command: pkgadd -n -G -a ${EXISTMODEADMINFILE} -d ${pf_installpkg} " \
289c289
< pkgadd -n -a ${EXISTMODEADMINFILE} -d ${pf_installpkg} 2>${IDSTEMPLOGFILE} 1>${IDSTEMPLOGFILE2} <<EOF
---
> pkgadd -n -G -a ${EXISTMODEADMINFILE} -d ${pf_installpkg} 2>${IDSTEMPLOGFILE} 1>${IDSTEMPLOGFILE2} <<EOF
315c315
< echo "Installing using command: pkgadd -n -a ${CLEANMODEADMINFILE} -d ${pf_installpkg} " \
---
> echo "Installing using command: pkgadd -n -G -a ${CLEANMODEADMINFILE} -d ${pf_installpkg} " \
317c317
< pkgadd -n -a ${CLEANMODEADMINFILE} -d ${pf_installpkg} 2>${IDSTEMPLOGFILE} 1>${IDSTEMPLOGFILE2} <<EOF
---
> pkgadd -n -G -a ${CLEANMODEADMINFILE} -d ${pf_installpkg} 2>${IDSTEMPLOGFILE} 1>${IDSTEMPLOGFILE2} <<EOF
358c358
< echo "Installing using command: pkgadd -n -a ${EXISTMODEADMINFILE} -d ${pu_installpkg} " \
---
> echo "Installing using command: pkgadd -n -G -a ${EXISTMODEADMINFILE} -d ${pu_installpkg} " \
360c360
< pkgadd -n -a ${EXISTMODEADMINFILE} -d ${pu_installpkg} 2>${IDSTEMPLOGFILE} 1>${IDSTEMPLOGFILE2} <<EOF
---
> pkgadd -n -G -a ${EXISTMODEADMINFILE} -d ${pu_installpkg} 2>${IDSTEMPLOGFILE} 1>${IDSTEMPLOGFILE2} <<EOF

4. Replace the original idsinstall script with the new one:

mv idsinstall.new idsinstall

5. Ensure the idsinstall script is executable:

chmod 754 idsinstall

6. Run the idsinstall command as root to install the Fix Pack 3 patch:

./idsinstall -u -f 






PRODUCT ALIAS/SYNONYM
 TNPMW TNPM