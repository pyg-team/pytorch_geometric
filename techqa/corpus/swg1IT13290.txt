Title: IBM IT13290: FILEOUTPUT NODE WITH REMOTE TRANSFER OPTION CAN RESULT IN A DEADLOCK SITUATION - United States

Text:
 SUBSCRIBE TO THIS APAR
By subscribing, you receive periodic emails alerting you to the status of the APAR, along with a link to the fix after it becomes available. You can track this item individually or track all items by product.

Notify me when this APAR changes.

Notify me when an APAR for this component changes.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  APAR IT10092 [http://www-01.ibm.com/support/docview.wss?uid=swg1IT10092] (FLOW HANGS DUE TO DEADLOCK IN FILEOUTPUT NODE)
   introduced a fix for a Java deadlock condition from the
   FileOutput node, however this fix does not fix all possible
   deadlock conditions. A FileOutput node with FTP/SFTP transport
   can still result in a java deadlock condition which causes the
   message flow to hang.
   
   A javacore shows the deadlock condition with following thread
   call stacks.
   
   3XMTHREADINFO      "Thread-47" J9VMThread:0x0000000013CD3800,
   j9thread_t:0x00007F22DC1A29B0,
   java/lang/Thread:0x000000000633B488, state:B, prio=5
   3XMJAVALTHREAD            (java/lang/Thread getId:0x3C,
   isDaemon:false)
   3XMTHREADINFO1            (native thread ID:0x14F6, native
   priority:0x5, native policy:UNKNOWN)
   3XMTHREADINFO2            (native stack address range
   from:0x00007F22C9BC5000, to:0x00007F22C9D46000, size:0x181000)
   3XMCPUTIME               CPU usage total: 0.919038587 secs
   3XMTHREADBLOCK     Blocked on:
   com/ibm/broker/flowgroupfiles/FlowGroupFilePool@0x00000000038AA5
   E0 Owned by: "FlowGroupFilePool file close daemon"
   (J9VMThread:0x000000001369E600,
   java/lang/Thread:0x00000000038A9EA0)
   3XMHEAPALLOC             Heap bytes allocated since last GC
   cycle=0 (0x0)
   3XMTHREADINFO3           Java callstack:
   4XESTACKTRACE                at
   com/ibm/broker/flowgroupfiles/FlowGroupFile.basicClose(FlowGroup
   File.java:362)
   5XESTACKTRACE                   (entered lock:
   com/ibm/broker/flowgroupfiles/FlowGroupFile@0x00000000129087D0,
   entry count: 1)
   4XESTACKTRACE                at
   com/ibm/broker/flowgroupfiles/FlowGroupFilePool.getJavaInputStre
   am(FlowGroupFilePool.java:406)
   4XESTACKTRACE                at
   com/ibm/broker/nodes/filenodes/AbstractFileOutputNode.transferTo
   RemoteServer(AbstractFileOutputNode.java:662)
   
   
   3XMTHREADINFO      "FlowGroupFilePool file close daemon"
   J9VMThread:0x000000001369E600, j9thread_t:0x00007F22E4234C10,
   java/lang/Thread:0x00000000038A9EA0, state:B, prio=5
   3XMJAVALTHREAD            (java/lang/Thread getId:0x12,
   isDaemon:true)
   3XMTHREADINFO1            (native thread ID:0x14CD, native
   priority:0x5, native policy:UNKNOWN)
   3XMTHREADINFO2            (native stack address range
   from:0x00007F22CD2FB000, to:0x00007F22CD3FC000, size:0x101000)
   3XMCPUTIME               CPU usage total: 0.020109576 secs
   3XMTHREADBLOCK     Blocked on:
   com/ibm/broker/flowgroupfiles/FlowGroupFile@0x00000000129087D0
   Owned by: "Thread-47" (J9VMThread:0x0000000013CD3800,
   java/lang/Thread:0x000000000633B488)
   3XMHEAPALLOC             Heap bytes allocated since last GC
   cycle=0 (0x0)
   3XMTHREADINFO3           Java callstack:
   4XESTACKTRACE                at
   com/ibm/broker/flowgroupfiles/FlowGroupFilePool.tryToReap(FlowGr
   oupFilePool.java:623)
   5XESTACKTRACE                   (entered lock:
   com/ibm/broker/flowgroupfiles/FlowGroupFilePool@0x00000000038AA5
   E0, entry count: 1)
   4XESTACKTRACE                at
   com/ibm/broker/flowgroupfiles/FlowGroupFilePool.run(FlowGroupFil
   ePool.java:575)
   4XESTACKTRACE                at
   java/lang/Thread.run(Thread.java:795)
   
   
    
   
   

LOCAL FIX
 *  N
   
   
    
   
   

PROBLEM SUMMARY
 *  ****************************************************************
   USERS AFFECTED:
   All users of IBM Integration Bus V9.0.0.3 and above and V10.0
   using the FileOutput node with the FTP or SFTP transport
   protocols.
   
   
   Platforms affected:
   z/OS, MultiPlatform
   
   ****************************************************************
   PROBLEM DESCRIPTION:
   APAR IT10092 [http://www-01.ibm.com/support/docview.wss?uid=swg1IT10092] (FLOW HANGS DUE TO DEADLOCK IN FILEOUTPUT NODE)
   introduced a fix for a Java deadlock condition in the FileOutput
   node, however it did not fix all possible deadlock conditions. A
   FileOutput node with FTP/SFTP transport can still results in a
   java deadlock condition causing the message flow to hang.
   
   
   There are a number of resource name changes between WebSphere
   Message Broker and IBM Integration Bus Version 9.0.  For details
   visit
   http://pic.dhe.ibm.com/infocenter/wmbhelp/v9r0m0/topic/com.ibm.e
   tools.mft.doc/bb23814_.htm [http://pic.dhe.ibm.com/infocenter/wmbhelp/v9r0m0/topic/com.ibm.etools.mft.doc/bb23814_.htm]
   
   
    
   
   

PROBLEM CONCLUSION
 *  The product no longer results in a java deadlock condition from
   the FileOutput Node.
   
   ---------------------------------------------------------------
   The fix is targeted for delivery in the following PTFs:
   
   Version    Maintenance Level
   v9.0       9.0.0.6
   v10.0      10.0.0.5
   
   The latest available maintenance can be obtained from:
   http://www-01.ibm.com/support/docview.wss?rs=849&uid=swg27006041 [http://www-01.ibm.com/support/docview.wss?rs=849&uid=swg27006041]
   
   If the maintenance level is not yet available,information on
   its planned availability can be found on:
   http://www-1.ibm.com/support/docview.wss?rs=849&uid=swg27006308 [http://www-1.ibm.com/support/docview.wss?rs=849&uid=swg27006308]
   ---------------------------------------------------------------
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IT13290
   
   
 * REPORTED COMPONENT NAME
   INTEGRATION BUS
   
   
 * REPORTED COMPONENT ID
   5724J0530
   
   
 * REPORTED RELEASE
   900
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt / Xsystem
   
   
 * SUBMITTED DATE
   2016-01-21
   
   
 * CLOSED DATE
   2016-05-24
   
   
 * LAST MODIFIED DATE
   2016-05-27
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   INTEGRATION BUS
   
   
 * FIXED COMPONENT ID
   5724J0530
   
   

APPLICABLE COMPONENT LEVELS
 * R900 PSY
   UP