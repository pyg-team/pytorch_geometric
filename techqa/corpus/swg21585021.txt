Title: IBM "FetchComment ... (0x800A005B): Object variable..." error when restricted user runs Excel report which retreives comments - United States

Text:
FetchComment 0x800A005B TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 User tries to run an Excel-based report which contains formulae which retrieves comments. User clicks 'preview'. User receives error message.
After clicking OK (to acknowledge the error) Controller correctly shows the report but *without* the comments. 

SYMPTOM
Screen: 

Information
Standard Error
Number: 5
Source: FrangoDirect.ExcelLinkD.FetchComment#ControllerProxyClient
Desctription: System.Web.Services.Protocols.SoapException: Server was unable to process request. --->
System.Runtime.InteropServices.COMException (0x800A005B): Object variable or With block variable not set
at FrExcelLinkB.ExcelLinkBClass.FetchComment(String sGuid, ....
<....>
[OK]

Event Viewer (Application Log)
Event Type: Warning
Event Source: Cognos Controller
Event Category: None
Event ID: 0
Date: 20/02/2012
Time: 10:34:02
User: N/A
Computer: SERVERNAME
Description:
Standard Error
Number: 5
Source: FrangoDirect.ExcelLinkD.FetchComment#ControllerProxyClient
Description: System.Web.Services.Protocols.SoapException: Server was unable to process request. ---> System.Runtime.InteropServices.COMException (0x800A005B): Object variable or With block variable not set
at FrExcelLinkB.ExcelLinkBClass.FetchComment(String sGuid, String sUser, Object nBit, Recordset rsKeys)
at Cognos.Controller.Proxy.CCRWS.ExcelLinkB_FetchComment(String sGuid, String sUser, Object nBit, DataSet rsKeys)
--- End of inner exception stack trace ---
at Microsoft.VisualBasic.ErrObject.Raise(Int32 Number, Object Source, Object Description, Object HelpFile, Object HelpContext)
at Cognos.Controller.Common.RaiseErrCli.RaiseError(Int32 lErrNo, String sErrSource, String sErrDesc, String sErrHelpFile, Int32 lErrHelpContext)
at Cognos.Controller.Direct.ExcelLinkD.FetchComment(DataSet rsKeys, Int32 nBit)
at Cognos.Controller.Reports.ExcelLink.FetchComment()

Event Type: Warning
Event Source: Cognos Controller
Event Category: None
Event ID: 0
Date: 20/02/2012
Time: 10:34:02
User: N/A
Computer: SERVERNAME
Description:
Error occured at 2/20/2012 10:34:02 AM in 2007 Microsoft Office system, Error No=5, Source=FrangoDirect.ExcelLinkD.FetchComment#ControllerProxyClient, Description=System.Web.Services.Protocols.SoapException: Server was unable to process request. ---> System.Runtime.InteropServices.COMException (0x800A005B): Object variable or With block variable not set
at FrExcelLinkB.ExcelLinkBClass.FetchComment(String sGuid, String sUser, Object nBit, Recordset rsKeys)
at Cognos.Controller.Proxy.CCRWS.ExcelLinkB_FetchComment(String sGuid, String sUser, Object nBit, DataSet rsKeys)
--- End of inner exception stack trace ---

CAUSE
Code production issue (APAR PM59448) in Controller 10.1. 

 
The problem is only triggered when the user is configured to be inside a group which has restrictions to the companies. 

 * In other words, the user can only see a limited number of companies.

RESOLVING THE PROBLEM
Fix: 

Upgrade to Controller 10.1.1 (10.1.1305) or later. 

 

Workaround: 

There are several different workarounds: 

 * Ignore the error - simply click OK to see the report (but without the comments) 
 * Remove company restrictions from the 'bad' user(s) 
 * Modify the 'bad' reports so that they do not retrieve the comments 
 * RECOMMENDED: Modify the file "...\server\excluded_methods.conf" on the application server, to add the line: FrExcelLinkB.ExcelLinkB.FetchComment


 * 
 * Steps
 * 
 * excluded_methods.conf
 * 
 *  Logon to the Controller application server as a Windows administrator Navigate to the "...\c10\server" folder. TIP: By default, this is located here: C:\Program Files (x86)\IBM\cognos\c10\server Open the file "excluded_methods.conf" inside NOTEPAD.EXE Add the line "FrExcelLinkB.ExcelLinkB.FetchComment " Save and close. 
 * 

RELATED INFORMATION
#APAR PM59448 [http://www-01.ibm.com/support/docview.wss?uid=swg1PM59448]