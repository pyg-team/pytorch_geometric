Title: IBM QRadar: Finding files that use the most disk space (Updated) - United States

Text:
disk usage; full; partition; QRadar; find disk space; disk usage; verify free space; security; QRadar SIEM; event processor; Data Node; Event Collector TECHNOTE (FAQ)

QUESTION
 How can you quickly find which files are using the most disk space on QRadar?



ANSWER
There can be times where you see that a partition is running out of space or is growing very rapidly. It is important to identify which file or files are taking up the most space to help identify the issue and address it. To find which files are using the most space, follow these instructions:

Important: While these instructions can find the largest file, the large file should not be removed unless you have been instructed by Support. Contact Technical Support [http://ibm.biz/qradarsupport] for guidance on dealing with the largest file.


 1. Using SSH, log in to the QRadar Console using the root credentials.
    
 2. Optional. To check disk space on a managed host, open an SSH session from the Console appliance to the managed host
    
 3. Run the following command to see the amount of disk space available on each file system and identify any space issues:
    df -h
    
 4. Based on the partition with space problems, use the partition path and run the following command in order to list and sort files from most space that is used to least space used:
    find /partition/with_space_issues/ -type f -ls | sort -k 7 -r -n | head -20
    Example: To find the largest files on /var/log, run the following: find /var/log -type f -ls | sort -k 7 -r -n | head -20
    [/support/docview.wss?uid=swg21988496&aid=1] [/support/docview.wss?uid=swg21988496&aid=1]
    Here you can see that /var/log/qradar.log is consuming 29,722,776 bytes (or 29,026 KB, taken from the seventh column) and is the largest file found.



Other useful disk space commands: 
 1. To check disk usage on all managed hosts: /opt/qradar/support/all_servers.sh -C "df -Th"
    
 2. To find which directories, excluding the store partition, use the most amount of disk space: du -sh /* --exclude=store | sort -h 
 3. To list all files in a given directory equal to or greater than a given size: find /your_directory -xdev -type f -size +500MB
    
    Example 1: List files in the root directory greater than 100MB: find / -xdev -type f -size +100M
    Example 2: List files in the /var/log/ director greater than 50MB: find /var/log/ -xdev -type f -size +50M
    
    
 4. Find the largest files in a directory and sort in descending order:
    find /your_directory/ -xdev -type f -size +100MB -exec du -sh {} ';' | sort -rh | head -n 
    
    Examples:
    find /var/log/ -xdev -type f -size +100M -exec du -sh {} ';' | sort -rh | head -n50
    find / -xdev -type f -size +100M -exec du -sh {} ';' | sort -rh | head -n50
    find /store/ -xdev -type f -size +100M -exec du -sh {} ';' | sort -rh | head -n50


Viewing top level directories by disk space usage 
Another option for administrators is to view what top level directories in QRadar are using the most disk space. 
 1. Using SSH, log in to the Console as the root user. 
 2. Using SSH, open a session to a managed host. 
 3. Type the following command: du -Pshx /* 2>/dev/null
    
    This command lists top level directories and disk usage. 
    [/support/docview.wss?uid=swg21988496&aid=2] [/support/docview.wss?uid=swg21988496&aid=2]




-----
Where do I find more information?
If you have additional questions or some of this content is not clear, you can see the QRadar forum or contact customer support: 

 * Online QRadar Customer Forums [https://ibm.biz/BdR2kC] 
 * Submit and manage your support tickets online 24x7 using IBM Service Request [http://www.ibm.com/software/support/servicerequest/quick_start.html] 
 * QRadar Downloads - IBM Fix Central [http://www.ibm.com/support/fixcentral/options?selection=Security+Systems;ibm/Other+software/IBM+Security+QRadar+SIEM]