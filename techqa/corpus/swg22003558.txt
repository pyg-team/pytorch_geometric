Title: IBM Security Bulletin: IBM Tivoli Access Manager for e-business and IBM Security Access Manager for Web software releases are affected by a vulnerability known as the SWEET32 Birthday attack (CVE-2016-2183) - United States

Text:
 SECURITY BULLETIN

SUMMARY
 The IBM Tivoli Access Manager for e-business and IBM Security Access Manager for Web software releases are affected by the SWEET32 Birthday attack vulnerability, which could allow an attacker to obtain sensitive information. 

VULNERABILITY DETAILS
CVEID: CVE-2016-2183 [http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-2183]
DESCRIPTION: OpenSSL could allow a remote attacker to obtain sensitive information, caused by an error in the DES/3DES cipher, used as a part of the SSL/TLS protocol. By capturing large amounts of encrypted traffic between the SSL/TLS server and the client, a remote attacker able to conduct a man-in-the-middle attack could exploit this vulnerability to recover the plaintext data and obtain sensitive information. This vulnerability is known as the SWEET32 Birthday attack.
CVSS Base Score: 3.7
CVSS Temporal Score: See https://exchange.xforce.ibmcloud.com/vulnerabilities/116337 [https://exchange.xforce.ibmcloud.com/vulnerabilities/116337] for the current score
CVSS Environmental Score*: Undefined
CVSS Vector: (CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N) 

AFFECTED PRODUCTS AND VERSIONS
IBM Tivoli Access Manager for e-business version 6.1 

IBM Tivoli Access Manager for e-business version 6.1.1 

IBM Security Access Manager for Web version 7 software

REMEDIATION/FIXES
 

Product VRMF APAR Remediation IBM Security Access Manager for Web 7.0 (software) IV93303 Apply Interim Fix 30: 
7.0.0-ISS-SAM-IF0030 [http://www-933.ibm.com/support/fixcentral/swg/selectFixes?parent=Security%2BSystems&product=ibm/Tivoli/Tivoli+Access+Manager+for+e-business&release=7.0.0&platform=All&function=all] 
For IBM Tivoli Access Manager version 6.1.1 and 6.1, IBM recommends either upgrading to the fixed IBM Security Access Manager version 7 release above, or refer to the mitigation steps in the following section to protect against this vulnerability. 

For IBM Security Access Manager 7.0 software environments, you can apply the interim fix above to protect against this vulnerability. Alternatively, you can follow the manual mitigation steps described for ISAM 7 environments in the following section. 

For IBM Tivoli Access Manager for e-business 6.0, IBM recommends upgrading to a supported release of the product. WORKAROUNDS AND MITIGATIONS
The Sweet32 Birthday vulnerability only affects Triple DES Ciphers. Specifically, it affects the following ciphers:
- TLS_RSA_WITH_3DES_EDE_CBC_SHA
- TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA
- TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA
In the reverse proxy configuration file, these ciphers are collectively known as DES-168.

The Sweet32 Birthday vulnerability only comes into effect when one of the DES-168 ciphers is used and more than 32G data is sent over a single connection. If single connections are not transferring more than 32G of data (or not using one of above ciphers) then no action is required.

Otherwise, DES-168 ciphers need to be disabled to prevent exposure to Sweet32 Birthday attacks.

Disabling DES-168

Check whether your Access Manager Runtime configuration includes either of the following settings:
- FIPS mode is enabled (versions 6.1, 6.1.1, 7.0), or 
- The SSL compliance setting (ISAM 7 only) is set to either NSA Suite B 128 or NSA Suite B 192 

If so, you must check that 'SSL Quality of Protection management' either isn't enabled or doesn't allow DES-168 ciphers in each of the reverse proxy configuration files.

The Access Manager Runtime configuration is stored in pd.conf. On Unix/Linux systems, this configuration file is located at /opt/PolicyDirector/etc/pd.conf. On Windows, this configuration file is located at <isam installdir>\PolicyDirector\etc\pd.conf. 

In TAMeb 6.1 and 6.1.1 environments, you can check the FIPS mode enabled setting, ssl-enable-fips, in the Runtime configuration file:

ssl-enable-fips = yes

In IBM Security Access Manager 7.0 software environments, you can check whether the ssl-compliance setting has been set to either FIPS, suite-b-128 or suite-b-192:

ssl-compliance = fips
or 
ssl-compliance = suite-b-128
or 
ssl-compliance = suite-b-192

If you have FIPS mode enabled (versions 6.1, 6.1.1 and 7.0) or one of the above ssl-compliance settings in an ISAM 7 software environment, you must ensure that the 'SSL Quality of Protection management' is either disabled or doesn't allow DES-168 ciphers. 

In all other environments (with FIPS and NSA Suite B disabled), make sure 'SSL Quality of Protection management' is enabled and doesn't enable DES-168 ciphers in each of the reverse proxy configuration files.

The 'SSL Quality of Protection management' setting is located in the WebSEAL configuration file (webseald-<instance>.conf).

[ssl-qop]
ssl-qop-mgmt = yes

If ssl-qop-mgmt is enabled (ssl-qop-mgmt = yes) then the allowed ciphers and the order in which the ciphers will be negotiated are specified in the [ssl-qop-mgmt-default] stanza. 

Make sure that Triple DES (both DES-168 and FIPS-DES-168) are not in the list of allowed ciphers. 
Note: The order of ciphers in the list is the order in which the ciphers will be negotiated.

Remove the *DES* ciphers from the [ssl-qop-mgmt-default] stanza.
For example:
Before
[ssl-qop-mgmt-default]
default = AES-128
default = DES-168
default = FIPS-DES-168
default = AES-256

After
[ssl-qop-mgmt-default]
default = AES-128
default = AES-256

You must also update the [ssl] cipher specs for the Policy Server (in ivmgrd.conf) and Authorization Servers (in <instance>-ivacld.conf)

Update the following entries in the [ssl] stanza to include only acceptable ciphers.

[ssl]
tls-v12-cipher-specs
tls-v11-cipher-specs
tls-v10-cipher-specs
ssl-v3-cipher-specs (if using SSLv3 which is not recommended*)

*Note: The use of SSLv3 is not recommended due to known vulnerabilities. See http://www-01.ibm.com/support/docview.wss?uid=swg21691605 [http://www-01.ibm.com/support/docview.wss?uid=swg21691605]. 

TLS v1.2

The SSL TLS v1.2 ciphers affected by the Sweet32 birthday vulnerability are TLS_RSA_WITH_3DES_EDE_CBC_SHA, TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA and TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA 

If ssl-compliance is either NSA Suite B 128 or NSA Suite B 192 then the above ciphers are disabled.

Otherwise, you need to ensure that they are not included in the configured list of TLS v1.2 cipher specs. 

For example, set:
tls-v12-cipher-specs = TLS_RSA_WITH_AES_128_GCM_SHA256, TLS_RSA_WITH_AES_256_GCM_SHA384, TLS_RSA_WITH_AES_128_CBC_SHA256, TLS_RSA_WITH_AES_256_CBC_SHA256, TLS_RSA_WITH_AES_128_CBC_SHA, TLS_RSA_WITH_AES_256_CBC_SHA, TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA, TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA, TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256, TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384, TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256, TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384, TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256, TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384, TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256, TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 
Note: The Suite B Allowed TLSV12 CipherSpecs are TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 and TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384

TLS v1.1

The TLS v1.1 cipher affected by the Sweet32 birthday vulnerability is TLS_RSA_WITH_3DES_EDE_CBC_SHA.
To disable this cipher, ensure it does not appear in the configured list of TLS v1.1 cipher specs. 
For example, set:
tls-v11-cipher-specs = TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA

TLS v1.0

The TLS v1.0 cipher affected by the Sweet32 birthday vulnerability is TLS_RSA_WITH_3DES_EDE_CBC_SHA. 
To disable this cipher, ensure it does not appear in the configured list of TLS v1.0 cipher specs.
For example, set:
tls-v10-cipher-specs = TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA

SSLv3
The SSL v3 cipher affected by the Sweet32 birthday vulnerability is TLS_RSA_WITH_3DES_EDE_CBC_SHA

To disable this cipher, ensure that it does not appear in the configured list of SSLv3 ciphers, as specified by the ssl-v3-cipher-specs configuration entry. Note however that the use of SSLv3 and the associated ssl-v3-cipher-specs configuration entry is not recommended due to other known vulnerabilities such as POODLE. 

GET NOTIFIED ABOUT FUTURE SECURITY BULLETINS
 Subscribe to My Notifications [ http://www-01.ibm.com/software/support/einfo.html] to be notified of important product support alerts like this. 

REFERENCES
Complete CVSS v3 Guide [http://www.first.org/cvss/user-guide] 
On-line Calculator v3 [http://www.first.org/cvss/calculator/3.0] 

RELATED INFORMATION
IBM Secure Engineering Web Portal [http://www.ibm.com/security/secure-engineering/bulletins.html] 
IBM Product Security Incident Response Blog [http://www.ibm.com/blogs/psirt] 

CHANGE HISTORY
 24 May 2017: Original version published. 

*The CVSS Environment Score is customer environment specific and will ultimately impact the Overall CVSS Score. Customers can evaluate the impact of this vulnerability in their environments by accessing the links in the Reference section of this Security Bulletin. 

DISCLAIMER
According to the Forum of Incident Response and Security Teams (FIRST), the Common Vulnerability Scoring System (CVSS) is an "industry open standard designed to convey vulnerability severity and help to determine urgency and priority of response." IBM PROVIDES THE CVSS SCORES "AS IS" WITHOUT WARRANTY OF ANY KIND, INCLUDING THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. CUSTOMERS ARE RESPONSIBLE FOR ASSESSING THE IMPACT OF ANY ACTUAL OR POTENTIAL SECURITY VULNERABILITY.