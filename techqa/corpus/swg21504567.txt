Title: IBM Troubleshooting People Finder user photo display - United States

Text:
People Finder; photo; user photo; LDAP; Person Card; Profile; Organization; admin portlet; jpegPhoto; imageServlet TECHNOTE (TROUBLESHOOTING)

PROBLEM
The user photo is not displayed in the People Finder portlet.

DIAGNOSING THE PROBLEM
The People Finder portlet can be configured to display a user's photo stored in the repository, typically an LDAP. You successfully search for a user in the People Finder portlet but the photo is not displayed in any view.

RESOLVING THE PROBLEM
To display the photo, both uid and the user's e-mail address as well as the binary photo must be successfully retrieved from the repository. 

People Finder uses the Portal PUMA (Portal User Management Architecture) component to retrieve attributes. Attributes can be mapped in the Portal Virtual Member Manager (VMM) configuration if required.

For Microsoft Active Directory (MSAD), VMM (WebSphere Virtual Member Manager) maps "sAMAccountName" to "uid" so no attribute mapping should be required.

Domino LDAP has its own mapping from ShortName to uid. If a user's ShortName is not populated, the photo may not display for that person, even if the photo is available in the Domino LDAP.

For all supported LDAP types, VMM maps the attribute "mail" to "ibm-primaryEmail", and People Finder uses "ibm-primaryEmail." If the LDAP e-mail attribute is not "mail" map ibm-primaryEmail to the actual attribute used for the e-mail address.

The binary photo attribute People Finder will query by default is jpegPhoto. If you use a different photo attribute, add and map the photo attribute in the Portal as required.

For more information on adding and mapping attributes in WebSphere Portal refer to the links in the Related information section of this technote.

If the photo is not shown in the People Finder portlet, troubleshoot as follows:

1. Use ldapsearch to return the user's attributes. The example below shows a simple anonymous search. Partial results are shown. 

Note that the binary photo itself is not returned but the attribute is returned which indicates the user does have jpegPhoto defined.

> ldapsearch -h <LDAP hostname> -p 389 uid=wpsadmin

cn=wpsadmin
displayname=wpsadmin/wpskbs
jpegphoto;binary=NOT ASCII
givenname=wps
sn=admin
uid=wpsadmin

If a reference to the photo attribute is not present in the ldapsearch result set, the photo will not be displayed in the People Finder portlet. This condition indicates an issue with the ldapsearch command itself, a possible misconfiguration in the user repository or simply that the photo attribute has no value.

In Domino environments, photos may be stored in the "native" Domino database, but not necessarily available through the Domino LDAP interface. To be retrieved by the Portal the photo must be stored in the correct format and exposed in Domino LDAP. 

2. Access the People Finder Image servlet directly in a browser and call the servlet with the email address or the uid as a parameter.

http://<PortalHostName>:<Port>/lwp/imageServlet/ImageServlet?email=<address>

http://<portalHostName>:<Port>/lwp/imageServlet/ImageServlet?uid=<uid>

Authenticate as the Portal administrative user when prompted. The photo should display in the browser.

3. Ensure that the photo is set in the Business Card configuration, as follows:

With the People Finder portlet displayed select the Configure option using the "arrow menu" in the upper right corner. In the next panel, select "Business Card." Verify that the check box next to "Include photo" is selected. If it is not, select or enable the option. Press "OK" and then the "Apply changes now" button on the next screen.

4. If the photo attribute is returned in the ldapsearch output but is not shown in the browser, either in the Portal itself or by accessing the Image servlet URL, collect the files and trace appropriate for your Portal version and open a service request with IBM Support [http://www.ibm.com/software/support/probsub.html].

Collecting Data: Issues with the People Finder portlet in WebSphere Portal 6.1 [https://www-304.ibm.com/support/docview.wss?rs=688&uid=swg21429065]

Collecting Data: People Finder for WebSphere Portal 7.0 [https://www-304.ibm.com/support/docview.wss?uid=swg21458362]

It's important that the trace be set to capture the Portal startup sequence as well as the failure of the photo to be shown in the portlet. Attributes and their initial values are retrieved from the user repository at startup and trace of the initial fetch provides an important view of the issue.

RELATED INFORMATION
 Add attributes (6.1) [http://publib.boulder.ibm.com/infocenter/wpdoc/v6r1/topic/com.ibm.wp.ent.doc_v6101/install/aix_add_attributes.html]
Map attributes (6.1) [http://publib.boulder.ibm.com/infocenter/wpdoc/v6r1/topic/com.ibm.wp.ent.doc_v6101/install/aix_map_attributes.html]
Adapting the attribute configuration (7.0) [http://www-10.lotus.com/ldd/portalwiki.nsf/dx/AIX_standalone_Adapting_the_attribute_configuration_wp7]
Standalone or Federated configuration? [https://www.ibm.com/support/docview.wss?uid=swg21386736]
Add and map attributes (technote) [https://www.ibm.com/support/docview.wss?uid=swg21327305]