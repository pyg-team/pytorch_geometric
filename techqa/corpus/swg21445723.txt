Title: IBM XSLT primitive date time transform to UTC produces unexpected results - United States

Text:
WESB; XSLT; DateTime; UTC TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Unexpected Date Time transformation to UTC using the WebSphere Enterprise Service Bus XSLT primitive. 

SYMPTOM
When a string field is mapped to a dateTime field in a XSLT primitive, and the date string does not specify timezone information, an unexpected 'Z' is added to the end of the Date Time, making it a UTC time. This behavior is encountered when the message mapping root has been chosen as /. If specifying message mapping root as /body, the 'Z' is not appended.

CAUSE
When using / as the message mapping root, the whole Service Message Object is serialized during XSL transformation. The SMO uses the business object layer of WebSphere Process Server/WebSphere Enterprise Service Bus and is based on EMF (Eclipse Modeling Framework). During data object serialization, the BO layer invokes EMF to convert the date value (XML datetime is implemented by Javaâ„¢ Date in the BO layer) to a string value. The BO layer sends the Java Date value to EMF and EMF returns a string value. The fields are defined as XSD dateTime type. According to the XSD specification, dateTime fields are strings with a default format : yyyy-mm-ddThh:mm:sstz where the final tz is timezone information and is either in the form +/-hh.mm or 'Z' which indicates base UTC time. By EMF design, if there is no timezone information provided, the dateTime value is considered as UTC, so the 'Z' is appended.

DIAGNOSING THE PROBLEM
Switch on trace com.ibm.ws.sibx.*=all to see the serialized Service Message Object during the mediation, and observe the value of the dateTime field in question after the transformation.

RESOLVING THE PROBLEM
This issue can be worked around by using a similar approach to the following suggestions:


1. Change the type of the DateTime field to be 'string' rather than 'dateTime'. This means that the BO will store the value as simple text exactly as output by the transformation and output it unchanged. 

2. Add customized code to remove the 'Z' from the output DateTime string.






Cross Reference information Segment Product Component Platform Version Edition Business Integration WebSphere Enterprise Service Bus XSLT Primitive 
PRODUCT ALIAS/SYNONYM
 WESB
WebSphere Enterprise Service Bus
ESB