Title: IBM What is the recommended setup for ActiveMQ and ISBI Cluster? - United States

Text:
 TECHNOTE (FAQ)

QUESTION
 What is the recommended ActiveMQ setup on a clustered IBM Sterling B2B Integrator (ISBI) installation?

- external standalone ActiveMQ broker
vs.
- clustered ActiveMQ brokers on ISBI nodes
vs. 
- separate non-clustered ActiveMQ brokers per ISBI node

Should activemqconfig.xml be modified in a clustered ISBI installation? 

CAUSE
For ISBI it is possible to use an external activeMQ server (that has to be installed and maintained separately). 
But it is always (in a clustered and in a non-clustered ISBI environment) possible to use the activeMQ instance that is automatically installed and configured during ISBI install time. 
(see ActiveMQ Modularization [http://www-01.ibm.com/support/knowledgecenter/SS3JSW_5.2.0/com.ibm.help.active_mq_modularization.doc/SI_ActiveMQModularization.html?lang=en]) 
You will find a folder "activemq" in the ISBI installation folder containing this ActiveMQ instance. 

If you decide for some reason (e.g. you want to reuse an existing ActiveMQ broker) you can modify ISBI configuration to use an external ActiveMQ broker.

ANSWER
In general it should be easier and better to use the existing activeMQ instance inside ISBI. 

Note: the Post Installation Configuration Checklist for Cluster Environment directs to "Configure ActiveMQ for a cluster environment" - but please consider that this page also states "Review all of the tasks, but note, some tasks may not be required for your system installation."

Looking at <si>/activemq/conf/readme_cluster.txt: 

 * brokers will be started in each node where gis cluster node is located.
 * 
 * install/properties/activemqconfig.xml also works for none activemq cluster out of the box. 

And looking at the ActiveMQ Modularization documentation site:  * No additional setup or configuration is necessary to use modularized ActiveMQ. The Sterling B2B Integrator installation process configures the system to use it out of the box for both cluster ActiveMQ and non-cluster ActiveMQ.


However, if you plan to use clustering, you may choose a different configuration by editing the activemqconfig.xml file. Before editing this file, read the readme_cluster.txt file. It contains information about how to use the options in the activemqconfig.xml file. Both files are located in the Sterling B2B Integrator install_dir/activemq/conf folder. 
So in general there is no need to modify activemqconfig.xml. 
Then ISBI clustering is taking care about the communication and the synchronicity between the nodes. 

Looking at <si>/activemq/conf/activemqconfig.xml.in (which is used to dynamically create activemqconfig.xml depending on ISBI configuration - e.g. clustering enabled etc.):  * <!-- turning off network of brokers configuration. This configuration has potential to send events onto topics of other activeMQ nodes. But this can cause orphaned events because each listener is listening to the topic for it's node. Leaving the configuration in place but commented out for future reference.
 * 
 * #:ifdef CLUSTER 
 * 
 * ...
 * 
 * #:endif 
 * 
 * -->

So clustering is taken into account when configuring activeMQ, but it is commented out for current version of ISBI. 
So it is recommended to keep activeMQ clustering off and let the ISBI clustering handle the inter node communication. RELATED INFORMATION
#IBM ISBI KC - ActiveMQ Modularization [http://www-01.ibm.com/support/knowledgecenter/SS3JSW_5.2.0/com.ibm.help.active_mq_modularization.doc/SI_ActiveMQModularization.html?lang=en]
IBM ISBI KC - Post Installation Configuration Checklist [http://www-01.ibm.com/support/knowledgecenter/SS3JSW_5.2.0/com.ibm.help.install_unix_clus_523.doc/SI_PostInstallationChecklist_Clust.html]