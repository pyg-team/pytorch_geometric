Title: IBM HTTP stub cannot be started as port is already in use - United States

Text:
RTVS; Stub; HTTP; TCP TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Attempts to start an HTTP/HTTPS stub in IBM Rational Test Virtualization Server (RTVS) with a fixed port number fail with CRRIT1721E JVM Bind error 

SYMPTOM
The stub gives Error status when started from RTCP. 

The Agent log file or Rational Integration Tester (RIT) console shows the following:

[RunTests/instance1 (0)]: [CRRIT1721E] Could not start HTTP server: java.net.BindException: Address already in use: JVM_Bind


CAUSE
You need to fix the port number of your stub so that client applications can hit it directly, without going through a proxy server. 

By default, the HTTP transport will attempt to listen on the port configured in the Settings tab as shown here:

[/support/docview.wss?uid=swg22014936&amp;aid=1] 

If this port is already in use, a random ephemeral port will be used. 

You can force the transport to listen on only one port with the Server configuration: 


[/support/docview.wss?uid=swg22014936&amp;aid=2] 

In this case port 19876 will be used.
If port 19876 is not available, the stub cannot start.



DIAGNOSING THE PROBLEM
Use the netstat command to find out which process is using the TCP port in question. 

Windows example:

C:\>netstat -ano | find "19876"
TCP 0.0.0.0:19876 0.0.0.0:0 LISTENING 21500

The last value is the process number.
Use Windows Task Manager or other Windows tools to find the program associated with that ID:

C:\>pslist 21500
...
Process information for MYMACHINE:

Name Pid Pri Thd Hnd Priv CPU Time Elapsed Time
IntegrationTester 21500 8 88 1199 646228 0:04:59.615 3:36:00.159

In this case, the stub was already running in Integration Tester.



RESOLVING THE PROBLEM
There are several options to resolve this: 

 

 * Do not use a fixed port and configure HTTP clients to use the RIT Proxy.
   The proxy will automatically route messages to the stub, wherever it is running, and on whichever port.
   
   
 * Choose a fixed port number that you know will be free.
   Work with your system administrators.
   
   
 * Choose a fixed port that is most likely to be free, that is, not within the range used by the operating system for ephemeral ports.
   These can be taken by any process at any time.
   
   You can check this range. Here is the Windows command:
   
   C:\>netsh int ipv4 show dynamicport tcp
   
   Protocol tcp Dynamic Port Range
   ---------------------------------
   Start Port : 49152
   Number of Ports : 16384
   
   Do not configure the stub to use a port greater than 49151.