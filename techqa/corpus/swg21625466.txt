Title: IBM Best practices to manage Business Space powered by WebSphere profiles for an IBM Case Manager installation - United States

Text:
profile management TECHNOTE (FAQ)

QUESTION
 What are the recommended procedures to prevent the most common profile-related problems and ensure a successful installation of the Business Space powered by WebSphere product as a part of an IBM Case Manager installation? 

ANSWER
The IBM Case Manager (ICM) installation procedure installs Business Space powered by WebSphere (Business Space), which is an underlying component to ICM. The installation of Business Space requires a profile defined in the WebSphere Application Server (WebSphere) product. Before Business Space is installed, the WebSphere profile is augmented to include Business Space configuration information. During an ICM installation procedure, that profile augmentation takes place when the Configure Business Space task is run in the Case Manager Administration Client. 

The following procedures are recommended to fix and prevent problems due to WebSphere profile corruption: 

 *  Back up and restore profiles. Check if a WebSphere profile has been augmented previously. Augment profiles correctly. 

Several steps in the procedures below use the WebSphere manageprofiles command. The manageprofiles command has to run at the command prompt in the <was_root>\AppServer\bin directory. A detailed reference of the manageprofiles command can be found in the WebSphere InfoCenter documentation. For example: 

 

 * WebSphere Network Deployment Version 7.0, manageprofiles command


1. Back up and Restore Profiles 

On each server where you will run the Configure Business Space task in CMAC, back up the WebSphere profiles using the WebSphere manageprofiles command before you start installing ICM. For example, to back up a profile called AppSrv01 on Windows: 

 * 
 * 


In case there are symptoms of a corrupted WebSphere profile during the ICM installation procedure, you can restore the original profile and go back to running the Configure Business Space task in CMAC again. For example, to restore the profile backup generated above on Windows:  * 
 * 


These are the steps of restoring a profile based on the WebSphere InfoCenter documentation:  *  Stop the server and the running processes for the profile that you want to restore. Manually delete the directory for the profile from the file system. Run the -validateAndUpdateRegistry option of the manageprofiles command. Restore the profile by using the -restoreProfile option of the manageprofiles command. 


Please note: In order to recover corrupted WebSphere profiles, we recommend restoring a good backup of the profile. We do not recommend unagmenting the profile with the manageprofiles command, as it may give unexpected results in rare cases.  

2. Check if a WebSphere Profile has been Augmented Previously 

If you want CMAC to install Business Space, then it is best to use a WebSphere profile that has not been augmented yet. Check if the WebSphere profile configured in CMAC had been augmented previously before running the Configure Business Space task in CMAC. 

To check which WebSphere profile is configured in CMAC: 

 *  In CMAC, open your CMAC profile. In the CMAC File menu, choose the Edit Profile Properties command. Check the value of the Application server profile directory parameter. 
 * 


To check if a WebSphere profile has been augmented: Method 1: 

 *  manageprofiles -listAugments -profileName "<profile name>" In the output, check if a Business Space profile is listed under Registered Augment Templates 

Method 2: 
 *  Open the <was_root>\AppServer\properties\profileRegistry.xml file in a text editor. Find the <profile> tag with the name="<profile name>" parameter, where <profile name> is the WebSphere profile you will use for the ICM installation. Check if there is another xml tag called <augmentor> is within the <profile> tag. If yes, then this profile is augmented. The path in the template parameter of the augmentor tag shows what template was used for the augmentation. 

3. Augment Profiles Correctly 

WebSphere profiles are created based on profile templates supplied with WebSphere. There are different types of WebSphere profile templates, such as: 

 *  Deployment manager Application server Custom profile Administrative agent Job manager Cell Secure proxy 

The Websphere profile templates are located in the following directory:  * 
 * 

The type of profile templates that exist in the directory above depends on the type of WebSphere installation. For example, the following profile templates may be there:  *  default dmgr management 


WebSphere profiles are augmented for Business Space based on profile templates supplied with Business Space. Business Space supports the following types of profiles:  *  Deployment manager Application server Custom profile 

The Business Space profile templates are located in the following directory:  * 
 * 

The folder above has the following profile templates:  *  default.bspace dmgr.bspace managed.bspace manageddefault.bspace 


IMPORTANT RULE: When augmenting a WebSphere profile for Business Space, the type of Business Space profile template must be compatible with the type of WebSphere profile template that was used to create the WebSphere profile. 

To look up the type of WebSphere profile template that was used to create the WebSphere profile: 

Method 1: 
 *  Open the <was_root>\AppServer\properties\profileRegistry.xml file in a text editor. Find the <profile> tag with the name="<profile name>" parameter, where <profile name> is the WebSphere profile you will use for the ICM installation. In the same xml tag, find the template parameter. It shows the path to the WebSphere profile template that was used to create the WebSphere profile. 


Method 2: 
 *  Open the <was_root>\AppServer\logs\manageprofiles\<profile name>_create.log file in a text editor. Find the <record> tag that has a <message> tag inside with the following text:  * "Incoming command line is:" OR 
    * "Current command line is:"
   
   In the same <message> tag, find the parameter "-templatePath". The next parameter after that is the path to the WebSphere profile template that was used to create the WebSphere profile. 


WebSphere and Business Space Profile Template Compatibility  *  WebSphere Profile Business Space Profile default default.bspace
   manageddefault.bspace dmgr dmgr.bspace management managed.bspace 
   

When running the Configure Business Space task in CMAC, make sure that the WebSphere profile configured in the CMAC profile properties is augmented using a compatible Business Space profile template.  

Using the Correct Business Space Profile Template in CMAC 

With the instructions above, you can do the following: 

 *  In the CMAC profile properties, look up the WebSphere profile used for the ICM installation. In the WebSphere profileRegistry.xml file or the <profile name>_create.log file, look up what WebSphere profile template was used to create the WebSphere profile. In the profile template compatibility table above, check the compatible Business Space profile templates. 

Now you have to make sure to use a compatible Business Space profile template in the Configure Business Space task in CMAC. This is controlled by the Environment parameter.  * 
 * 
 * 2. Make sure the value of the Environment property maps to a compatible Business Space profile template type. 
 * 

CMAC Environment and Business Space Profile Template Mapping  *  CMAC Environment Business Space Profile Type Stand-alone Profile default.bspace
   manageddefault.bspace Deployment Manager Profile dmgr.bspace Managed Profile managed.bspace 


Messages in the CMAC log files: 

The CMAC log files are located in the <ICM install location>\logs directory. For example, on Windows: 
 * 
 * 
 * 
 *  Scenario CMAC log message Augmenting a WebSphere profile with an incompatible Business Space Profile template in the Configure Business Space task in CMAC java.lang.RuntimeException: The Business Space template type for the selected environment, deployment type, and managed node type is incompatible with the selected profile. Please either select a different profile to augment, or verify that you have selected the appropriate environment, deployment type, and managed node types for your profile and try again Augmenting a profile that has already been augmented The specified profile has already been augmented with the Business Space Template. You do not need to run this task. Profile augmentation fails (UNIX example) Profile augmentation failed. For more information, consult /opt/IBM/WebSphere7/AppServer/logs/manageprofiles/<profile_name>_augment.log.