Title: IBM Defining unknown fonts to the client - United States

Text:
Font mapping; alignment; cpi; AFP; local print; fonts; *OTHER with overlay TECHNOTE (FAQ)

QUESTION
 What can you do if data viewed or printed locally from the Content Manager OnDemand client is not positioned correctly on the page? (The document is either Advanced Function Presentation (AFP) data or *OTHER data with a named overlay.) 

ANSWER
This procedure describes a resolution to the following situation: Data viewed or printed locally from the OnDemand client is not positioned correctly on the page; host printing from the client or printing from the green screen to an AS/400 printer looks fine; and the document is either Advanced Function Presentation (AFP) data or *OTHER data with a named overlay. Although there are several reasons why this situation might occur, a primary reason is that the fonts used in the datastream are not known to the client and must be defined. If a fixed pitch font is used that is unknown by the client, then the client uses a variable pitch font. Therefore, the data rarely lines up with an overlay.
Recommendation: Installation of the Content Manager OnDemand Client will cause you to lose customization you might have made for font mapping. Therefore, place copies of the files you modify (or create) for your installation in a common place. We suggest creating an AS/400Â® IFS (Integrated File System) directory called FONTMAPS under /QIBM/UserData/RDARS . Files that are commonly created or modified for font mapping are located at 
C:\Program Files\IBM\OnDemand32\FONT and are named: 
csdef.fnt
alias.fnt
cpdef.fnt
coded.fnt

It is also possible that you have created or modified code page files located at 
C:\Program Files\IBM\OnDemand32\FONT\maps. These files have the extension.cp. You need to back up only those code page files that you create or modify.

Instructions: 

 1. Create an IFS directory. Type:
    CRTDIR DIR(/QIBM/Userdata/RDARS/FONTMAPS). 
 2. Change the owner. Type:
    CHGOWN OBJ('(QIBM/UserData/RDARS/FONTMAPS)') NEWOWN(QRDARS400) RVKOLDAUT(*YES) SYMLNK(*NO) 
 3. Map a network drive to the AS/400, use Windows Explorer to locate the objects to back up, and copy them to the new IFS directory. Now, your files reside in a common directory. These files must be copied back to the PC after you upgrade to a new client. 


If you have just upgraded your client code and the document initially displayed correctly, restore the changes you previously made. If you did not save these changes, find someone who has not yet upgraded and copy their customized files. Otherwise, you must again determine the changes to make. If you are using hardware fonts, usually specified as Font Global Identifiers (FGID), you might not have the definition for one or more FGIDs in your document. Look at the csdef.fnt file in directory Program Files\IBM\OnDemand32\Font. The FGID definitions are in the second part of the file (the first part defines the character sets). 

Add to this file any FGIDs that you are using, but that are not defined in it. The FGID entry identifies the font family name, style, weight, and whether it is italicized. For example, suppose you are using FGID 761. To add it to the csdef.fnt file: 

 1. Find the description of the font for the FGID. Table 1 below lists commonly used FGIDs. See Appendix D, "Working with Fonts, Font Character Sets, Code Pages, CHRIDs, and Coded Fonts" in OS/400 Printer Device Programming Version 4 Release 4 [http://as400bks.rochester.ibm.com/cgi-bin/bookmgr/BOOKS/QB3AUJ03/CCONTENTS] (SC41-5713-03) for a discussion of the elements and the table listings. 
 2. In the table, find the name for the FGID. In this case, it is Times Roman Bold. 
 3. Specify the font family name based on the FGID name. The name you specify here should identify a font name that is found in the file Program Files\IBM\OnDemand32\Font\alias.fnt. The alias.fnt file defines the Adobe Type font and the TrueType font that should be used on your workstation. You might want to find another FGID in Table 1 that has the same (or almost the same) FGID name and that is already defined in the csdef.fnt file. In our case, we looked at FGID 2309, called Times New Roman Bold. 
    In the csdef.fnt file, FGID 2309 is defined to use WbTimesNewRoman, so specify that as the font family name. Refer to the alias.fnt file; you can also specify TimesNewRoman as the font family name, because it uses exactly the same Type 1 and TrueType fonts as the font WbTimesNewRoman. 
 4. Specify the style attribute: the choices are SWISS, ROMAN, SCRIPT, MODERN, or DISPLAY. This style attribute is the same as the Windows "family" and is approximately equivalent to type family plus typeface style in AFP fonts. The easiest way to select this value is to look for another FGID definition in the csdef.fnt file that has the same font family name and use the same style attribute. Refer to the definition for FGID 2309; because it uses ROMAN as the style attribute, you can also use Roman for FGID 761. 
 5. Weight is the amount of bold used on the typeface. Possible values are LIGHT, MED or BOLD. Because the name of the font is Times New Roman Bold, specify BOLD for the weight. 
 6. Specify the italic attribute. If the font is italicized, specify a value of 1; if not, specify 0. Normally, the FGID name includes the word italic when appropriate. For FGID 761 the italic attribute is set to 0.


Based on this analysis, add the following to the csdef file: 761=WbTimesNewRoman,ROMAN,BOLD,0


The excerpt below is from Appendix D of OS/400 Printer Device Programming (SC41-5713). 

 * 

Appendix 1.4.5.12.1 Font Attributes 

Font attributes are the characteristics or properties that combine to give a font identity. For example: attributes can be 14 point (height of the font), bold, and italic. 

Types of Fonts: The following diagram identifies the types of fonts and gives examples of each type:  * Mixed pitch fonts which simulate proportionally spaced fonts.
   Characters in the font have a limited number of widths. Overall spacing is about 12 characters per inch. Examples are Document or Essay fonts.
   
 * Uniformly spaced fonts which are similar to typewriter fonts.
   Characters in the font are all the same width. Examples are Courier and Gothic Text fonts. Some uniformly spaced fonts and many typographic fonts are scalable. For scalable fonts, specify a point size to indicate the size of the font. For example a 12 point uniformly spaced font corresponds to 10 CPI. An example of such a font is font 416, Courier Roman Medium. If no point size is specified when using scalable fonts, 10 point is defaulted.

 * Typographic fonts
   Typographic fonts have variable height, measured in points (1 point = 1/72 inch). Therefore, a 36-point font has characters that are 1/2 inch high. Typographic fonts have variable widths. Width is part of the design and varies on a character-by-character basis. Examples are Sonoran Serif and Century Schoolbook. 

Comparison of mixed pitch, uniformly spaced, and typographic fonts [/support/docview.wss?uid=swg21006809&amp;aid=1] 
The Table Legend and Table 1 in the file below provide information about each font. This information could save you time in trial-and-error testing when you choose a font for your application. 

To view the Table Legend and Table 1, click the attached document icon for the file called fontinfo.123. 

Table 1. Font Information 
fontinfo.123 [/support/docview.wss?uid=swg21006809&aid=3] [/support/docview.wss?uid=swg21006809&aid=2] 

Table note: Pitch or CPI column for typographic fonts indicates the width of the space character between printed characters. Width, pitch, and CPI of other space characters will vary. 


Cross reference information Segment Product Component Platform Version Edition Enterprise Content Management Content Manager OnDemand Clients