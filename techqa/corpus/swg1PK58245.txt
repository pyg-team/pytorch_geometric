Title: IBM PK58245: WLM TX CORRECTLY MARK SERVERS UNAVAILABLE WITH REJECTED TX - United States

Text:
  FIXES ARE AVAILABLE
Java SDK 1.5 SR8 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24020073]
Java SDK 1.5 SR8 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24021203]
Java SDK 1.5 SR10 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24024201]
6.1.0.31: Java SDK 1.5 SR11 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24026453]
6.1.0.33: Java SDK 1.5 SR12 FP1 Cumulative Fix for WebSphere [http://www-01.ibm.com/support/docview.wss?uid=swg24027786]
6.1.0.29: Java SDK 1.5 SR11 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24025191]
6.1.0.35: Java SDK 1.5 SR12 FP2 Cumulative Fix for WebSphere [http://www-01.ibm.com/support/docview.wss?uid=swg24028574]
6.1.0.37: Java SDK 1.5 SR12 FP3 Cumulative Fix for WebSphere [http://www-01.ibm.com/support/docview.wss?uid=swg24029525]
6.1.0.39: Java SDK 1.5 SR12 FP4 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24030426]
6.1.0.41: Java SDK 1.5 SR12 FP5 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24031035]
6.1.0.43: Java SDK 1.5 SR13 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24031963]
6.1.0.45: Java SDK 1.5 SR14 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24033270]
6.1.0.47: WebSphere Application Server V6.1 Fix Pack 47 [http://www-01.ibm.com/support/docview.wss?uid=swg24035508]
6.1.0.47: Java SDK 1.5 SR16 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24035649]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  In the scenario where a transactional request is sent out from
   the
   client to the server, and that server fails to respond before
   the ORB
   request timeout, a NO_RESPONSE will be thrown by the ORB.  The
   TX
   interceptor will see this exception and correctly throw a
   TX_ROLLEDBACK.
   The other interceptors are called with the TX_ROLLEBACK and
   eventually
   this exception is what is thrown to WLMClient.handleRemote.  The
   problem
   occurs because a TX_ROLLEDBACK is not an exception by which the
   WLM code
   will mark a server unavailable, but the original NO_RESPONSE is.
   This
   APAR will fix the code in such a way that WLM will be aware of
   the fact
   the TX_ROLLEDBACK resulted from a NO_RESPONSE and take the
   action of
   both marking the server unavailable and passing the
   TX_ROLLEDBACK to the
   client.
   
   
    
   
   

LOCAL FIX
 *  N/A
   
   
    
   
   

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED: IBM WebSphere Application Server V6.0.2 and  *
   *                 V6.1 users of clustering and transactional   *
   *                 requests                                     *
   ****************************************************************
   * PROBLEM DESCRIPTION: Continued timed-out routing to          *
   *                      downed application servers on           *
   *                      transactional requests                  *
   ****************************************************************
   * RECOMMENDATION:                                              *
   ****************************************************************
   In the scenario where a transactional request is sent out from
   the client to the server, and that server fails to respond
   before the ORB request timeout, a NO_RESPONSE will be thrown
   by the ORB.  The TX interceptor will see this exception and
   correctly throw a TX_ROLLEDBACK. The other interceptors are
   called with the TX_ROLLEBACK and eventually this exception is
   what is thrown to WLMClient.handleRemote.  The problem occurs
   because a TX_ROLLEDBACK is not an exception by which the
   WorkLoad Management (WLM) code will mark a server unavailable,
   but the original NO_RESPONSE is.
   
   The relevant symptom is a continued routing to an unavailable
   server to try and establish an affinity, and each request
   would be subject to the ORB Request Timeout (default 3 mins)
   before failing and being failed over to another server,
   resulting in an overall performance degredation.
   
   
    
   
   

PROBLEM CONCLUSION
 *  This APAR addresses the issue by changing the interaction
   between the TX and WLM interceptors through the ORB code
   such that WLM will be aware of the fact the TX_ROLLEDBACK
   resulted from a NO_RESPONSE and take the action of both
   marking the server unavailable and passing the TX_ROLLEDBACK
   back to the client.
   
   The fix for this APAR is currently targeted for inclusion
   in fix packs 6.0.2.27 and 6.1.0.17.
   Please refer to the recommended updates page for delivery
   information:
   http://www.ibm.com/support/docview.wss?rs=180&uid=swg27004980 [http://www.ibm.com/support/docview.wss?rs=180&uid=swg27004980]
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PK58245
   
   
 * REPORTED COMPONENT NAME
   WEBS APP SERV N
   
   
 * REPORTED COMPONENT ID
   5724H8800
   
   
 * REPORTED RELEASE
   60A
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2007-12-14
   
   
 * CLOSED DATE
   2008-03-10
   
   
 * LAST MODIFIED DATE
   2008-03-10
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WEBS APP SERV N
   
   
 * FIXED COMPONENT ID
   5724H8800
   
   

APPLICABLE COMPONENT LEVELS
 * R60A PSY
   UP
   
   
 * R60H PSY
   UP
   
   
 * R60I PSY
   UP
   
   
 * R60P PSY
   UP
   
   
 * R60S PSY
   UP
   
   
 * R60W PSY
   UP
   
   
 * R60Z PSY
   UP
   
   
 * R61A PSY
   UP
   
   
 * R61H PSY
   UP
   
   
 * R61I PSY
   UP
   
   
 * R61P PSY
   UP
   
   
 * R61S PSY
   UP
   
   
 * R61W PSY
   UP
   
   
 * R61Z PSY
   UP