Title: IBM A hung thread occurs when starting the IBM Business Process Manager (BPM) server - United States

Text:
startup; start; hang; hung; getAllGroups; transaction timeout; timeout; WSVR0605Wl; 99999; LSW_USR TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 When you start IBM Business Process Manager server, you see a hung thread and a transaction timeout in log file. 

SYMPTOM
You may see the following messages in SystemOut.log file: 

[8/20/14 10:23:15:213 EDT] 00000003 ThreadMonitor W WSVR0605W: Thread "server.startup : 0" (00000017) has been active for 692993 milliseconds and may be hung. There is/are 1 thread(s) in total in the server that may be hung.
at java.lang.Thread.sleep(Native Method)
at java.lang.Thread.sleep(Thread.java:853)
at com.lombardisoftware.server.core.GroupCore.getAllGroups(GroupCore.java:518)
at com.lombardisoftware.server.ejb.security.SecurityCore.listAllGroups(SecurityCore.java:564)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:60)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)
at java.lang.reflect.Method.invoke(Method.java:611)
at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:310)
at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:182)
at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:149)
at com.lombardisoftware.utility.spring.TransactionInterceptor$1.call(TransactionInterceptor.java:52)
at com.lombardisoftware.utility.spring.ProgrammaticTransactionSupport$1.doInTransaction(ProgrammaticTransactionSupport.java:317)
at org.springframework.transaction.jta.WebSphereUowTransactionManager$UOWActionAdapter.run(WebSphereUowTransactionManager.java:306)
at com.ibm.ws.uow.UOWManagerImpl.runUnderNewUOW(UOWManagerImpl.java:1115)
at com.ibm.ws.uow.UOWManagerImpl.runUnderUOW(UOWManagerImpl.java:629)
at org.springframework.transaction.jta.WebSphereUowTransactionManager.execute(WebSphereUowTransactionManager.java:252)
at com.lombardisoftware.utility.spring.ProgrammaticTransactionSupport.executeInNewTransaction(ProgrammaticTransactionSupport.java:312)
at com.lombardisoftware.utility.spring.ProgrammaticTransactionSupport.execute(ProgrammaticTransactionSupport.java:192)
at com.lombardisoftware.utility.spring.TransactionInterceptor.invoke(TransactionInterceptor.java:50)
at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:171)
at com.lombardisoftware.utility.spring.CoreEntryInterceptor.invoke(CoreEntryInterceptor.java:44)
at com.lombardisoftware.utility.spring.PSCoreEntryInterceptor.invoke(PSCoreEntryInterceptor.java:14)
at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:171)
at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:204)
at $Proxy47.listAllGroups(Unknown Source)
at com.lombardisoftware.server.ejb.security.SecurityBean$23.execute(SecurityBean.java:344)
at com.lombardisoftware.server.ejb.security.SecurityBean$23.execute(SecurityBean.java:342)
at com.lombardisoftware.server.ejb.EjbServerUtils.handleEjbCall(EjbServerUtils.java:90)
at com.lombardisoftware.server.ejb.security.SecurityBean.handleEjbCall(SecurityBean.java:49)
at com.lombardisoftware.server.ejb.security.SecurityBean.listAllGroups(SecurityBean.java:342)
at com.lombardisoftware.server.ejb.security.EJSRemoteStatelessSecurity_287acf5b.listAllGroups(Unknown Source)
at com.lombardisoftware.server.ejb.security._SecurityInterface_Stub.listAllGroups(_SecurityInterface_Stub.java:1148)
at com.lombardisoftware.client.delegate.SecurityDelegateDefault$19.run(SecurityDelegateDefault.java:484)
at java.security.AccessController.doPrivileged(AccessController.java:277)
at com.lombardisoftware.client.delegate.common.WebsphereDelegateHelper.doAsCurrentSubjectContextSensitive(WebsphereDelegateHelper.java:175)
at com.lombardisoftware.client.delegate.SecurityDelegateDefault.listAllGroups(SecurityDelegateDefault.java:481)
at com.lombardisoftware.servlet.util.GroupCache.initAll(GroupCache.java:111)
at com.lombardisoftware.servlet.util.GroupCache.getAllGroups(GroupCache.java:84)
at com.lombardisoftware.servlet.util.GroupCache.getGroups(GroupCache.java:57)
at com.lombardisoftware.servlet.util.CacheManager.init(CacheManager.java:102)
at com.ibm.ws.webcontainer.servlet.ServletWrapper.init(ServletWrapper.java:359)
at com.ibm.ws.webcontainer.servlet.ServletWrapperImpl.init(ServletWrapperImpl.java:171)
at com.ibm.ws.webcontainer.servlet.ServletWrapper.initialize(ServletWrapper.java:1818)
at com.ibm.wsspi.webcontainer.extension.WebExtensionProcessor.createServletWrapper(WebExtensionProcessor.java:98)
at com.ibm.ws.webcontainer.webapp.WebApp.getServletWrapper(WebApp.java:1048)
at com.ibm.ws.webcontainer.webapp.WebApp.getServletWrapper(WebApp.java:969)
at com.ibm.ws.webcontainer.webapp.WebApp.initializeTargetMappings(WebApp.java:648)
at com.ibm.ws.webcontainer.webapp.WebApp.commonInitializationFinally(WebApp.java:450)
at com.ibm.ws.webcontainer.webapp.WebAppImpl.initialize(WebAppImpl.java:304)
at com.ibm.ws.webcontainer.webapp.WebGroupImpl.addWebApplication(WebGroupImpl.java:100)
at com.ibm.ws.webcontainer.VirtualHostImpl.addWebApplication(VirtualHostImpl.java:166)
at com.ibm.ws.webcontainer.WSWebContainer.addWebApp(WSWebContainer.java:732)
at com.ibm.ws.webcontainer.WSWebContainer.addWebApplication(WSWebContainer.java:617)
at com.ibm.ws.webcontainer.component.WebContainerImpl.install(WebContainerImpl.java:376)
at com.ibm.ws.webcontainer.component.WebContainerImpl.start(WebContainerImpl.java:668)
at com.ibm.ws.runtime.component.ApplicationMgrImpl.start(ApplicationMgrImpl.java:1127)
at com.ibm.ws.runtime.component.DeployedApplicationImpl.fireDeployedObjectStart(DeployedApplicationImpl.java:1319)
at com.ibm.ws.runtime.component.DeployedModuleImpl.start(DeployedModuleImpl.java:611)
at com.ibm.ws.runtime.component.DeployedApplicationImpl.start(DeployedApplicationImpl.java:944)
at com.ibm.ws.runtime.component.ApplicationMgrImpl.startApplication(ApplicationMgrImpl.java:740)
at com.ibm.ws.runtime.component.ApplicationMgrImpl.start(ApplicationMgrImpl.java:2051)
at com.ibm.ws.runtime.component.CompositionUnitMgrImpl.start(CompositionUnitMgrImpl.java:385)
at com.ibm.ws.runtime.component.CompositionUnitImpl.start(CompositionUnitImpl.java:123)
at com.ibm.ws.runtime.component.CompositionUnitMgrImpl.start(CompositionUnitMgrImpl.java:328)
at com.ibm.ws.runtime.component.CompositionUnitMgrImpl.access$300(CompositionUnitMgrImpl.java:113)
at com.ibm.ws.runtime.component.CompositionUnitMgrImpl$CUInitializer.run(CompositionUnitMgrImpl.java:895)
at com.ibm.wsspi.runtime.component.WsComponentImpl$_AsynchInitializer.run(WsComponentImpl.java:496)
at com.ibm.ws.util.ThreadPool$Worker.run(ThreadPool.java:1646)

[8/20/14 14:12:33:782 EDT] 00000006 TimeoutManage I WTRN0006W: Transaction 00000147F3C31376000000010000000482AFCA42DD48D10A048A7F1573FE5F6F58FFEC8000000147F3C31376000000010000000482AFCA42DD48D10A048A7F1573FE5F6F58FFEC8000000001 has timed out after 14400 seconds.


RESOLVING THE PROBLEM
To resolve this issue, complete the following steps:


 1. Stop all of the servers or clusters.
    
    
 2. Back up the process server database for IBM Business Process Manager.
    
    
 3. Connect to process server database and execute the following SQL query: 
    select * from LSW_USR where USER_ID = '99999'
    
    
 4. Delete the row which is queried from the LSW_USR table in step 3. The row to be deleted is similar to the following row: 
    ('99999', 'RefreshLock', '1234567812345678','RefreshLock', 'T', null, null);
    
    
 5. Restart the servers or clusters one at the time.

 

Cross reference information Segment Product Component Platform Version Edition Business Integration IBM Business Process Manager Standard Security AIX, Linux, Linux zSeries, Solaris, Windows 7.5.1, 7.5 Business Integration IBM Business Process Manager Express Security Linux, Windows 7.5.1, 7.5 
PRODUCT ALIAS/SYNONYM
 BPM