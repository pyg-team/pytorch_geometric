Title: IBM Network IPS 4.6.1: LMI pages fail to load in FIPS mode when TLS V1.0 and TLS V1.1 are not allowed - United States

Text:
CPE.jar; SSL handshake failure; FIPS mode; NIST SP 800-131A; TLS; LMI; Java; SHA-1; SHA-256; hash algorithm; Java error message TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Network IPS LMI pages fail to load in FIPS mode when TLS V1.0 and TLS V1.1 are not allowed. 

SYMPTOM
The following Java exception error occurs in the Network IPS LMI: 

java.lang.ClassNotFoundException: net.iss.cpe.CpeControllerApplet


CAUSE
The pages in the Network IPS LMI fail to load when the Oracle Java Plugin V1.7 tries to load the CPE.jar file from the appliance. By default, the cipher suites that are listed in the "client hello" message that is sent from the Oracle Java Plugin allow only SHA1 as the hash algorithm by default. However, the SHA1 hash algorithm. However, the SHA-1 hash algorithm is not NIST-compliant.


DIAGNOSING THE PROBLEM
For NIST SP 800-131A, SHA-256 or a stronger hash algorithm is required for digital signature generation, which must also be supported by the client. However, the cipher suites that are listed in the "client hello" message that is sent from the Oracle Java Plugin allow only SHA1 as the hash algorithm by default, which causes a handshake_failure when you try to load the pages in the Network IPS LMI.



RESOLVING THE PROBLEM
Add the following OS global environment variable: 


JAVA_TOOL_OPTIONS = -Dhttps.cipherSuites=TLS_RSA_WITH_AES_128_CBC_SHA256,TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256

If you are using Windows 7:

1. From Windows Explorer, right-click Computer > Properties.
2. Click Advanced system settings.
3. In the System Properties window, click the Advanced tab. 
4. Click Environment Variables, and then click New in the System variables section.
5. Add the new system variable, and click OK.

Warning: Adding this system property might cause other Java applications to not function properly. Add this property if you want to only access a NIST-compliant appliance LMI.







[/support/docview.wss?uid=swg21646301&aid=1] [http://ibm.biz/KC-SNIPS] [/support/docview.wss?uid=swg21646301&aid=2] [http://ibm.biz/InfraSecForumTechnote] [/support/docview.wss?uid=swg21646301&aid=3] [http://ibm.biz/SecSuptUTube] [/support/docview.wss?uid=swg21646301&aid=4] [http://ibm.biz/InfraSecFixes] [/support/docview.wss?uid=swg21646301&aid=5] [http://ibm.biz/FlexLicLogin] [/support/docview.wss?uid=swg21646301&aid=6] [http://ibm.biz/MyNotification] [/support/docview.wss?uid=swg21646301&aid=7] [http://ibm.biz/ContactSecSupport]