Title: IBM PM26590: CSQX053E CSQXFFST ERROR CSQSNAP XCSFREEOWNEDBUFFERS - United States

Text:
z/os  A FIX IS AVAILABLE
Obtain the fix for this APAR.


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  CSQX053E CSQXFFST Error information recorded in CSQSNAP data set
   The issue is caused when a client is running multiple
   connections over the same channel (i.e. sharecnv is >1).
   When one of the client connections performs a get, the CHINIT
   uses an asynchronous receive thread to request messages from
   the queue manager. The asynchronous receive thread is owned by
   the channel and lasts for the life of the primary conversation.
   
   If the queue manager finds a message which could be returned
   on the get, but it is bigger than the current buffer, a new
   larger buffer is allocated in the CHINIT address space to hold
   the message. The buffer owner is set to be the conversation
   block of the specific conversation which performed the get.
   Once the message has been returned, the asynchronous receive
   thread continues to use the larger buffer for subsequent
   requests. At a later point, the conversation which owns the
   buffer may end, so the conversation block is freed. The primary
   conversation is still performing processing for other
   conversations sharing the same socket, so the buffer remains in
   use.
   
   The freed conversation block is reused as a primary conversation
   block for another channel. If that channel terminates while the
   original channel is still using the buffer, then the checks made
   during channel termination detect that the primary conversation
   is the owner of a storage buffer which is still allocated.
   
   This triggers the observed snap dump.
   *
   Additional keywords:
   XFFSxcsFreeOwnedBuffers
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED: All users of WebSphere MQ for z/OS Version 7 *
   *                 Release 0 Modification 1.                    *
   ****************************************************************
   * PROBLEM DESCRIPTION: CSQX053E CSQXFFST Error information     *
   *                      recorded in CSQSNAP data set -          *
   *                      xcsFreeOwnedBuffers                     *
   ****************************************************************
   * RECOMMENDATION:                                              *
   ****************************************************************
   A channel has been defined with a SHARECNV value greater than
   one so multiple connections can use the channel.
   When one of the client connections performs a Get, the CHINIT
   uses an asynchronous receive thread to request messages from the
   queue manager. This thread is owned by the channel and lasts for
   the life of the primary conversation.
   If the queue manager finds a message which could be returned
   on the Get, but it is bigger than the current buffer, a new
   larger buffer is allocated in the CHINIT address space to hold
   the message. The buffer owner is set to be the conversation
   block of the specific conversation which performed the get,
   and not the primary conversation who was the initiator of the
   receive thread.
   The conversation ends and its conversation block is freed and
   subsequently assigned to the primary conversation block for
   another channel.
   If that channel terminates while the original channel is still
   using the buffer, then the checks made during channel
   termination detect that the primary conversation is the owner of
   a storage buffer which is still allocated.
   This causes the CSQX053E message for xcsFreeOwnedBuffers.
   
   
    
   
   

PROBLEM CONCLUSION
 *  CSQXRSTM has been altered to make the primary conversation
   the owner of any new buffers.
   010Y
   CSQXRSTM
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PM26590
   
   
 * REPORTED COMPONENT NAME
   WMQ Z/OS V7
   
   
 * REPORTED COMPONENT ID
   5655R3600
   
   
 * REPORTED RELEASE
   010
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2010-11-11
   
   
 * CLOSED DATE
   2010-12-24
   
   
 * LAST MODIFIED DATE
   2011-07-05
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
    UK63508
   
   

MODULES/MACROS
 *  CSQXRSTM
   
   
    
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WMQ Z/OS V7
   
   
 * FIXED COMPONENT ID
   5655R3600
   
   

APPLICABLE COMPONENT LEVELS
 * R010 PSY UK63508 [HTTPS://WWW14.SOFTWARE.IBM.COM/WEBAPP/SET2/ORDERMEDIA/SHOPCART?PTFS=UK63508]
   UP11/01/15 P F101
   
   

FIX IS AVAILABLE
 * SELECT THE PTF APPROPRIATE FOR YOUR COMPONENT LEVEL. YOU WILL BE REQUIRED TO SIGN IN. DISTRIBUTION ON PHYSICAL MEDIA IS NOT AVAILABLE IN ALL COUNTRIES.