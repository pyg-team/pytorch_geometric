Title: IBM Permission requirements in a Microsoft Exchange 2007 or Microsoft Exchange 2010 environment - United States

Text:
 TECHNOTE (FAQ)

QUESTION
 Which permissions are required to archive e-mail from a Microsoft Exchange Server? 

ANSWER
Access to the local machine
The accounts running the IBM ICC E-Mail Connector service and the IBM ICC WebApplications service require full access to the local machine disk. Otherwise, the services cannot be started, and no log information can be written.

Access to the mailboxes and public folders
To archive e-mail, IBM InfoSphere Content Collector requires write access to the mailboxes and public folders to be archived. You can provide this access by running IBM InfoSphere Content Collector with an account that has administrative rights or by explicitly granting permission to the mailboxes or public folders to be archived.

To archive messages from personal folders (PST files), the account that runs IBM InfoSphere Content Collector does not require specific rights unless you use the EC Copy to Mailbox task to copy the message stubs from the PST to a mailbox. In this case, IBM InfoSphere Content Collector requires write access to the mailbox that is associated with the PST.

Running IBM InfoSphere Content Collector with an account that has administrative rights

- Exchange 2007
The accounts running the IBM ICC E-Mail Connector service and the IBM ICC WebApplications service require the Exchange Organization Administrator role (Exchange Organization Administrator role [/support/docview.wss?uid=swg21431315&amp;aid=1]) or the Exchange Server Administrator role (Exchange Server Administrator role [/support/docview.wss?uid=swg21431315&amp;aid=2]) for all Exchange servers that host mailboxes that are supposed to be archived, including the trigger mailbox.

To apply an administrator role to an account by using the Exchange Management Console, select Organization Configuration (Organization Configuration [/support/docview.wss?uid=swg21431315&amp;aid=3]) and use the action Add Exchange Administrator… (Add Exchange Administrator… [/support/docview.wss?uid=swg21431315&amp;aid=4]). For more information, see How to Add a User or Group to an Administrator Role [http://technet.microsoft.com/en-us/library/aa998008(EXCHG.80).aspx].

- Exchange 2010
The accounts running the IBM ICC E-Mail Connector service and the IBM ICC WebApplications service must be member of the Exchange 2010 built-in role group Organization Management.

For more information, see Understanding Role Based Access Control [http://technet.microsoft.com/en-us/library/dd298183.aspx] and Add Members to a Role Group [http://technet.microsoft.com/en-us/library/dd638143.aspx].

Running IBM InfoSphere Content Collector with an account that does not have administrative rights

Starting with Content Collector 2.1.1, you can run the IBM ICC E-Mail Connector service and the IBM ICC WebApplications service under an account that does not have administrative rights. To do so, set the environment variable AFU_EX_DISABLE_ADMIN_PRIV (the value is irrelevant). In this case, the account that runs the services must not have administrative rights, but it requires full access permission to all mailboxes that are supposed to be archived (including the trigger mailbox) and permission level Editor to the public folders that are supposed to be archived.
If you want to use the collection source "All mailboxes on a server", the account running the IBM ICC E-Mail Connector service must have the Exchange View-Only Administrator role (Exchange View-Only Administrator role [/support/docview.wss?uid=swg21431315&amp;aid=5]).

To grant permission to mailboxes by using the Exchange Management Console, select Recipient Configuration (Recipient Configuration [/support/docview.wss?uid=swg21431315&amp;aid=6]) / Mailbox (Mailbox [/support/docview.wss?uid=swg21431315&amp;aid=7]), then select the mailbox and use the action Manage Full Access Permission... (Manage Full Access Permission... [/support/docview.wss?uid=swg21431315&amp;aid=8]). For more information, see How to Allow Mailbox Access [http://technet.microsoft.com/en-us/library/aa996343(EXCHG.80).aspx].

Note that using an account without administrative rights applies to both mailbox and public folder processing. It is not possible to use administrative access for public folders only.

Error codes related to insufficient access permission

If the account running the IBM ICC E-Mail Connector service or the IBM ICC WebApplications service does not have sufficient permission, one or more of the following error codes will be seen in the log file (afu_mailconnector_trace_<index>.log): 

 * Error code MAPI_E_NOT_FOUND in module CsxMAPIMessageStore.cpp when trying to open the inbox folder of a mailbox 
 * Error code MAPI_E_FAILONEPROVIDER in module CsxMAPISession.cpp when trying to open the public message store 
 * Error code MAPI_E_NO_ACCESS in module CsxMAPIPrivateStoreMgr.cpp when trying to get the mailbox table from the Exchange server 
 * Error code MAPI_E_NO_ACCESS in module CsxMAPIPropertyBase.cpp when trying to save a message 
 * Error code MAPI_E_NO_ACCESS in module CsxMAPIFolder.cpp when trying to create a message