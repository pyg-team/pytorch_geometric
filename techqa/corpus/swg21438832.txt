Title: IBM Extended Agent for Oracle not connecting to Oracle database server - United States

Text:
5724B96OOTR; database connection for subnode is not established database type unknown krzclient oracle extended agent TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 In case of configuration errors, the ITCAM Extended Agent for Oracle Database does not connect to the monitored Oracle server. 

SYMPTOM
Most of the time, at the end of the krzclient log, you can find messages like the following: 

(4C04C66B.0000-3:krzreqprocess.cpp,497,"buildIntervalSQLInfo") The
database connection for subnode sssss-xxx-s-yyy-zzzz is not established, database type unknown yet.


RESOLVING THE PROBLEM
There can be different reasons for this error message to occur, and depending on the reason you have a different solution. 

1) Wrong Connection String. 

If the connection string is not the expected one, the agent will not be able to connect. In order to check if you are using the correct connection string, try using it with SQLPlus. 

For example:
sqlplus 
<user>/<passwd_of_user>@"(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST= 
<hostname>)(PORT= <port>))(CONNECT_DATA=(SERVER= 
DEDICATED)(SID=<serverSID>))" 

if SQLPlus is also not able to connect, double check the connection string again and in case reconfigure the agent using the correct string.

2) Wrong database connection name or bad userid/password. 

As per the connection string, also in this case we can check if the userid/password and the database connection name are correct by using sqlplus. 

For example:

sqlplus <user>/<passwd_of_user>@<database_connection_name>

If SQLPlus is also not able to connect, verify again the userid/password or the CONNECT DATA section within the tnsnames.ora file, that should be consistent with the information specified during the agent instance configuration (anyway this is still related to the connection string).

3) Problems with the listener. 

Check that the Oracle listener status is the expected one by using the following commands:
lsnrctl status 
lsnrctl service 

4) Problems with access rights on Oracle dynamic views (v$,gv$). 

Extended Agent requires access rights on Oracle dynamic views (v$,gv$).
Double check that you have already successfully executed the krzgrant.sql script.
If it has not been executed, the following SQL script needs to be run on the Oracle server itself:

krzgrant.sql user_id temporary_directory 

Script krzgrant.sql can be found into:
<ITM_HOME>/<arch>/rz/bin (unix) 
<ITM_HOME>/tmaitm6 (windows) 

In order to check for additional possible issues concerning dynamic views or Oracle system tables, you can connect to the server using the userid/password used to start the agent, and then execute the following commands:

select decode(upper(value),'RDBMS','RDB',upper(value)) DBTYPE 
from v$parameter where name='instance_type

If the query returns an error like the following:

ERROR at line 1: ORA-00942: table or view does not exist 

you may need to check with Oracle DBA for the availability of these tables or the dynamic views.
Check with him if the catalog.sql Oracle script has been executed and if necessary run it again.

 

PRODUCT ALIAS/SYNONYM
 IBM Tivoli Monitoring Oracle Extended Agent 6.3