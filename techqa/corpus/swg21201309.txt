Title: IBM Details on mail template Discover Folders action and @Command DiscoverFolders - United States

Text:
Vantive; 1539146; incident; view with column; folders; where is a document; discover folders; discoverfolders; @command; new command; errors; new formula; @Command DiscoverFolders; templates; mail file; mailfile; Folders containing current document; Action Failed; Cannot execute the specified command; Document does not exist in any of the folders; @Command and other UI functions are not allowed with this search TECHNOTE (FAQ)

QUESTION
Lotus Notes 7.0 introduces a new formula, @Command DiscoverFolders, that returns a dialog box listing all the folders in which a document resides. This new functionality is also included in an action in various views and folders in the release 7.x mail templates. In the mail file, the action is Folders --> Discover Folders. You can find the action in all views and folders except the Drafts and Junk Mail folders. 

When you highlight a document and select the action, a dialog box displays titled "Folders containing current document," with options for "Open Folder" or "Remove from Folder." You can also right-click a mail document and select "Discover Folders." The action also functions in newly created folders or views that are based on an existing design containing the action.

When you design a custom application that uses the @Command DiscoverFolders function, it appears that the function fails or you receive an error, although you know that the document is contained in a folder in the database. You may see the following message on the Notes status bar:


 * 
 * 

Or the following errors display: 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 

ANSWER
This issue was reported to Quality Engineering as SPR# KDOY5L8LRG.

To use the DiscoverFolders @Command successfully, do the following:

1. You must first create an outline containing all folders in which the document may reside, as well as all the views on which you want to execute the @Command.
2. Place this outline embedded within a page.
3. Make sure the embedded outline has the property, "Maintain folder unread information", enabled.
4. Add the page to a frame within a frameset.
5. Make sure the database property, "Don't maintain unread marks", is disabled (Advanced Properties [beanie] tab in Database Properties). The database must be closed and reopened for the revised setting to have an effect.

NOTE: With databases based on the mail template, only Step 5 above is necessary.

The @Command functions only when it is triggered with the frameset opened. If you are using the @Command in an agent, be sure that the runtime type is set to "None" instead of "Selected Documents."

NOTE: The LotusScript language includes functionality to provide similar folder information programmatically. For details on this topic, refer to Document #1092899 [http://www.ibm.com/support/docview.wss?rs=463&uid=swg21092899], "LotusScript FolderReferences property helps determine in which folders a document is stored." [http://www.ibm.com/support/docview.wss?rs=463&uid=swg21092899]

What follows is the Domino Designer Online Help entry for @Command([DiscoverFolders])

DiscoverFolders @Command 
Displays the "Folders containing current document" dialog box. 

Note This @command is new with Release 7. 

Syntax 

@Command( [DiscoverFolders] ) 

Usage 

This command does not work on the Web. 

This command works only in a design element containing an embedded outline with the "Maintain folder unread information" property selected. Elsewhere in the design a document must be selected. Otherwise, the error "Cannot execute the specified command" occurs. 

The dialog box displays the names of the folders containing the document. The user can open a folder or remove the document from a folder. The dialog box is replaced by the message box "Document does not exist in any of the folders" if that is the case.

RELATED INFORMATION
 LotusScript FolderReferences property helps determine i [http://www.ibm.com/support/docview.wss?uid=swg21092899]




Cross reference information Segment Product Component Platform Version Edition Messaging Applications IBM Notes Lotus Notes Linux, Mac OS, Windows 8.5, 8.0, 7.0 All Editions