Title: IBM MustGather: Collecting data on the command line: WebSphere DataPower SOA Appliances problem determination - United States

Text:
MustGather; MustGather; MustGather; MustGatherDocument; MustGatherDocument; MustGatherDocument; MustGatherReadFirstDocument; datapower; data power; collect; data; command line; cli; must gather; must-gather; 7993; 7993; 7993; machine type 7993 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Collect the following MustGather information for IBM Support to use in troubleshooting problems with the WebSphere DataPower SOA Appliance. You may need to collect data through the command line interface (CLI). This document presents CLI commands you can use to collect data. 

RESOLVING THE PROBLEM
The following information describes the basic documentation needed by IBM support to investigate questions or problems when using IBM WebSphere DataPower SOA Appliances: 

 * WebSphere DataPower Integration Appliance XI50 
 * WebSphere DataPower XML Security Gateway XS40 
 * WebSphere DataPower XML Accelerator XA35.


Section 1: Resolving or Collecting information on this problem: 


When you log into the appliance, you will see information similar to the following: 

 * Welcome to DataPower XI50 console configuration.
 * 
 * (C) 2000-2006 by DataPower Technology, Inc.
 * 
 * 
 * Version: XI50.3.5.1.0 build 130692 on 2006/06/12 13:09:38
 * 
 * Serial number: xxxxx xxxxx
 * 
 * 
 * xi50#



This will allow you to get the model number, firmware number, and serial number. 

If you are already logged into the appliance, show version will give: 

xi50# show version 
version: XI50.3.5.1.0 
build: 130692 
build date: 2006/06/12 13:09:38 
watchdog build: XI50.3.5.1.0 
installed DPOS: XI50.3.5.1.0 
running DPOS: XI50.3.5.1.0 
MQ library: 6.0.0-0 
TAM library: 4.1 
Coproc library: 1.2 
Netegrity library: (not available) 
ODBC library: (not available) 
Tibco EMS library: (not available) 
serial: xxxxx xxxxx 
XML accelerator: xg3 

From this you can get the model and firmware version number (both from "version"). Then you can run show system to get the serial number. 

xi50# show system 
description: DataPower XI50 
serial number: xxxxx xxxxx 
product id: 9002-XI50-03 [Rev 04] 
OID: 1.3.6.1.4.1.14685.1.3 
uptime: 11 days 00:46:51 
contact: 
name: 
location: 
services: 72 


Set the following trace and logging settings: 

You will need to set the log level to debug for all message types so that the DataPower appliance will log everything. To set the log to debug: 

1. Enter show logging target to see what the log is currently set to: 
 * xi50# show logging target
 * 
 * 
 * logging target: default-log [up]
 * 
 * ---------------------------
 * 
 * admin-state enabled
 * 
 * summary "Default System Log"
 * 
 * type file
 * 
 * format text
 * 
 * timestamp sysloghe
 * 
 * size 500
 * 
 * local-file logtemp:///default-log
 * 
 * archive-mode rotate
 * 
 * rotate 3
 * 
 * ansi-color off
 * 
 * local-address
 * 
 * facility user
 * 
 * Signing Mode off
 * 
 * Encryption Mode off
 * 
 * event all error
 * 
 * event mgmt notice
 * 
 * 
 * 
 * 
 * 
 * 

2. Go to config mode to change the logging level: 
 * xi50# config
 * 
 * Global configuration mode
 * 
 * 

3. Use the logging event command to change what gets logged. The syntax is: logging event <name of log> all debug. 
 * xi50(config)# logging event default-log all debug


4. Repeat the show logging target command to see that the logging level is now debug. 
 * xi50(config)# show logging target
 * 
 * 
 * logging target: default-log [up]
 * 
 * ---------------------------
 * 
 * admin-state enabled
 * 
 * summary "Default System Log"
 * 
 * type file
 * 
 * format text
 * 
 * timestamp syslog
 * 
 * size 500
 * 
 * local-file logtemp:///default-log
 * 
 * archive-mode rotate
 * 
 * rotate 3
 * 
 * ansi-color off
 * 
 * local-address
 * 
 * facility user
 * 
 * Signing Mode off
 * 
 * Encryption Mode off
 * 
 * event mgmt notice
 * 
 * event all debug


Recreate the problem. 

Collect these files: 

1. Save the error report by typing save error-report. 
 * xi50(config)# save error-report
 * 
 * Error report written to temporary:///error-report.txt
 * 
 * 

2. Make a note of the error report directory, in this case temporary:/// 

3. Type show file <url given for error report> to make sure it's there. (You'll see a lot of text, the contents of the file.) 

 * xi50(config)# 
 * show file
 * 
 * temporary:///error-report.txt


4. Still in config mode, type backup all.zip to create an export of the configurations for all domains on the appliance: 

 * xi50(config)# backup all.zip

 *  Backup to all.zip scheduled (may take a few minutes to complete) 

 * 


5. Type dir export:/// to make sure it's there. 
 * xi50(config)# dir export:///
 * 
 * 
 * File Name Last Modified Size
 * 
 * --------- ------------- ----
 * 
 * querystrings/ Mon Jul 10 09:08:09 2006 1024
 * 
 * Basics/ Fri Jul 14 13:58:27 2006 1024
 * 
 * all.zip Fri Jul 21 10:26:49 2006 1217533
 * 


6. Make a note of the all.zip file's location. 

7. Note locations for any other relevant files, such as input files, .wsdl files, etc., or any file specifically requested by DataPower support. 

8. Download the error report, the backup file, and any other relevant documents from the DataPower appliance. Use the copy command with the scp or sftp protocol. This is much easier if you can transfer the files to a UNIX machine; Windows machines do not come with scp/sftp servers by default. 

N ote: scp URLs are implicitly rooted in your home directory. So if the file is actually on host xx.xx.xx.xx, in /home/jdoe/foo.txt, the scp description would be: 
 * 


and not 
 * 


Section 2. Preparing to contact IBM Support 
 1. Obtain the serial number of the appliance which experienced the problem. This is need for IBM entitlement processing, before a PMR can be created. Use the WebGUI, select Status > System > Version Information, locate tag on the case of the appliance, or from the CLI use Show System 
 2. Locate the firmware version of the appliance. Use the WebGUI, select Status > System > Version Information or from the CLI use Show Version 
 3. Have your IBM customer number ready. 
 4. Determine the severity of your problem based on the Severity Levels table found in the following technote: "WebSphere DataPower Extended Maintenance and Support Services". [http://www.ibm.com/support/docview.wss?rs=2362&uid=swg21254180#severity.] 
 5. Prepare to describe how the problem affects your business operations. 
 6. Determine which telephone number IBM should use to contact you concerning this problem report.



Section 3. Contacting IBM Support and sending your MustGather information to IBM Support 
 1. Reference our technote for information on Contacting IBM WebSphere DataPower SOA Appliance Support [http://www.ibm.com/support/docview.wss?rs=2362&uid=swg21236322]. 
 2. After you have contacted IBM Support, a PMR number will be assigned. Create a zip file of the MustGather information:  * A text file which contains: the questions and answers to any of the MustGather steps, elaboration on the problem, list of steps to recreate, notation on specific errors, and description external events noted at the time of the error. 
     * WebGui Screen Captures 
     * CLI command output results 
     * An error report at the time of the error as described in section 1. [http://www.ibm.com/support/docview.wss?rs=2362&uid=swg21235587] [http://www.ibm.com/support/docview.wss?rs=2362&uid=swg21242396] 
    
    
 3. Rename the zip file and send to IBM as noted in Exchanging information with IBM WebSphere DataPower Technical Support for problem determination [http://www-1.ibm.com/support/docview.wss?rs=2362&uid=swg21267385]. 
 4. Do not send any proprietary or confidential information from your company.


RELATED INFORMATION
#Collecting data: WebSphere DataPower SOA Appliances [http://www.ibm.com/support/docview.wss?uid=swg21235587]






Cross reference information Segment Product Component Platform Version Edition Business Integration WebSphere DataPower Integration Appliance XI50 Business Integration WebSphere DataPower XML Security Gateway XS40 Business Integration WebSphere DataPower XML Accelerator XA35