Title: IBM How can Domino be set up to work with Microsoft's Active Directory? - United States

Text:
ldap; ad; active directory; directory assistance; da TECHNOTE (FAQ)

QUESTION
What are the steps to set up the Lotus Domino server to be able to use the Microsoft Active Directory user repository?

ANSWER
There are several steps necessary to set up Domino's Directory Assistance to refer to an Active Directory LDAP server:
Hide details for I. Confirm the Active Directory Configuration [/support/docview.wss?uid=swg21293255&amp;aid=1]I. Confirm the Active Directory Configuration 

There are several attributes of the Active Directory server that can be used when configuring the Domino server, specifically they are: 

 1. The host name and port for your Active Directory server's LDAP task
    The Active Directory LDAP task may be listening for connections on the default LDAP port 389, but it is also common for it to listen on port 390. You should also verify a DNS hostname or IP address you can use to connect to the Active Directory LDAP service. 
 2. The search base of the Active Directory server
    The search base of the Active Directory server is configured when the Active Directory server is initially configured, and will usually have the format "DC=company,DC=com". Additionally, there may be a CN value before the DC values, such as "CN=Users,DC=company,DC=com". Search bases like this one must be used with caution since Active Directory may have one search base for users and a different search base for groups. For example, a group search base could be something like "CN=Groups,DC=company,DC=com". 
 3. A username and password that can be used to search the Active Directory server
    Some Active Directory servers require authentication in order to search their user store. For this reason, you will need to either make sure anonymous searches are allowed on the Active Directory server, or obtain a username and password from the Active Directory server which has sufficient permission to search for users and groups within the Active Directory user store. 
 4. The name of an LDAP attribute which contains a Domino hierarchical name
    If you have Domino users who also have Active Directory accounts you can link the Domino person document with the Active Directory record for purposes of web authentication. This will allow your users to authenticate with their Active Directory credentials but still be known to the Domino server by their Domino hierarchical name. If this has been set up then you will need to obtain the name of the LDAP attribute that is used to store the Domino hierarchical name within the Active Directory server. 
 5. A list of LDAP attributes that correspond with usernames that your users will want to use when logging in to the Domino server via HTTP
    When a user attempts to authenticate to the Lotus Domino HTTP server it will search the Active Directory server for the username entered. In order for the Domino server to find that the user exists, it must know which LDAP attribute's values may contain usernames used to log in via a web browser. Some common values for these are: cn, uid, samAccountName and mail. 
 6. The objectclass values for group entries from the Active Directory server
    The Lotus Domino server can be configured to use group information from the Active Directory server for authorization purposes. If this is configured, the Domino server must know how the groups are defined in the Active Directory LDAP server. Some common values for this are: groupOfNames, groupOfUniqueNames and group.


NOTE: The only mandatory information is hostname, port and search base, as all other values may not be necessary depending on your Active Directory configuration. 

You can use the ldapsearch utility to verify the information above once you have collected it. The ldapsearch tool comes with Domino server and Notes client installations and is located in the program directory of each.
Hide details for Verification of Items i - vi above [/support/docview.wss?uid=swg21293255&amp;aid=1]Verification of Items i - vi above 

You can use the following command to verify items i - iii above: 

ldapsearch -h active_directory_server_name -p active_directory_LDAP_port -b "base_for_active_directory" -D "test_username" -w "test_username_password" "(cn=test_user_name)" 

An example of this with values is: ldapsearch -h adserver.ibm.com -p 390 -b "CN=Users,DC=ibm,DC=com" -D "cn=test user,cn=users,dc=ibm,dc=com" -w "password" "(cn=test user)" 

This will search for the test user in the Active Directory LDAP server and will return all of the attributes associated with that user. Any errors received will give you clues as to what might be wrong with the ldapsearch you just issued. See technote 1214189 [http://www.ibm.com/support/docview.wss?rs=899&uid=swg21214189] for some of the possible return codes and their interpretation. 

You can use the following format to verify items iv and v from above: 

ldapsearch -h adserver.ibm.com -p 390 -b "dc=ibm,dc=com" -D "cn=test user,cn=users,dc=ibm,dc=com" -w "password" "(|(cn=test user)(uid=tuser)(samaccountname=tu123))" dominoName 

If the above command is successful, you should should see the user's name returned as well as the value of the dominoName attribute from the Active Directory server. The search filter "(|(cn=test user)(uid=tuser)(samaccountname=tu123))" is an example using common LDAP attributes whose values are used to log in to various systems. 

To verify item vi above you can use the following command: 

ldapsearch -h adserver.ibm.com -p 390 -b "dc=ibm,dc=com" -D "cn=test user,dc=ibm,dc=com" -w "password" "(&(cn=group name)(objectclass=groupofuniquenames))" 

If the group is found, then the objectclass value from item vi above is valid for your Active Directory server. 


Hide details for Configure Domino's Directory Assistance [/support/docview.wss?uid=swg21293255&amp;aid=1]Configure Domino's Directory Assistance 

Follow these steps if you do not have Directory Assistance already enabled on your server. To check this, use the command "show xdir" at the Domino server console and look for the line "Directory Assistance Data 'dbname.nsf' in use". If there is no database name in this line then you do not have Directory Assistance enabled on your server. 

 1. Create a new Database on the server using the "Directory Assistance" template and make note of the file name used:
    [/support/docview.wss?uid=swg21293255&aid=2] [/support/docview.wss?uid=swg21293255&aid=2] 
 2. Use the "Add Directory Assistance" button in this new database and fill in the fields of this new document:
    [/support/docview.wss?uid=swg21293255&amp;aid=3]



[/support/docview.wss?uid=swg21293255&aid=4] [/support/docview.wss?uid=swg21293255&aid=4]  


[/support/docview.wss?uid=swg21293255&aid=5] [/support/docview.wss?uid=swg21293255&aid=5] 


Hide details for Optional settings [/support/docview.wss?uid=swg21293255&amp;aid=1]Optional settings




Configure Domino to allow Active Directory Group Authorization (Basics tab) 

Group Authorization can be enabled under Basics tab of LDAP document. For more information refer to article from Domino InfoCenter "Directory assistance and group lookups for database authorization [http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/topic/com.ibm.help.domino.admin.doc/DOC/H_PLANNING_TO_USE_A_SECONDARY_DIRECTORY_FOR_ACL_GROUP_AUTHORIZATION_STEPS.html?resultof=%22%67%72%6f%75%70%22%20%22%61%75%74%68%6f%72%69%7a%61%74%69%6f%6e%22%20%22%61%75%74%68%6f%72%22%20%22%6c%64%61%70%22%20%22%64%69%72%65%63%74%6f%72%79%22%20%22%64%69%72%65%63%74%6f%72%69%22%20%22%61%73%73%69%73%74%61%6e%63%65%22%20%22%61%73%73%69%73%74%22%20]" 


http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp [http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp] 

Use custom filter if needed (LDAP tab). 

Active Directory filter uses predefined search filters that work with Active Directory servers which include sAMAccountName for the Authentication filter: (|(cn=LocalDomainAdmins)(sAMAccountName=LocalDomainAdmins)(uid=LocalDomainAdmins)(sn=LocalDomainAdmins)(givenname=LocalDomainAdmins)(mail=LocalDomainAdmins)) 

Additional information refer to article from Domino InfoCenter "Configuring search filters in a Directory Assistance document for a remote LDAP directory [http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/topic/com.ibm.help.domino.admin.doc/DOC/H_USING_CUSTOM_SEARCH_FILTERS_WHEN_CONNECTING_TO_AN_LDAP_DIRECTORY_STEPS.html?resultof=%22%61%63%74%69%76%65%22%20%22%61%63%74%69%76%22%20%22%64%69%72%65%63%74%6f%72%79%22%20%22%64%69%72%65%63%74%6f%72%69%22%20%22%66%69%6c%74%65%72%22%20]"

http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp [http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp] 

 



RELATED INFORMATION
 What are the LDAP return codes and message descriptions [http://www.ibm.com/support/docview.wss?uid=swg21214189]
Using ldapsearch [http://www.ibm.com/support/docview.wss?uid=swg27002627]