Title: IBM Call to Stored procedure fails: The statement did not return a result set - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 
The LWJDBC Adapter in a custom Business process is configured to call a MS SQL Stored Procedure that uses output parameters. The LightweightJDBCAdapterQuery step finished in ERROR:

The statement did not return a result set


SYMPTOM
 

LWJDBC Adapter does not return a result from the DB, The stored procedure has output parameters and SELECT statements instead of PROCEDURE


CAUSE
 

To execute a MS SQL Stored Procedure that uses an output parameter, the LWJDBC "sql" parameter must include the Declare, Execute and Select 
statements to return the output parameter.

In 5.2.x the source code has changed and you must change all Select queries to PROCEDURE

Please see Technote for more details: http://www-01.ibm.com/support/docview.wss?uid=swg21529647 [http://www-01.ibm.com/support/docview.wss?uid=swg21529647]


ENVIRONMENT
This problem will occur in all 5.2.x environments that have been upgraded from an older version



DIAGNOSING THE PROBLEM
 

1. Check that the stored procedure is returning 1 to the business process for the result set meaning the stored procedure has successfully executed. 

2. Check that stored procedure has PROCEDURE instead of SELECT statements


RESOLVING THE PROBLEM
 

To resolve this problem ensure that all SELECT commands in the SP are changed to PROCEDURE and that the result set is returning 1 to the Business Process. 

 

Check the stored Procedure and ensure that the following property is added in there: SET NOCOUNT ON