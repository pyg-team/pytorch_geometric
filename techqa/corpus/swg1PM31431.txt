Title: IBM PM31431: SERVICE INTEGRATION BUS TRANSACTION REMAINS INDOUBT AFTER MESSAGING ENGINE DATABASE OUTAGE - United States

Text:
  FIXES ARE AVAILABLE
7.0.0.19: WebSphere Application Server V7.0 Fix Pack 19 [http://www-01.ibm.com/support/docview.wss?uid=swg24030660]
7.0.0.21: WebSphere Application Server V7.0 Fix Pack 21 [http://www-01.ibm.com/support/docview.wss?uid=swg24031366]
7.0.0.23: WebSphere Application Server V7.0 Fix Pack 23 [http://www-01.ibm.com/support/docview.wss?uid=swg24032493]
7.0.0.25: WebSphere Application Server V7.0 Fix Pack 25 [http://www-01.ibm.com/support/docview.wss?uid=swg24033267]
7.0.0.27: WebSphere Application Server V7.0 Fix Pack 27 [http://www-01.ibm.com/support/docview.wss?uid=swg24033882]
7.0.0.29: WebSphere Application Server V7.0 Fix Pack 29 [http://www-01.ibm.com/support/docview.wss?uid=swg24034966]
7.0.0.31: WebSphere Application Server V7.0 Fix Pack 31 [http://www-01.ibm.com/support/docview.wss?uid=swg24036768]
7.0.0.27: Java SDK 1.6 SR13 FP2 Cumulative Fix for WebSphere Application Server [http://www-01.ibm.com/support/docview.wss?uid=swg24035324]
7.0.0.33: WebSphere Application Server V7.0 Fix Pack 33 [http://www-01.ibm.com/support/docview.wss?uid=swg24037573]
7.0.0.35: WebSphere Application Server V7.0 Fix Pack 35 [http://www-01.ibm.com/support/docview.wss?uid=swg24038310]
7.0.0.37: WebSphere Application Server V7.0 Fix Pack 37 [http://www-01.ibm.com/support/docview.wss?uid=swg24039338]
7.0.0.39: WebSphere Application Server V7.0 Fix Pack 39 [http://www-01.ibm.com/support/docview.wss?uid=swg24041013]
7.0.0.41: WebSphere Application Server V7.0 Fix Pack 41 [http://www-01.ibm.com/support/docview.wss?uid=swg24041931]
7.0.0.43: WebSphere Application Server V7.0 Fix Pack 43 [http://www-01.ibm.com/support/docview.wss?uid=swg24043400]
7.0.0.45: WebSphere Application Server V7.0 Fix Pack 45 [http://www-01.ibm.com/support/docview.wss?uid=swg24044551]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  When the messaging engine database suffers an outage, it is
   possible that Service Integration Bus (SIB) transactions remain
   indoubt indefinitely.  Any messages associated with that
   transaction remain locked and the transaction must be manually
   resolved.
   
   When this problem occurs messages in the SystemOut log will
   indicate that SIB responded with XAER_RMFAIL to xa_prepare
   followed by XAER_PROTO to xa_rollback or nothing further.
   
   WTRN0046E: An attempt by the transaction manager to call
   prepare on a transactional resource has resulted in an error.
   The error code was XAER_RMFAIL. The exception stack trace
   follows: javax.transaction.xa.XAException: CWSIC8007E: An
   exception was caught from the remote server with Probe Id
   3-013-0010. Exception: .
   at java.lang.Throwable.<init>(Throwable.java:67)
   at
   com.ibm.ws.sib.comms.common.CommsByteBuffer.parseSingleException
   (CommsByteBuffer.java:1694)
   at
   com.ibm.ws.sib.comms.common.CommsByteBuffer.getException(CommsBy
   teBuffer.java:1263)
   at
   com.ibm.ws.sib.comms.common.CommsByteBuffer.checkXACommandComple
   tionStatus(CommsByteBuffer.java:1218)
   at
   com.ibm.ws.sib.comms.client.OptimizedSIXAResourceProxy.prepare(O
   ptimizedSIXAResourceProxy.java:746)
   ...
   
   An FFDC at the messaging engine server will also indicate the
   same problem.
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED:  Users of the default messaging provider     *
   *                  for IBM WebSphere Application Server        *
   ****************************************************************
   * PROBLEM DESCRIPTION: Service Integration Bus transactions    *
   *                      remain indoubt indefinitely following   *
   *                      an outage of the messaging engine       *
   *                      database.                               *
   ****************************************************************
   * RECOMMENDATION:  The transactions must be resolved           *
   *                  manually.                                   *
   *                  NB: Care must be taken to ensure the        *
   *                  correct direction for the transaction is    *
   *                  chosen (i.e. commit or rollback) in order   *
   *                  to avoid data loss or duplication. Some     *
   *                  investigation may be required in some       *
   *                  cases to determine the correct direction.   *
   *                  If unsure, contact IBM support.             *
   *                  The following script can be used to         *
   *                  manually resolve the transaction:           *
   *                  http://publib.boulder.ibm.com/infocenter/wa *
   *                  s                                           *
   *                  info/v7r0/index.jsp?topic=/com.ibm.webspher *
   *                  e                                           *
   *                  .nd.multiplatform.doc/info/ae/ae/tjm0165_.h *
   *                  t                                           *
   *                  ml                                          *
   ****************************************************************
   A discrepancy between the in-memory state of the messaging
   engine and that persisted to its database caused the messaging
   engine to report that a transaction had not prepared
   successfully, when in fact it had.  The discrepancy arose from
   a failure at a particular point when the messaging engine was
   communicating with the database.
   
   
    
   
   

PROBLEM CONCLUSION
 *  Better state maintenance ensures that when the particular
   failure occurs, the correct transaction outcome results.
   
   The fix for this APAR is currently targeted for inclusion in
   fix pack 7.0.0.19.  Please refer to the Recommended Updates
   page for delivery information:
   http://www.ibm.com/support/docview.wss?rs=180&uid=swg27004980 [http://www.ibm.com/support/docview.wss?rs=180&uid=swg27004980]
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PM31431
   
   
 * REPORTED COMPONENT NAME
   PLAT MSG COM
   
   
 * REPORTED COMPONENT ID
   620800101
   
   
 * REPORTED RELEASE
   300
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2011-01-28
   
   
 * CLOSED DATE
   2011-02-22
   
   
 * LAST MODIFIED DATE
   2012-06-26
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   PLAT MSG COM
   
   
 * FIXED COMPONENT ID
   620800101
   
   

APPLICABLE COMPONENT LEVELS
 * R300 PSY
   UP