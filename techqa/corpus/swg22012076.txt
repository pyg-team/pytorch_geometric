Title: IBM Workflow is not triggered after documents are federated, got error message "Principal [Server] not found" - United States

Text:
Principal [Server] not found TECHNOTE (FAQ)

THIS DOCUMENT APPLIES ONLY TO THE FOLLOWING LANGUAGE VERSION(S):
 English 

QUESTION
 We have create event subscription to trigger the workflow after document is federated using CFS. The source is FileNet IS 4.0, target is CPE 5.2.1. 

The workflow is subscribed to the document creation event. However the workflow is not triggered after documents are federated. 

The following error is shown in p8 server error log:

2017-09-06T17:16:57.889 30533D75 ASYN FNRCV0006E - ERROR Failed dispatching QueueItem row {641C17F3-1D2E-4C6E-81FD-DA255F4F6542} 
com.filenet.api.exception.EngineRuntimeException: FNRCV0006E: EVENT_HANDLER_THREW: An exception occurred in the event handler. Message
was: [FNRPE0920020008E]The user or group could not be found. ([Server]) 
Root cause:com.filenet.api.exception.EngineRuntimeException: The requested item was not found. Principal [Server] not found. 

We want to know how to fix this issue?


CAUSE
This is a known issue that resulted from a change in the way that background tasks are executed that was implemented in the 5.2.1 release.Prior to 5.2.1, background tasks executed as the bootstrap user, which is an actual user that can be looked up in the LDAP. Starting with 5.2.1, background tasks execute as pseudo users that are not necessarily present in the LDAP. 

There were some unintended side effects, one of which is the fact that EntireNetwork.getCurrentUser() now fails when executed from a background task, as it is when executed from an event action. In this case, the customer is attempting to have documents federated from Content Manager OnDemand be declared as records automatically when upon federation. This behavior is implemented as an event action and the event action for auto-declare happens to call EntireNetwork.getCurrentUser(), which fails for the reason described above. 


ANSWER
The work around is to set the following Java system property, which will restore the old behavior: 

 
-Dcom.filenet.engine.init.BGThreadsAsBootstrapId=true 

Add this to the Generic JVM arguments for every Content Platform Engine instance in the environment and restart the instances. After doing so, the auto-declare event action should successfully execute when triggered for documents created by federation. 

Additionally, make sure your bootstrap account being granted monitor role at WAS console.