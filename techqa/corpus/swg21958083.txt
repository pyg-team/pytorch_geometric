Title: IBM How to identify crashed instance of a multi-instance DataStage job - United States

Text:
dsjob crashed HA_STATUS failover TECHNOTE (FAQ)

QUESTION
 For DataStage Engine tier failover, it is necessary to get the list of crashed jobs. Information Server Administration Guide suggests to use "dsjob -ljobs -status 96 project_name" command, but this command does not show crashed instance of a multi-instance job.

Is there a way to detect the crashed instance of a multiple instance job in a shell script? 

CAUSE
"dsjob -ljobs -status 96 ..." command prints only the job name, not the job invocation ID, so it cannot tell if a specific instance of a multiple instance job crashed or not, which is a limitation of the command.

ANSWER
Starting from DataStage 8.x, <project_directory>/HA_STATUS/job_name.[job_invocation_id] file is created when starting a job and deleted when finishing the job. For a crashed job, the file is not deleted. 


So, to check if an instance of multi-instance job crashed or not, do as follows. 

 

1. Get the list of possibly crashed jobs using the following commands: 

 * 
 * 
 * ls -l HA_STATUS 
 *  
 * Example: 
 * If instanceA or a multiple instance job JobA crashed, JobA.instanceA file will remain in HA_STAUS directory. 
 * 
   $ pwd
   /opt/IBM/InformationServer/Server/Projects/dstage1
   $ ls -l HA_STATUS
   total 8
   -rwxrwxr-x 1 dsadm dstage 20 Sep 07 14:34 JobA.instanceA
   


2. For the job instances of above step, run next command to confirm if the "Job status" is 96 (Crashed).  * 
 * 


 * Example
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * 
 * Job status=96 (Crashed)
 * 
 * 

RELATED INFORMATION
 Identifying and restarting crashed jobs [http://www-01.ibm.com/support/knowledgecenter/SSZJPZ_9.1.0/com.ibm.swg.im.iis.found.admin.ha.common.doc/topics/admclstr_crashrestart.html]