Title: IBM IT17979: FFDC files with probe ids MP003001 or MP003002 reporting RC=2161(MQRC_Q_MGR_QUIESCING) - United States

Text:
 SUBSCRIBE TO THIS APAR
By subscribing, you receive periodic emails alerting you to the status of the APAR, along with a link to the fix after it becomes available. You can track this item individually or track all items by product.

Notify me when this APAR changes.

Notify me when an APAR for this component changes.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  When using the MQ Managed File Transfer (MFT) component, if an
   agent is in the middle of creating a new CLIENT transport mode
   connection to its queue manager but the connection is then
   broken, for example because a request to shutdown the queue
   manager has been issued, one of two FFDCs can be generated from
   the Advanced Message Security (AMS) code that is part of the
   Java MQI (which handles all communication from an agent to /
   from a queue manager):
   
   FFDC 1
   --------
   Source Class      :-
   com.ibm.mq.ese.intercept.JmqiConnInterceptorImpl
   Source Method :- afterConnect
   ProbeID             :- MP003001
   
   Cause:1       :-  com.ibm.mq.jmqi.JmqiException:
   CC=2;RC=2161;AMQ9509:
   Program cannot open queue manager object. [1=2161,5=???]
   
   StackTrace:1  :-  com.ibm.mq.jmqi.JmqiException:
   CC=2;RC=2161;AMQ9509:
   Program cannot open queue manager object.   [1=2161,5=???]
   at com.ibm.mq.jmqi.internal.JmqiTools.getQueueManagerInfo
       (JmqiTools.java:838)
   at com.ibm.mq.jmqi.remote.impl.RemoteSession.loadInfo
       (RemoteSession.java:1997)
   at com.ibm.mq.jmqi.remote.impl.RemoteSession.getName
       (RemoteSession.java:2030)
   at com.ibm.mq.jmqi.remote.api.RemoteHconn.getName
       (RemoteHconn.java:728)
   at com.ibm.mq.ese.intercept.JmqiConnInterceptorImpl.validate
       (JmqiConnInterceptorImpl.java:321)
   at com.ibm.mq.ese.intercept.JmqiConnInterceptorImpl.afterConnect
       (JmqiConnInterceptorImpl.java:226)
   
   FFDC 2
   --------
   Source Class      :-
   com.ibm.mq.ese.intercept.JmqiConnInterceptorImpl
   Source Method :- afterConnect
   ProbeID             :- MP003002
   
   exception  :-  ExceptionDepth is 3
   
   Cause:1       :-  IBM WebSphere MQ Advanced Message Security
   internal error: could not inquire about queue manager properties
   ('2161').
   The IBM WebSphere MQ Advanced Message Security interceptor could
   not inquire about queue managers properties because an internal
   error occurred.
   Make sure that the queue manager is connected through IBM
   WebSphere MQ Advanced Message Security. If the problem persists,
   contact your IBM service representative
   
   Cause:2       :-  MQOPEN() call failed: reason code ('2161').
   The IBM WebSphere MQ Advanced Message Security interceptor call
   to the WebSphere MQ MQOPEN() function failed with the indicated
   error.
   Consult the WebSphere MQ documentation for an explanation of the
   error code and suggested corrective action. Ensure that the
   queue manager is operational, the q
   
   Message:1     :-  IBM WebSphere MQ Advanced Message Security
   internal error: could not inquire about queue manager properties
   ('2161').
   Message:2     :-  MQOPEN() call failed: reason code ('2161').
   
   StackTrace:1  :-  IBM WebSphere MQ Advanced Message Security
   internal error: could not inquire about queue manager properties
   ('2161').
   The IBM WebSphere MQ Advanced Message Security interceptor could
   not inquire about queue managers properties because an internal
   error occurred.
   Make sure that the queue manager is connected through IBM
   WebSphere MQ Advanced Message Security. If the problem persists,
   contact your IBM service representative.
   
   at com.ibm.mq.ese.service.EseMQServiceImpl.inqQmgrDlq
       (EseMQServiceImpl.java:204)
   at
   com.ibm.mq.ese.intercept.JmqiConnInterceptorImpl.pickQmgrDlqName
       (JmqiConnInterceptorImpl.java:264)
   at com.ibm.mq.ese.intercept.JmqiConnInterceptorImpl.afterConnect
       (JmqiConnInterceptorImpl.java:228)
   at
   com.ibm.mq.ese.intercept.JmqiConnInterceptorImpl.afterJmqiConnec
   t
       (JmqiConnInterceptorImpl.java:133)
   at com.ibm.mq.ese.jmqi.InterceptedJmqiImpl.jmqiConnect
       (InterceptedJmqiImpl.java:315)
   at com.ibm.mq.ese.jmqi.ESEJMQI.jmqiConnect
       (ESEJMQI.java:337)
   
   StackTrace:2  :-  MQOPEN() call failed: reason code ('2161').
   The IBM WebSphere MQ Advanced Message Security interceptor call
   to the WebSphere MQ MQOPEN() function failed with the indicated
   error.
   Consult the WebSphere MQ documentation for an explanation of the
   error code and suggested corrective action. Ensure that the
   queue manager is operational, the queue exists.
   
   at com.ibm.mq.ese.service.EseMQServiceImpl.exceptionOnMQOPEN
       (EseMQServiceImpl.java:687)
   at com.ibm.mq.ese.service.EseMQServiceImpl.inqStringQmgr
       (EseMQServiceImpl.java:269)
   at com.ibm.mq.ese.service.EseMQServiceImpl.inqQmgrDlq
       (EseMQServiceImpl.java:199)
   at
   com.ibm.mq.ese.intercept.JmqiConnInterceptorImpl.pickQmgrDlqName
       (JmqiConnInterceptorImpl.java:264)
   at com.ibm.mq.ese.intercept.JmqiConnInterceptorImpl.afterConnect
       (JmqiConnInterceptorImpl.java:228)
   at
   com.ibm.mq.ese.intercept.JmqiConnInterceptorImpl.afterJmqiConnec
   t
       (JmqiConnInterceptorImpl.java:133)
   at com.ibm.mq.ese.jmqi.InterceptedJmqiImpl.jmqiConnect
       (InterceptedJmqiImpl.java:315)
   
   
    
   
   

LOCAL FIX
 *  If not using Advanced Message Security (AMS) functionality,
   disable the AMS Java Interceptor using the instructions
   documented in APAR IC94205 [http://www-01.ibm.com/support/docview.wss?uid=swg1IC94205]:
   
   http://www-01.ibm.com/support/docview.wss?uid=swg1IC94205 [http://www-01.ibm.com/support/docview.wss?uid=swg1IC94205]
   
   
    
   
   

PROBLEM SUMMARY
 *  ****************************************************************
   USERS AFFECTED:
   This issue affects all users of the:
   
     - WebSphere MQ V7.5 classes for JMS
     - IBM MQ V8 and V9 classes for JMS (including the JCA Resource
   Adapter)
   
   who are not using the migration (v6 style) mode of operation.
   
   This issue also affects users of the:
   
     - MQ Managed File Transfer V7.5, V8 and V9
     - WebSphere Application Server V9 MQ messaging provider.
   
   
   Platforms affected:
   MultiPlatform
   
   ****************************************************************
   PROBLEM DESCRIPTION:
   If a CLIENT transport mode connection from a Java application
   using the Java MQI implementation (which includes the classes
   for JMS, classes for Java and Managed File Transfer agents) can
   be established, but the Advanced Message Security (AMS)
   component within the Java MQI layer is then unable to inquire
   information on the queue manager (such as the name of the Dead
   Letter Queue), then one of two FFDCs could have been generated.
    These are noted in the Problem Description section of this
   APAR.
   
   FFDC files (otherwise referred to as FFSTs) are intended for
   serious internal error occurs.  Being unable to inquire
   information on a queue manager, perhaps because of a broken
   connection or insufficient authority, does not warrant the
   generation of an FFDC.  However, the AMS Java Interceptor was
   treating any non-zero return code from the queue manager when
   querying the queue manager name or dead-letter queue as a
   serious error and generating an FFDC.
   
   
    
   
   

PROBLEM CONCLUSION
 *  From the IBM MQ V8.0.0.3 and V9.0.0.0 AMS Java Interceptor, the
   first FFDC noted in the Problem Description section of this APAR
   (with Probe ID MP003001) can no longer be generated.  This APAR
   removes that FFDC from WebSphere MQ V7.5 AMS Java Interceptor.
   
   This APAR also prevents the second FFDC noted in the Problem
   Description section of this APAR (with Probe ID MP003002) from
   being generated.
   
   ---------------------------------------------------------------
   The fix is targeted for delivery in the following PTFs:
   
   Version    Maintenance Level
   v7.5       7.5.0.8
   v8.0       8.0.0.7
   v9.0 CD    9.0.2
   v9.0 LTS   9.0.0.1
   
   The latest available maintenance can be obtained from
   'WebSphere MQ Recommended Fixes'
   http://www-1.ibm.com/support/docview.wss?rs=171&uid=swg27006037 [http://www-1.ibm.com/support/docview.wss?rs=171&uid=swg27006037]
   
   If the maintenance level is not yet available information on
   its planned availability can be found in 'WebSphere MQ
   Planned Maintenance Release Dates'
   http://www-1.ibm.com/support/docview.wss?rs=171&uid=swg27006309 [http://www-1.ibm.com/support/docview.wss?rs=171&uid=swg27006309]
   ---------------------------------------------------------------
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IT17979
   
   
 * REPORTED COMPONENT NAME
   WEBSPHERE MQ 7.
   
   
 * REPORTED COMPONENT ID
   5724H7240
   
   
 * REPORTED RELEASE
   750
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt / Xsystem
   
   
 * SUBMITTED DATE
   2016-11-15
   
   
 * CLOSED DATE
   2016-12-21
   
   
 * LAST MODIFIED DATE
   2017-06-01
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WEBSPHERE MQ 7.
   
   
 * FIXED COMPONENT ID
   5724H7240
   
   

APPLICABLE COMPONENT LEVELS
 * R750 PSY
   UP