Title: IBM Unable to start Apache Tomcat as a Windows service - United States

Text:
RQM; Tomcat; Windows; Service; Fails; Start TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 After installing and configuring Apache Tomcat to run as a Windows service to use with IBM Rational Quality Manager, the service fails to start. 

SYMPTOM
You may or may not see an error thrown from Windows when the service fails to start.

CAUSE
It is possible that the default Java Options for tomcat5w.exe are missing.

ENVIRONMENT
Either 32 or 64-bit Windows

DIAGNOSING THE PROBLEM
Check the following for errors logged:




 1. Go to the Windows Event Viewer and look under Applications. See if there are any errors for Tomcat5.exe. An example of a captured error:
    
    Faulting application name: tomcat5.exe, version: 1.0.2.0, time stamp: 0x4b7e5697
    Faulting module name: J9PRT23.dll, version: 2.3.0.57823, time stamp: 0x4be80b50
    Exception code: 0xc0000005
    Fault offset: 0x000000000000ca5f
    Faulting process id: 0x22c4
    Faulting application start time: 0x01cc326a1d40ce8d
    Faulting application path: C:\Program Files\IBM\JazzTeamServer\server\tomcat\bin\tomcat5.exe
    Faulting module path: C:\program files\ibm\JazzTeamServer\server\jre\bin\J9PRT23.dll
    Report Id: 5d6ffeaf-9e5d-11e0-953b-889ffaf61ab9
    
    
 2. Check the stderr_<date>.log file found under [JazzTeamServer Install Directory]\server\tomcat\logs\ and see if the following error is logged:
    
    java.lang.ClassNotFoundException: org.apache.catalina.startup.Catalina
    at java.net.URLClassLoader.findClass(URLClassLoader.java:497)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:639)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:605)
    at org.apache.catalina.startup.Bootstrap.init(Bootstrap.java:222)
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:410)
    
    
 3. Check the Java Options shown for tomcat5w.exe:  1. Go to [JazzTeamServer Install Dir]\server\tomcat\bin\ 
     2. Double-click tomcat5w.exe 
     3. Click the Java tab 
     4. In the Java Options section, ensure that you have the following options listed in addition to the options found from the setup guide on how to run Apache Tomcat as a Windows service:
    
     * Dcatalina.base=C:\Program Files\IBM\JazzTeamServer\server\tomcat 
     * Dcatalina.home=C:\Program Files\IBM\JazzTeamServer\server\tomcat 
     * Djava.endorsed.dirs=C:\Program Files\IBM\JazzTeamServer\server\tomcat\common\endorsed 
     * Djava.io.tmpdir=C:\Program Files\IBM\JazzTeamServer\server\tomcat\temp 
     * Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager 
     * Djava.util.logging.config.file=C:\Program Files\IBM\JazzTeamServer\server\tomcat\conf\logging.properties
    
    

RESOLVING THE PROBLEM
If you find the above errors logged and are missing the default Java Options, follow these steps: 

 1. In the Apache Tomcat Properties window (tomcat5w.exe), add the following default Java options, making sure to edit the path to reflect the correct JazzTeamServer installation path  * Dcatalina.base=C:\Program Files\IBM\JazzTeamServer\server\tomcat 
     * Dcatalina.home=C:\Program Files\IBM\JazzTeamServer\server\tomcat 
     * Djava.endorsed.dirs=C:\Program Files\IBM\JazzTeamServer\server\tomcat\common\endorsed 
     * Djava.io.tmpdir=C:\Program Files\IBM\JazzTeamServer\server\tomcat\temp 
     * Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager 
     * Djava.util.logging.config.file=C:\Program Files\IBM\JazzTeamServer\server\tomcat\conf\logging.properties
       
       
    
    
 2. Click Apply to save the additions
    
    
 3. Close the Apache Tomcat Properties window
    
    
 4. Rename stderr_<date>.log to stderr_<date>.log.bak so that it generates a new error log when the service is started
    
    
 5. Start the service. 
    It should start successfully now that the default Java Options are restored.
    
    If the service fails to start, check the event and tomcat logs again