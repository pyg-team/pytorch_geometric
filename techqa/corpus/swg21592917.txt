Title: IBM Configuring multiple domains for a single WebSphere Commerce instance - United States

Text:
 TECHNOTE (FAQ)

QUESTION
 How can I configure multiple domains for my WebSphere Commerce instance? 

ANSWER
Overall, configuring multiple domains is generally addressed at the web server tier through the use of Virtual Host definitions. When WebSphere Commerce generates absolute URLs within the various JSPs, the ServerName of the applicable domain is obtained from the request context. By leveraging this approach, the same WebSphere Commerce instance can utilize requests for multiple domains configured at the web server. 

For example, an Apache configuration may look similar to the following:


httpd.conf
...
Listen 80
...
...
<VirtualHost wcstore1.wcs.com:80>
ServerName wcstore1.wcs.com
Alias /wcsstore
"/opt/IBM/WebSphere/AppServer/profiles/demo/installedApps/WC_demo_cell/WC_demo.ear/Stores.war"
Alias /wcs
"/opt/IBM/WebSphere/AppServer/profiles/demo/installedApps/WC_demo_cell/WC_demo.ear/CommerceAccelerator.war"
</VirtualHost>
...

<VirtualHost wcstore2.wcs.com:80>
ServerName wcstore2.wcs.com
Alias /wcsstore
"/opt/IBM/WebSphere/AppServer/profiles/stage/installedApps/WC_stage_cell/WC_stage.ear/Stores.war"
Alias /wcs
"/opt/IBM/WebSphere/AppServer/profiles/stage/installedApps/WC_stage_cell/WC_stage.ear/CommerceAccelerator.war"
</VirtualHost>
...


Note: The Virtual Host declarations for the SSL ports may require unique SSLServerCert definitions for each domain if your certificate does not support multiple domains. See this [http://pic.dhe.ibm.com/infocenter/wasinfo/v7r0/topic/com.ibm.websphere.ihs.doc/info/ihs/ihs/tihs_setupssl.html] document for more information.

Ensure your Virtual Hosts are defined accordingly within the WebSphere Application Server Administration Console:
Environment > Virtual Hosts > VH_instance_name > Host Aliases

Afterward, regenerate and propagate the WebSphere Application Server Plug-in configuration file (plugin-cfg.xml) within the WebSphere Application Server Administration Console
Servers > Server Types > Web Servers > webserver1 > Generate Plug-in

Either propagate the plugin-cfg.xml file to the web server using the WebSphere Application Server Administration Console (IHS only) or manually copy the file to your web server machine (non-IHS).
Servers > Server Types > Web Servers > webserver1 > Propagate Plug-in

Source: <WAS_profiledir>/config/cells/../../nodes/../servers/<web_server_name>/plugin-cfg.xml
Destination: <Plugin_installdir>/config/<web_server_name>/plugin-cfg.xml


Note: The <instance_name>.xml file, or wc-server.xml, has a HostName definition in the WebServer element. The following functionality is dependant upon this host name definition: 

 1. The messaging CompositionRequestServlet for generating messages (For example: e-mails) from Views 
 2. The ImageServlet for fetching product images and thumbnails used by Management Center 
 3. The Store Preview feature in Management Center


This web server host name definition will not conflict with domain name resolution for requests to the Stores Request Servlet.