Title: IBM IC74758: ANS1688I SPARSE ATTRIBUTES FOR 'C:\SOMEDIR\SOMEFILE' CANNOT BE BACKED UP CORRECTLY - United States

Text:
AIX  FIXES ARE AVAILABLE
IBM Tivoli Storage Manager (TSM) Client 5.5.4 Downloads and READMEs [http://www-01.ibm.com/support/docview.wss?uid=swg24032025]
IBM Tivoli Storage Manager (TSM) Client 6.1.5 Downloads and READMEs [http://www-01.ibm.com/support/docview.wss?uid=swg24031696]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  When using the backup-archive client to back up a Microsoft
   Windows system, a message similar to the following might be
   issued:
   
   ANS1688I Sparse attributes for 'C:\somedir\somefile' cannot be
   backed up correctly because the volume from which the file is
   backed up does not support sparse files.
   
   Although this message should be issued only if the drive does
   not support sparse files, the Windows "fsutil" utility reports
   that the drive does support sparse files:
   
     C:\>fsutil fsinfo volumeinfo c:
     Volume Name :
     Volume Serial Number : 0xf882e3f5
     Max Component Length : 255
     File System Name : NTFS
     Supports Case-sensitive filenames
     Preserves Case of filenames
     Supports Unicode in filenames
     Preserves & Enforces ACL's
     Supports file-based Compression
     Supports Disk Quotas
     Supports Sparse files
       ...
   
   The problem described by this APAR can occur when all of the
   following conditions apply:
   
   - The file is sparse
   - The file cannot be accessed. Possible reasons include, but are
     not necessarily limited to:
      . The file is used exclusively by another application
         (Windows return code 32)
      . Windows security prevents access to the file
         (Windows return code 5)
   
   Under these conditions, even if an EXCLUDE statement is used to
   exclude the file from backup, the client will still examine the
   file, issue this message, then skip the file because it is
   excluded.
   
   Tivoli Storage Manager Versions Affected:
    Windows client  5.5.3   , 6.1.4 , 6.2.2
   The message is erroneously issued with these client
   levels due to the fix for IC68197 [http://www-01.ibm.com/support/docview.wss?uid=swg1IC68197] that was included
   in these levels.
   
    The following extract from a SERVICE trace shows the signature
   for this problem in a "file in use" situation :
   
   : cacheobj.cpp ( 977): dbQueryEntry(): DB Query Entry
      Operation - Elapsed time < 1 ms
   : cacheobj.cpp (1002): dbQueryEntry(): Key not found in db.
   : cacheobj.cpp (1015): dbQueryEntry(): exit., result code=104 .
   : ntfileio.cpp (9220): GetFileSecurityInfo(): Get security
      descriptors in new format for 'C:\somedir\somefile'
   : ntfileio.cpp (9386): GetFileSecurityInfo(): size of the SDs
      is 168.
   : ntfileio.cpp (5294): fioScanDirEntry(): Obtained NTFS
      File Security Info.
   : ntrc.cpp     ( 895): TransWin32RC(): Translated Win32
      RC 32 (0x00000020) from QueryAllocatedRanges(): CreateFile to
      TSM RC 933
   : ntrc.cpp     ( 967): TransWin32RC(): SnapshotErrMode = 0;
      dwWin32RC = 32
   
   Initial Impact: Medium
   
   Additional Keywords:
    zz61 zz62
   
   
    
   
   

LOCAL FIX
 *  If an ANS1688I message reports a file that resides on a volume
   that supports sparse files, then the message can be safely
   ignored. The message has no impact on whether the file is backed
   up. If the file should be backed up, then correct the condition
   that causes the file to be skipped. For example:
   
   - If a file is skipped because it is open for exclusive use by
   another application, ensure that the application closes the file
   before backing it up. You can also use Open File Support to back
   up the volume on which the files reside.
   
   - If a file is skipped because of an "access denied" error, make
   sure the backup runs with an account that has sufficient
   privilege to back up the file.
   
   
    
   
   

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED: Version 5.5.3, 6.1.4, 6.2.2 and 6.2.3        *
   *                 backup-archive clients running on Microsoft  *
   *                 Windows                                      *
   ****************************************************************
   * PROBLEM DESCRIPTION: See ERROR DESCRIPTION                   *
   ****************************************************************
   * RECOMMENDATION: Apply fixing level when available. This      *
   *                 problem is currently projected to be fixed   *
   *                 in levels 5.5.4, 6.1.5 and 6.2.4. Note that  *
   *                 until the fixing levels are available, this  *
   *                 information is subject to change at the      *
   *                 discretion of IBM.                           *
   ****************************************************************
   The ANS1688I message, introduced by the fix for APAR IC68197 [http://www-01.ibm.com/support/docview.wss?uid=swg1IC68197],
   is intended to be displayed when an attempt is made to back
   up a file whose sparse attribute is set, but exists on a file
   system that does not support sparse files. It is triggered if
   the backup-archive client is unable to query the sparse file's
   allocated ranges.
   
   However the backup-archive client might not be able to query a
   sparse file's allocated ranges for reasons other than the file
   system not supporting sparse files. For example, if the file is
   opened for exclusive use by another application so that the
   backup-archive client cannot read it, then the allocated ranges
   cannot be queried.
   
   An error in the backup-archive client code causes ANS1688I to
   be issued without regard for why the allocated ranges cannot be
   queried.
   
   
    
   
   

PROBLEM CONCLUSION
 *  The backup-archive client has been fixed so that the ANS1688I
   message is displayed only if the attempt to query a sparse
   file's allocated ranges is unsuccessful because the file system
   does not support sparse files. If the file cannot be backed up
   for other reasons, such as the file being used exclusively by
   another application, then another message will be issued to
   indicate why the file cannot be backed up.
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IC74758
   
   
 * REPORTED COMPONENT NAME
   TSM CLIENT
   
   
 * REPORTED COMPONENT ID
   5698ISMCL
   
   
 * REPORTED RELEASE
   55F
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2011-03-01
   
   
 * CLOSED DATE
   2011-03-31
   
   
 * LAST MODIFIED DATE
   2011-03-31
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

MODULES/MACROS
 *  DSMC
   
   
    
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   TSM CLIENT
   
   
 * FIXED COMPONENT ID
   5698ISMCL
   
   

APPLICABLE COMPONENT LEVELS
 * R55D PSY
   UP
   
   
 * R55F PSY
   UP
   
   
 * R55W PSY
   UP
   
   
 * R61D PSY
   UP
   
   
 * R61F PSY
   UP
   
   
 * R61W PSY
   UP
   
   
 * R62W PSY
   UP