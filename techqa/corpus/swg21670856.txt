Title: IBM SECJ0371W: Validation of the LTPA token failed - United States

Text:
SECJ0371W: Validation of the LTPA token failed; LTPAToken2; LTPAToken; validateLTPATokenCookies TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 WebSphere Portal requests that WebSphere Application Server validate LTPA tokens when generating URLs. This can result in multiple SECJ0371W warnings for each request that includes an invalid LTPA token. 

CAUSE
WebSphere Portal received a request with an expired or otherwise invalid LTPA token for which it needed to generate one or more URLs. By default, the LTPA token timeout is two hours. This timeout is encoded into the token itself. With the default settings, this condition could occur if someone logged in and worked in WebSphere Portal for longer than two hours.

DIAGNOSING THE PROBLEM
Review SystemOut.log for SECJ0371W warnings immediately followed by stack traces like: 

at com.ibm.wps.util.HttpUtils.validateLTPATokenCookies(HttpUtils.java:458)
at com.ibm.wps.auth.extensions.impl.ExtendedAuthenticationServiceImpl.isUserLoggedIn(ExtendedAuthenticationServiceImpl.java:136)
at com.ibm.wps.state.accessors.url.EngineURLOnRequest.isProtected(EngineURLOnRequest.java:371)
at com.ibm.wps.state.accessors.url.EngineURLOnRequest.reset(EngineURLOnRequest.java:450)
atcom.ibm.wps.state.accessors.url.URLAccessorFactoryExImpl.newURL(URLAccessorFactoryExImpl.java:319)

Such stack traces indicate that WebSphere Portal explicitly requests LTPA token validation from WebSphere Application Server during URL generation. This is by design.


RESOLVING THE PROBLEM
You can either ignore these warnings [http://www.ibm.com/support/docview.wss?uid=swg21670856] or suppress them. To suppress such warnings, set: 


com.ibm.ws.security.ltpa.LTPAServerObject=severe

per the WebSphere Application Server InfoCenter section on Log level settings [http://www.ibm.com/support/knowledgecenter/SSAW57_8.0.0/com.ibm.websphere.nd.multiplatform.doc/info/ae/ae/utrb_loglevel.html].

RELATED INFORMATION
 Log level settings [http://www.ibm.com/support/knowledgecenter/SSAW57_8.0.0/com.ibm.websphere.nd.multiplatform.doc/info/ae/ae/utrb_loglevel.html]
SECJ0371W [http://www.ibm.com/support/docview.wss?uid=swg21670856]