Title: IBM IC34012: SHOW LOGPINNED - United States

Text:
AIX SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  A new "undocumented" command is being added to the TSM
   server to help diagnose problems with a "pinned" recovery
   log.  The TSM manuals will not be updated to reflect this
   command, but the command will be supported within the
   context of why this command was created and the limitations
   on this command.  The new command is
   
   SHOW LOGPINNED
   In general there are five reasons why the recovery log is
   pinned.
   
   1 - There is a transaction associated with a session or
   process that is using space in the recovery log and that
   transaction has been processing for some time, and while
   this transaction is processing space in the recovery log
   is being used buy this transaction and other transactions.
   Space used by other transactions that started after this
   transaction has started is still "used space" in the
   recovery log until this log running transaction completes
   even if those other transactions complete.
   
   2 - The logmode is set to rollforward and space can not be
   freed until the next database backup.
   
   3 - A database backup is currently running and there is
   data in the recovery log that the TSM server still needs
   as part of the database backup processing.
   
   4 - There is a dirty page in the database buffer pool that
   needs to get flushed out to disk before the log tail can
   be advanced.
   
   5 - The log tail can not advance until the next checkpoint.
   A checkpoint is something that the server handles
   automatically as space is used in the recovery log.
   
   Some terminology:
   What is a "pinned" recovery log?  A pinned recovery
   log is when the "log tail" can not be moved because
   there is information needed in the recovery log for
   a transaction that is currently processing, for a
   transaction that has completed but has not been flushed
   to disk, for a currently running data base backup, or
   for a possible "roll-forward" operation on a data base
   restore.
   What is the "log tail"?  The log tail is the point in
   the recovery log that contains the oldest record still
   needed by the server.
   What is the "log head"?  The log head is the point that
   the next record will be written to the recovery log.
   When this command is issued the server will determine if one
   of the first four situations exists.  If none of the first
   four situations exist then the server will report that the
   recovery log is not pinned and space will be freed with the
   next checkpoint operation.
   
   If the second, third or fourth situations exist then the
   server will report which one of those conditions is causing
   the space to be pinned in the recovery log.
   
   If the first situation exists then the server will attempt
   to determine which session or process is associated with the
   transaction that is pinning space in the recovery log.  In
   the process of determining this there will be some additional
   information reported that can be useful if the server is
   unable to determine a session or process assocation with that
   transaction.  If the server is able to determine the session
   or transaction it will report the session or process
   number in addition to some other information such as the
   node name or the command issued for the process.
   
   This command is only intended to be run when the recovery log
   is actually pinned, therefore it is not recommended to
   schedule this command to run on a regular basis.  If the
   recovery log is not actually pinned there are some small
   timing windows where incorrect results may get reported.
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED: All TSM users having to diagnose a problem   *
   *                 with a recovery log that fills too fast.     *
   ****************************************************************
   * PROBLEM DESCRIPTION: There is currently no way to determine  *
   *                      the exact cause for space in the        *
   *                      recovery log not being released.        *
   ****************************************************************
   * RECOMMENDATION:                                              *
   ****************************************************************
   A new diagnostic command is being added to the TSM server.
   The command is SHOW LOGPINNED.  See the APAR opening text
   for details on this command.
   
   
    
   
   

PROBLEM CONCLUSION
 *  Apply this fix when available to have a new command
   SHOW LOGPINNED to help diagnose problems with a filling
   recovery log.
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IC34012
   
   
 * REPORTED COMPONENT NAME
   TSM SERVER 510
   
   
 * REPORTED COMPONENT ID
   5698ISMSV
   
   
 * REPORTED RELEASE
   51A
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2002-06-28
   
   
 * CLOSED DATE
   2002-06-28
   
   
 * LAST MODIFIED DATE
   2002-06-28
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
    IC33830
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   TSM SERVER 510
   
   
 * FIXED COMPONENT ID
   5698ISMSV
   
   

APPLICABLE COMPONENT LEVELS
 * R51A PSY
   UP
   
   
 * R51H PSY
   UP
   
   
 * R51S PSY
   UP
   
   
 * R51W PSY
   UP