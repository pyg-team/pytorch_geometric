Title: IBM Changing DataStage ITAG setting - United States

Text:
 TECHNOTE (FAQ)

QUESTION
 How can I change my exisiting DataStage installation ITAG setting? 

ANSWER
For this example we will be changing the current install to have an ITAG of "aaa" and a port number of 31540. 


 1.  Check that all users are out of DataStage and that no connections remain:
     
     netstat -a|grep dsrpc
     tcp 0 0 *:dsrpc *:* LISTEN
     
     You should only see the dsrpc daemon(s) in a listen state. If you see client connections, you need to get the users off the system first.
     
     
 2.  Stop the DataStage Engine
     
     cd to the DSEngine directory. 
     Ensure that the $DSHOME environment variable is set correctly, especially if you have multiple DataStage server installations on this system.
     Run: ./bin/uv -admin -stop
     
     Note: If you have multiple DataStage servers running, stop any server that has an ITAG or dsrpcd port setting that conflicts with what you are setting this server to.
     
     
 3.  Run the “itag change script” located in $DSHOME/scripts directory (must be run from DSEngine as root)
     
     cd $DSHOME
     
     scripts/DSEsettag.sh -itag <new tag> -verbose
     
     where <new tag> is the new tag. Example:
     
     scripts/DSEsettag.sh -itag aaa -verbose
     
     Note: If you are setting an itag install back to the default itag, you can run
     
     scripts/DSEsettag.sh -itag reset -verbose
     
     
 4.  Edit the /etc/services file and be sure the script changed the service name to match your itag. The original entry in /etc/services would have the default:
     dsrpc 31538/tcp #dsrpc RPC daemon 
     
     Port 31538 is the default port used by DataStage. The script should change that entry to:
     aaadsrpc 31538/tcp #dsrpc RPC daemon
     
     
 5.  You will need to change the default port 31538 to the non-default port of 31540 (or whatever port number you would like to use). Verify that the port number you pick is not already in use by another application. You can search or grep the /etc/services file for the port number you want to use to see if it is in use. It should now look like:
     aaadsrpc 31540/tcp #dsrpc RPC daemon
     
     
 6.  Verify that the script changed the itag setting in $DSHOME/sample/ds.rc file. There is a known issue where this may not get changed automatically. 
     
     # grep INSTANCETAG= $DSHOME/sample/ds.rc
     INSTANCETAG=aaa
     
     If it is not correct, edit $DSHOME/sample/ds.rc and change it manually.
     
     
 7.  Verify that the script changed the INSTANCETAG in $DSHOME/uvconfig:
     # grep INSTANCETAG $DSHOME/uvconfig
     # INSTANCETAG - Specifies a 3 digit hex value indicating
     INSTANCETAG aaa
     
     If for some reason the script did not change it, edit the $DSHOME/uvconfig file and manually change INSTANCETAG to have the new itag aaa.
     
     
 8.  Verify that the script changed the $DSHOME/script/info.sh script to use the new tag. There is a known issue where this does not get changed automatically. 
     
     # grep INSTANCETAG= $DSHOME/scripts/info.sh
     INSTANCETAG=aaa
     
     If it is not correct, edit $DSHOME/scripts/info.sh and change it manually.
     
     
 9.  cd to the $DSHOME/bin directory and verify that the following 3 programs now have the new itag prepended to their name:
     
     $ ls -l | grep aaa
     -rwxrwx--x 1 dsadm dstage 1592451 Mar 24 2006 aaadcfreest
     -rwsr-x--x 1 root dstage 1645099 Mar 24 2006 aaadsdlockd
     -rwxrwx--- 1 dsadm dstage 37243 Mar 24 2006 aaadsrpcd 
     
     If they still have the old names, manually rename the files.
     
     
 10. Once the changes have been made to the uvconfig file, cd into the $DSHOME directory and run: 
     
     bin/uv -admin -regen
     
     
 11. At this point you can restart DataStage if you are not switching the itag settings for any other instances of DataStage. If you are switching multiple instances of DataStage, bring all of the engines down for the instances that you are changing, make sure the $DSHOME environment variable is set to the instance that you are changing, and follow the steps above to change each instance (Be sure to reset the $DSHOME variable for each instance). Once you have completed all the instances, you can bring the engines back up. 
 12. The last step is for version 8.x ONLY.
     Run the RegistrationCommand script (use .bat or .sh as appropriate for your system). 
     **This command must be run on the Engine Tier.
     cd to the InformationServer/ASBNode/bin directory.
     Next run:
     ./RegistrationCommand.sh -sp dsrpcPort -app DSServer -val <newport> -user isadmin -password <adminPasswd> 
     Where isadmin can be any suite admin user.
     example ... 
     ASBNode/bin/RegistrationCommand.sh -sp dsrpcPort -app DSServer -val 31540 -user isadmin -password 12345 
 13. After step 12 is completed successfully, stop and restart WebSphere