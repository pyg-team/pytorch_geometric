Title: IBM How to implement a second CDC started task on a second LPAR for failover situations - United States

Text:
Second Cdc started task; failover TECHNOTE (FAQ)

QUESTION
 How to implement a second CDC started task on a second LPAR for failover situations 

CAUSE
CDC 10.2.1 provides the ability to implement a 2nd CDC started task on a 2nd LPAR within the sysplex. When configured appropriately data replication would failover to the 2nd started task in the event of a problem on the lpar where the primary CDC task was running (for instance in the event of an abend in the primary CDC task, or if that LPAR crashed, or to bring the task down for maintenance

ANSWER
The FailOver capability was originally added to assist the IDAA DB2 feature in providing a high availability solution. It is fully contained within ISCDC4zOS. It was Implemented originally as an SPE (Small Programming Enhancement) PTF to ISCDC4zOS V6R5M0, the documentation on how to use it was made available in ++HOLD statements within the PTF. The IDAA product provides documentation on how to set up a DVIPA configuration that uses the FailOver feature for an high availability configuration. The FailOver Feature was made available in V10R2M1 as base functionality. No ++HOLD statements can be consulted for V10R2M1. 

 Here are the requirements to use the ISCDC4zOS FailOver Feature, it is assumed that you are using a DB2 Data Sharing Group: 

1) Ensure that PTF UI23734 is applied to ISCDC4zOS. This PTF incorporates all currently available functionality and fixes for the FailOver Feature. 

2) Ensure that the CHCPALOG and CHCMTDTA VSAM clusters have SHROPTIONS(3,3) set. If not, issue the ALTER statements to change them. 

3) Ensure that the SSID parameter in the CHCDBMxx configuration control member specifies the DSG Group Attach Name and not the DB2 subsystem name. 

4) You may want to use DVIPA to provide automated routing of Management Console to Agent connections to the Active Agent when a FailOver occurs. This is described in the IDAA documentation, which can be found at http://www-01.ibm.com/support/docview.wss?uid=swg27037912 [http://www-01.ibm.com/support/docview.wss?uid=swg27037912],. 

5) The same JCL should be used to run multiple instances (Active and Hot-Standbys) of the product. Items 2) and 3) above will permit this. 

6) Bring up two instances of the product on different systems running members of the same DSG, using the same JCL. One will perform a normal initialization, this is the Active instance. The other will indicate that it is entering Hot-Standby mode. If additional instances are brought up, they will also enter Hot-Standby mode. 

7) If the Active instance is shut down, the Hot-Standby instance(s) will also shut down. If a Hot-Standby instance is shut down, the Active instance and any other Hot-Standby instances will not shut down. 

8) If the HANDOVER keyword is specified on the SHUTDOWN command for the Active instance, the Active instance will shut down, but the Hot-Standby instances will not shut down. One of the Hot-Standby instances will become the new Active instance, after issuing a message stating so. This is functionally identical to a FailOver after a catastrophic outage, but without the catastrophe. 

9) If the DB2 subsystem to which the Active instance is connected is shut down, then the Active instance will wait for DB2 to restart, and one of the Hot-Standby instances will change to Active mode. When the DB2 subsystem returns, the old Active instance will become another Hot-Standby instance. 

10) While a FailOver configuration is active (1 Active and at least 1 Hot-Standby), a GRS resource will exist that has one exclusive holder and at least one exclusive requestor active. This may show as an outstanding contention on some system monitors. It should be ignored, the feature is working as designed. 

11) The FailOver feature is coordinated with the subscription Persistancy Feature. During a FailOver action, persistent subscriptions will automatically be restarted by or connect to the new Active instance.