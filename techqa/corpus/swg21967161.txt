Title: IBM After an Object Store database migration and upgrade to Content Platform Engine 5.2.x the database schema name appears to be incorrect - United States

Text:
DatabaseSchemaName; CPE Upgrade; wrong schema TECHNOTE (FAQ)

QUESTION
 After an Object Store database migration and upgrade to FileNet Content Platform Engine (CPE) 5.2.x the database schema name appears to be incorrect. The Object Store in question cannot be accessed and the error message clearly indicates that the database schema name is incorrect. What steps can cause this condition and how can it be rectified? 

CAUSE
FileNet Content Engine (CE) versions prior to CPE 5.2.x used the default schema for the database user configured for the JDBC datasource pair. CPE 5.2.0 introduced support for Database Connection objects where a pair of JDBC datasources could be used by more than one object store. Each object store uses a schema name persisted as the DatabaseSchemaName property in order to separate which tables it accesses. 

During an upgrade from an earlier version to CPE 5.2.x, the database schema name is looked up and then stored in the object store properties. If the CPE 5.2.x EAR is deployed and the application is started then stopped and the database is migrated to another location, CPE may have already saved the schema name for the original database location. 

For example, if a CE 5.1.x Object Store uses datasources FNOS1DS and FNOS1DSXA which are configured using database user DBUSER1, all queries issued against the Object Store database do not use the fully qualified schema name but reference <tablename>. During the upgrade to CPE 5.2.x, the default schema name of the user configured in the datasources is looked up and persisted. All further queries against the object store database will include the schema name, for example DBUSER1.<tablename>. If the database is migrated to another server under schema name DBUSER2, then the object store will not be accessible. 


ANSWER
If the schema name is incorrect, you may not be able to access the properties of the respective Object Store in FileNet Enterprise Manager (FEM) or the Administration Console for Content Engine (ACCE). In order to access the Object Store properties, you may try to restore the database to the schema name referenced by CPE (DBUSER1 in the example above) first.

If using CPE 5.2.0.x you will then be able to use FileNet Enterprise Manager to modify the schema name to another value (DBUSER2), stop CPE and restore the database to the desired schema name. The schema name may not be modified in ACCE until a fix for APAR PJ43576 is applied. 

If unable to restore the database to the schema name expected by CPE, please contact IBM Support.