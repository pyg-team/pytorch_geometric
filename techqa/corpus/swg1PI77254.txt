Title: IBM PI77254: DMGR or Node Agent times out during shutdown issuing AdminException ADMU3060E - United States

Text:
  FIXES ARE AVAILABLE
9.0.0.4: WebSphere Application Server traditional V9.0 Fix Pack 4 [http://www-01.ibm.com/support/docview.wss?uid=swg24043693]
8.5.5.12: WebSphere Application Server V8.5.5 Fix Pack 12 [http://www-01.ibm.com/support/docview.wss?uid=swg24043844]
9.0.0.5: WebSphere Application Server traditional V9.0 Fix Pack 5 [http://www-01.ibm.com/support/docview.wss?uid=swg24044067]
9.0.0.6: WebSphere Application Server traditional V9.0 Fix Pack 6 [http://www-01.ibm.com/support/docview.wss?uid=swg24044242]
8.5.5.13: WebSphere Application Server V8.5.5 Fix Pack 13 [http://www-01.ibm.com/support/docview.wss?uid=swg24044479]
9.0.0.7: WebSphere Application Server traditional V9.0 Fix Pack 7 [http://www-01.ibm.com/support/docview.wss?uid=swg24044620]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  The hang on shutdown is due to a wait for initialization
   call
   being made by the IM_REST services running the dmgr and
   nodeagent processes. It's hanging because the P2P layer is
   not
   successfully initializing on the dmgr process.
   Regardless of the state of P2P , dmgr or nodeagent should
   not
   be hanging on shutdown.
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED:  All users of IBM WebSphere Application      *
   *                  Server WAS ND edition- Virtual              *
   *                  Enterprise/IM Component                     *
   ****************************************************************
   * PROBLEM DESCRIPTION: DMGR or Node Agent times out during     *
   *                      shutdown issuing AdminException         *
   *                      'ADMU3060E: Timed out waiting for       *
   *                      server shutdown.'.                      *
   ****************************************************************
   * RECOMMENDATION:                                              *
   ****************************************************************
   The Deployment Manager or Node Agent process times out during
   server shutdown issuing the following AdminException in
   SystemOut.log:
   ADMU3111E: Server stop requested but failed to complete.
   ADMU3002E: Exception attempting to process server dmgr
   ADMU3007E: Exception
   com.ibm.websphere.management.exception.AdminException:
   ADMU3060E: Timed out waiting for server shutdown.
   ADMU3007E: Exception
   com.ibm.websphere.management.exception.AdminException:
   ADMU3060E: Timed out waiting for server shutdown.
    at
   com.ibm.ws.management.tools.WsServerStop.runTool(WsServerStop.ja
   va:434)
    at
   com.ibm.ws.management.tools.AdminTool.executeUtility(AdminTool.j
   ava:271) ...
   
   Associated javacores taken while the server shutdown routine is
   hung will show a single running daemon thread waiting on
   'com/ibm/ws/wsgroup/nd/odc/ODCGroup' with the following stack:
   Java callstack:
    at java/lang/Object.wait(Native Method)
    at java/lang/Object.wait(Object.java:167(Compiled Code))
    at
   com/ibm/ws/wsgroup/nd/odc/ODCGroup.waitUntilReady(ODCGroup.java:
   278)
     (entered lock:
   com/ibm/ws/wsgroup/nd/odc/ODCGroup@0x0000000001A77FD8, entry
   count: 1)
    at
   com/ibm/ws/xd/agent/odc/rest/ODCServer.startService(ODCServer.ja
   va:506)
     (entered lock:
   com/ibm/ws/xd/agent/odc/rest/ODCServer@0x0000000001E668A0, entry
   count: 1)
    at
   com/ibm/ws/xd/agent/odc/XDAgentODCService$IMServiceStateChange.r
   un(XDAgentODCService.java:193)
   
   
    
   
   

PROBLEM CONCLUSION
 *  The Intelligent Management (IM) REST service, residing on the
   deployment manager and node agents, must wait until ODCGroup is
   up and healthy before accepting requests to avoid sending out
   partial routing information to its clients. However ODCGroup
   will never initialize if the P2P/SON communication layer fails
   to start and under that condition the IM REST service logic
   allowed the shutdown process on the deployment manager and node
   agents to hang. The IM REST service ODCGroup wait for
   initialization logic has been altered to prevent the hang
   condition on shutdown when the P2P/SON layer fails start-up.
   
   The fix for this APAR is currently targeted for inclusion in fix
   packs 8.5.5.12 and 9.0.0.4.  Please refer to the Recommended
   Updates page for delivery information:
   http://www.ibm.com/support/docview.wss?rs=180&uid=swg27004980 [http://www.ibm.com/support/docview.wss?rs=180&uid=swg27004980]
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PI77254
   
   
 * REPORTED COMPONENT NAME
   WEBS APP SERV N
   
   
 * REPORTED COMPONENT ID
   5724H8800
   
   
 * REPORTED RELEASE
   850
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt / Xsystem
   
   
 * SUBMITTED DATE
   2017-02-27
   
   
 * CLOSED DATE
   2017-03-08
   
   
 * LAST MODIFIED DATE
   2017-03-08
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WEBS APP SERV N
   
   
 * FIXED COMPONENT ID
   5724H8800
   
   

APPLICABLE COMPONENT LEVELS
 * R850 PSY
   UP