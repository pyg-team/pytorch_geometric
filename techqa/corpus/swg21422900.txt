Title: IBM Error 'Either BOF or EOF is True, or the current record has been deleted. Requested operation requires a current record' when running an ad-hoc report in Controller - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
User clicks "Reports - Ad Hoc". User selects a report, then chooses parameters (which include using a 'closing version' value of 'REPO'), and then clicks green 'tick' box to confirm the selections. User clicks 'Run' button. An error message appears. 

SYMPTOM
Screen: 

Information
Standard Error
Number: 5
Source: 
FrangoDirect.ReportAdHocD.AdHocCRN#....
<.....>...Either BOF or EOF is True, or the current record has been deleted. Requested operation requires a current record...<.....>
<.....>
[OK] 

 

Event Viewer (Application Log):
Event Type: Warning
Event Source: Cognos Controller
Event Category: None
Event ID: 0
Date: 03/03/2010
Time: 09:29:58
User: N/A
Computer: SERVERNAME
Description:
Standard Error
Number: 5
Source: FrangoDirect.ReportAdHocD.AdHocCRN#ControllerProxyClient.frmReportAdHoc.IFormStandardReport_CreateReportData:FrangoClient.clsStandardReports.CreateReport:FrangoClient.clsStandardReports.CreateReports:FrangoClient.clsStandardReports.PreviewReports.frmReportAdHoc.IPrint_DoPreview
Description: System.Web.Services.Protocols.SoapException: Server was unable to process request. ---> System.Runtime.InteropServices.COMException (0x800A0BCD): Either BOF or EOF is True, or the current record has been deleted. Requested operation requires a current record.
at FrReportB.ReportAdHocClass.AdHocCRN(String sGuid, String sUser, Recordset rsBnr, Recordset rsKeys, Int32 lLLocale, Boolean loksprak, String sXmlDoc)
at Cognos.Controller.Proxy.CCRWS.ReportAdHoc_AdHocCRN(String sGuid, String sUser, DataSet rsBnr, DataSet rsKeys, Int32 lLLocale, Boolean loksprak, String sXmlDoc)
--- End of inner exception stack trace ---
at Microsoft.VisualBasic.ErrObject.Raise(Int32 Number, Object Source, Object Description, Object HelpFile, Object HelpContext)
at Cognos.Controller.Common.RaiseErrCli.RaiseError(Int32 lErrNo, String sErrSource, String sErrDesc, String sErrHelpFile, Int32 lErrHelpContext)
at Cognos.Controller.Forms.Form.frmReportAdHoc.IPrint_DoPreview()
at Cognos.Controller.Forms.Form.frmReportAdHoc.IForm_DoClick(Int32 lCmd, String& sTag)

Event Type: Warning
Event Source: Cognos Controller
Event Category: None
Event ID: 0
Date: 03/03/2010
Time: 09:29:58
User: N/A
Computer: SERVERNAME
Description:
Error occured at 03/03/2010 09:29:58 in IBM Cognos 8 Controller, Error No=5, Source=FrangoDirect.ReportAdHocD.AdHocCRN#ControllerProxyClient.frmReportAdHoc.IFormStandardReport_CreateReportData:FrangoClient.clsStandardReports.CreateReport:FrangoClient.clsStandardReports.CreateReports:FrangoClient.clsStandardReports.PreviewReports.frmReportAdHoc.IPrint_DoPreview, Description=System.Web.Services.Protocols.SoapException: Server was unable to process request. ---> System.Runtime.InteropServices.COMException (0x800A0BCD): Either BOF or EOF is True, or the current record has been deleted. Requested operation requires a current record.
at FrReportB.ReportAdHocClass.AdHocCRN(String sGuid, String sUser, Recordset rsBnr, Recordset rsKeys, Int32 lLLocale, Boolean loksprak, String sXmlDoc)
at Cognos.Controller.Proxy.CCRWS.ReportAdHoc_AdHocCRN(String sGuid, String sUser, DataSet rsBnr, DataSet rsKeys, Int32 lLLocale, Boolean loksprak, String sXmlDoc)

Event Type: Warning
Event Source: VBRuntime
Event Category: None
Event ID: 1
Date: 03/03/2010
Time: 09:29:57
User: N/A
Computer: VBRACONT8AP9
Description:
The VB Application identified by the event source logged this Application FrReportB: Thread ID: 1732 ,Logged: Error occured at 03/03/2010 09:29:57 in FrReportB, Error No=3021, Source=FrReportB.ReportAdHoc.AdHoc, Description=Either BOF or EOF is True, or the current record has been deleted. Requested operation requires a current record., HelpFile= HelpContext=0 

CAUSE
Corrupt database. For an unknown reason, the closing version 'REPO' was missing in the table 'xbtypgrp'.

DIAGNOSING THE PROBLEM
Click 'Maintain/Configuration/Define/Define Closing Version/Journal Type'. You will find 'REPO' but there is no journal type connected to it. REPO cannot be changed in 'Define Closing Version' since it is a default closing version. 

RESOLVING THE PROBLEM
Manually add the missing 'REPO' inside database table 'xbtypgrp'.

Steps: 

 1.  Obtain a period of downtime (no users in system) 
 2.  Logon to the SQL server as an administrator 
 3.  Launch 'SQL Server Management Studio' 
 4.  As a precaution, backup the Controller database to a file 
 5.  Afterwards, expand the database, then expand 'Tables' 
 6.  Right-click on table 'xbtypgrp' and choose 'Open Table' 
 7.  There are two columns, called 'grupp' and 'btyp'. Notice how there is currently not an entry called 'REPO' underneath 'grupp' 
 8.  Scroll to the bottom, and locate the two 'NULL' entries at the bottom 
 9.  Inside the column 'grupp', replace 'NULL' by typing in REPO (in capital letters) 
 10. Leave the corresponding cell inside the column 'btyp' blank (no not type anything inside here) 
 11. Close 'SQL Server Management Studio' 
 12. Test