Title: IBM Out of Memory Error During CCL Startup For OmniFind Enterprise Edition - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 My OmniFind Enterprise Edition Version 8.5 or 9.1 server fails to start up and the command line console displays a java.lang.OutOfMemoryError. The error produces a javacore and a heap dump. 

SYMPTOM
CCL fails to start and a javacore and heapdump is created.

CAUSE
A large file in the OmniFind master_config directory can cause an out-of-memory error during OmniFind startup. This happens because the CCL is trying to synchronize the master_config directory to the config directory and it loads those files during the process. Typically the config files are all very small, but if there is an unexpectedly large file in that directory, the error may occur. 

The esservice command can produce a potentially large zip file in the directory in which it is run. If esservice is inadvertently run from the master_config directory and the resultant zip file is left there, it can lead to this startup error.


DIAGNOSING THE PROBLEM
 

 1. Stop CCL using "stopccl.sh" 
 2. Edit ES_INSTALL_ROOT/configurations/ccl.properties as follows:  1. Change console log level "java.util.logging.ConsoleHandler.level=FINER" 
     2. Enable detailed logging by adding this line "com.ibm.es.ccl.server.responders.sys.sync.FileGroup.level=FINER" 
    
    
 3. Start CCL in foreground using "startccl.sh -fg"


With the FINER logging level, the console output may look like the following example: 

com.ibm.es.ccl.server.responders.sys.sync.FileGroup syncWith 
FINER: Update candidates [[collectionID].[crawlerID]/service_timestamp.zip, [collectionID]_config.ini, [collectionID].[crawlerID]/jdbccrawler.xml, vault.xml, services.ini_bkp, [collectionID2].[crawlerID2]/jdbccrawler.xml, [collectionID2]_config.ini, [collectionID2].indexservice/collection.xml] 
JVMDUMP006I Processing dump event "systhrow", detail "java/lang/OutOfMemoryError" - please wait. 
JVMDUMP032I JVM requested Heap dump using '/data/omni/esadmin/logs/heapdump.[timestamp].phd' in response to an event 
JVMDUMP010I Heap dump written to /data/omni/esadmin/logs/heapdump.[timestamp].phd 
JVMDUMP032I JVM requested Java dump using '/data/omni/esadmin/logs/javacore.[timestamp].txt' in response to an event 
JVMDUMP010I Java dump written to /data/omni/esadmin/logs/javacore.[timestamp].txt 
JVMDUMP032I JVM requested Snap dump using '/data/omni/esadmin/logs/Snap.[timestamp].trc' in response to an event 
JVMDUMP010I Snap dump written to /data/omni/esadmin/logs/Snap.[timestamp].trc 
JVMDUMP013I Processed dump event "systhrow", detail "java/lang/OutOfMemoryError". 
java.lang.OutOfMemoryError 
at java.util.Arrays.copyOfRange(Arrays.java:4138) 
at java.util.Arrays.copyOf(Arrays.java:3870) 
... 

In the second line, the [collectionID].[crawlerID]/service_[timestamp].zip file is actually an out-of-place esservice output zip file and very large in size. 

It is located at master_config/[collectionID].[crawlerID]/service_[timestamp].zip 
RESOLVING THE PROBLEM
Relocate or remove any extraneous large files in the OmniFind master_config directory. 

Remove any Finer logging levels enabled earlier before restarting the CCL.