Title: IBM HD88661: GENERATE REPORT FROM MACROS . - United States

Text:
AIX SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  This issue concern the utilisation of automation API
   RpmReport.
   Consider we  would like to generate a report with
   this class.
   For this we don't understand how to use the
   RpmReport class and we have not any sample or documenttion
   explaining the use of RpmReport.
   So regarding your last email,
   you write " there are missing pieces that we need to put in
   before you can access the RpmReport VB object from a Document
   VB object.  When we supply the missing pieces, the following
   sample code will work.   Currently, the highlighted line will
   fail. "
   For this I create this IR.
   for remembering the code
   of macro is :
   '===============================================================
   Sub CATMain
   ()
   '===============================================================
   Dim objCATIAV5CurDocument As
   Document
   Dim objPrdRoot As Product
   Dim objRpmReport As
   RpmReport
   'Assume the current document is the CATProduct
   containing all the objects to be reported
   Set
   objCATIAV5CurDocument = CATIA.ActiveDocument
   If (
   objCATIAV5CurDocument Is Nothing  ) Then
   CATIA.SystemService.Print "Unable to get Active document"
   Else
   CATIA.SystemService.Print
   "Succeeded in getting Active document"
   Set objPrdRoot =
   objCATIAV5CurDocument.Product
   End If
   If ( objPrdRoot
   Is Nothing  ) Then
   CATIA.SystemService.Print "Unable to
   get product root"
   Else
   CATIA.SystemService.Print "Success in getting product root"
   Set objRpmReport =
   objPrdRoot.GetTechnologicalObject("RpmReport")
   End If
   If (objRpmReport Is Nothing) Then
   CATIA.SystemService.Print "Unable to get reporter interface
   handle"
   Else
   CATIA.SystemService.Print "Success in
   getting reporter interface handle"
   objRpmReport.GenerateReport
   "Q:\prjapa19_pc\CATReporterModeler.tst\FunctionTests\InputData\S
   "d:\sampleRpmOutput.txt",
   "Text (*.txt)", ""
   End If
   End Sub
   '/////////////////////////////////////////////////////////// CAT
   CATMain
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  This issue concern the utilisation of automation API
   RpmReport.
   Consider we  would like to generate a report with
   this class.
   For this we don't understand how to use the
   RpmReport class and we have not any sample or documenttion
   explaining the use of RpmReport.
   So regarding your last email,
   you write " there are missing pieces that we need to put in
   before you can access the RpmReport VB object from a Document
   VB object.  When we supply the missing pieces, the following
   sample code will work.   Currently, the highlighted line will
   fail. "
   For this I create this IR.
   for remembering the code
   of macro is :
   '===============================================================
   Sub CATMain
   ()
   '===============================================================
   Dim objCATIAV5CurDocument As
   Document
   Dim objPrdRoot As Product
   Dim objRpmReport As
   RpmReport
   'Assume the current document is the CATProduct
   containing all the objects to be reported
   Set
   objCATIAV5CurDocument = CATIA.ActiveDocument
   If (
   objCATIAV5CurDocument Is Nothing  ) Then
   CATIA.SystemService.Print "Unable to get Active document"
   Else
   CATIA.SystemService.Print
   "Succeeded in getting Active document"
   Set objPrdRoot =
   objCATIAV5CurDocument.Product
   End If
   If ( objPrdRoot
   Is Nothing  ) Then
   CATIA.SystemService.Print "Unable to
   get product root"
   Else
   CATIA.SystemService.Print "Success in getting product root"
   Set objRpmReport =
   objPrdRoot.GetTechnologicalObject("RpmReport")
   End If
   If (objRpmReport Is Nothing) Then
   CATIA.SystemService.Print "Unable to get reporter interface
   handle"
   Else
   CATIA.SystemService.Print "Success in
   getting reporter interface handle"
   objRpmReport.GenerateReport
   "Q:\prjapa19_pc\CATReporterModeler.tst\FunctionTests\InputData\S
   "d:\sampleRpmOutput.txt",
   "Text (*.txt)", ""
   End If
   End Sub
   '/////////////////////////////////////////////////////////// CAT
   CATMain
   
   
    
   
   

PROBLEM CONCLUSION
 *  THIS PROBLEM WILL BE FIXED ON   VERSION V5R20 GA level.
   NOTE
   THAT THIS PROBLEM WILL ALSO BE FIXED ON V5R19 SP6.
   Additional
   Closure Information:
   The problem of VB API GenerateReport was
   due to fact that we have missing a bridge from the CATProduct
   document to get the RpmReport VB object, given a root
   product.
   So Now this problem has been corrected and it's
   possible to generate RPM Report
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   HD88661
   
   
 * REPORTED COMPONENT NAME
   CATIA V5 NT>XP
   
   
 * REPORTED COMPONENT ID
   569151000
   
   
 * REPORTED RELEASE
   518
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2009-09-10
   
   
 * CLOSED DATE
   2009-09-23
   
   
 * LAST MODIFIED DATE
   2009-09-23
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   CATIA V5 NT>XP
   
   
 * FIXED COMPONENT ID
   569151000
   
   

APPLICABLE COMPONENT LEVELS
 * R518 PSN
   UP