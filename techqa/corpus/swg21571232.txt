Title: IBM Debug a user-defined function or aggregate (UDX) - United States

Text:
 TECHNOTE (FAQ)

QUESTION
 How can I debug my UDX? 

ANSWER
To debug a User-Defined Function or Aggregate (UDX), you can add debug messages to your UDX that are only generated when the function or aggregate is in a debug mode.
1. Add the logMsg function (similar to the following examples) in areas of your code that are likely to prove helpful to troubleshoot your code.


 * logMsg(LOG_DEBUG, "Found a length of %d\n", lengths);

or  * logMsg(LOG_TRACE, "Found a length of %d\n", lengths);


2. Once you've added the necessary logMsg function calls, re-compile your UDX and re-register it in the appropriate database. 

3. Once the UDX has been registered, alter it to allow for debug or trace mode. 
 * MYDATABASE(ADMIN)=>alter function myFunction (int4) logmask debug,trace;


Possible logmask options are: 


LOGMASK Option Description NONE No special debugging available (default) TRACE logMsg function calls with LOG_TRACE flag are generated DEBUG logMsg function calls with LOG_DEBUG flag are generated TRACE,DEBUG logMsg function calls with either LOG_DEBUG or LOG_TRACE are generated 
By having two separate flags, you have varying levels of verbosity within the UDX. 

4. The database must be restarted to allow for the capture of debug messages. This can be done by running the following commands: 
 * [nz@cs-spubox6 nz]$ nzstop
 * 
 * [nz@cs-spubox6 nz]$ nzstart -log /nz/kit/log/init.log


By using -log /nz/kit/log/init.log, you ensure that any debug messages generated by an NPS component will be written to the log file specified. 

5. Once the system is online, run the debug command: 
 * [nz@cs-spubox6 nz]$ nzudxdbg --user admin --pw password -â€“on --file 


You can now run your UDX and review the debug information by reviewing the /nz/kit/log/init.log file. You should see messages similar to: 
 * (event006.1001) [d,udx] Found a length of 12


This indicates that process event 006 generated this message on SPU hardware ID 1001. 

Disabling Debug Info 

1. To disable the debug information generated by your UDX, run one of the following commands: 
 * MYDATABASE(ADMIN)=>alter function myfunction (int4) logmask none;


or 
 * MYDATABASE(ADMIN)=>alter aggregate myAggregate (int4) logmask none;


2. Also, you should disable UDX debugging with the following command: 
 * [nz@cs-spubox6 nz]$ nzudxdbg --user admin -pw password --off


Which should produce output similar to: 
 * Processing 4 spus
 * 
 * ....
 * 
 * done
 * 
 * Processing host
 * 
 * done

 

HISTORICAL NUMBER
 NZ873274