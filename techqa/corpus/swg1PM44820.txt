Title: IBM PM44820: WMQ Z/OS 7.0.1: SLOW PROCESSING OF MESSAGES IN THE SYSTEM.CLUSTER.COMMAND.QUEUE - United States

Text:
z/os  A FIX IS AVAILABLE
Obtain the fix for this APAR.


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  Slow consumption of the messages from the
   SYSTEM.CLUSTER.COMMAND.QUEUE is reported on v701 with increased
   work load but not on v6.
   The problem here is that rrmMaintenance keeps rescheduling
   itself to run immediately, and as a result the repository task
   doesn't get a chance to get messages from the
   SYSTEM.CLUSTER.COMMAND.QUEUE.
   It also explains why we would see RC=2189, because cluster
   resolution hasn't occurred within the 10 seconds. The reason is
   that the publications from the full repository are at
   the end of the command queue, and it takes longer than
   10 seconds for them to be processed.
   Symptom:
   Cluster Repository manager is stopped and is not restartable
   with below message:
   CSQX038E ;CSQ1 CSQXREPO Unable to put message to
   SYSTEM.CLUSTER.TRANSMIT.QUEUE, MQCC=2 MQRC=2269
   CSQX411I ;CSQ1 CSQXREPO Repository manager stopped.
   And applications trying to open cluster queues encounter
   problems (MQ (RC2189):MQRC_CLUSTER_RESOLUTION_ERROR)/failures.
   
   
    
   
   

LOCAL FIX
 *  If recycling the MSTR and CHINIT does not bypass the
   problem.  PUT inhibit the SYSTEM.CLUSTER.COMMAND.QUEUE
   and allow the messages to drain.  Recycle the CHINIT.
   
   
    
   
   

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED: All users of WebSphere MQ for z/OS version 7 *
   *                 Release 0 Modification 1.                    *
   ****************************************************************
   * PROBLEM DESCRIPTION: Slow processing of messages on the      *
   *                      SYSTEM.CLUSTER.COMMAND.QUEUE.           *
   *                      Also high CHINIT CPU may be seen,       *
   *                      especially during CHINIT                *
   *                      initialisation.                         *
   *                      Applications may get RC=2189 when       *
   *                      putting to previously unreferenced      *
   *                      cluster queues.                         *
   ****************************************************************
   * RECOMMENDATION:                                              *
   ****************************************************************
   As part of CHINIT start-up rrmRepository first executes
   rrmInitRepos to create the cache (if required) and then
   adds a timer element to run rrmMaintenance.
   Later rrmRepository calls rrmGetMsg. This first checks the
   timer chain by running rrmRunTimers, and finding the timer
   element it calls rrmMaintenance.
   rrmMaintenance finds that the reconcile2 flag is still on so
   it reschedules itself immediately and exits. rrmRunTimers
   finds this new element on the timer chain and schedules
   rrmMaintenance and so this process continues for a long time,
   preventing rrmGetMsg from proceeding to process the messages
   from the SYSTEM.CLUSTER.COMMAND.QUEUE.
   The reconcile2 flag will not be set to zero until a new message
   arrives on the command queue or the queue is empty, and
   therefore rrmMaintenance will continue to be rescheduled
   in this way.
   
   
    
   
   

PROBLEM CONCLUSION
 *  rrmMaintenance has been changed so that it always reschedules
   itself at hourly intervals.
   Also, rrmMaintenance will not be scheduled to run unless the
   reconcile2 flag has been switched off.
   010Y
   AMQRRMHA
   CSQXRCTL
   CSQXRRMF
   
   
    
   
   

TEMPORARY FIX
 *  *********
   * HIPER *
   *********
   
   
    
   
   

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PM44820
   
   
 * REPORTED COMPONENT NAME
   WMQ Z/OS V7
   
   
 * REPORTED COMPONENT ID
   5655R3600
   
   
 * REPORTED RELEASE
   000
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   YesHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2011-08-01
   
   
 * CLOSED DATE
   2011-08-23
   
   
 * LAST MODIFIED DATE
   2012-05-07
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
    UK71098 IV09401 [http://www-01.ibm.com/support/docview.wss?uid=swg1IV09401]
   
   

MODULES/MACROS
 *  AMQRRMHA CSQXRCTL CSQXRRMF
   
   
    
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WMQ Z/OS V7
   
   
 * FIXED COMPONENT ID
   5655R3600
   
   

APPLICABLE COMPONENT LEVELS
 * R010 PSY UK71098 [HTTPS://WWW14.SOFTWARE.IBM.COM/WEBAPP/SET2/ORDERMEDIA/SHOPCART?PTFS=UK71098]
   UP11/09/10 P F109
   
   

FIX IS AVAILABLE
 * SELECT THE PTF APPROPRIATE FOR YOUR COMPONENT LEVEL. YOU WILL BE REQUIRED TO SIGN IN. DISTRIBUTION ON PHYSICAL MEDIA IS NOT AVAILABLE IN ALL COUNTRIES.