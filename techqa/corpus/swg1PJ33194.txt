Title: IBM PJ33194: FAIL TO DELETE CENTERA MIGRATED FILES FROM STORAGE AREA ON LINUX 4 - United States

Text:
 SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  Description of Problem (full details)
   Documents are not deleted from staging area and the number of
   files keeps growing (since files are not deleted), consuming
   disk space.  It is unclear whether these documents have already
   been migrated to Centera.  There is not a known way to verify
   if documents have been migrated.
   Errors in p8_server_error.log seems to indicate this issue is
   related to ecmdb00749721, e.g.,
   com.filenet.api.exception.EngineRuntimeException:
   E_UNEXPECTED_EXCEPTION: An unexpected exception was detected.
   Failed to delete content element file:
   /apps/FileNET/FileStore/Staging_Area/content/FN10/FN14/FN{F7C31
   818-E387-4436-9B0A-3DFDDFB08CD8}{35C47D2A-AFB8-4706-B39E-A1194F
   0C3C7A}-0.zip at
   com.filenet.engine.content.FileContentArea.rollfwdDeleteAllCont
   entElements(FileContentArea.java:2020) at
   com.filenet.engine.content.FixedContentArea.executeRollFwdComma
   nd(FixedContentArea.java:1358) at
   com.filenet.engine.content.BaseContentArea.executeRollFwdComman
   d(BaseContentArea.java:1605) at
   com.filenet.engine.queueitem.ContentQueueWorker.processBatch(Co
   ntentQueueWorker.java:344) at
   com.filenet.engine.queueitem.ContentQueueWorker.execute(Content
   QueueWorker.java:93) at
   com.filenet.engine.tasks.BackgroundTask.safeExecute(BackgroundT
   ask.java:185) at
   com.filenet.engine.tasks.BackgroundTask.access$000(BackgroundTa
   sk.java:39) at
   com.filenet.engine.tasks.BackgroundTask$BackgroundTaskPriviledg
   edExceptionAction.run(BackgroundTask.java:628) at
   com.filenet.engine.context.CallState.doAsSystem(CallState.java:
   391) at
   com.filenet.engine.tasks.BackgroundTask.run(BackgroundTask.java
   :141) at
   com.filenet.engine.jca.workmgr.ThreadPool$WorkerThread.run(Thre
   adPool.java:85)
   Caused by: com.filenet.api.exception.EngineRuntimeException:
   CONTENT_CA_DELETE_SCRUB_FAILED: Unable to scrub file for secure
   delete:
   /apps/FileNET/FileStore/Staging_Area/content/FN10/FN14/FN{F7C31
   818-E387-4436-9B0A-3DFDDFB08CD8}{35C47D2A-AFB8-4706-B39E-A1194F
   0C3C7A}-0.zip. An error occured while scrubbing file with
   pattern: [10].
    at
   com.filenet.engine.content.FileDelete.scrubFileWithPattern(File
   Delete.java:358)
    at
   com.filenet.engine.content.FileDelete.scrubFile(FileDelete.java
   :140)
    at
   com.filenet.engine.content.FileDelete.deleteFile(FileDelete.jav
   a:73)
    at
   com.filenet.engine.content.FileDelete.deleteFile(FileDelete.jav
   a:53)
    at
   com.filenet.engine.content.FileContentArea.deleteFile(FileConte
   ntArea.java:1645)
    at
   com.filenet.engine.content.FileContentArea.rollfwdDeleteAllCont
   entElements(FileContentArea.java:2016)
    ... 10 more
   Caused by: java.nio.channels.ClosedChannelException
    at
   sun.nio.ch.FileLockImpl.release(FileLockImpl.java:54)
    at
   com.filenet.engine.content.FileDelete.scrubFileWithPattern(File
   Delete.java:267)
    ... 15 more
   2008-02-14 18:48:46,296  WARN [ContentQueueWorker_CSSTEST_#1]
   - Failed to release lock on error for file:
   /apps/FileNET/FileStore/Staging_Area/content/FN10/FN14/FN{F7C31
   818-E387-4436-9B0A-3DFDDFB08CD8}{35C47D2A-AFB8-4706-B39E-A1194F
   0C3C7A}-0.zip
   2008-02-14 18:48:46,299 ERROR
   How long has the problem been occurring (recent changes)? :
   Since day 1.  This is start of testing, getting ready to go
   into production.
   Does this occur on more than one station / server? :
   Only have one server to work with.
   Is there a workaround? :
   No
   What is the impact to the customer/system? :
   Unable to test, jeopardizing production rollout schedule in
   mid-March, 2008.
   Can the problem be replicated on an internal system?  N
   By Who (L3, Support, etc..)
   CSS is setting up an environment.
   Steps to Reproduce:
   1. Setup Centera storage area, setting rentention to 60
   minutes (see word attachment).
   2. Add documents
   3. Wait for documents to be migrated to Centera and deleted
   from staging area.
   Actual Results:
   - Not sure if documents have been copied to Centera device.  Is
   there a way?
   - Documents are still in staging area with errors in
   p8_server_error and p8_server_trace.log (attached).
   Expected Results:
   - Documents migrated to Centera device.
   - Documents deleted from staging area.
   Are there any similar or related Defects? If Y provide ECMDB #s
   Maybe ecmdb00749721.
   What logs were collected and where are they located?
   p8_server_error.log, p8_server_trace.log
   Configuration/Environment :
   Server OS : Linux 4
   Client OS : Linux 4
   Database : Oracle
   Network:
   App Server :Websphere 6.1
   Browser :
   Note if non US Language:
   Other Product Component Versions:
   P8 CE 4.0.1
   query results from FileNet/Engine:
   PCH Listener: 4.0.1.004 pch420.004
   Operating System: Linux 2.6.9-42.EL.smp
   JDBC Driver: Oracle JDBC driver 10.2.0.3.0
   Startup Message: P8 CEMP startup: 4.0 dap435.029
   Process Engine: 4.0.1.0 pui410.010
   JVM: IBM Corporation 2.3
   Non Web Environment  Y or N
   N
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  users using Centera for storageDocuments are not deleted from st
   
   
    
   
   

PROBLEM CONCLUSION
 *  This issue is fixed in P8CE-4.0.1-004.
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PJ33194
   
   
 * REPORTED COMPONENT NAME
   CONTENT ENGINE
   
   
 * REPORTED COMPONENT ID
   5724R8101
   
   
 * REPORTED RELEASE
   401
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2008-03-17
   
   
 * CLOSED DATE
   2008-06-24
   
   
 * LAST MODIFIED DATE
   2008-06-24
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   CONTENT ENGINE
   
   
 * FIXED COMPONENT ID
   5724R8101
   
   

APPLICABLE COMPONENT LEVELS
 * R401 PSY
   UP