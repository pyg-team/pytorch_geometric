Title: IBM Tivoli Integrated Portal 2.x.x install failure. Can't stop WebSphere - United States

Text:
TIPL2INST; TIPL2SSL; expired SSL; certificates; keystore; TDWC; TIP; failed; install; retrieveSigners TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Tivoli Integrated Portal failed to install because the TIP install script could not stop WebSphere. The error upon failure: ADMC0016E: The system cannot create a SOAP connector to connect to host localhost at port <port_num>. retrieveSigners 

SYMPTOM
TIP install failed.


CAUSE
The stop WAS function could not connect to server1, thus not able to stop WAS, causing the TIP Upgrade to fail.

ENVIRONMENT
Embedded or stand alone Tivoli Integrated Portal installation.

DIAGNOSING THE PROBLEM
Exceptions and/or errors in the install logs and $TIPHOME/_uninst directory.




TIPInstaller-00.log 


CWPKI0314E: The following error is returned from an exception: 
ADMC0016E: The system cannot create a SOAP connector to connect to host localhost at port 28880.

2014-03-12 15:33:25.004-04:00 : FINE : MachinePlanEventOccurred(An exception was received during the processing of MachinePlan: localhost. 
See the Exception Stack Trace for more information.) (from com.ibm.ac.coi.ext.ia.COIWrapperPluginImpl.eventOccurred) 

Caused by: The following error occurred while executing this line: 
$TIPHOME/_uninst/TIPInstall22/plan/install/MachinePlan_localhost/00003_TIPCorePostConfig/TIPCorePostConfig.xml:479: condition satisfied 
at 
org.apache.tools.ant.ProjectHelper.addLocationToBuildException(ProjectHelper.java:508) 

TIPCorePostConfig.xml 

<exec dir="${IAGLOBAL_TIP_HOME}/profiles/${IAGLOBAL_WASProfileName}/bin" executable="${IAGLOBAL_TIP_HOME}/profiles/${IAGLOBAL_WASProfileName}/bin /retrieveSigners${platform.script.ext}" failonerror="false" resultproperty="returnCode"> <redirector output="${IAGLOBAL_TIP_HOME}/logs/retrieveSigners.out" 
error="${IAGLOBAL_TIP_HOME}/logs/retrieveSigners.err"/> 


$TIPHOME/logs/retrieveSigners.out 

CWPKI0314E: The following error is returned from an exception: 
ADMC0016E: The system cannot create a SOAP connector to connect to host 
localhost at port 28880.

--------------------------------

If you run stopServer.[sh||cmd] with the -trace option set:

$TIPHOME/profiles/TIPProfile/bin/stopServer.sh server1 -username <uid> -password <password> -trace

It will create additional traces in the stopServer.log. In this case, it showed the following errors, which indicate that the certificates have expired.

[3/17/14 16:36:04:135 EDT] 0000000a WSX509TrustMa E CWPKI0312E: The certificate with subject DN CN=Server, OU=TWS, O=IBM, C=US has an end date Mon Feb 10 08:43:16 EST 2014 which is no longer valid. 

Caused by: org.omg.CORBA.COMM_FAILURE: 
CAUGHT_EXCEPTION_WHILE_CONFIGURING_SSL_CLIENT_SOCKET: JSSL0080E: 
javax.net.ssl.SSLHandshakeException - The client and server could not negotiate the desired level of security. 
Reason: com.ibm.jsse2.util.g: Certificate expired vmcid: 0x49421000 
minor code: 70 completed: No 

Due to this error stopServer launcher failed to connect server1 and 
unable to stop it. Please renew the expired certificates in the JKS files 
mentioned in the messages below from stopServer.log log file.

[3/17/14 15:10:38:045 EDT] 0000000a SSLConfig 3 keyStore: 
$TIPHOME/profiles/TIPProfile/etc/ClientKeyFile.jks 

[3/17/14 15:10:38:045 EDT] 0000000a SSLConfig 3 trustStore: 
$TIPHOME/profiles/TIPProfile/etc/ClientTrustFile.jks

You can use the keytool to check the status of the certificates:

ls -lart $TIPHOME/profiles/TIPProfile/etc/*.jks 
-rwxr-xr-x 1 root root 1088 Mar 2 2010 ServerTrustFile.jks 
-rwxr-xr-x 1 root root 1265 Mar 2 2010 ServerKeyFile.jks 
-rwxr-xr-x 1 root root 558 Mar 11 17:08 ClientTrustFile.jks 
-rwxr-xr-x 1 root root 1262 Mar 11 17:08 ClientKeyFile.jks 
$TIPHOME/java/bin/keytool -list -v -keystore ./ServerTrustFile.jks Enter keystore password: 


RESOLVING THE PROBLEM
Please renew the expired certificates in the JKS files mentioned in the stopServer.log: 


Refer to the technote below for information on SSL Certificate renewal. This 
technote written for portal scenario where it failed to connect SOAP 
connector. In this case stopServer failed to connect SOAP with SSL. 

www-01.ibm.com/support/docview.wss?uid=swg21514601