Title: IBM Population or Synchronization fails trying to update the IBM Connections PEOPLEDB with the error SQLCODE: -302, SQLSTATE: 22001 - United States

Text:
SQLCODE: -302; SQLSTATE: 22001; !com.ibm.lconn.profiles.api.tdi.service.TDIException: CLFRN1182E: An error occurred while creating the profile; Caused by: org.springframework.dao.DataIntegrityViolationException: SqlMapClient operation TECHNOTE (TROUBLESHOOTING)

PROBLEM
In the 3.0 version of IBM Connections Profiles, the Employee table stores the ldap query that is used to look up users. If the query is longer than 256 characters the profiles update will fail.

SYMPTOM
Population or synchronization fails with the following errors in the ibmdi.log:

!com.ibm.lconn.profiles.api.tdi.service.TDIException: CLFRN1182E: An
error occurred while creating the profile:
cn=user,ou=orgunit,ou=People,o=org!
2011-04-28 14:32:41,931 ERROR
[org.apache.log4j.DailyRollingFileAppender.4b4c318a-4947-4d5f-94ad-c949c
b5aabd1] - com.ibm.lconn.profiles.api.tdi.service.TDIException:
CLFRN1182E: An error occurred while creating the profile:
cn=user,ou=orgunit,ou=People,o=org
at
com.ibm.lconn.profiles.api.tdi.service.impl.ProfilesTDICRUDServiceImpl.c
reateProfile(ProfilesTDICRUDServiceImpl.java:329)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)


Caused by: org.springframework.dao.DataIntegrityViolationException:
SqlMapClient operation; SQL [];
--- The error occurred while applying a parameter map.
--- Check the Profile.createProfile-InlineParameterMap.
--- Check the statement (update failed).
--- Cause: com.ibm.db2.jcc.b.SqlException: DB2 SQL error: SQLCODE: -302,
SQLSTATE: 22001, SQLERRMC: null; nested exception is
com.ibatis.common.jdbc.exception.NestedSQLException:


CAUSE
The search_ldap_filter line in profiles_tdi.properties is used to populate the PROF_SOURCE_URL column in the Employee Table. This column is limited to 256 characters. 

ENVIRONMENT
IBM Connections 3.x

DIAGNOSING THE PROBLEM
To enable greater debug for TDI population issues, update the profiles_tdi.properties: 

source_ldap_debug=true
tds_changelog_debug=true
sync_updates_clean_temp_files= false

In the file Wizards\TDIPopulation\TDISOL\win\etc\log4j.properties:
look for
log4j.rootCategory=INFO, Default 

change it to 
log4j.rootCategory=DEBUG, Default 

Run the commands and collect the logs\ibmdi.log


RESOLVING THE PROBLEM
Customers can use a smaller ldap query to resolve the issue. IBM Development is aware of the issue and an enhancement request has been opened to make the column larger in a future release of the product.