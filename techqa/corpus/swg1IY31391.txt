Title: IBM IY31391: EEE : FCM BUFFERS CORRUPTIONS DURING GLOBAL SNAPSHOT MONITORING - United States

Text:
AIX SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  PROBLEM DESCRIPTION:
   .
   Fast communication manager (sqlk) may cause memory corruption in
   boundary conditions.  Encountering this problem is unlikely.  I
   will most likely be in conjunction with other problems (such as
   node failures, or link failures).
   .
   Because there is results in memory corruption.  The results are
   somewhat unpredictable. Db2diag.log entries indicating errors
   encountered during global snapshots could be indicator we may
   have corrupted some memory due to this problem.
   .
   The following monitoring error is a good indicator of the
   SQM memory corruption :
   .
   2002-04-20-03.14.48.656064   Instance:udbinst7   Node:001
   PID:34604(db2agent (instance) 1)   Appid:none
   database_monitor  sqm_aggr_snapshot_buffer::aggre   Probe:65
   .
   DIA9999E An internal error occurred. Report the following error
   code : "0x7".
   .
   .
   We should also see messages in the db2diag.log indicating
   that db2 could not allocate further FCM buffers as following :
   .
   2002-04-20-03.14.51.800548   Instance:udbinst7   Node:001
   PID:105784(db2agntp 1)   Appid:none
   fast_comm_manager  sqlkf_alloc_buffer   Probe:103
   .
   DiagData
   0000 1000
   ...
   .
   2002-04-20-03.14.51.807726   Instance:udbinst7   Node:001
   PID:105784(db2agntp 1)   Appid:none
   fast_comm_manager  sqlkf_alloc_buffer   Probe:104
   .
   DiagData
   0000 0000 0000 0faf 0000 083f 0000 0000       .......ï¿®...?....
   0000 0000 0000 0000                           ........
   .
   2002-04-20-03.14.51.823702   Instance:udbinst7   Node:001
   PID:105784(db2agntp 1)   Appid:none
   buffer_dist_serv  sqlkdSendReply   Probe:55
   .
   Increase FCM_NUM_BUFFERS.  Attempting connection reset to node
   0001
   .
   db2 will panic the instance and shut down db2 because it won't
   be able to ensure internode communications anymore.
   .
   AFFECTED USERS : All EEE users taking global snapshots.
   
   
    
   
   

LOCAL FIX
 *  There is no circumvention or workaround.
   In order to avoid further outages, please disable your snapshot
   monitoring activity til installing the fix.
   
   
    
   
   

PROBLEM SUMMARY
 *  USERS AFFECTED:  All EEE users taking global snapshots.
   PROBLEM DESCRIPTION:
   Fast communication manager (sqlk) may cause memory corruption
   in boundary conditions.  Encountering this problem is unlikely.
   It will most likely be in conjunction with other problems (such
   as node failures, or link failures).
   .
   Because there is results in memory corruption.  The results are
   somewhat unpredictable. Db2diag.log entries indicating errors
   encountered during global snapshots could be indicator we may
   have corrupted some memory due to this problem.
   .
   Corruption of real data will not occur.
   .
   PROBLEM SUMMARY:
    The following monitoring error is a good indicator of the
    SQM memory corruption :
   .
    2002-04-20-03.14.48.656064   Instance:udbinst7   Node:001
    PID:34604(db2agent (instance) 1)   Appid:none
    database_monitor  sqm_aggr_snapshot_buffer::aggre   Probe:65
   .
    DIA9999E An internal error occurred. Report the following error
    code : "0x7".
   .
    We should also see messages in the db2diag.log indicating
    that db2 could not allocate further FCM buffers as following :
   .
    2002-04-20-03.14.51.800548   Instance:udbinst7   Node:001
    PID:105784(db2agntp 1)   Appid:none
    fast_comm_manager  sqlkf_alloc_buffer   Probe:103
   .
    DiagData
    0000 1000
    ...
   .
    2002-04-20-03.14.51.807726   Instance:udbinst7   Node:001
    PID:105784(db2agntp 1)   Appid:none
    fast_comm_manager  sqlkf_alloc_buffer   Probe:104
   .
    DiagData
    0000 0000 0000 0faf 0000 083f 0000 0000       ....... ...?....
    0000 0000 0000 0000                           ........
   .
    2002-04-20-03.14.51.823702   Instance:udbinst7   Node:001
    PID:105784(db2agntp 1)   Appid:none
    buffer_dist_serv  sqlkdSendReply   Probe:55
   .
    Increase FCM_NUM_BUFFERS.  Attempting connection reset to node
    0001
   .
    db2 will panic the instance and shut down db2 because it won't
    be able to ensure internode communications anymore.
   
   
    
   
   

PROBLEM CONCLUSION
 *  defect 234913
   CSD >= s021110
   module=engn_sqkf
   
   
    
   
   

TEMPORARY FIX
 *  There is no workaround.
   
   
    
   
   

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IY31391
   
   
 * REPORTED COMPONENT NAME
   UDB EEE AIX
   
   
 * REPORTED COMPONENT ID
   5648D5000
   
   
 * REPORTED RELEASE
   710
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2002-05-21
   
   
 * CLOSED DATE
   2002-12-13
   
   
 * LAST MODIFIED DATE
   2002-12-13
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   UDB EEE AIX
   
   
 * FIXED COMPONENT ID
   5648D5000
   
   

APPLICABLE COMPONENT LEVELS
 * R720 PSY
   UP