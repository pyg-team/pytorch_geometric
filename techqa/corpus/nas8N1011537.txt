Title: IBM Installing WebSphere Application Server Into an  iASP - United States

Text:
IASP; WAS TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 WebSphere can be installed into an iASP. The supported method to install WebSphere Application Server into an iASP is to do the installation on both the primary and backup system. 

RESOLVING THE PROBLEM
Installing WebSphere Application Server into a iASP 

WebSphere Application Server can be installed into an iASP as long as the steps below are followed. The installation must be performed on both the primary and backup system, leaving the product directory on SYSBASE and putting the profile directory on the iASP. This document explains the steps necessary to do this.

Note: The same set of steps below apply to both WebSphere 6.1 and WebSphere 7.0. Some commands may only show one version of WebSphere; however, either version of WebSphere can be used.

Restrictions for running WebSphere under an iASP

To share the same UserData directory on an iASP, the following restrictions apply: 

1. The same prerequisite and optional software for WebSphere Application Server is installed on both the primary and secondary systems. 2. The names of the installation libraries for the WebSphere Application Server installations must be the same (in other words, WAS61A, WAS61B, and so on). 3. Maintenance of the WebSphere Application Server installations sharing the UserData directory is done such that they are kept at the same fix level. 4. The product default Java Virtual Machine (JVM) value must be the same for both primary and secondary installations. This should not be an issue if the primary and secondary systems have the same IBM Developer Kit for Java product options installed. The most practical way of achieving the second restriction is to ensure that the installation is the first WebSphere Application Server 6.1 installation on each system. After installing, look in the <app_server_root>/properties/product.properties file to find the name of the installation library. 

To determine the JVM that the WebSphere Application Server product installation is enabled to use, you should view the contents of file app_server_root/properties/product.properties: 

o If was.use.j9=false, the installation is enabled to use the "classic" JVM. 
o If was.use.j9=true, then: 
- If was.j9.version=32bit, the installation is enabled to use the "std32" JVM 
- Else if was.j9.version=64bit, the installation is enabled to use the "std64" JVM. 

Use the enablejvm command to change the product default JVM. 

Installing WebSphere on the primary system 

The steps below show how to perform the installation on the primary system. After performing these steps, you will have the product directory (ProdData) on SYSBAS and the profile directory (UserData) on the iASP: 1. CD to the WAS directory on the WebSphere installation image:
o cd /QOPT/WEBSPHERE/WAS 2. Make a copy of the default response file into the directory of your choosing:
o cd /QOPT/WEBSPHERE/WAS/responsefile.nd.txt /WAS61ND 3. Edit the following option in the response file you created in Step 2:
o -OPT silentInstallLicenseAcceptance="true"
o -OPT installLocation="/QIBM/ProdData/WebSphere/AppServer/V61/ND"
o -OPT defaultProfileLocation="/MyIASP/QIBM/UserData/WebSphere/AppServer/V61/ND"
o -OPT PROF_enableAdminSecurity="false"
o -OPT PROF_omitAction=samplesInstallAndConfig 4. Install WebSphere using the modified response file from Step 3:
o INSTALL -options /was61nd/responsefile.nd.txt 
Installing WebSphere on the backup system 

The steps below show how to perform the installation on the backup system. After performing these steps, you will have the product directory (ProdData) on SYSBAS and the profile directory (UserData) on the iASP: 1. Ensure the iASP is available on to the backup system. 2. CD to the WAS directory on the WebSphere installation image:
o cd /QOPT/WEBSPHERE/WAS 3. Make a copy of the default response file into the directory of your choosing:
o cd /QOPT/WEBSPHERE/WAS/responsefile.nd.txt /WAS61ND 4. Edit the following option in the response file you created in Step 2:
o -OPT silentInstallLicenseAcceptance="true"
o -OPT installLocation="/QIBM/ProdData/WebSphere/AppServer/V61/ND"
o -OPT defaultProfileLocation="/MyIASP/QIBM/UserData/WebSphere/AppServer/V61/ND"
o -OPT allowOverrideProfileLocation="true"
o -OPT profileType="none"
o -OPT PROF_enableAdminSecurity="false"
o -OPT PROF_omitAction=samplesInstallAndConfig 5. Install WebSphere using the modified response file from Step 3:
o INSTALL -options /was61nd/responsefile.nd.txt

Note: The two options in bold prevent the default profile from being created a second time. The default profile already exists on the iASP and was created when the installation was done on the primary system. 
Adding iASP group to WebSphere’s job description 

WebSphere will not be able to see libraries and databases on the iASP unless the job description that WebSphere 6.1 runs under is changed to set the iASP group. That can be done by issuing the following command: 

CHGJOBD JOBD(QWAS61/QWASJOBD) INLASPGRP({MYiASP}) 

Note: This must be done on both Primary and Backup systems. 

Changing Host Name in WebSphere 

By default, when WebSphere is installed, it uses whatever the system name is set to as the host name throughout the configuration files. That is not always the name we want WebSphere to use. In a high availability environment similar to what was created here, we want WebSphere to use theTakeover IP Address. By switching WebSphere to use the TakeOverIP Address, we are able to run WebSphere on either the backup or primary system and avoid any IP or naming issues when a switchover occurs. To change WebSphere’s host names, you should follow the instructions listed in the Information Center link below: 

http://www.ibm.com/support/knowledgecenter/en/SSEQTP_7.0.0/com.ibm.websphere.base.iseries.doc/info/iseries/ae/tagt_hostname.html [http://www.ibm.com/support/knowledgecenter/en/SSEQTP_7.0.0/com.ibm.websphere.base.iseries.doc/info/iseries/ae/tagt_hostname.html] 

Note: This since the profile directory resides on the iASP changing the host name only needs to be done once. 

Recommended cleanup after a switchover 

When a switchover is done, it is recommended that WebSphere’s OSGi cache is cleaned up. This step could be added to an auto start or stop program and occur automatically when a switchover is done. 

To cleanup the OSGi cache, you should do the following: 

1. Ensure the server is not running 
2. cd /MYIASP/Websphere_profile_dir/profiles/ProfileName/bin 
3. Run: osgiCfgInit  


Cross reference information Segment Product Component Platform Version Edition Operating System IBM i 6.1 Operating System IBM i 7.1 
HISTORICAL NUMBER
 599166201