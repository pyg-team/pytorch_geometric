Title: IBM Computing week number (XDATE.WEEK) with Sunday as start of week - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 I want a command that will look at the value of an SPSS date variable and count the number of calendar weeks,
or parts thereof, from the beginning of the same year. This is like the xdate.week function, but that function always treats the start of the week as the day on which Jan. 1 fell in that year. So the XDATE.WEEK result for Jan 4. would always be 1. If Jan. 4 fell on a Sunday, then I want my command to set the week number for Jan. 4 to 2, showing that it is the second calendar week in that year. In other words, the Sunday on or just before Jan. 1 is the starting point for counting weeks.
Suppose that I wanted to treat Monday, rather than Sunday, as the beginning of the calendar week. Would the adjustments described above be possible in that scenario? 

RESOLVING THE PROBLEM
The following commands store the calendar week number of an SPSS date variable value into the new variable WEEKCAL. The principle is that if the weekday of the date is less than the weekday of Jan. 1 of that year, then the week number returned by XDATE.WEEK should be increased by 1 to reflect that a change in calendar week has occurred within an XDATE.WEEK week. The XDATE.WKDAY() functions returns a value in the range from 1 to 7 to reflect the weekday of the date variable in the parentheses. Sunday is assigned a value of 1; Saturday, a value of 7.

The command uses an SPSS date variable and the corresponding calendar year as inputs. DATEX and YEAR are used in this example. If you just have DATEX, you can compute YEAR with the command:

COMPUTE YEAR = XDATE.YEAR(DATEX).

If your date is just comprised of the separate variables DAY, MONTH, and YEAR, you compute DATEX with the command:

COMPUTE DATEX = DATE.DMY(DAY,MONTH,YEAR).

With Sunday as the beginning of the calendar week, the calendar week number is then computed as follows:

COMPUTE WEEKCAL = XDATE.WEEK(DATEX) +
(XDATE.WKDAY(DATEX) < XDATE.WKDAY(DATE.MDY(1,1,YEAR))).
EXECUTE. 

To perform the adjustments with Monday as the first day of the calendar week, you need to break the above COMPUTE command into segments. The day of the week for each of DATEX and Jan. 1 are saved as new variables with the XDATE.WKDAY function. These new variables are then recoded so that Sundays are assigned a 7; Monday, a 1; Tuesdays, a 2; and so forth. The recoded weekday variables are then the inputs to the WEEKCAL calculation. To distinguish this calculation from the Sunday-based calculation above, the final variable is called WEEKCAL_MONDAY in the commands below. The FORMATS command is optional. 

 

 * compute week number with week starting on Monday.
compute wkdayM_now = (XDATE.WKDAY(DATEX)).
compute wkdayM_newyear =XDATE.WKDAY(DATE.MDY(1,1,YEAR)).
recode wkdayM_now wkdayM_newyear (1=7) (2=1) (3=2) (4=3) (5=4) (6=5) (7=6).
compute Weekcal_Monday = XDATE.WEEK(DATEX) + (wkdayM_now < wkdayM_newyear).
execute.
formats wkdayM_now to Weekcal_Monday (f8).

RELATED INFORMATION
 Need more help? Our Statistics forum is Live! [https://developer.ibm.com/answers/topics/statistics.html?smartspace=predictive-analytics]


 

HISTORICAL NUMBER
 15395