Title: IBM IC47064: IBM RATIONAL CLEARQUEST MULTISITE: STRING OR BINARY DATA WOULD BE TRUNCATED - United States

Text:
 SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  Environment:
   - All Windows Platforms
    - IBM Rational ClearQuest Multisite 2003.06.14
   Build Label MCK_PATCH_2004D_HOTFIX.D050410
   Reproducible Y/N: Yes
   Description of problem:
   If you have a field in a Multisite Environment that gets
   populated automatically by a value set in an Action Validation
   Hook, and that is bigger than the max length of the field, an
   error occurs when running the multiutil syncreplica -import
   
   If you enter the value directly into ClearQuest, the field will
   get truncated automatically. It also gets truncated in the
   backend.
   
   It should also get truncated in the multiutil syncreplica
   -export and import.
   
   
   Step to reproduce: In a Multisite environment:
   - On the Master site, create a Validation hook on the Submit
   Action
   Eg. setfieldvalue "Headline","This headline has more than 125
   characters. This headline has more than 125 characters. This
   headline has more than 125 characters"
   - check in your schema, and upgrade your user database
   - sync the MASTR database with your replica site
   - Upgrade the user database on the replica site
   - Submit a new Defect on the master site. The Defect gets saved.
   - Perform a syncreplica -export
   - Perform a sync replica -import. You will get an error:
   C:\Documents and Settings\nl059734>multiutil syncreplica -import
   -clan MULTISITE -site REPLICA -family MSITE -user admin
   -password "" "C:\Multisite\export.xml"
   Multiutil: SQLExecDirect: RETCODE=-1, State=22001, Native
   Error=8152
   SQL statement="insert into Defect ( dbid, headline, id,
   is_active, is_duplicate,lock_version, locked_by, owner, project,
   ratl_mastership, severity, state, subm
   it_date, submitter, version ) values ( 33554439, 'This headline
   has more than 125 characters. This headline has more than 125
   characters. This headline has more than 125 characters.',
   'MSITE00000007', 1, 0, 0, 0, 0, 0, 16777
   308, '1-Critical', 16777345, { ts '2005-08-09 22:00:00'},
   33554433, 1 )"
   [Microsoft][ODBC SQL Server Driver][SQL Server]String or binary
   data would be truncated.
   [Microsoft][ODBC SQL Server Driver][SQL Server]The statement has
   been terminated.
   
   The packlet being imported was epoch number 55 from database
   'MSITE',
   replica 'MASTER' (UUID = DD5C296E-FF5C-4246-8AE6-F1D20D72B1B2).
   
   Multiutil: Packet C:\Multisite\export.xml not processed...
   Workaround:
   
   
    
   
   

LOCAL FIX
 *   Pdsql in to your database at the exporting site:
    - Open a DOS window
    - Type in the following command: pdsql -v ss -db <db-name> -s
   <server-machine> -u <dblogin> -p <pswd>
    - Run the following command: select serial_no from ratl_oplog
   where epoch_no=55;
    - (It may have more than one serial no.)
    - For each of these serial numbers, run the following command:
    dump_longbinary c:\temp\serial####.txt select paklet from
   ratl_oplog
   where serial_no=####;
    - Send these files to IBM Rational Support
    - The serial####.txt files need to be modified so that the
   field value is under the maximum length
    - IBM Rational Support will then send you a fix for this issue
   
   
    
   
   

PROBLEM SUMMARY
 *  If you have a field in a Multisite Environment that gets
   populat
   ed automatically by a value set in an Action
   Validation Hook, an
   d that is bigger than the max length of
   the field, an error occu
   rs when running the multiutil
   syncreplica -import
   If you enter
   the value directly into ClearQuest, the field
   will get truncated
    automatically. It also gets truncated in
   the backend.
   
   
   
   It should also get truncated in the mul
   tiutil syncreplica
   -export and import.
   
   
    
   
   

PROBLEM CONCLUSION
 *  Fixed in ClearQuest 2003.06.16
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IC47064
   
   
 * REPORTED COMPONENT NAME
   RATL CQ MSITE V
   
   
 * REPORTED COMPONENT ID
   5724F2100
   
   
 * REPORTED RELEASE
   ALL
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2005-08-10
   
   
 * CLOSED DATE
   2006-12-01
   
   
 * LAST MODIFIED DATE
   2006-12-01
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

MODULES/MACROS
 *  na
   
   
    
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   RATL CQ MSITE V
   
   
 * FIXED COMPONENT ID
   5724F2100
   
   

APPLICABLE COMPONENT LEVELS
 * RALL PSN
   UP