Title: IBM PI30253: IPCONN STILL IN FREEING STATE AFTER PARTNER CICS WAS SHUT DOWN - United States

Text:
z/os  A FIX IS AVAILABLE
Obtain the fix for this APAR.


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  An IPCONN connection remains in FREEing state in CICS region A
   after an IPIC partner CICS region B was shut down.
   
   CICS region B tries to establish the IPIC connection again after
   a subsequent restart, however this fails due to the fact that
   the corresponding IPCONN is still in FREEing state.
   
   The reconnect fails with message DFHIS1015 "Unable to accept
   connection for IPCONN xxxx. IPCONN client session state is
   invalid (Code X'0515')".
   
   This status can be resolved only by a TCP/IP socket timeout or
   restart from CICS region A. The TCP/IP timeout is accompanied by
   message DFHSO1000 in CICS A.
   
   CICS region A gets furthermore the following problem indication
   during shutdown from CICS B:
   
   DFHIS4000 Conversation failure on IPCONN xxxx.
             Sense code (X'08390000').
   DFHIS1025 Failed to attach mirror transaction CSM3 on
             IPCONN xxxx. Error code is X'061A'
   
   
   
   Following issues were identified:
   
   
   1. The CICS region that is shutting down do not send any BIS
      request to the partner IPCONN not close the 4 IPIC SOCKETs.
   
   2. The region that stays up attempts to start a mirror task
      in the partner region but gets rejected with error,
      "Transaction not enable for shutdown". This causes the
      IPCONN to be set to FREEing state.
   
   
    
   
   

LOCAL FIX
 *  Explicit SET IPCONN RELEASE before shutdown
   
   
    
   
   

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED: All CICS users.                              *
   ****************************************************************
   * PROBLEM DESCRIPTION: IPCONN remain in FREEING state of a     *
   *                      normal shutdown from the partner        *
   *                      region.                                 *
   ****************************************************************
   * RECOMMENDATION:                                              *
   ****************************************************************
   CICS region A and region B are connected via IPIC. The IPCONN is
   in ACQUIRE status. Region A is shutdown normally, which triggers
   CISD task to release the IPCONN. But the TCPIPSERVICE name
   doesn't get passed into CISD. When CISD task starts to run, it
   tries to release the IPCONN which are associated with the
   TCPIPSERVICE name. As the TCPIPSERVICE name is blank, no
   IPCONN can be found. CISD then terminates normally which
   actually did nothing.
   
   The region B doesn't get notified from TCPIP level. A request
   is sent to region A for mirror task, which is rejected with IS7
   as the response. When IS7 is received into region B, it sets
   the IPCONN to FREEing, without taking further action to release
   the IPCONN. This causes the IPCONN in region B remain in FREEing
   status after region A shutdown.
   
   
    
   
   

PROBLEM CONCLUSION
 *  DFHISCO has been changed so that CISD can properly handle the
   IPCONN release process.
   
   
    
   
   

TEMPORARY FIX
 *  FIX AVAILABLE BY PTF ONLY
   
   
    
   
   

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PI30253
   
   
 * REPORTED COMPONENT NAME
   CICS TS Z/OS V4
   
   
 * REPORTED COMPONENT ID
   5655S9700
   
   
 * REPORTED RELEASE
   700
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2014-11-25
   
   
 * CLOSED DATE
   2015-01-29
   
   
 * LAST MODIFIED DATE
   2015-03-03
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
    PI32143 [http://www-01.ibm.com/support/docview.wss?uid=swg1PI32143] UI24760
   
   

MODULES/MACROS
 *  DFHISCO
   
   
    
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   CICS TS Z/OS V4
   
   
 * FIXED COMPONENT ID
   5655S9700
   
   

APPLICABLE COMPONENT LEVELS
 * R700 PSY UI24760 [HTTPS://WWW14.SOFTWARE.IBM.COM/WEBAPP/SET2/ORDERMEDIA/SHOPCART?PTFS=UI24760]
   UP15/02/05 P F502
   
   

FIX IS AVAILABLE
 * SELECT THE PTF APPROPRIATE FOR YOUR COMPONENT LEVEL. YOU WILL BE REQUIRED TO SIGN IN. DISTRIBUTION ON PHYSICAL MEDIA IS NOT AVAILABLE IN ALL COUNTRIES.