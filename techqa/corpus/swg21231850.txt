Title: IBM During CICS shutdown empty USS STDOUT files are not being deleted - United States

Text:
Empty STDOUT Not deleting deletes termination STDERR JVMDG200 PQ67303 UQ75370 5697E9300 R300 300 R630 630 HCI6300 5697-E93 5697E93 5655M1500 R640 640 R400 400 R650 650 R500 500 HCI6400 HCI6500 5655-M15 5655M15 kixinfo retention32 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 You are running CICS Java™ applications and empty STDOUT files in UNIX® System Services are not being deleted at shutdown. The CICS System Definition Guide states that "if the STDOUT file is empty and it has been generated for the specific JVM, it is deleted. Otherwise, the file is kept." 

SYMPTOM
STDERR files contain the message JVMDG200: Diagnostics system property ibm.jvm.events.output=event.log.


CAUSE
Even after APAR PQ67303 (PTF UQ75370) for CICS Transaction Server for z/OS V2.2, CICS does not currently attempt to stop JVMs as part of shutdown processing. Attempting to do so would mean adding logic to make sure the JVMs had all gone away properly. There is a possibility that some threads in the JVM may be doing work (outside of a running CICS transaction) and this could delay or even hang CICS shutdown. 

In regard to the STDERR file, the JVMDG200 message is normal and to be expected. This message simply indicates that the STDERR exists for the JVM to write any error messages if they occur.


DIAGNOSING THE PROBLEM
The following steps show how to recreate this problem: 

 1. Use ishell to view the HFS directory where the STDOUT files are created. 
 2. Run the JHE2 transaction that runs a HelloWorld sample using JCICS. 
 3. Switch back to ishell and see a new empty STDOUT file created. 
 4. Enter CEMT I JVmpool to see that a JVM was created. 
 5. Enter CEMT Set JVmpool Phaseout to terminate the JVM. 
 6. Switch back to ishell and refresh the display and confirm that the STDOUT file was indeed deleted. 
 7. Rerun the JHE2 transaction creating another JVM and STDOUT file. 
 8. Enter a CEMT Perform Shutdown and see CICS shutdown without deleting the STDOUT file.

RESOLVING THE PROBLEM
Use one of the following options to remove the empty files: 

 * Create a program to run during shutdown and have it phaseout the JVMs so the empty STDOUT files are deleted. The CEMT SET JV PHASEOUT [http://publib.boulder.ibm.com/infocenter/cicsts/v3r2/index.jsp?topic=/com.ibm.cics.ts.doc/dfha7/transactions/cemt/dfha7ng.html] command can be used. 
 * Use the BPXBATCH program to delete the STD* files in your HFS prior to start up. The z/OS V1.10 UNIX System Services User's Guide (SA22-7801-10) describes how to set this type of job up in section 11.3.5.2 Running a Shell Command in Batch [http://publibfi.boulder.ibm.com/cgi-bin/bookmgr/BOOKS/bpxza490/11.3.5.2]. 
   


To stop the message JVMDG200 requires that you turn logging off. You would need to comment out the following line in your JVM property file: 

# The following lines are needed while testing application 
# for conformance with the rules for reuse of JVMs. 
# 
ibm.jvm.events.output=event.log 

However, if you do comment out this line, this means you do not wish to monitor for events affecting JVM reset. You will receive no messages if an error of this nature does in fact occur and this is not recommended. If you had any error messages, it would read something like this: JVMDG200: Diagnostics system property ibm.jvm.events.output=event.log Warning: JIT compiler "off" not found. Will use interpreter.




PRODUCT ALIAS/SYNONYM
 CICS/TS CICS TS CICS Transaction Server