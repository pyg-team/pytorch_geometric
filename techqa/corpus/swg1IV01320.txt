Title: IBM IV01320: MARKING DEVICES AS UNMANAGED WHEN THE BACKUP DOMAIN IS ACTING PRIMARY FAILS TO SET NMOSMANAGEDSTATUS IN PROBE EVENTS - United States

Text:
  DIRECT LINKS TO FIXES
ITNMIP_Patch_V3.8.0.89_Win32 [http://www.ibm.com/support/fixcentral/quickorder?product=ibm%2FTivoli%2FTivoli+Network+Manager+IP+Edition&fixids=3.8.0-TIV-ITNMIP-Windows-REF-FP0007&source=SAR]
3.8.0-TIV-ITNMIP-Solaris-REF-FP0007 [http://www.ibm.com/support/fixcentral/quickorder?product=ibm%2FTivoli%2FTivoli+Network+Manager+IP+Edition&fixids=3.8.0-TIV-ITNMIP-Solaris-REF-FP0007&source=SAR]
3.8.0-TIV-ITNMIP-Linux-REF-FP0007 [http://www.ibm.com/support/fixcentral/quickorder?product=ibm%2FTivoli%2FTivoli+Network+Manager+IP+Edition&fixids=3.8.0-TIV-ITNMIP-Linux-REF-FP0007&source=SAR]
ITNMIP_Patch_V3.8.0.89_AIXPPC32 [http://www.ibm.com/support/fixcentral/quickorder?product=ibm%2FTivoli%2FTivoli+Network+Manager+IP+Edition&fixids=3.8.0-TIV-ITNMIP-AIX-REF-FP0007&source=SAR]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  Product:  Tivoli Network Manager for IP Networks
   Version: 3.8
   Component: ncp_model
   
   Symptom:
   Unmanage a device when in failover mode, with the Backup domain
   having become the acting primary domain, unmanage one of the
   devices.  Events from the ITNM poller are correctly suppressed.
   However, events from other sources, such Syslog or Mttrapd
   (SNMP) probe fail to have the NmosManagedStatus field set
   correctly to 1.  This means they show up on Event Lists that
   use NmosManagedStatus to filter out events from devices that
   are known to be unmanaged.
   
   This works as expected when the Primary domain is the acting
   primary domain.
   
   
   Cause:
   When setting the status to Unmanaged via Tivoli Integrated
   Portal, the new ncim.managedStatus.status for the entity is not
   propagated back to
   model.master.entityByName.ExtraInfo->m_ManagedStatus  and so is
   not picked up by the NcoGate's copy of this data in
   ncogate.topoCache.entityByName.ExtraInfo->m_ManagedStatus.  When
   the subsequent event is sent for Root Cause Analysis via the
   NcoGate, the NmosManagedStatus value for the returning update in
   alerts.status is left as zero.
   
   
   Expected behaviour:
   Setting a device to unmanaged should have the same effect on the
   NmosManagedStatus field for an event regardless of whether the
   Primary or Backup domain is the acting primary domain.
   
   
    
   
   

LOCAL FIX
 *  When unmanaging devices in a failed-over environment (i.e. when
   the Backup domain is the acting Primary) manually update the
   ExtraInfo->m_ManagedStatus value to 1.
   
   
   ncp_oql -domain <BACKUP_DOMAIN> -username admin -password ""
   -service model -password "" -query  "update master.entityByName
   set ExtraInfo->m_ManagedStatus=1 where ObjectId=<ENTITY_ID>;"
   
   Replace <BACKUP_DOMAIN> with the Backup domain name and
   <ENTITY_ID> with the entity ID for the device.
   
   Note: You must manually set this back to zero if you manage the
   device again.
   
   
    
   
   

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED:                                              *
   * users of 3.8, all platforms                                  *
   ****************************************************************
   * PROBLEM DESCRIPTION:                                         *
   * When setting the status to Unmanaged via Tivoli Integrated   *
   * Portal (when backup model is running as Primary), the new    *
   * ncim.managedStatus.status for the entity is not              *
   * propagated back to                                           *
   * model.master.entityByName.ExtraInfo->m_ManagedStatus  and so *
   * is                                                           *
   * not picked up by the NcoGate's copy of this data in          *
   * ncogate.topoCache.entityByName.ExtraInfo->m_ManagedStatus.   *
   * When                                                         *
   * the subsequent event is sent for Root Cause Analysis via the *
   * NcoGate, the NmosManagedStatus value for the returning       *
   * update in                                                    *
   * alerts.status is left as zero.                               *
   *                                                              *
   *                                                              *
   * Expected behaviour:                                          *
   * Setting a device to unmanaged should have the same effect on *
   * the                                                          *
   * NmosManagedStatus field for an event regardless of whether   *
   * the                                                          *
   * Primary or Backup domain is the acting primary domain.       *
   ****************************************************************
   * RECOMMENDATION:                                              *
   * install APAR IV01320 or upgrade to                           *
   * | fix pack | 3.8.0-ITNMIP-FP0007                             *
   ****************************************************************
   a new argument called '-primaryNonrepDomain' can be used on the
   backup model process in a non-replicating environment to specify
   the name of the Primary domain, which the backup model process
   can use to lookup the Primary domain manager id in NCIM.
   
   Documentation has been updated as follows:
   
   Added description of the -primaryNonrepDomain command-line
   option to the ncp_model command topic:
   http://publib.boulder.ibm.com/infocenter/tivihelp/v8r1/topic/com [http://publib.boulder.ibm.com/infocenter/tivihelp/v8r1/topic/com]
   .ibm.networkmanagerip.doc_3.8/itnm/ip/wip/ref/reference/nmip_sta
   _model.html
   
   Added note about setting the value of the ncp_model
   -primaryNonrepDomain command-line option.
   http://publib.boulder.ibm.com/infocenter/tivihelp/v8r1/topic/com [http://publib.boulder.ibm.com/infocenter/tivihelp/v8r1/topic/com]
   .ibm.networkmanagerip.doc_3.8/itnm/ip/wip/install/concept/nmip_i
   ns_backupinstallationwithoutncimbackup.html
   
   
    
   
   

PROBLEM CONCLUSION
 *  | fix pack | 3.8.0-ITNMIP-FP0007
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IV01320
   
   
 * REPORTED COMPONENT NAME
   NC/PREC DISCOVY
   
   
 * REPORTED COMPONENT ID
   5724O52DS
   
   
 * REPORTED RELEASE
   380
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2011-06-01
   
   
 * CLOSED DATE
   2011-06-30
   
   
 * LAST MODIFIED DATE
   2011-07-06
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   NC/PREC DISCOVY
   
   
 * FIXED COMPONENT ID
   5724O52DS
   
   

APPLICABLE COMPONENT LEVELS
 * R380 PSY
   UP