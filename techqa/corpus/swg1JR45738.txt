Title: IBM JR45738: GENERATING REPORT WHICH USES EXCEL METHODS FAILS AFTER MIGRATION TO A LATER FIXPACK - United States

Text:
 SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS DOCUMENTATION ERROR.
    
   
   

ERROR DESCRIPTION
 *  In IBM InfoSphere Master Data Management Server for Product
   Information Management Version 9.1.0, after migration to MDM
   9.1.0 FP10, an old Java API report that uses the method
   setCellValue which is in the third-party jar POI-3.2-FINAL .jar
   file fails.
   In MDM 9.1.0 FP10, there is a conflict as there are 2 jar files
   that have this method setCellValue. One is
   poi-3.2-FINAL-20081019.jar and the other poi-3.7-20101029.jar.
   In the classpath, poi-3.2-FINAL-20081019.jar appears first and
   therefore the method will be taken from this jar file. The
   problem is there are 2 versions of this method and obviously
   the customer  java code is accessing the wrong one causing
   the java.lang.NoSuchMethodError
   The error message in appsvr exception.log:
   java.lang.NoSuchMethodError:
   org/apache/poi/hssf/usermodel/HSSFCell.setCellValue(Lorg/apache/
   poi/ss/usermodel/RichTextString;)V
          at
   com.ibm.ccd.common.excel.impl.hssf.ExcelCell.setCellValue(ExcelC
   ell.java:77)
          at
   com.ibm.ccd.common.interpreter.operation.generated.GenSetStringC
   ellValueOperation.execute(GenSetStringCellValueOperation.java:87
   )
   java.lang.NoSuchMethodError means :
   Thrown if an application tries to call a specified method of a
   class (either static or instance), and that class no longer has
   a definition of that method. Normally, this error is caught by
   the compiler; this error can only occur at run time if the
   definition of a class has incompatibly changed.
   There are these 2 methods in POI jars  :
   poi-3.2-FINAL-20081019.jar ->  setCellValue(HSSFRichTextString
   value)
   and poi-3.7-20101029.jar ->  setCellValue(RichTextString value)
   Result:
   Apparently this use case is related to some modifications that
   were made to support excel 2007 .xlsx format, which was already
   delivered in 9.1.0.main branch. This enhancement has provided
   .xlsx feature and introduced the update poi jar, namely
   poi-3.7-20101029.jar. To provide support for
   poi-3.7-20101029.jar, all the excel functionality related
   classes was modified to suit the new behavior defined by this
   jar and ExcelCell.java is one of the java file which was
   updated.
   Conclusion:
   The problem is that this code change was not propagated in the
   9.1.0 code stream.
   For some reason, the intended fix for this issue is not there
   in 9.1.0. main and therefore this APAR serves the purpose to
   track this integration to the next release of 9.1.0 fix pack.
   
   
    
   
   

LOCAL FIX
 *  N/A
   
   
    
   
   

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED:                                              *
   * All IBM InfoSphere Master Data Management Server for Product *
   * Information Management implementations are affected by this  *
   * issue.                                                       *
   ****************************************************************
   * PROBLEM DESCRIPTION:                                         *
   * Generating reports that use Microsoft Excel methods fail     *
   * after migration to a later fixpack.                          *
   ****************************************************************
   * RECOMMENDATION:                                              *
   * IBM recommends that customers facing the issue reported by   *
   * this APAR look into the information center of IBM InfoSphere *
   * Master Data Management Server for Product Information        *
   * Management V9.1.0.                                           *
   ****************************************************************
   
   
    
   
   

PROBLEM CONCLUSION
 *  A fix for this problem has been included in IBM InfoSphere
   Master Data Management Server for Product Information Management
   V9.1.0 Fix Pack 12.
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   JR45738
   
   
 * REPORTED COMPONENT NAME
   MDM SERVER FOR
   
   
 * REPORTED COMPONENT ID
   5724V5100
   
   
 * REPORTED RELEASE
   910
   
   
 * STATUS
   CLOSED DOC
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2013-02-13
   
   
 * CLOSED DATE
   2013-06-26
   
   
 * LAST MODIFIED DATE
   2013-06-26
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION

APPLICABLE COMPONENT LEVELS