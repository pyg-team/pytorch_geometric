Title: IBM Group member searches persist after configuring a membership attribute - United States

Text:
ldap; performance; group membership; membershipAttribute TECHNOTE (TROUBLESHOOTING)

PROBLEM
You configured Virtual Member Manager (VMM) to use a membership attribute. VMM persists in searching groups' member lists to determine group membership in certain cases. This negatively affects login performance.

SYMPTOM
Users experience slow logins.


CAUSE
If the membership attribute value indicates that a user belongs to no groups, by design, VMM attempts to determine group membership based on the member attribute configuration. If no member attribute configuration exists, VMM uses the default member attribute for the LDAP.

DIAGNOSING THE PROBLEM
Collect a Login MustGather. Verify VMM's group configuration in wimconfig.xml. 

Example:
<config:groupConfiguration>
<config:membershipAttribute name="dominoAccessGroups" ... /> 
</config:groupConfiguration>

Review the trace of a login with poor performance. Look for:

... ServiceProvid > com.ibm.websphere.wim.ServiceProvider WIM_API get ENTRY ... GroupMembershipControl ...
...
... LdapConnectio > com.ibm.ws.wim.adapter.ldap.LdapConnection JNDI_CALL getAttributes ENTRY CN=user1,DC=ibm,DC=com [dominoAccessGroups]
...
... LdapConnectio < com.ibm.ws.wim.adapter.ldap.LdapConnection JNDI_CALL getAttributes RETURN No attributes
...
... LdapAdapter > com.ibm.ws.wim.adapter.ldap.LdapAdapter getGroupsByMembership ENTRY
...
... LdapAdapter > com.ibm.ws.wim.adapter.ldap.LdapAdapter getGroupsByMember ENTRY
...
... LdapConnectio > com.ibm.ws.wim.adapter.ldap.LdapConnection JNDI_CALL search(String, String, Object[], SearchControls) ENTRY "" (&(objectClass=dominogroup)(member=CN=user1,DC=ibm,DC=com))
...
... LdapConnectio < com.ibm.ws.wim.adapter.ldap.LdapConnection searchEntities RETURN []
... LdapAdapter < com.ibm.ws.wim.adapter.ldap.LdapAdapter getGroupsByMember RETURN false
... LdapAdapter < com.ibm.ws.wim.adapter.ldap.LdapAdapter getGroupsByMembership RETURN false
... 
... ServiceProvid < com.ibm.websphere.wim.ServiceProvider WIM_API get RETURN 

 

This example includes the requests to the LDAP (identifiable by "JNDI_CALL"). Not every trace will include these calls depending on VMM attribute and search caches.
Notice that if the LDAP returns nothing for the membership attribute (dominoAccessGroups in this example), then VMM's getGroupsByMembership call falls back to getGroupsByMember. VMM then makes a broad search request to the LDAP, which could take a long time to process which would affect performance. 

Notice that this example includes no <config:memberAttributes .../> configuration. If it did, getGroupsByMember's JNDI_CALL would be based on that explicit configuration rather than the default for that LDAP type.


RESOLVING THE PROBLEM
To avoid this delay, add an LDAP group that contains all WebSphere Portal users. The LDAP should then set the membership attribute value for every user, avoiding the getGroupsByMember fallback scenario above.

RELATED INFORMATION
 6.1 Login MustGather [http://www.ibm.com/support/docview.wss?uid=swg21312738]
7.0 Login MustGather [https://www.ibm.com/support/docview.wss?uid=swg21592791]




Cross reference information Segment Product Component Platform Version Edition Organizational Productivity- Portals & Collaboration WebSphere Portal End of Support Products AIX, HP-UX, Linux, Solaris, Windows, z/OS, IBM i 6.1