Title: IBM How to resolve and avoid the B2B Persistence down problem due to running out of space - United States

Text:
B2B; Archive; B2B Persistence TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 DataPower B2B appliances use the B2B Persistence configuration to store metadata and document payload. No B2B Gateway service can be operational when the B2B persistence store is unavailable. Therefore, you must monitor the space of the B2B persistence store and tune the archive settings to ensure that B2B persistence remains in a healthy state. 

SYMPTOM
Issue 1. The B2B persistence store is about to run out of space. 

To prevent the B2B persistence store from running out of space, the appliance runs an internal task periodically to check the free space. The appliance shuts down the B2B Gateway service, which sets its operational state to "down", when the used space is close to the maximum size of the persistence storage size as specified in the Storage Size field.

[/support/docview.wss?uid=swg21639436&aid=1] [/support/docview.wss?uid=swg21639436&aid=1]

When the B2B persistence store runs out of space, the system logs contain an error message and one of the following critical messages:


 * [b2bp][error] b2b-persistence(B2BPersistence) 0x82c0004a Disk space used by persistent store is close to maximum 
 * [mgmt][critic] b2bgw(myb2bgw) 0x03120018 Insufficient persistent store space on RAID volume 
 * [mgmt][critic] b2bgw(myb2bgw) 0x03120025 B2B persistence store down



Issue 2. The B2B persistence store abruptly runs out of space. 

When B2B Gateway services process large volumes of transactions, the persistence store can run out of space before the next periodic check. If you enabled high availability, you can see a backtrace in the temporary:/// directory that indicates an unscheduled restart of a critical internal task. 

RESOLVING THE PROBLEM
To resolve the out-of-space problem, increase the storage size of the B2B Persistence configuration. 


To avoid the out-of-space problem, use the B2B archive procedure as depicted in the Advanced guidance for WebSphere DataPower B2B gateway archive [http://www-01.ibm.com/support/docview.wss?uid=swg21576630] [http://www-01.ibm.com/support/docview.wss?uid=swg21576630]technote to define a fine capacity plan. For more information, see "Capacity Planning [http://pic.dhe.ibm.com/infocenter/wsdatap/v5r0m0/topic/com.ibm.dp.xb.doc/b2bdevelopersguide.xb6077.htm?path=5_2_0_6_0#b2b-gw_capacityplanning_concept]" in the DataPower Information Center. 

For example, if you expect B2B Gateway services to process a large number of translations over a long period of time, you can define a lower value for the threshold of the archive monitor. Hence the aged transactions can be archived in a timely manner and do not abruptly use up the storage.






Cross reference information Segment Product Component Platform Version Edition Business Integration WebSphere DataPower B2B Appliance XB60 4.0.2, 4.0.1, 5.0.0