Title: IBM How to protect Lotus Protector for Mail Security against POODLE (Padding Oracle On Downgraded Legacy Encryption) attack - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM
In order to protect a Lotus Protector for Mail Security system against POODLE it is recommended to disable SSLv3. The following article describes how SSLv3 is disabled for Apache and XMail. 

IMPORTANT: disabling SSLv3 for XMail may cause severe incompatibility problems with other MTAs that do not support TLS 1.x 


RESOLVING THE PROBLEM
1. disabling SSLv3 for Apache 


/etc/apache2/vhosts.d/mailsec_vhosts.conf

For both VirtualHosts (443 and 4443) add â€“SSLv3 to the SSLProtocol line: 

<IfDefine SSL>
SSLEngine on
SSLProtocol all -SSLv2 -SSLv3
SSLCipherSuite !MD5:!aNULL:HIGH
</IfDefine>


[/support/docview.wss?uid=swg21687838&amp;aid=1]
(after changing the mailsec_vhosts.conf file, please restart Apache --> service apache2 restart) 

Testing if disabling SSLv3 was successful:

Before the Change:
# openssl s_client -ssl3 -connect localhost:443 </dev/null 2>/dev/null | egrep 'Protocol.*SSLv'
Protocol : SSLv3

# openssl s_client -ssl3 -connect localhost:4443 </dev/null 2>/dev/null | egrep 'Protocol.*SSLv'
Protocol : SSLv3

After the Change:
# openssl s_client -ssl3 -connect localhost:443 </dev/null 2>/dev/null | egrep 'Protocol.*SSLv'
# 

# openssl s_client -ssl3 -connect localhost:4443 </dev/null 2>/dev/null | egrep 'Protocol.*SSLv'
# 


2. disabling SSLv3 For XMail 

Add the line ISSSSLOptions to /etc/xmail/server.tab (if it doesn't already exist) and set the value to 0x02000000L. If SSLv2 and SSLv3 should be disabled, the line looks like the following:

"ISSSSLOptions" "0x01000000L,0x02000000L"
(Note: the white space between a parameter name and a value in the server.tab file has always to be a TAB. Therefore the line should be "ISSSSLOptions"[TAB]"0x01000000L,0x02000000L")


[/support/docview.wss?uid=swg21687838&amp;aid=2]
(after changing the server.tab, please restart XMail --> service xmail restart) 

Testing if disabling SSLv3 was successful:

Before the change:
# openssl s_client -starttls smtp -crlf -ssl3 -connect 127.0.0.1:25 -CAfile /etc/apache2/ssl.crt/ca-bundle.crt </dev/null 2>/dev/null | grep "Protocol"
Protocol : SSLv3


After the Change:
# openssl s_client -starttls smtp -crlf -ssl3 -connect 127.0.0.1:25 -CAfile /etc/apache2/ssl.crt/ca-bundle.crt </dev/null 2>/dev/null | grep "Protocol"
#