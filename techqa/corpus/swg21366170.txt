Title: IBM System Log messages stop writing after running arstblsp and an upgrade to Content Manager OnDemand V8.4.1.0 - United States

Text:
 FLASH (ALERT)

ABSTRACT
 After upgrading to IBM® Content Manager OnDemand server V8.4.1.0 and running the command, arstblsp -a 1 -g 'System Log', OnDemand System Log messages stop writing. Running the command again generates errors similar to the following:

DB Error: [IBM][CLI Driver][DB2/AIX64] SQL0117N The number of values assigned is not the same as the number of specified or implied columns. SQLSTATE=42802 -- SQLSTATE=21S01, SQLCODE=-117, File=arsdoc.c, Line=3977

DB Error: [IBM][CLI Driver][DB2/AIX64] SQL0206N "TIME_STAMP" is not valid in the context where it is used. SQLSTATE=42703 -- SQLSTATE=42S22, SQLCODE=-206, File=arsseg.c, Line=6519
Unable to close table: ApplGroup(System Log) Agid(5011) Table(SL7) 

CONTENT
In OnDemand server V8.4.1.0, it is recommended to update the System Log application group to support message text up to 2000 characters. To complete this process, arstblsp -a 1 -g 'System Log must be run to close the current System Log data table. 

A defect, APAR PK78168, was identified in OnDemand server V8.4.1.0, where running the arstblsp -a 1 -g 'System Log' command created an invalid new System Log data table. The defect does not affect OnDemand server on Microsoft® Windows®.

If affected, the newest System Log table will only contain 10 columns, instead of 18. To obtain the name of the newest System Log table, take the highest numbered table returned in the following SQL query:

SELECT table_name FROM arsseg WHERE agid = (SELECT agid FROM arsag WHERE name='System Log')

The solution is to: 

 1. Restore the backup of your OnDemand database taken before the upgrade to V8.4.1.0. 
 2. Download the fixed arstblsp utility from the OnDemand FTP fixpack site in the Related information section; instructions for applying the fix can be found in PK78168.txt. 
 3. Run the fixed arstblsp utility to close the current System Log table.


The procedure to update the System Log application group can be run in any OnDemand server V8.4.1X version. The fixed arstblsp should only be used in V8.4.1.0. RELATED INFORMATION
 V8.4.1.0 FTP fix pack site [ftp://service.software.ibm.com/software/ondemand/fixes/v841/8.4.1.0/]