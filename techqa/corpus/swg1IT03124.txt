Title: IBM IT03124: WMQ 7.5: A SVRCONN CHANNEL TERMINATES WHEN BROWSING THE SYSTEM.ADMIN.TRACE.ACTIVITY.QUEUE - United States

Text:
  A FIX IS AVAILABLE
Fix Pack 8.0.0.1 for WebSphere MQ V8.0 [http://www-01.ibm.com/support/docview.wss?uid=swg24038219]


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  An attempt to browse the SYSTEM.ADMIN.TRACE.ACTIVITY.QUEUE
   using a client application results in an unexpected termination
   of a SVRCONN channel.
   
   The following error can be seen in a queue manager's error log:
   AMQ9604: Channel 'MQ.ADMINISTRATOR' terminated unexpectedly
   
   EXPLANATION:
   The process or thread executing channel 'CLIENT.TO.TEST' is no
   longer running. The check process system call returned
   545284357 for process 12345.
   
   Corresponding FDC shows that the amqrmppa process terminated
   with a SIGSEGV:
   
   Probe Id :- XC130003
     Component :- xehExceptionHandler
     Program Name :- amqrmppa
     Major Errorcode :- STOP
     Probe Type :- HALT6109
     Probe Description :- AMQ6109: An internal WMQ error has
   occurred.
     Arith1 :- 11 (0xb)
     Comment1 :- SIGSEGV: address not
   mapped(0x7ff699f0b4c0)
   
   ----------------------------------------------------------------
   -
     O/S Call Stack for current thread
   
   /opt/mqm/lib64/libmqmcs_r.so(xcsPrintStackForCurrentThread+0x3e)
     [0x7ff6ad9b71be]
     /opt/mqm/lib64/libmqmcs_r.so(signalHandlerInternal+0x8d)
     [0x7ff6ad9cfcfd]
   
   /opt/mqm/lib64/libmqmcs_r.so(PrepareDumpAreas+0xbce)[0x7ff6ad9ce
   97e]
     /opt/mqm/lib64/libmqmcs_r.so(xcsFFSTFn+0x842)[0x7ff6ad9d0e42]
     /opt/mqm/lib64/libmqmcs_r.so(xehExceptionHandler+0x93e)
     [0x7ff6ad9cc38e]
     /lib64/libpthread.so.0[0x3dc8a0f500]
     /opt/mqm/lib64/libmqmr_r.so(rriSizeofMQMD+0x0)[0x7ff6ae2a59d0]
   
   /opt/mqm/lib64/libmqmr_r.so(rstSendAsyncMessage+0x3ff)[0x7ff6ae2
   f71df]
     /opt/mqm/lib64/libmqmr_r.so(rstCheckForOneMessage+0x792)
     [0x7ff6ae2f8342]
     /opt/mqm/lib64/libmqmr_r.so(rstReceiveMessageRequest+0x8dc)
     [0x7ff6ae2f9cbc]
   
   /opt/mqm/lib64/libmqmr_r.so(rriServerAsyncRcv+0x77e)[0x7ff6ae246
   51e]
   
   /opt/mqm/lib64/libmqmr_r.so(cciProcessAsyncRcv+0xee)[0x7ff6ae0b6
   c3e]
   
   /opt/mqm/lib64/libmqmr_r.so(cciProcessUserData+0xc4)[0x7ff6ae0b8
   c24]
   
   /opt/mqm/lib64/libmqmr_r.so(cciProcessOne+0x803)[0x7ff6ae0bc193]
   
   /opt/mqm/lib64/libmqmr_r.so(ccxReceiveThreadFn+0x199)[0x7ff6ae0b
   e7b9]
   
   /opt/mqm/lib64/libmqmr_r.so(rrxResponder+0x3f4)[0x7ff6ae25b6a4]
   
   /opt/mqm/lib64/libmqmr_r.so(ccxResponder+0x1e0)[0x7ff6ae0c6d10]
   
   /opt/mqm/lib64/libmqmr_r.so(cciResponderThread+0x9d)[0x7ff6ae0c6
   e5d]
     /opt/mqm/lib64/libmqmcs_r.so(+0x113d53)[0x7ff6ada1cd53]
     /lib64/libpthread.so.0[0x3dc8a07851]
     /lib64/libc.so.6(clone+0x6d)[0x3dc82e890d]
     .
     MQM Function Stack
     ccxResponder
     rrxResponder
     ccxReceiveThreadFn
     cciProcessOne
     cciProcessUserData
     cciProcessAsyncRcv
     rriServerAsyncRcv
     rstReceiveMessageRequest
     rstCheckForOneMessage
     rstSendAsyncMessage
     xcsFFST
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY
 *  ****************************************************************
   USERS AFFECTED:
   Customers exploiting data conversion via MQ clients, where the
   message being retrieved expands due to data conversion.
   
   
   Platforms affected:
   MultiPlatform
   
   ****************************************************************
   PROBLEM DESCRIPTION:
   The queue manager tries to allocate the MQMD and the payload in
   contiguous memory such that it can be sent in a single buffer.
   If the payload expands due to data conversion and if the MQMD
   was contiguous with the payload this relationship is maintained
   and both the MQMD and the payload are reallocated.
   Not all references to the MQMD were aware of the potential
   movement of the MQMD. If the storage used for the previous copy
   of the MQMD is reused then unpredictable results follow.
   
   
    
   
   

PROBLEM CONCLUSION
 *  If the MQMD is moved as part of message expansion due to data
   conversion with async consume, then all subsequent references to
   the MQMD are now to the new copy of the MQMD.
   
   In addition it was noticed that a PCF message being converted
   from CCSID 819 to CCSID 819, big endian to little endian, was
   being unexpectedly expanded.
   The message was generated as part of MQ internal activity trace
   processing, and had been generated with sub-structures that were
   not properly aligned. The code that generates the activity trace
   PCF messages was also corrected to ensure correct alignment.
   
   ---------------------------------------------------------------
   The fix is targeted for delivery in the following PTFs:
   
   Version    Maintenance Level
   v7.5       7.5.0.5
   v8.0       8.0.0.1
   
   The latest available maintenance can be obtained from
   'WebSphere MQ Recommended Fixes'
   http://www-1.ibm.com/support/docview.wss?rs=171&uid=swg27006037 [http://www-1.ibm.com/support/docview.wss?rs=171&uid=swg27006037]
   
   If the maintenance level is not yet available information on
   its planned availability can be found in 'WebSphere MQ
   Planned Maintenance Release Dates'
   http://www-1.ibm.com/support/docview.wss?rs=171&uid=swg27006309 [http://www-1.ibm.com/support/docview.wss?rs=171&uid=swg27006309]
   ---------------------------------------------------------------
   
   
    
   
   

TEMPORARY FIX

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   IT03124
   
   
 * REPORTED COMPONENT NAME
   WMQ BASE MULTIP
   
   
 * REPORTED COMPONENT ID
   5724H7241
   
   
 * REPORTED RELEASE
   750
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2014-07-11
   
   
 * CLOSED DATE
   2014-08-11
   
   
 * LAST MODIFIED DATE
   2014-08-11
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   WMQ BASE MULTIP
   
   
 * FIXED COMPONENT ID
   5724H7241
   
   

APPLICABLE COMPONENT LEVELS
 * R750 PSY
   UP