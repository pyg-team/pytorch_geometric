Title: IBM Unknown Error Occurs When Saving Web Data Following the Execution of a System Link - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 On the Contributor Web, when a particular system link is run which brings data from one application into another
application, the link runs fine and the correct data appears.

However, upon saving, the following error occurs regardless of user and regardless of machine.




SYMPTOM
ON SCREEN ERROR:
The following error was reported by the server:-
Unknown error
OK

PLANNINGERRORLOG.CSV from user's workstation

Unable to open ini file ''
Unable to open ini file ''
Process exception
IO Error loading link

PLANNINGERRORLOG.CSV from Admin Server:

RESPONSE_ERROR (Database errors: number: 0x80004005, source: Microsoft OLE DB Provider for SQL Server, description: [DBNETLIB][ConnectionOpen (Connect()).]SQL Server does not exist or access denied., details: Open, com error description: [DBNETLIB][ConnectionOpen (Connect()).]SQL Server does not exist or access denied.)
general exception in try block
Process exception
process general exception
Stub invoke failed, rc = 0



CAUSE
SQLOLEDB driver

ENVIRONMENT
Microsoft SQL 2005 Server

RESOLVING THE PROBLEM
Use the SQL Native Client driver (SQLNCLI) in place of the SQLOLEDB driver. 
(Note: You may also need to enable the MS SQL 2000 compatibility mode in SQL Server 2005. For information about compatibility modes in MS SQL Server, please refer to Microsoft documentation.)




Steps: To update the driver, the following steps are required: 
1. Download and install the Microsoft SQL Native Client Interface package from the Microsoft website. 
2. Install the SQLNCLI driver onto ALL Planning server machines and the SQL server machine. All Planning servers are those that have Planning server components installed (except the Gateway). i.e. if the machine has Planning services enabled in IBM Cognos Configuration under Environment - IBM Cognos 8x or 10x Services 

The steps for configuring IBM Cognos Planning to use the new driver are as follows: 
3. Open the Contributor Administration Console 
4. Expand Datastores and Application folders until all applications are visible. 
For each datastore: 
5. Click on each of the datastore(s) in turn. 
6. Click on the Configure button on the right hand side of the screen 
7. In the Configure Datastore Server Connection window click Advanced 
8. In the field Provider Driver change to SQLNCLI 
9. Test Connection and click OK 
10. You will get a message saying do you wish to apply this setting to all child applications; click Yes. 
This should cascade to all applications and publish containers in that datastore. 
11. You can check the Provider Driver for each application, by clicking the individual applications, selecting Configure and click on Advanced. 
12. You can check the Publish Containers by going to the Application 
13. Click on Production 
14. Select Table only layout or view layout 
15. Click on the Options tab and select Configure 
16. Select the publish container and click configure and click Advanced. 
NB: Scheduling downtime and bringing the whole system down when making this change is recommended. When restarting services bring the primary Content Manager up first before all the other machines. 
Configuration changes previously made but where the services had not been restarted will take affect when you restart the services at this point