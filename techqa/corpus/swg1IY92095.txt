Title: IBM IY92095: FAIL TO DISCOVER WEBLOGIC 9.2 - United States

Text:
 SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS SUGGESTION FOR FUTURE RELEASE.
    
   
   

ERROR DESCRIPTION
 *  Problems  discovering WebLogic 9.2
   .
   
   The sensors kicks off, but fails in error.
   The error.log file indicated a classdefinition not found on the
   javax.management.DynamicMBean class.
   .
   
   **** Analysis  by  L3 team ***
   
   L3 tried to discover weblogic 9.2 running on a machine in our
   lab.
   The taddm server did NOT have webservices.jar or weblogic.jar
   .
   First,  they added an entry to the scope and an entry to the
   access
   list, then ran a discovery.
   The weblogic sensor did NOT kick off and there was no
   local-anchor log
   The error we got  in the log is:
   -----------------------
   2006-11-21 11:08:14,218 DiscoverManager
   ﾜDiscoverEngineMainThread]
   ERROR agent.
   ConfigurableAgentLoader -
   java.lang.NoClassDefFoundError:
   weblogic.management.runtime.ServerRuntimeMBean
           at java.lang.J9VMInternals.verifyImpl(Native Method)
           at java.lang.J9VMInternals.verify(J9VMInternals.java:
           at java.lang.J9VMInternals.verify(J9VMInternals.java:42)
           at
   java.lang.J9VMInternals.initialize(J9VMInternals.java:111)
           at java.lang.Class.forNameImpl(Native Method)
           at java.lang.Class.forName(Class.java:131)
   ------------------------
   The error you were getting in the log is:
   ---------------------
   2006-11-20 15:31:12,942  ﾜThread: 0,8494]  ERROR
   collation.AnchorServerﾜ0] - han
   dler.run() throwable exception
   java.lang.NoClassDefFoundError: javax/management/DynamicMBean
           at java.lang.ClassLoader.defineClass0(Native Method)
           at
   java.lang.ClassLoader.defineClass(ClassLoader.java:808)
           at
   java.security.SecureClassLoader.defineClass(SecureClassLoader.j
   va:14
   7)
   ---------------------
   .
   Those errors are very similar - could be due to differences in
   the taddm
   version.
   VERIFY that you
   have the webservices.jar and weblogic.jar
   WE then unzipped our supplement.zip and copied in weblogic.jar
   and
   webservices.jar AS ROOT which is wrong, but
   we  wanted to test it.
   .
   Ran discover.
   The weblogic sensor did NOT kick off and there was no
   local-anchor log
   file.
   .
   .
   -  changed the ownership of the two files to the taddm service
   account
   and re-ran discover.
   .
   The weblogic sensor DID kick off and it succeeded, but it stored
   0
   domains and 0 clusters
   There is now a local-anchor log file.
   .
   
   *** Additional analysis  by  customer *****
   ______________________________________________
   
   
   
   I have done the same tests multiple times. You need the jar
   files in
   order to kick off the WL sensor. The main class it needs in
   weblogic
   is the weblogic.management.runtime.ServerRuntimeMBean (see your
   erro
   So whenever the jar files are not there (and that particular
   class f
   cannot be found), no local anchor file will be created and your
   error.log file will tell you that he didn't find the
   weblogic.management.runtime.ServerRuntimeMBean class. The
   WebLogic
   sensor runs in a separate JVM, that's why it creates another log
   fil
   separate from the
   ﾽCOLLATION_HOME/log/service/DiscoverManager.log fi
   
   I have ran two major tests where the sensor kicks off. One
   fails, th
   other one has the same result you describe:
   The last set of logs I sent you was the scenario you just talked
   abo
   
   Let me walk you through:
   
   I am in the library directory:
   -sh-3.00ﾽ pwd
   /opt/IBM/itaddm/dist/lib
   
   This is tne supplement file, I got from support, let me show you
   the
   contents so you can check it with your jar files. The only thing
   I c
   think off is that you use a different version of the supplement
   zip
   -sh-3.00ﾽ unzip -l WL-supp.zip
   Archive:  WL-supp.zip
     Length     Date   Time    Name
    --------    ----   ----    ----
    37058122  03-14-06 22:36   weblogic.jar
     1898885  03-14-06 22:36   webservices.jar
    --------                   -------
    38957007                   2 files
   
   These are the weblogic jar files in my ﾽCOLLATION_HOME/lib
   directory
   you can see they are the same as in my supplement zip file and
   they
   owned by itaddm (the collation process owner):
   -sh-3.00ﾽ ls -l web*
   -rw-r--r--  1 itaddm sys 37058122 Mar 14  2006 weblogic.jar
   -rw-r--r--  1 itaddm sys  1898885 Mar 14  2006 webservices.jar
   
   
   Whenever I run a discovery, my local anchor file indicates 2
   differe
   errors. This is probably related due to the fact that two
   WebLogic
   sensors are kicked off.
   
   1) This is the error coming from the first sensor it starts,
   trying
   9.36.159:7011 (which is the correct port). As you can see in the
   log
   below, it succeeds in initiating connection, sending messages,
   getti
   Home, etc. Finally, the sensor fails in getting the domains.
   
   2006-11-21 13:17:50,954  ﾜThread: 0,8495]  DEBUG
   collation.WeblogicA
   - Trying URL : t3://9.36.159.55:7011
   2006-11-21 13:17:50,954  ﾜThread: 0,8495]  DEBUG
   collation.WeblogicA
   - Getting Environment
   2006-11-21 13:17:50,954  ﾜThread: 0,8495]  DEBUG
   collation.WeblogicA
   - Class Path :
   /opt/IBM/itaddm/dist/lib/anchor14.jar:/opt/IBM/itaddm/dist/lib/p
   latf
   model.jar:/opt/IBM/itaddm/dist/lib/anchor-dep.jar:/opt/IBM/itadd
   m/di
   ib/discover-sensors14.jar:/opt/IBM/itaddm/dist/lib/webservices.j
   ar
   2006-11-21 13:17:50,954  ﾜThread: 0,8495]  DEBUG
   collation.WeblogicA
   - Getting Initial Context from Env for User : weblogic
   2006-11-21 13:17:52,947  ﾜThread: 0,8495]  DEBUG
   collation.WeblogicA
   - Calling Lookup on Context:
   javax.naming.InitialContext@45ff9924
   2006-11-21 13:17:53,211  ﾜThread: 1,8494]  DEBUG
   collation.AnchorServerﾜ1] - server(1)
   readMessage:HelloMsg:(#4):ip=127.0.0.1,host=loopback:loopback:cl
   ass
   connection
   2006-11-21 13:17:53,213  ﾜThread: 1,8494]  DEBUG
   collation.AnchorServerﾜ1] - server(1) sendMessage
   to:127.0.0.1:ReplyMsg:(#1):ip=null,host=localhost:MSG_SUCCESS:::
   2006-11-21 13:17:53,277  ﾜThread: 1,8494]  INFO
   collation.AnchorServerﾜmain] - message handler thread finished
   2006-11-21 13:17:53,277  ﾜThread: 1,8494]  DEBUG
   collation.AnchorServerﾜmain] - thread id: Thread: 1,8494
   finished
   running
   2006-11-21 13:17:53,310  ﾜThread: 0,8494]  DEBUG
   collation.AnchorServerﾜ0] - server(0)
   readMessage:HelloMsg:(#5):ip=127.0.0.1,host=loopback:loopback:ne
   w au
   2006-11-21 13:17:53,318  ﾜThread: 0,8494]  DEBUG
   collation.AnchorServerﾜ0] - server(0) sendMessage
   to:127.0.0.1:ReplyMsg:(#2):ip=null,host=localhost:MSG_SUCCESS:::
   2006-11-21 13:17:53,453  ﾜThread: 0,8495]  DEBUG
   collation.WeblogicA
   - Got Home From the Lookup :
   weblogic.rmi.internal.BasicRemoteRef@10
   hostID:
   '-4275943562114557215S:blade5.be.ibm.com:ﾜ7011,7011,-1,-1,-1,-
   -1]:
   ec:MedRecServer', oid: '260'
   2006-11-21 13:17:53,454  ﾜThread: 0,8495]  DEBUG
   collation.WeblogicA
   .......
   ..................
   
   
    
   
   

LOCAL FIX

PROBLEM SUMMARY

PROBLEM CONCLUSION

TEMPORARY FIX

COMMENTS
 *  This request has been submitted to the appropriate product
   manager via MR MR1130063440.
   
   
    
   
   

APAR INFORMATION
 * APAR NUMBER
   IY92095
   
   
 * REPORTED COMPONENT NAME
   APP DEPENDENCY
   
   
 * REPORTED COMPONENT ID
   5724N5500
   
   
 * REPORTED RELEASE
   511
   
   
 * STATUS
   CLOSED SUG
   
   
 * PE
   NoPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt
   
   
 * SUBMITTED DATE
   2006-11-22
   
   
 * CLOSED DATE
   2006-12-05
   
   
 * LAST MODIFIED DATE
   2006-12-05
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
   
   
   

FIX INFORMATION

APPLICABLE COMPONENT LEVELS