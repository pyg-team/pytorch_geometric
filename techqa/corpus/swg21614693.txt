Title: IBM SQL agent causes faulting application koqos.exe message in the event log - United States

Text:
5724B96MOTR IBM Tivoli MSSQL TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 ITCAM for Microsoft Applications - SQL Server monitoring agent - Event log floods with application error messages from faulting application koqos.exe. 

SYMPTOM
Event log shows following event: 

Faulting application koqos.exe virsion 0.0.0.0 time stamp <hex>, 
faulting module koqos.exe, version 0.0.0.0, time stamp <hex>, exception 
code 0xc0000005, fault offset... 


CAUSE
Some performance counters required by the monitoring agent may have been disabled. 


DIAGNOSING THE PROBLEM
Check if Operating System and Process performance counter services are disabled. These correspond to perfos.dll and perfproc.dll. 

For example, on Windows 2008, use following commands to check status of these performance services.

LODCTR /Q:PerfOS 

LODCTR /Q:PerfProc



RESOLVING THE PROBLEM
If any of the performance services (PerfOS, PerfProc) are found disabled, then enable the services. 

For example, following shows that performance counter service for process is disabled:
C:\Windows>LODCTR /Q:PerfProc 
Performance Counter ID Queries [PERFLIB]: 
... 
[PerfProc] Performance Counters (Disabled) 
DLL Name: %SystemRoot%\System32\perfproc.dll 
... 

Enable the service as follows:

LODCTR /E:PerfProc

Query to ensure that it is now enabled:

C:\Windows>LODCTR /Q:PerfProc 

Performance Counter ID Queries [PERFLIB]: 
... 
[PerfProc] Performance Counters (Enabled) 
DLL Name: %SystemRoot%\System32\perfproc.dll 
...