Title: IBM Tightened SSL Protoocols to resolve CVE-2014-3566 results in Secure Sockets Layer (SSL) Connection Fails With TCP3D2C RC = -11 - United States

Text:
 FIX README

ABSTRACT
 After an OS upgrade where weak SSL protocols and cipher specifications are not included in default support or they have been removed from support manually to maintain strong encryption on the system, attempts to connect to a server using a weak (unsupported) protocol and/or cipher specification will fail. An SSL return code of -11 (TCP3D2C rc -11) is an example of a connection rejection due to the server attempting to use a weak encryption type. 

To resolve this either the remote server must upgrade to strong encryption or the IBMi System Values must be modified to allow the weak protocols and ciphers used by the remote server. 

CONTENT
The most secure solution would be to upgrade the SSL server certificate and/or the remote server to only use strong encryption protocols, cipher specifications, and key sizes. This would maintain PCI / Security audit compliance. 

If the weak protocol, cipher specification, and key sizes are acceptable for the local security policies in place, system values can be modified to allow support of the weak encryption protocols, and cipher specifications. 

Note: You must have *IOSYSCFG, *ALLOBJ, and *SECADM special authorities to change this system value. 

To modify system values so that the existing weak encryption ciphers are supported on your IBMi system do the following: 

First set the system value to indicate you want the operating system to automatically add the supported cipher specifications for each of the Protocols desired: 

From a 5250 command line: 

 * WRKSYSVAL SYSVAL(QSSL*)
 * 
 *   * Enter 5 to display QSSLCSLCTL 
    * The value of *OPSYS (Default Value) allows the operating system to automatically add/remove cipher specifications to support the SSL protocols defined in the QSSLPCL system value. 
    * The value of *USRDFN sets the cipher specification list to be manually updated. This allows you (the system security officer) to specify a list of restricted list of supported ciphers to match your organizations unique security policies. Note: if set to *USRDFN, cipher specifications required for the SSL protocols you wish to use must be manually managed prior to adding be able to a new protocol. To manually display the cipher specifications supported:  * Enter 5 to display QSSLCSL: This will display the cipher specifications currently supported by the system 
       * Enter 2 to edit QSSLCSL: This will allow the addition and/or removal of the cipher specification list supported by the system
      
      
   
   
 * Reference the following link for the list of cipher specifications supported when manually managing the cipher specifications List:
 * 
 * http://www.ibm.com/support/knowledgecenter/ssw_ibm_i_72/rzakz/rzakzqsslcsl.htm
 * 
 * 
 * 
 *   * Enter 5 to display QSSLPCL: This will display one of two things:  1. *OPSYS: Which indicates the default protocols for the OS release are supported. To see what those defaults protocols actually are, reference the IBM Knowledge center for the appropriate OS release. 
       2. A manually defined list of the SSL protocols currently supported by the system
      
      
    * Enter 2 to edit QSSLPCL: *OPSYS is the default value. To add or remove an SSL protocol, the *OPSYS value must be removed and replaced with a complete list of all the SSL protocols you want to support. To see what the defaults protocols actually are and the list of protocols availabel, reference the IBM Knowledge Center for the appropriate OS release.
   
   Note: If an error is reported when attempting to modify the protocol list indicating that the QSSLCSL system value must be updated first, it means that the cipher specifications needed to support the protocols aren't present. They either have to be added manually or QSSLCSLCTL set to *OPSYS, so they can be added for you. 


Returning the system to its default SSL settings: 
If at any time, you wish to return the system to the default values:  1. Set the QSSLCSLCTL system value to *OPSYS 
 2. Set the QSSLPCL system value to *OPSYS 


Any changes to the cipher specification list or the protocol list are immediate for all subsequent system SSL sessions. 
NOTE: Adding SSL protocols and/or cipher specifications that have been identified as "weak" (SSLV2 and SSLV3 being examples of weak protocols), will not meet PCI compliance. Prior to enabling weak protocols and/or ciphers we recommend that you contact your organization's security officer or team for their concurrence. RELATED INFORMATION
 V7R2 Memo to users [http://www.ibm.com/support/knowledgecenter/ssw_ibm_i_72/rzahg/rzahgmtu.htm]


 


Cross reference information Segment Product Component Platform Version Edition Operating System IBM i 7.2 Operating System IBM i 7.1 Operating System IBM i 6.1