Title: IBM PI54515: CICS TS VER.5.1 T8 TCB NOT DISSOCIATED AFTER THE BACKOUT HAS BEEN DRIVEN. 16/02/04 PTF PECHANGE - United States

Text:
z/os  A FIX IS AVAILABLE
Obtain the fix for this APAR.


SUBSCRIBE
You can track all active APARs for this component.



APAR STATUS
 * CLOSED AS PROGRAM ERROR.
    
   
   

ERROR DESCRIPTION
 *  After upgrade CICS TS Ver.5.1 Websphere Liberty Profile (WLP)
   to 8.5.5.6 Fixpack, an exception on a db2 call is issued:
   
   T2zOS exception:
   Ýjcc~ÝT2zos~T2zosConnection.flowConnect:execConnect: 1337:
   Connection dead, SQLCODE:-4499, SQLSTATE:null ERRORCODE=-4499,
   SQLSTATE=null
   
   It ends with an 00F30018 error at DB2 (at that point a COMMIT
   call to DB2 was issued).
   
   From dump you can see a task has issued DB2 API calls from both
   a L8 TCB and a T8 TCB.  This task eventually drives COMMIT -
   but BACKWARDS. D2D2 is driven for function BACKOUT on the T8
   TCB. As seen in the internal CSUB trace in trace this involves
   an ASSO for the TCB and then an ABRT.  These work OK. A little
   later Switch_application_env is done to come off the T8 back to
   QR. The TRUES are then called for task end and D2D2 is driven
   for END_OF_TASK but on the L8 TCB. This fails because the
   CSUB is still associate with the T8 TCB.
   
   Doing a VERBX dsnwdmp 'subsys=DBP1,DS=1' shows:
   
   ACE: 192DD0C0 Status: T   Req: 0055    Allied Chain
    Authid: ........ Plan: ..X..... Corrid: ".0.".0..... Corrname:
   ........
   Token: 000170E1
    EB       Primary(Asid)  Home(Asid)     EBSPAWND TCB/SRB
   -Status-- R14
    192DD180 CICSALAP(0289) CICSALAP(0289) 00000000 00A93E88
   Running
   00000000
   
   When the T8 TCB had finished backout and before the switch
   environment call it needs to do a DISS, so that task can
   finish cleanly.
   
   
    
   
   

LOCAL FIX
 *  No Local fix
   
   
    
   
   

PROBLEM SUMMARY
 *  ****************************************************************
   * USERS AFFECTED: All CICS Users with PI36541 [http://www-01.ibm.com/support/docview.wss?uid=swg1PI36541] applied.         *
   ****************************************************************
   * PROBLEM DESCRIPTION: CICS DB2 application may receive -4499  *
   *                      errorcode and feedback of 00F30018.     *
   ****************************************************************
   * RECOMMENDATION:                                              *
   ****************************************************************
   A mixed language CICS DB2 application may fail with feedback
   code of 00F30018 and an errorcode of -4499.
   In the customer's case the application issued DB2 calls on
   both a L8 TCB and a T8 TCB. The problem occurs when a T8 TCB
   has issued a SYNCPOINT call. This call completes but does not
   then issue a DISSOCIATE for the T8 TCB, which when the L8 TCB
   is being ASSOCIATEd back to the DB2 thread, fails, because the
   DB2 thread is still ASSOCIATEd to the T8 TCB.
   This leaves the T8 TCB and DB2 thread permanently ASSOCIATEd.
   
   Keywords: abendAD3L AD3L
   
   
    
   
   

PROBLEM CONCLUSION
 *  UI26932 UI26933
   
   DFHD2EX1 has been changed to ensure a DISSOCIATE is issued
   following a SYNCPOINT call.
   
   
    
   
   

TEMPORARY FIX
 *  FIX AVAILABLE BY PTF ONLY
   
   
    
   
   

COMMENTS

APAR INFORMATION
 * APAR NUMBER
   PI54515
   
   
 * REPORTED COMPONENT NAME
   CICS TS Z/OS V5
   
   
 * REPORTED COMPONENT ID
   5655Y0400
   
   
 * REPORTED RELEASE
   800
   
   
 * STATUS
   CLOSED PER
   
   
 * PE
   YesPE
   
   
 * HIPER
   NoHIPER
   
   
 * SPECIAL ATTENTION
   NoSpecatt / Xsystem
   
   
 * SUBMITTED DATE
   2015-12-23
   
   
 * CLOSED DATE
   2016-02-09
   
   
 * LAST MODIFIED DATE
   2016-03-02
   
   

 * APAR IS SYSROUTED FROM ONE OR MORE OF THE FOLLOWING:
   
   
   
 * APAR IS SYSROUTED TO ONE OR MORE OF THE FOLLOWING:
    UI35286 UI35287
   
   

MODULES/MACROS
 *  DFHD2EX1
   
   
    
   
   

FIX INFORMATION
 * FIXED COMPONENT NAME
   CICS TS Z/OS V5
   
   
 * FIXED COMPONENT ID
   5655Y0400
   
   

APPLICABLE COMPONENT LEVELS
 * R800 PSY UI35286 [HTTPS://WWW14.SOFTWARE.IBM.COM/WEBAPP/SET2/ORDERMEDIA/SHOPCART?PTFS=UI35286]
   UP16/02/19 P F602 {
   
   
 * R900 PSY UI35287 [HTTPS://WWW14.SOFTWARE.IBM.COM/WEBAPP/SET2/ORDERMEDIA/SHOPCART?PTFS=UI35287]
   UP16/02/19 P F602 {
   
   

FIX IS AVAILABLE
 * SELECT THE PTF APPROPRIATE FOR YOUR COMPONENT LEVEL. YOU WILL BE REQUIRED TO SIGN IN. DISTRIBUTION ON PHYSICAL MEDIA IS NOT AVAILABLE IN ALL COUNTRIES.