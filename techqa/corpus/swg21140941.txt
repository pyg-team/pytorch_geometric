Title: IBM MustGather: Synchronization problems in WebSphere Application Server - United States

Text:
MustGather; MustGather; MustGather; autopd; auto pd; MustGatherDocument TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 Collecting data for synchronization problems with the IBM WebSphere Application Server. Gathering this MustGather information before calling IBM support will help you understand the problem and save time analyzing the data. 

RESOLVING THE PROBLEM
 

TAB NAVIGATION
 * Learn more [http://www.ibm.com/support/docview.wss?uid=swg21237241]
 * Troubleshoot [http://www.ibm.com/support/docview.wss?uid=swg21199305]
 * Collect data- selected tab,
 * Analyze data [http://www.ibm.com/support/docview.wss?uid=swg21199304]


If you have already contacted support, continue to the component-specific MustGather information. Otherwise, click: MustGather: Read first for all WebSphere Application Server products [http://www.ibm.com/support/docview.wss?rs=180&uid=swg21145599]. 

Note: Collecting the following MustGather information has been automated in the IBM Support Assistant [http://www.ibm.com/software/support/isa/] product feature for WebSphere Application Server. 


Synchronization specific MustGather information 
This technote explains the information needed to better understand why specific files are not properly transferred and synchronized or why the administrative console or wsadmin display a node as being not Synchronized. 

Do the following to test and collect the correct information for understanding synchronization problems: 
 1. If you are running versions 5.0 or 5.1, make sure the File Transfer enterprise application is running on the deployment manager (dmgr) by checking the running applications in the console.
    
    
 2. Try to do a full resynchronization of the problem node. This double checks if synchronization is initialized. The following are two ways to perform a full resynchronization:
    
    If the node status is Unknown or the MBean is not returned, this is not a synchronization problem, but instead a discovery problem.
     1. Using wsadmin commands:  1. Identify the ConfigRepository MBean and assign it to variable a:
            
            
            wsadmin>set a [$AdminControl completeObjectName type=
            ConfigRepository,process=nodeagent,node=nodename,*]
            
            
            =>Returns a MBean.
            
            
         2. Invoke the object operation without any parameter:
            
            
            wsadmin>$AdminControl invoke $a refreshRepositoryEpoch
            
            
            =>Returns an integer.
            
            
         3. Set the variable b for node synchronize:
            
            
            wsadmin>set b [$AdminControl completeObjectName type=
            NodeSync,node=nodename,*]
            
            
            =>Returns a MBean.
            
            
         4. Synchronize by issuing the following command:
            
            
            wsadmin>$AdminControl invoke $b sync
            
            
            where: is: set JACL command a,b Variable names $ JACL operator for substituting a variable name with its value AdminControl Object that enables the manipulation of MBeans running in a WebSphere Application Server process completeObjectName $AdminControl command that creates a string representation of a complete ObjectName value based on a fragment process Key property that represents the name of the server process in which the object runs node Key property that represents the name of the node on which the object runs type Key property that indicates the type of object that is accessible through the MBean invoke Invokes the object operation without any parameter. Returns the result of the invocation. refreshRepositoryEpoch Resets the node digest set sync Attribute of modify objects 
        
        
     2. Using the administrative console:  1. Expand the System Administration section and select Nodes.
            
         2. Check the box next to the nodes that are not synchronized.
            
            
         3. Click Full Resynchronize.
            
            
        
        
    
    
 3. Trace the synchronization process.  1. Enable synchronization tracing on the dmgr:  1. Edit the server.xml file for the dmgr located in the following directory:
            
            
            $WAS_ND_HOME/config/cells/cellname/nodes/nodename/servers/dmgr
            
            
         2. Find the TraceService XML tag section.
            
            
         3. Modify the startupTraceSpecification entry to look like the following:  * For version 6.x, 7.0, 8.0, 8.5 and 9/0: 
               com.ibm.ws.management.*=all:com.ibm.websphere.management.*=all
               
               
               
            
            
        
        
     2. Make sure the enable entry is set to true.  1. Recycle the dmgr server and clear the ffdc and dmgr log directories.
            
        
        
     3. Use the syncNode script on the Base install:
         1. Stop the nodeagent. This is done because the syncNode script uses the nodeagent SOAP port.
            
         2. Execute the syncNode script located in your $WAS_BASE_HOME/bin directory.
        
         * Command with security Disabled:
           
           
           syncNode.bat(sh) cell_hostnamedmgr_SOAP_port-trace
           
           
         * Command with security Enabled:
           
           
           syncNode.bat(sh) cell_hostnamedmgr_SOAP_port-username uid-password pwd-trace
        
        
    
    
 4. Run the collector tool on both ND and BASE.
    
 5. If Step 3 works and you still have synchronization problems with your nodeagent, trace the nodeagent synchronization process with the dmgr.  1. Enable synchronization tracing on the dmgr:  1. Edit the server.xml file for the dmgr located in the following directory:
            $WAS_ND_HOME/config/cells/cellname/nodes/nodename/servers/dmgr
            
            
         2. Find the TraceService XML tag section.
            
            
         3. Modify the startupTraceSpecification entry to look like the following:  * For versions 7.0, 8.0, 8.5, 8.5.5 and 9.0:
               com.ibm.ws.management.*=all:com.ibm.websphere.management.*=all
               
               
            
            
        
        
     2. Make sure the enable entry is set to true.  1. Recycle the dmgr server and clear the ffdc and dmgr log directories.
            
        
        
     3. Enable synchronization tracing on the nodeagent:  1. Edit the server.xml file for the nodeagent located in the following directory:
            $WAS_BASE_HOME/config/cells/cellname/nodes/nodename/servers/nodeagent
            
            
         2. Find the TraceService XML tag section.
            
         3. Modify the startupTraceSpecification entry to look like the following:  * For versions 7.0, 8.0, 8.5, 8.5.5 and 9.0:
               com.ibm.ws.management.*=all:com.ibm.websphere.management.*=all
               
               
            
            
         4. Make sure the enable entry is set to true.
            
            
        
        
     4. Recycle the nodeagent and clear the ffdc and nodeagent log directories.
        
        
     5. Run the collector tool on both ND and BASE.
        
        
        
    
    

What to do Next? 
Once you have collected the preceding information, you can begin Analyzing the data [http://www.ibm.com/support/docview.wss?rs=180&uid=swg21199304] or simply submit the diagnostic information to IBM support [http://www.ibm.com/support/docview.wss?rs=180&uid=swg21153852]. 

For a listing of all technotes, downloads, and educational materials specific to synchronization, search the WebSphere Application Server support site [http://www.ibm.com/software/webservers/appserv/was/support/]. RELATED INFORMATION
 Recording your screen to share with IBM Support [https://www.ibm.com/developerworks/community/blogs/IBMElectronicSupport/entry/recording_your_screen_to_share_with_support?lang=en]





Cross reference information Segment Product Component Platform Version Edition Application Servers Runtimes for Java Technology Java SDK