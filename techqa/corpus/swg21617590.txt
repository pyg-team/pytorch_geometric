Title: IBM The db2ssh tool and FIPS - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 The db2ssh tool is used to secure inter-node communication in DB2® pureScale® clusters. It uses cryptography to secure this communication. In environments where the use of cryptography must be FIPS 140 compliant, additional db2ssh configuration is required. 

SYMPTOM
The db2ssh tool was introduced in DB2 Version 10.1 Fix Pack 2 and is applicable only to DB2 pureScale environments. 

The db2ssh tool uses cryptography to secure certain types of communication between members in a DB2 pureScale cluster. The cryptographic modules are capable of operating in a mode that strictly enforces FIPS 140 compliance ("FIPS mode").

Operating in FIPS mode can, in some circumstances, impose a performance penalty; therefore FIPS mode is not the default for db2ssh.
In environments where strict FIPS 140 compliance is required, db2ssh can be configured for "FIPS mode" by running the following command:

/var/db2/db2ssh/db2locssh/db2locssh set_fips_mode on

This command should be run on every host in the DB2 pureScale cluster.

While the performance degradation associated with FIPS mode is normally negligible, certain combinations of hardware, operating system and DB2 levels can exhibit significant impact. For this reason, it is recommended that FIPS mode be enabled only for environments subject to regulatory or industry controls that demand FIPS 140 compliance.


CAUSE
 Cryptographic modules operating in compliance with FIPS 140 assure operational correctness by implementing additional checks for certain operations. In particular, the statistical checks imposed on the pseudo-random number generation algorithms can be significantly more rigorous, resulting in additional performance overhead in certain situations.


ENVIRONMENT
DB2 pureScale environment on AIX® and Linux™



DIAGNOSING THE PROBLEM
You can determine if FIPS mode is enabled for db2ssh using the following command: 

/var/db2/db2ssh/db2locssh display_config
version = 1
time_delta = 20 second(s)
debug_level = 2
db2sshid = db2sshid
gskit_path = /home/adebimpe/sqllib/lib/gskit/
fips_mode = on

To turn FIPS OFF, issue the following command:
/var/db2/db2ssh/db2locssh/db2locssh set_fips_mode off

To turn FIPS ON, issue the following command:
/var/db2/db2ssh/db2locssh/db2locssh set_fips_mode on

When FIPS mode is enabled, GPFS™ administration commands might take longer. The impact varies greatly between different configurations, but can range from insignificant (milliseconds) to several or even tens of seconds.

Delays caused by FIPS mode operation can be diagnosed by looking at the system log. You might notice the call to ICC_Attach takes a few seconds on both the originating and target hosts for a particular db2ssh command.

db2locssh:
Nov 4 17:00:26 coralpib225 syslog:debug haCheckICCStatus[10354740]: exit rc = 0
Nov 4 17:00:32 coralpib225 syslog:debug haCheckICCStatus[10354740]: entry
Nov 4 17:00:32 coralpib225 syslog:debug haCheckICCStatus[10354740]: haInitCrypto icc status after call to ICC_Attach: majRC=0 minRC=0 desc=OK iccRC=1
Nov 4 17:00:32 coralpib225 syslog:debug haCheckICCStatus[10354740]: exit rc = 0

db2remssh:
Nov 4 17:00:33 coralpib225 syslog:debug haCheckICCStatus[21299444]: haInitCrypto icc status after call to ICC_SetValue: majRC=0 minRC=0 desc=OK iccRC=1
Nov 4 17:00:33 coralpib225 syslog:debug haCheckICCStatus[21299444]: exit rc = 0
Nov 4 17:00:40 coralpib225 syslog:debug haCheckICCStatus[21299444]: entry
Nov 4 17:00:40 coralpib225 syslog:debug haCheckICCStatus[21299444]: haInitCrypto icc status after call to ICC_Attach: majRC=0 minRC=0 desc=OK iccRC=1
Nov 4 17:00:40 coralpib225 syslog:debug haCheckICCStatus[21299444]: exit rc = 0



RESOLVING THE PROBLEM
FIPS mode should be enabled only in environments that require it.