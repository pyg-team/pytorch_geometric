Title: IBM Where do we need to place the certificate in WebSphere Application Server when using LDAP with SSL - United States

Text:
 TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 We would like to use Active Directory with SSL as the security 
provider in our Collaboration & Deployment Services (C&DS) installation. We are using IBM WebSphere as application server. We need to add a certification to be able to use SSL. 
Where do we need to add this certification?



SYMPTOM
Logging into Deployment Manger Client may result in the following error: 

Login failed 

Reason: 

com.spss.security.authenticaiton.AuthenticationExeption :E#15 

NOT_AUTHENTICATED


CAUSE
The certificate has not been added to the trust.p12 file in WebSphere



DIAGNOSING THE PROBLEM
Review the WebSphere systemout.log for the following error: 


[11/9/16 14:09:43:922 CST] 000000f2 WSX509TrustMa E CWPKI0045E: SSL HANDSHAKE FAILURE: A signer with SubjectDN "CN=xxxxx" was sent from a target host. The signer may need to be added to local trust store "/opt/IBM/WebSphere/AppServer/profiles/CNDSprofile/config/cells/cndsCell/nodes/cndsNode/trust.p12" located in SSL configuration alias "NodeDefaultSSLSettings" loaded from SSL configuration file "security.xml". The extended error message from the SSL handshake exception is: "PKIX path building failed: java.security.cert.CertPathBuilderException: PKIXCertPathBuilderImpl could not build a valid CertPath.; internal cause is: 
java.security.cert.CertPathValidatorException: The certificate issued by CN=XX O=XX is not trusted; internal cause is: 
java.security.cert.CertPathValidatorException: Certificate chaining error"

What this message is saying is that there is a handshake failure between WebSphere and the LDAP server (CN=xxxxx). The signer certificate may need to be added to the local trust store and the path of the local trust store follows. 

A few lines further in the log are the steps to add the signer to the trust store:
11/9/16 14:09:43:923 CST] 000000f2 SystemOut O CWPKI0429I: The signer might need to be added to the local trust store. You can use the Retrieve from port option in the administrative console to retrieve the certificate and resolve the problem. If you determine that the request is trusted, complete the following steps: 1. Log into the administrative console. 2. Expand Security and click SSL certificate and key management. Under Configuration settings, click Manage endpoint security configurations. 3. Select the appropriate outbound configuration to get to the (cell):cndsCell:(node):cndsNode management scope. 4. Under Related Items, click Key stores and certificates and click the NodeDefaultTrustStore key store. 5. Under Additional Properties, click Signer certificates and Retrieve From Port. 6. In the Host field, enter <target host name> in the host name field, enter <target host port> in the Port field, and unknown_cert in the Alias field. 7. Click Retrieve Signer Information. 8. Verify that the certificate information is for a certificate that you can trust. 9. Click Apply and Save. If you do not see an actual host and port field specified in step 6, your client has not specified the host and port.
[11/9/16 14:09:43:924 CST] 000000f2 SystemOut O 








RESOLVING THE PROBLEM
To resolve this issue the certificate must be added in the trust.p12 file which is located in 

<profile>/config/cells/<cellname>/nodes/ of the WAS. 


The signer might need to be added to the local trust store. You can use the Retrieve from port option in the WebSphere administrative console to retrieve the certificate and resolve the problem. If you determine that the request is trusted, complete the following steps: 
1. Log into the administrative console. 
2. Expand Security and click SSL certificate and key management. Under Configuration settings, click Manage endpoint security configurations. 
3. Select the appropriate outbound configuration to get to the (cell):cndsCell:(node):cndsNode management scope. 
4. Under Related Items, click Key stores and certificates and click the NodeDefaultTrustStore key store. 
5. Under Additional Properties, click Signer certificates and Retrieve From Port. 
6. In the Host field, enter <target host name> in the host name field, enter <target host port> in the Port field, and unknown_cert in the Alias field. 
7. Click Retrieve Signer Information. 
8. Verify that the certificate information is for a certificate that you can trust.
9. Click Apply and Save. If you do not see an actual host and port field specified in step 6, your client has not specified the host and port. 

 

RELATED INFORMATION
 Need more help? Our C&DS forum is Live! [https://developer.ibm.com/answers/topics/collaboration.html?smartspace=predictive-analytics]