Title: IBM AEIP when signing on to a CICS 3270 bridge virtual terminal - United States

Text:
ABENDAEIP AEIP ; eibresp2 11 ; 5655M1500 R640 640 R400 400 HCI6400 R650 650 R500 500 HCI6500 5655-M15 5655M15 ; 5655S9700 R660 660 R600 600 HCI6600 5655-S97 5655S97 KIXINFO5655S9700 R670 670 R700 700 HCI6700 ; 564805400 RA0P R410 R110 RB0P R411 R111 5648-054 5648054 KIXINFO TECHNOTE (TROUBLESHOOTING)

PROBLEM(ABSTRACT)
 You are attempting to use the CICS 3270 bridge. You are coming in from a web browser directly into your CICS region. You can run transactions. The problem happens when you try to run your CICS signon program. When the program gets to the "EXEC CICS SIGNON" statement, it abends with an AEIP (abendAEIP), eibresp2=11. 

SYMPTOM
This indicates that the assigned terminal has preset security. You are running the bridge unmodified. You created a profile and added FACILITYLIKE=CBRF to it. The bridge is generating a virtual }AAA terminal id. 

You have reassembled your BMS maps into the DFHHTML PDS. 



CAUSE
Because 3270 bridge terminal uses preset security, SIGNON and SIGNOFF commands cannot be used. The CICS Transaction Server (CICS TS) V3.2 information center, External Interfaces Guide, explains this in section Link3270 programming considerations [http://publib.boulder.ibm.com/infocenter/cicsts/v3r2/topic/com.ibm.cics.ts.doc/dfhtm/topics/dfhtm27.html]: 


Security Processing
When a bridge facility is created, it is signed on as a preset USERID terminal, with the client's USERID. 
As with other preset terminals, the SIGNON and SIGNOFF commands are not permitted, and INVREQ is raised. 

The bridge facility is signed off when it is discarded. It remains signed on if the user transaction ends and the bridge exit specifies a keep time value. 

The USERID is the value returned on the bridge exit initialization call. If no value is returned, the USERID with which the transaction was started is used. 

When the bridge exit initialization call returns a bridge facility token, a check is made that the USERID is the same as that specified when the bridge facility was created. No other security check is made. If a greater level of security is required, such as validation of every message, this can be done in the bridge exit by issuing a VERIFY PASSWORD command. 

You might want to read the entire section Part 2. Bridging to 3270 transactions in the External Interfaces Guide.


DIAGNOSING THE PROBLEM
CICS TS V1.3 APAR PQ45098 added code to CICS to allow the WEB Bridge to handle expired passwords. The documentation in the PTF (UQ50963) states that there is an error message (message 6) for a REVOKED userid. The revoked userid message will be issued by DFHWBPW but only when it detected the revoked userid on its CHANGE PASSWORD call. There is no revoked userid processing if the userid is immediately found to be revoked and DFHWBPW is not even called. 

The whole functionality of PQ45098 is to allow access if the userid and password are correct (valid or expired) and to reject everything else. If the request is rejected then no information is returned to the user. This is important when CICS can be accessed over the internet. If a revoked userid response was sent back a potential attacker would now have one piece of valuable information, a valid userid on your system. 

By rejecting all invalid requests in the same fashion any attackers do not know if the userid, password or both were wrong. They only know that the particular userid and password combination is not valid. If the userid and password combination is valid then you must be a legitimate user of the system. For expired passwords DFHWBPW is used and it provides more information to the legitimate user (such as userid becoming revoked).



RESOLVING THE PROBLEM
Do not attempt to use EXEC CICS SIGNON with the 3270 bridge. The terminals for the bridge have preset security.





PRODUCT ALIAS/SYNONYM
 CICS/TS CICS TS CICS Transaction Server